!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(1);i(o);"findPersonBody"==document.body.id&&!function(){var t=!0,e=document.querySelectorAll("#searchPerson input"),n=document.querySelector("#findPerson"),i=document.querySelector("#searchPhone");e.forEach(function(e){0!=e.value.trim().length||"last-name"!=e.name&&"first-name"!=e.name||(t=!1)}),t===!1?n.setAttribute("disabled","disabled"):null,e.forEach(function(t){t.addEventListener("input",function(){var t=!0,o=0;e.forEach(function(n){0==n.value.trim().length||"last-name"!=n.name&&"DOB"!=n.name&&"first-name"!=n.name?null:o++,3===o?(t=!0,i.removeAttribute("disabled"),e.forEach(function(t,e,n){e<=2&&t.classList.remove("myError")})):(t=!1,e.forEach(function(t,e,n){e<=2&&t.classList.add("myError")}),i.setAttribute("disabled","disabled"))}),t===!0?n.removeAttribute("disabled"):n.setAttribute("disabled","disabled")})}),i.addEventListener("click",function(t){document.querySelector("#action").value="searchByPhone"}),document.querySelector("#btnClear").addEventListener("click",function(t){e.forEach(function(t){t.value=""}),t.preventDefault()})}()},function(t,e,n){var i,o,a;(function(n){!function(n,r){o=[],i=r,a="function"==typeof i?i.apply(e,o):i,!(void 0!==a&&(t.exports=a))}(this,function(){var t="undefined"!=typeof n?n:this||window,e=document.documentElement,i=document.body,o=null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&parseFloat(RegExp.$1),a="data-toggle",r="data-dismiss",l="data-spy",c="data-ride",u="Affix",s="Alert",f="Button",d="Carousel",h="Collapse",p="Dropdown",m="Modal",v="Popover",g="ScrollSpy",b="Tab",y="Tooltip",x="data-backdrop",T="data-keyboard",w="data-target",E="data-interval",I="data-height",C="data-pause",A="data-original-title",L="data-original-text",S="data-dismissible",M="data-trigger",k="data-animation",D="data-container",B="data-placement",H="data-delay",N="data-offset-top",P="data-offset-bottom",W="backdrop",q="keyboard",$="delay",O="duration",R="content",z="target",j="interval",_="pause",F="animation",U="placement",X="container",Y="offsetTop",G="offsetBottom",J="offsetLeft",K="scrollTop",Q="scrollLeft",V="clientWidth",Z="clientHeight",tt="offsetWidth",et="offsetHeight",nt="innerWidth",it="innerHeight",ot="scrollHeight",at="height",rt="aria-expanded",lt="aria-hidden",ct="click",ut="hover",st="keydown",ft="resize",dt="scroll",ht="show",pt="shown",mt="hide",vt="hidden",gt="close",bt="closed",yt="slid",xt="slide",Tt="change",wt="getAttribute",Et="setAttribute",It="hasAttribute",Ct="getElementsByTagName",At="getBoundingClientRect",Lt="querySelectorAll",St="getElementsByClassName",Mt="indexOf",kt="parentNode",Dt="length",Bt="toLowerCase",Ht="Transition",Nt="Webkit",Pt="style",Wt="active",qt="in",$t="collapsing",Ot="disabled",Rt="loading",zt="left",jt="right",_t="top",Ft="bottom",Ut="onmouseleave"in document?["mouseenter","mouseleave"]:["mouseover","mouseout"],Xt=/\b(top|bottom|left|top)+/,Yt=Nt+Ht in e[Pt]||Ht[Bt]()in e[Pt],Gt=Nt+Ht in e[Pt]?Nt[Bt]()+Ht+"End":Ht[Bt]()+"end",Jt=function(t){t.focus?t.focus():t.setActive()},Kt=function(t,e){t.classList.add(e)},Qt=function(t,e){t.classList.remove(e)},Vt=function(t,e){return t.classList.contains(e)},Zt=function(t){for(var e=[],n=0,i=t[Dt];n<i;n++)e.push(t[n]);return e},te=function(t,e){var n=8===o?Lt:St;return Zt(t[n](8===o?"."+e.replace(/\s(?=[a-z])/g,"."):e))},ee=function(t,e){var n=e?e:document;return"object"==typeof t?t:n.querySelector(t)},ne=function(t,e){for(var n=e.charAt(0);t&&t!==document;t=t[kt]){if(("."===n||"#"!==n)&&null!==ee(e,t[kt]))return t;if("#"===n&&t.id===e.substr(1))return t}return!1},ie=function(t,e,n){t.addEventListener(e,n,!1)},oe=function(t,e,n){t.removeEventListener(e,n,!1)},ae=function(t,e,n){ie(t,e,function i(){n(),oe(t,e,i)})},re=function(t,e){Yt?ae(t,Gt,e):e()},le=function(t,e,n){var i=new CustomEvent(t+".bs."+e);i.relatedTarget=n,this.dispatchEvent(i)},ce=document[Ct]("*"),ue=function(t,e,n,i){for(var o=i&&i[Dt]?i:ce,a=0;a<o[Dt];a++){var r=o[a][wt](n),l=t.replace(/spy/i,"")[Bt]();(r&&t===f&&r[Mt](l)>-1||r===l)&&new e(o[a])}},se=function(e){var n=e&&(e.currentStyle||t.getComputedStyle(e)),i=/px/.test(n.borderTopWidth)?Math.round(n.borderTopWidth.replace("px","")):0,o=/px/.test(n.borderBottomWidth)?Math.round(n.borderBottomWidth.replace("px","")):0,a=/px/.test(n.marginTop)?Math.round(n.marginTop.replace("px","")):0,r=/px/.test(n.marginBottom)?Math.round(n.marginBottom.replace("px","")):0;return e[Z]+parseInt(i)+parseInt(o)+parseInt(a)+parseInt(r)},fe=function(t){for(var e=0,n=0,i=t.children[Dt];n<i;n++)e+=se(t.children[n]);return e},de=function(n){var i=n[At]();return i[_t]>=0&&i[zt]>=0&&i[Ft]<=(t[it]||e[Z])&&i[jt]<=(t[nt]||e[V])},he=function(){return{y:t.pageYOffset||e[K],x:t.pageXOffset||e[Q]}},pe=function(t,e,n,o){var a=t[At](),r=o===i?he():{x:o[J]+o[Q],y:o[Y]+o[K]},l={w:a[jt]-a[zt],h:a[Ft]-a[_t]},c={w:e[tt],h:e[et]};n===_t?(e[Pt][_t]=a[_t]+r.y-c.h+"px",e[Pt][zt]=a[zt]+r.x-c.w/2+l.w/2+"px"):n===Ft?(e[Pt][_t]=a[_t]+r.y+l.h+"px",e[Pt][zt]=a[zt]+r.x-c.w/2+l.w/2+"px"):n===zt?(e[Pt][_t]=a[_t]+r.y-c.h/2+l.h/2+"px",e[Pt][zt]=a[zt]+r.x-c.w+"px"):n===jt&&(e[Pt][_t]=a[_t]+r.y-c.h/2+l.h/2+"px",e[Pt][zt]=a[zt]+r.x+l.w+"px"),e.className[Mt](n)===-1&&(e.className=e.className.replace(Xt,n))},me=function(t){return t===_t?Ft:t===Ft?_t:t===zt?jt:t===jt?zt:t},ve=function(n,a){n=ee(n),a=a||{};var r=n[wt](w),l=n[wt](N),c=n[wt](P),s="affix",f="affixed",d="function",h="update",p="affix-top",m="affixed-top",v="affix-bottom",g="affixed-bottom";if(this[z]=a[z]?ee(a[z]):ee(r)||null,this[Y]=a[Y]?a[Y]:parseInt(l)||0,this[G]=a[G]?a[G]:parseInt(c)||0,this[z]||this[Y]||this[G]){var b,y,x,T,E,I,C=this,A=o&&o<10?500:50,L=!1,S=!1,M=function(){return Math.max(i[ot],i[et],e[Z],e[ot],e[et])},k=function(){return null!==C[z]?C[z][At]()[_t]+T:C[Y]?parseInt(typeof C[Y]===d?C[Y]():C[Y]||0):void 0},D=function(){if(C[G])return x-n[et]-parseInt(typeof C[G]===d?C[G]():C[G]||0)},B=function(){x=M(),T=parseInt(he().y,0),b=k(),y=D(),E=parseInt(b)-T<0&&T>parseInt(b),I=parseInt(y)-T<0&&T>parseInt(y)},H=function(){L||Vt(n,s)||(le.call(n,s,s),le.call(n,p,s),Kt(n,s),L=!0,le.call(n,f,s),le.call(n,m,s))},W=function(){L&&Vt(n,s)&&(Qt(n,s),L=!1)},q=function(){S||Vt(n,v)||(le.call(n,s,s),le.call(n,v,s),Kt(n,v),S=!0,le.call(n,f,s),le.call(n,g,s))},$=function(){S&&Vt(n,v)&&(Qt(n,v),S=!1)},O=function(){I?(E&&W(),q()):($(),E?H():W())};this[h]=function(){B(),O()},u in n||(ie(t,dt,this[h]),ie(t,ft,function(){setTimeout(function(){C[h]()},A)})),n[u]=this,this[h]()}};ue(u,ve,l);var ge=function(t){t=ee(t);var e=this,n="alert",i=ne(t,"."+n),o=function(o){var a=o[z];a=a[It](r)?a:a[kt],a&&a[It](r)&&(i=ne(a,"."+n),t=ee("["+r+'="'+n+'"]',i),(t===a||t===a[kt])&&i&&e.close())},a=function(){le.call(i,bt,n),oe(t,ct,o),i[kt].removeChild(i)};this.close=function(){i&&t&&Vt(i,qt)&&(le.call(i,gt,n),Qt(i,qt),setTimeout(function(){i&&re(i,a)},O))},s in t||ie(t,ct,o),t[s]=this};ue(s,ge,r);var be=function(t,e){t=ee(t),e=e||null;var n=!1,i="button",o="checked",a="reset",r="LABEL",l="INPUT",c=function(){e&&e!==a&&(e===Rt&&(Kt(t,Ot),t[Et](Ot,Ot)),t[Et](L,t.innerHTML.replace(/^\s+|\s+$/g,"")),t.innerHTML=t[wt]("data-"+e+"-text"))},u=function(){t[wt](L)&&((Vt(t,Ot)||t[wt](Ot)===Ot)&&(Qt(t,Ot),t.removeAttribute(Ot)),t.innerHTML=t[wt](L))},s=function(e){var a=e[z][kt],c=e[z].tagName===r?e[z]:a.tagName===r?a:null;if(c){var u=this,s=te(u,"btn"),f=c[Ct](l)[0];if(f){if("checkbox"===f.type&&(f[o]?(Qt(c,Wt),f[wt](o),f.removeAttribute(o),f[o]=!1):(Kt(c,Wt),f[wt](o),f[Et](o,o),f[o]=!0),n||(n=!0,le.call(f,Tt,i),le.call(t,Tt,i))),"radio"===f.type&&!n&&!f[o]){Kt(c,Wt),f[Et](o,o),f[o]=!0,le.call(f,Tt,i),le.call(t,Tt,i),n=!0;for(var d=0,h=s[Dt];d<h;d++){var p=s[d],m=p[Ct](l)[0];p!==c&&Vt(p,Wt)&&(Qt(p,Wt),m.removeAttribute(o),m[o]=!1,le.call(m,Tt,i))}}setTimeout(function(){n=!1},50)}}};Vt(t,"btn")&&null!==e&&(e!==a?c():u()),Vt(t,"btn-group")&&(f in t||ie(t,ct,s),t[f]=this)};ue(f,be,a);var ye=function(e,n){e=ee(e),n=n||{};var i="false"!==e[wt](E)&&(parseInt(e[wt](E))||5e3),o=e[wt](C)===ut||!1,a="true"===e[wt](T)||!1,r="carousel",l="paused",c="direction",u="data-slide-to";this[q]=n[q]===!0||a,this[_]=!(n[_]!==ut&&!o)&&ut,n[j]||i?this[j]=parseInt(n[j])||i:this[j]=!1;var s=this,f=e.index=0,h=e.timer=0,p=!1,m=te(e,"item"),v=m[Dt],g=this[c]=zt,b=te(e,r+"-control"),y=b[0],x=b[1],w=ee("."+r+"-indicators",e),I=w[Ct]("LI"),A=function(){s[j]===!1||Vt(e,l)||(Kt(e,l),!p&&clearInterval(h))},L=function(){s[j]!==!1&&Vt(e,l)&&(Qt(e,l),!p&&clearInterval(h),!p&&s.cycle())},S=function(t){if(t.preventDefault(),!p){var e=t[z],n=s.getActiveIndex();if(!e||Vt(e,Wt)||!e[wt](u))return!1;f=parseInt(e[wt](u),10),n<f||0===n&&f===v-1?g=s[c]=zt:(n>f||n===v-1&&0===f)&&(g=s[c]=jt),s.slideTo(f)}},M=function(t){if(t.preventDefault(),!p){var e=t.currentTarget||t.srcElement;e===x?(f++,g=s[c]=zt,f===v-1?f=v-1:f===v&&(f=0)):e===y&&(f--,g=s[c]=jt,0===f?f=0:f<0&&(f=v-1)),s.slideTo(f)}},k=function(t){if(!p){switch(t.which){case 39:f++,g=s[c]=zt,f==v-1?f=v-1:f==v&&(f=0);break;case 37:f--,g=s[c]=jt,0==f?f=0:f<0&&(f=v-1);break;default:return}s.slideTo(f)}},D=function(t){for(var e=0,n=I[Dt];e<n;e++)Qt(I[e],Wt);I[t]&&Kt(I[t],Wt)};this.cycle=function(){g=this[c]=zt,h=setInterval(function(){f++,f=f===v?0:f,s.slideTo(f)},this[j])},this.slideTo=function(t){var n=this.getActiveIndex(),i=g===zt?"next":"prev";le.call(e,xt,r,m[t]),p=this.isSliding=!0,clearInterval(h),D(t),Yt&&Vt(e,"slide")?(Kt(m[t],i),m[t][tt],Kt(m[t],g),Kt(m[n],g),ae(m[t],Gt,function(){p=s.isSliding=!1,Kt(m[t],Wt),Qt(m[n],Wt),Qt(m[t],i),Qt(m[t],g),Qt(m[n],g),s[j]&&!Vt(e,l)&&s.cycle(),le.call(e,yt,r,m[t])})):(Kt(m[t],Wt),m[t][tt],Qt(m[n],Wt),setTimeout(function(){p=!1,s[j]&&!Vt(e,l)&&s.cycle(),le.call(e,yt,r,m[t])},100))},this.getActiveIndex=function(){return m[Mt](te(e,"item active")[0])||0},d in e||(this[_]&&this[j]&&(ie(e,Ut[0],A),ie(e,Ut[1],L),ie(e,"touchstart",A),ie(e,"touchend",L)),x&&ie(x,ct,M),y&&ie(y,ct,M),w&&ie(w,ct,S,!1),this[q]===!0&&ie(t,st,k,!1)),this.getActiveIndex()<0&&(m[Dt]&&Kt(m[0],Wt),I[Dt]&&D(0)),this[j]&&this.cycle(),e[d]=this};ue(d,ye,c);var xe=function(t,e){t=ee(t),e=e||{};var n=null,i=null,o=this,a=!1,r=t[wt]("data-parent"),l="collapse",c="collapsed",u=function(t){le.call(t,ht,l),a=!0,Kt(t,$t),Kt(t,qt),setTimeout(function(){t[Pt][at]=fe(t)+"px"},0),re(t,function(){Qt(t,$t),t[Pt][at]="",a=!1,t[Et](rt,"true"),le.call(t,pt,l)})},s=function(t){le.call(t,mt,l),a=!0,t[Pt][at]=fe(t)+"px",setTimeout(function(){Kt(t,$t),t[Pt][at]="0px"},0),re(t,function(){Qt(t,$t),Qt(t,qt),t[Pt][at]="",a=!1,t[Et](rt,"false"),le.call(t,vt,l)})},f=function(){var e=t.href&&t[wt]("href"),n=t[wt](w),i=e||n&&/#/.test(n)&&n;return i&&ee(i)};this.toggle=function(t){t.preventDefault(),a||(Vt(i,qt)?o.hide():o.show())},this.hide=function(){s(i),Kt(t,c)},this.show=function(){if(u(i),Qt(t,c),null!==n)for(var e=te(n,l+" "+qt),o=0,a=e[Dt];o<a;o++)e[o]!==i&&s(e[o])},h in t||ie(t,ct,this.toggle),i=f(),n=ee(e.parent)||r&&ne(t,r),t[h]=this};ue(h,xe,a);var Te=function(t,e){t=ee(t),this.persist=e===!0||"true"===t[wt]("data-persist")||!1;var n=this,i=!1,o=t[kt],r="dropdown",l="open",c=null,u=ee(".dropdown-menu",o),s=Zt(u[Ct]("*")),f=function(t){!i||27!=t.which&&27!=t.keyCode||(c=null,m())},d=function(e){var r,l=e[z];if(r=1!==l.nodeType&&(l[wt](a)||l[kt][wt](a)),l===t||l===o||l[kt]===t)e.preventDefault(),c=t,n.toggle();else if(i){if((l===u||s&&s[Mt](l)>-1)&&(n.persist||r))return;c=null,m()}(/\#$/.test(l.href)||l[kt]&&/\#$/.test(l[kt].href))&&e.preventDefault()},h=function(){le.call(o,ht,r,c),Kt(o,l),u[Et](rt,!0),le.call(o,pt,r,c),ie(document,st,f),i=!0},m=function(){le.call(o,mt,r,c),Qt(o,l),u[Et](rt,!1),le.call(o,vt,r,c),oe(document,st,f),i=!1};this.toggle=function(){Vt(o,l)&&i?m():h()},p in t||(u[Et]("tabindex","0"),ie(document,ct,d)),t[p]=this};ue(p,Te,a);var we=function(n,o){n=ee(n);var a=n[wt](w)||n[wt]("href"),l=ee(a),c=Vt(n,"modal")?n:l,u="modal",s="static",f="paddingLeft",d="paddingRight",h="modal-backdrop";if(Vt(n,"modal")&&(n=null),c){o=o||{},this[q]=o[q]!==!1&&"false"!==c[wt](T),this[W]=o[W]!==s&&c[wt](x)!==s||s,this[W]=o[W]!==!1&&"false"!==c[wt](x)&&this[W],this[R]=o[R];var p,v,g,b,y=this,E=this.open=!1,I=null,C=function(){var n=e[At]();return t[nt]||n[jt]-Math.abs(n[zt])},A=function(){var e=i.currentStyle||t.getComputedStyle(i),n=parseInt(e[d],10);p&&(i[Pt][d]=n+g+"px")},L=function(){i[Pt][d]=""},S=function(){var t,e=document.createElement("div");return e.className=u+"-scrollbar-measure",i.appendChild(e),t=e[tt]-e[V],i.removeChild(e),t},M=function(){p=i[V]<C(),v=c[ot]>e[Z],g=S()},k=function(){c[Pt][f]=!p&&v?g+"px":"",c[Pt][d]=p&&!v?g+"px":""},D=function(){c[Pt][f]="",c[Pt][d]=""},B=function(){var t=document.createElement("div");b=ee("."+h),null===b&&(t[Et]("class",h+" fade"),b=t,i.appendChild(b))},H=function(){b=ee("."+h),b&&null!==b&&"object"==typeof b&&(i.removeChild(b),b=null)},N=function(){Vt(c,qt)?oe(document,st,j):ie(document,st,j)},P=function(){Vt(c,qt)?oe(t,ft,y.update):ie(t,ft,y.update)},$=function(){Vt(c,qt)?oe(c,ct,_):ie(c,ct,_)},O=function(t){var e=t[z];e=e[It](w)||e[It]("href")?e:e[kt],E||e!==n||Vt(c,qt)||(c.modalTrigger=n,I=n,y.show(),t.preventDefault())},j=function(t){var e=t.which||t.keyCode;y[q]&&27==e&&E&&y.hide()},_=function(t){var e=t[z];E&&(e[kt][wt](r)===u||e[wt](r)===u||e===c&&y[W]!==s)&&(y.hide(),I=null,t.preventDefault())};this.toggle=function(){E&&Vt(c,qt)?this.hide():this.show()},this.show=function(){le.call(c,ht,u,I);var t=te(document,u+" in")[0];t&&t!==c&&t.modalTrigger[m].hide(),this[W]&&B(),b&&!Vt(b,qt)&&setTimeout(function(){Kt(b,qt)},0),setTimeout(function(){c[Pt].display="block",M(),A(),k(),P(),$(),N(),Kt(i,u+"-open"),Kt(c,qt),c[Et](lt,!1)},0),re(c,function(){E=y.open=!0,Jt(c),le.call(c,pt,u,I)})},this.hide=function(){le.call(c,mt,u),b=ee("."+h),null!==b&&Qt(b,qt),Qt(c,qt),c[Et](lt,!0),re(c,function(){Qt(i,u+"-open"),P(),$(),N(),D(),L(),c[Pt].display="",te(document,u+" "+qt)[0]||H(),E=y.open=!1,n&&Jt(n),le.call(c,vt,u)})},this.setContent=function(t){ee("."+u+"-content",c).innerHTML=t},this.update=function(){E&&(M(),A(),k())},!n||m in n||ie(n,ct,O),this[R]&&this.setContent(this[R]),!!n&&(n[m]=this)}};ue(m,we,a);var Ee=function(e,n){e=ee(e);var a=e[wt](M),r=e[wt](k),l=e[wt](B),c=e[wt](S),u=e[wt](H),s=e[wt](D),f="popover",d="template",h="trigger",p="class",m="div",g="fade",b="data-title",y="data-content",x="dismissible",T='<button type="button" class="close">Ã—</button>';n=n||{},this[d]=n[d]?n[d]:null,this[h]=n[h]?n[h]:a||ut,this[F]=n[F]&&n[F]!==g?n[F]:r||g,this[U]=n[U]?n[U]:l||_t,this[$]=parseInt(n[$]||u)||200,this[x]=!(!n[x]&&"true"!==c),this[X]=ee(n[X])||ee(s)||i;var w=this,E=e[wt](b)||null,I=e[wt](y)||null;if(I||this[d]){var C=null,A=0,L=this[U],N=function(t){null!==C&&t[z]===ee(".close",C)&&w.hide()},P=function(){w[X].removeChild(C),A=null,C=null},W=function(){if(E=e[wt](b),I=e[wt](y),C=document.createElement(m),null!==I&&null===w[d]){if(C[Et]("role","tooltip"),null!==E){var t=document.createElement("h3");t[Et](p,f+"-title"),t.innerHTML=w[x]?E+T:E,C.appendChild(t)}var n=document.createElement(m),i=document.createElement(m);n[Et](p,"arrow"),i[Et](p,f+"-content"),C.appendChild(n),C.appendChild(i),i.innerHTML=w[x]&&null===E?I+T:I}else{var o=document.createElement(m);o.innerHTML=w[d],C.innerHTML=o.firstChild.innerHTML}w[X].appendChild(C),C[Pt].display="block",C[Et](p,f+" "+L+" "+w[F])},q=function(){!Vt(C,qt)&&Kt(C,qt)},O=function(){pe(e,C,L,w[X]),de(C)||(L=me(L),pe(e,C,L,w[X]))};this.toggle=function(){null===C?w.show():w.hide()},this.show=function(){clearTimeout(A),A=setTimeout(function(){null===C&&(L=w[U],W(),O(),q(),le.call(e,ht,f),re(C,function(){le.call(e,pt,f)}))},20)},this.hide=function(){clearTimeout(A),A=setTimeout(function(){C&&null!==C&&Vt(C,qt)&&(le.call(e,mt,f),Qt(C,qt),re(C,function(){P(),le.call(e,vt,f)}))},w[$])},v in e||(w[h]===ut?(ie(e,Ut[0],w.show),w[x]||ie(e,Ut[1],w.hide)):/^(click|focus)$/.test(w[h])&&(ie(e,w[h],w.toggle),w[x]||ie(e,"blur",w.hide)),w[x]&&ie(document,ct,N),o&&o<9||ie(t,ft,w.hide)),e[v]=w}};ue(v,Ee,a);var Ie=function(e,n){e=ee(e);var i=ee(e[wt](w));if(n=n||{},n[z]||i){for(var a,r=n[z]&&ee(n[z])||i,l=r&&r[Ct]("A"),c=[],u=[],s=e[et]<e[ot]?e:t,f=s===t,d=0,h=l[Dt];d<h;d++){var p=l[d][wt]("href"),m=p&&/#[a-z0-9]+$/i.test(p)&&ee(p);m&&(c.push(l[d]),u.push(m))}var v=function(t){var n=c[t][kt],i=u[t],o=ne(n,".dropdown"),r=f&&i[At](),l=Vt(n,Wt)||!1,s=f?r[_t]+a:i[Y]-(u[t-1]?0:10),d=f?r[Ft]+a:u[t+1]?u[t+1][Y]:e[ot],h=a>=s&&d>a;if(!l&&h)"LI"!==n.tagName||Vt(n,Wt)||(Kt(n,Wt),l=!0,o&&!Vt(o,Wt)&&Kt(o,Wt),le.call(e,"activate","scrollspy",c[t]));else if(h){if(!h&&!l||l&&h)return}else"LI"===n.tagName&&Vt(n,Wt)&&(Qt(n,Wt),l=!1,o&&Vt(o,Wt)&&!te(n[kt],Wt).length&&Qt(o,Wt))},b=function(){a=f?he().y:e[K];for(var t=0,n=c[Dt];t<n;t++)v(t)};this.refresh=function(){b()},g in e||(ie(s,dt,this.refresh),o&&o<9||ie(t,ft,this.refresh)),this.refresh(),e[g]=this}};ue(g,Ie,l);var Ce=function(t,e){t=ee(t);var n=t[wt](I),i="tab",o="height",a="isAnimating";t[a]=!1,e=e||{},this[o]=!!Yt&&(e[o]||"true"===n);var r,l,c=this,u=ne(t,".nav"),s=ee(".dropdown",u),f=function(){var t,e=te(u,Wt);return 1!==e[Dt]||Vt(e[0],"dropdown")?e[Dt]>1&&(t=e[e[Dt]-1]):t=e[0],t[Ct]("A")[0]},d=function(){return ee(f()[wt]("href"))},h=function(t){t.preventDefault(),r=t[z],c.show()};this.show=function(){var e=ee(r[wt]("href")),n=f(),c=d();n[a]&&r[a]||Vt(r[kt],Wt)||(n[a]=r[a]=!0,Qt(n[kt],Wt),Kt(r[kt],Wt),s&&(Vt(t[kt][kt],"dropdown-menu")?Vt(s,Wt)||Kt(s,Wt):Vt(s,Wt)&&Qt(s,Wt)),l&&(l[Pt][o]=fe(c)+"px"),le.call(n,mt,i,r),setTimeout(function(){Qt(c,qt)},0),re(c,function(){l&&Kt(l,$t),Qt(c,Wt),Kt(e,Wt),setTimeout(function(){Kt(e,qt),l&&(l[Pt][o]=fe(e)+"px")},0),le.call(r,ht,i,n),le.call(n,vt,i,r)}),re(e,function(){le.call(r,pt,i,n),l?setTimeout(function(){re(l,function(){l[Pt][o]="",Qt(l,$t),n[a]=r[a]=!1})},0):n[a]=r[a]=!1}))},b in t||ie(t,ct,h),this[o]&&(l=d()[kt]),t[b]=this};ue(b,Ce,a);var Ae=function(t,e){t=ee(t);var n=t[wt](k);placementData=t[wt](B),delayData=t[wt](H),containerData=t[wt](D),component="tooltip",classString="class",title="title",fade="fade",div="div",e=e||{},this[F]=e[F]&&e[F]!==fade?e[F]:n||fade,this[U]=e[U]?e[U]:placementData||_t,this[$]=parseInt(e[$]||delayData)||200,this[X]=ee(e[X])||ee(containerData)||i;var o=this,a=0,r=this[U],l=null,c=t[wt](title)||t[wt](A);if(c){var u=function(){o[X].removeChild(l),l=null,a=null},s=function(){c=t[wt](title)||t[wt](A),l=document.createElement(div),l[Et]("role",component);var e=document.createElement(div),n=document.createElement(div);e[Et](classString,component+"-arrow"),n[Et](classString,component+"-inner"),l.appendChild(e),l.appendChild(n),n.innerHTML=c,o[X].appendChild(l),l[Et](classString,component+" "+r+" "+o[F])},f=function(){pe(t,l,r,o[X]),de(l)||(r=me(r),pe(t,l,r,o[X]))},d=function(){!Vt(l,qt)&&Kt(l,qt)};this.show=function(){clearTimeout(a),a=setTimeout(function(){null===l&&(r=o[U],s(),f(),d(),le.call(t,ht,component),re(l,function(){le.call(t,pt,component)}))},20)},this.hide=function(){clearTimeout(a),a=setTimeout(function(){l&&null!==l&&Vt(l,qt)&&(le.call(t,mt,component),Qt(l,qt),re(l,function(){u(),le.call(t,vt,component)}))},o[$])},this.toggle=function(){l?o.hide():o.show()},y in t||(t[Et](A,c),t.removeAttribute(title),ie(t,Ut[0],this.show),ie(t,Ut[1],this.hide)),t[y]=this}};return ue(y,Ae,a),{Affix:ve,Alert:ge,Button:be,Carousel:ye,Collapse:xe,Dropdown:Te,Modal:we,Popover:Ee,ScrollSpy:Ie,Tab:Ce,Tooltip:Ae}})}).call(e,function(){return this}())}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbXktY29tLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA4MjdkZGZiOTgwNTMxNmNhY2E5OCIsIndlYnBhY2s6Ly8vLi9qcy9sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9ib290c3RyYXAubmF0aXZlL2Rpc3QvYm9vdHN0cmFwLW5hdGl2ZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfYm9vdHN0cmFwIiwiZG9jdW1lbnQiLCJib2R5IiwiYmxuUmVtb3ZlU3VtYml0IiwiZWxtSW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImJ0blN1bWJpdCIsInF1ZXJ5U2VsZWN0b3IiLCJidG5GaW5kUGVyc29uIiwiZm9yRWFjaCIsImN1cjIiLCJ2YWx1ZSIsInRyaW0iLCJsZW5ndGgiLCJuYW1lIiwic2V0QXR0cmlidXRlIiwiY3VyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImJsblN1bWJpdCIsImludFJpZ2h0IiwiY3VyUGxhY2VkIiwicmVtb3ZlQXR0cmlidXRlIiwiZWxlbWVudCIsImluZGV4IiwiYXJyYXkiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyIsIl9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fIiwiZ2xvYmFsIiwicm9vdCIsImZhY3RvcnkiLCJhcHBseSIsInVuZGVmaW5lZCIsInRoaXMiLCJnbG9iYWxPYmplY3QiLCJ3aW5kb3ciLCJkb2MiLCJkb2N1bWVudEVsZW1lbnQiLCJpc0lFIiwiUmVnRXhwIiwiZXhlYyIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInBhcnNlRmxvYXQiLCIkMSIsImRhdGFUb2dnbGUiLCJkYXRhRGlzbWlzcyIsImRhdGFTcHkiLCJkYXRhUmlkZSIsInN0cmluZ0FmZml4Iiwic3RyaW5nQWxlcnQiLCJzdHJpbmdCdXR0b24iLCJzdHJpbmdDYXJvdXNlbCIsInN0cmluZ0NvbGxhcHNlIiwic3RyaW5nRHJvcGRvd24iLCJzdHJpbmdNb2RhbCIsInN0cmluZ1BvcG92ZXIiLCJzdHJpbmdTY3JvbGxTcHkiLCJzdHJpbmdUYWIiLCJzdHJpbmdUb29sdGlwIiwiZGF0YWJhY2tkcm9wIiwiZGF0YUtleWJvYXJkIiwiZGF0YVRhcmdldCIsImRhdGFJbnRlcnZhbCIsImRhdGFIZWlnaHQiLCJkYXRhUGF1c2UiLCJkYXRhT3JpZ2luYWxUaXRsZSIsImRhdGFPcmlnaW5hbFRleHQiLCJkYXRhRGlzbWlzc2libGUiLCJkYXRhVHJpZ2dlciIsImRhdGFBbmltYXRpb24iLCJkYXRhQ29udGFpbmVyIiwiZGF0YVBsYWNlbWVudCIsImRhdGFEZWxheSIsImRhdGFPZmZzZXRUb3AiLCJkYXRhT2Zmc2V0Qm90dG9tIiwiYmFja2Ryb3AiLCJrZXlib2FyZCIsImRlbGF5IiwiZHVyYXRpb24iLCJjb250ZW50IiwidGFyZ2V0IiwiaW50ZXJ2YWwiLCJwYXVzZSIsImFuaW1hdGlvbiIsInBsYWNlbWVudCIsImNvbnRhaW5lciIsIm9mZnNldFRvcCIsIm9mZnNldEJvdHRvbSIsIm9mZnNldExlZnQiLCJzY3JvbGxUb3AiLCJzY3JvbGxMZWZ0IiwiY2xpZW50V2lkdGgiLCJjbGllbnRIZWlnaHQiLCJvZmZzZXRXaWR0aCIsIm9mZnNldEhlaWdodCIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsInNjcm9sbEhlaWdodCIsImhlaWdodCIsImFyaWFFeHBhbmRlZCIsImFyaWFIaWRkZW4iLCJjbGlja0V2ZW50IiwiaG92ZXJFdmVudCIsImtleWRvd25FdmVudCIsInJlc2l6ZUV2ZW50Iiwic2Nyb2xsRXZlbnQiLCJzaG93RXZlbnQiLCJzaG93bkV2ZW50IiwiaGlkZUV2ZW50IiwiaGlkZGVuRXZlbnQiLCJjbG9zZUV2ZW50IiwiY2xvc2VkRXZlbnQiLCJzbGlkRXZlbnQiLCJzbGlkZUV2ZW50IiwiY2hhbmdlRXZlbnQiLCJnZXRBdHRyaWJ1dGUiLCJoYXNBdHRyaWJ1dGUiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImdldEVsZW1lbnRzQnlDTEFTU05BTUUiLCJpbmRleE9mIiwicGFyZW50Tm9kZSIsInRvTG93ZXJDYXNlIiwiVHJhbnNpdGlvbiIsIldlYmtpdCIsInN0eWxlIiwiYWN0aXZlIiwiaW5DbGFzcyIsImNvbGxhcHNpbmciLCJkaXNhYmxlZCIsImxvYWRpbmciLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJtb3VzZUhvdmVyIiwidGlwUG9zaXRpb25zIiwic3VwcG9ydFRyYW5zaXRpb25zIiwidHJhbnNpdGlvbkVuZEV2ZW50Iiwic2V0Rm9jdXMiLCJmb2N1cyIsInNldEFjdGl2ZSIsImFkZENsYXNzIiwiY2xhc3NOQU1FIiwicmVtb3ZlQ2xhc3MiLCJoYXNDbGFzcyIsImNvbnRhaW5zIiwibm9kZUxpc3RUb0FycmF5Iiwibm9kZUxpc3QiLCJjaGlsZEl0ZW1zIiwiaSIsIm5sbCIsInB1c2giLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwic2VsZWN0aW9uTWV0aG9kIiwicmVwbGFjZSIsInF1ZXJ5RWxlbWVudCIsInNlbGVjdG9yIiwicGFyZW50IiwibG9va1VwIiwiZ2V0Q2xvc2VzdCIsImZpcnN0Q2hhciIsImNoYXJBdCIsInN1YnN0ciIsIm9uIiwiaGFuZGxlciIsIm9mZiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvbmUiLCJoYW5kbGVyV3JhcHBlciIsImVtdWxhdGVUcmFuc2l0aW9uRW5kIiwiYm9vdHN0cmFwQ3VzdG9tRXZlbnQiLCJldmVudE5hbWUiLCJjb21wb25lbnROYW1lIiwicmVsYXRlZCIsIk9yaWdpbmFsQ3VzdG9tRXZlbnQiLCJDdXN0b21FdmVudCIsInJlbGF0ZWRUYXJnZXQiLCJkaXNwYXRjaEV2ZW50IiwiQWxsRE9NRWxlbWVudHMiLCJpbml0aWFsaXplRGF0YUFQSSIsImNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwiZGF0YUF0dHJpYnV0ZSIsImNvbGxlY3Rpb24iLCJhdHRyVmFsdWUiLCJleHBlY3RlZEF0dHJWYWx1ZSIsImdldE91dGVySGVpZ2h0IiwiY2hpbGQiLCJjaGlsZFN0eWxlIiwiY3VycmVudFN0eWxlIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImJ0cCIsInRlc3QiLCJib3JkZXJUb3BXaWR0aCIsIk1hdGgiLCJyb3VuZCIsImJ0YiIsImJvcmRlckJvdHRvbVdpZHRoIiwibXRwIiwibWFyZ2luVG9wIiwibWJwIiwibWFyZ2luQm90dG9tIiwicGFyc2VJbnQiLCJnZXRNYXhIZWlnaHQiLCJwYXJlbnRIZWlnaHQiLCJrIiwibGwiLCJjaGlsZHJlbiIsImlzRWxlbWVudEluVmlld3BvcnQiLCJyZWN0IiwiZ2V0U2Nyb2xsIiwieSIsInBhZ2VZT2Zmc2V0IiwieCIsInBhZ2VYT2Zmc2V0Iiwic3R5bGVUaXAiLCJsaW5rIiwicG9zaXRpb24iLCJzY3JvbGwiLCJsaW5rRGltZW5zaW9ucyIsInciLCJoIiwiZWxlbWVudERpbWVuc2lvbnMiLCJjbGFzc05hbWUiLCJ1cGRhdGVQbGFjZW1lbnQiLCJBZmZpeCIsIm9wdGlvbnMiLCJ0YXJnZXREYXRhIiwib2Zmc2V0VG9wRGF0YSIsIm9mZnNldEJvdHRvbURhdGEiLCJhZmZpeCIsImFmZml4ZWQiLCJmbiIsInVwZGF0ZSIsImFmZml4VG9wIiwiYWZmaXhlZFRvcCIsImFmZml4Qm90dG9tIiwiYWZmaXhlZEJvdHRvbSIsInBpbk9mZnNldFRvcCIsInBpbk9mZnNldEJvdHRvbSIsIm1heFNjcm9sbCIsInNjcm9sbFkiLCJwaW5uZWRUb3AiLCJwaW5uZWRCb3R0b20iLCJzZWxmIiwicmVzaXplRGVsYXkiLCJhZmZpeGVkVG9Ub3AiLCJhZmZpeGVkVG9Cb3R0b20iLCJnZXRNYXhTY3JvbGwiLCJtYXgiLCJnZXRPZmZzZXRUb3AiLCJnZXRPZmZzZXRCb3R0b20iLCJjaGVja1Bvc2l0aW9uIiwicGluVG9wIiwidW5QaW5Ub3AiLCJwaW5Cb3R0b20iLCJ1blBpbkJvdHRvbSIsInVwZGF0ZVBpbiIsInNldFRpbWVvdXQiLCJBbGVydCIsImFsZXJ0IiwiY2xpY2tIYW5kbGVyIiwiZSIsImV2ZW50VGFyZ2V0IiwiY2xvc2UiLCJ0cmFuc2l0aW9uRW5kSGFuZGxlciIsInJlbW92ZUNoaWxkIiwiQnV0dG9uIiwib3B0aW9uIiwidG9nZ2xlZCIsImNoZWNrZWQiLCJyZXNldCIsIkxBQkVMIiwiSU5QVVQiLCJzZXRTdGF0ZSIsImlubmVySFRNTCIsInJlc2V0U3RhdGUiLCJ0b2dnbGUiLCJsYWJlbCIsInRhZ05hbWUiLCJsYWJlbHMiLCJpbnB1dCIsInR5cGUiLCJvdGhlckxhYmVsIiwib3RoZXJJbnB1dCIsIkNhcm91c2VsIiwiaW50ZXJ2YWxEYXRhIiwicGF1c2VEYXRhIiwia2V5Ym9hcmREYXRhIiwicGF1c2VkIiwiZGlyZWN0aW9uIiwiZGF0YVNsaWRlVG8iLCJ0aW1lciIsImlzU2xpZGluZyIsInNsaWRlcyIsInRvdGFsIiwic2xpZGVEaXJlY3Rpb24iLCJjb250cm9scyIsImxlZnRBcnJvdyIsInJpZ2h0QXJyb3ciLCJpbmRpY2F0b3IiLCJpbmRpY2F0b3JzIiwicGF1c2VIYW5kbGVyIiwiY2xlYXJJbnRlcnZhbCIsInJlc3VtZUhhbmRsZXIiLCJjeWNsZSIsImluZGljYXRvckhhbmRsZXIiLCJhY3RpdmVJbmRpY2F0b3IiLCJnZXRBY3RpdmVJbmRleCIsInNsaWRlVG8iLCJjb250cm9sc0hhbmRsZXIiLCJjdXJyZW50VGFyZ2V0Iiwic3JjRWxlbWVudCIsImtleUhhbmRsZXIiLCJ3aGljaCIsInNldEFjdGl2ZVBhZ2UiLCJwYWdlSW5kZXgiLCJpY2wiLCJzZXRJbnRlcnZhbCIsIm5leHQiLCJhY3RpdmVJdGVtIiwib3JpZW50YXRpb24iLCJDb2xsYXBzZSIsImFjY29yZGlvbiIsImNvbGxhcHNlIiwiaXNBbmltYXRpbmciLCJhY2NvcmRpb25EYXRhIiwiY29sbGFwc2VkIiwib3BlbkFjdGlvbiIsImNvbGxhcHNlRWxlbWVudCIsImNsb3NlQWN0aW9uIiwiZ2V0VGFyZ2V0IiwiaHJlZiIsImhpZGUiLCJzaG93IiwiYWN0aXZlQ29sbGFwc2VzIiwiYWwiLCJEcm9wZG93biIsInBlcnNpc3QiLCJpc09wZW4iLCJvcGVuIiwibWVudSIsImtleUNvZGUiLCJoYXNEYXRhIiwibm9kZVR5cGUiLCJNb2RhbCIsImJ0bkNoZWNrIiwiY2hlY2tNb2RhbCIsIm1vZGFsIiwic3RhdGljU3RyaW5nIiwicGFkZGluZ0xlZnQiLCJwYWRkaW5nUmlnaHQiLCJtb2RhbEJhY2tkcm9wU3RyaW5nIiwiYm9keUlzT3ZlcmZsb3dpbmciLCJtb2RhbElzT3ZlcmZsb3dpbmciLCJzY3JvbGxiYXJXaWR0aCIsIm92ZXJsYXkiLCJnZXRXaW5kb3dXaWR0aCIsImh0bWxSZWN0IiwiYWJzIiwic2V0U2Nyb2xsYmFyIiwiYm9keVN0eWxlIiwiYm9keVBhZCIsInJlc2V0U2Nyb2xsYmFyIiwibWVhc3VyZVNjcm9sbGJhciIsInNjcm9sbEJhcldpZHRoIiwic2Nyb2xsRGl2IiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiY2hlY2tTY3JvbGxiYXIiLCJhZGp1c3REaWFsb2ciLCJyZXNldEFkanVzdG1lbnRzIiwiY3JlYXRlT3ZlcmxheSIsIm5ld092ZXJsYXkiLCJyZW1vdmVPdmVybGF5Iiwia2V5ZG93bkhhbmRsZXJUb2dnbGUiLCJyZXNpemVIYW5kbGVyVG9nZ2xlIiwiZGlzbWlzc0hhbmRsZXJUb2dnbGUiLCJkaXNtaXNzSGFuZGxlciIsImNsaWNrVGFyZ2V0IiwibW9kYWxUcmlnZ2VyIiwia2V5IiwiY3VycmVudE9wZW4iLCJkaXNwbGF5Iiwic2V0Q29udGVudCIsIlBvcG92ZXIiLCJ0cmlnZ2VyRGF0YSIsImFuaW1hdGlvbkRhdGEiLCJwbGFjZW1lbnREYXRhIiwiZGlzbWlzc2libGVEYXRhIiwiZGVsYXlEYXRhIiwiY29udGFpbmVyRGF0YSIsInRlbXBsYXRlIiwidHJpZ2dlciIsImNsYXNzU3RyaW5nIiwiZGl2IiwiZmFkZSIsImRhdGFUaXRsZSIsImRhdGFDb250ZW50IiwiZGlzbWlzc2libGUiLCJjbG9zZUJ0biIsInRpdGxlU3RyaW5nIiwiY29udGVudFN0cmluZyIsInBvcG92ZXIiLCJwbGFjZW1lbnRTZXR0aW5nIiwiZGlzbWlzc2libGVIYW5kbGVyIiwicmVtb3ZlUG9wb3ZlciIsImNyZWF0ZVBvcG92ZXIiLCJwb3BvdmVyVGl0bGUiLCJwb3BvdmVyQXJyb3ciLCJwb3BvdmVyQ29udGVudCIsInBvcG92ZXJUZW1wbGF0ZSIsImZpcnN0Q2hpbGQiLCJzaG93UG9wb3ZlciIsInVwZGF0ZVBvcG92ZXIiLCJjbGVhclRpbWVvdXQiLCJTY3JvbGxTcHkiLCJzY3JvbGxPZmZzZXQiLCJzcHlUYXJnZXQiLCJsaW5rcyIsIml0ZW1zIiwidGFyZ2V0SXRlbXMiLCJzY3JvbGxUYXJnZXQiLCJpc1dpbmRvdyIsImlsIiwidGFyZ2V0SXRlbSIsInVwZGF0ZUl0ZW0iLCJkcm9wZG93biIsInRhcmdldFJlY3QiLCJpc0FjdGl2ZSIsInRvcEVkZ2UiLCJib3R0b21FZGdlIiwiaW5zaWRlIiwidXBkYXRlSXRlbXMiLCJpdGwiLCJyZWZyZXNoIiwiVGFiIiwiaGVpZ2h0RGF0YSIsInRhYnNDb250ZW50Q29udGFpbmVyIiwidGFicyIsImdldEFjdGl2ZVRhYiIsImFjdGl2ZVRhYiIsImFjdGl2ZVRhYnMiLCJnZXRBY3RpdmVDb250ZW50IiwibmV4dENvbnRlbnQiLCJhY3RpdmVDb250ZW50IiwiVG9vbHRpcCIsInRpdGxlIiwidG9vbHRpcCIsInJlbW92ZVRvb2xUaXAiLCJjcmVhdGVUb29sVGlwIiwidG9vbHRpcEFycm93IiwidG9vbHRpcElubmVyIiwidXBkYXRlVG9vbHRpcCIsInNob3dUb29sdGlwIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxH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dUgsR0FBQSxHQUFBdkcsS0FBQThTLE9BRUE5VCxFQUFBMEMsR0FBQTFCLE1BUUEsT0FIQW9KLElBQUExSCxFQUFBcVksR0FBQW5aLElBSUFzTCxTQUNBa0MsU0FDQVEsVUFDQWtCLFlBQ0FxQyxZQUNBZSxZQUNBUSxTQUNBd0MsV0FDQStCLGFBQ0FvQixPQUNBVSxnQkhpSThCN2MsS0FBS0osRUFBVSxXQUFhLE1BQU9rRCIsImZpbGUiOiJteS1jb20uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfYm9vdHN0cmFwID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfYm9vdHN0cmFwMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jvb3RzdHJhcCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0aWYgKGRvY3VtZW50LmJvZHkuaWQgPT0gJ2ZpbmRQZXJzb25Cb2R5Jykge1xuXHQgICAgKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgYmxuUmVtb3ZlU3VtYml0ID0gdHJ1ZTtcblx0ICAgICAgICB2YXIgZWxtSW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3NlYXJjaFBlcnNvbiBpbnB1dCcpO1xuXHQgICAgICAgIHZhciBidG5TdW1iaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ZpbmRQZXJzb25cIik7XG5cdCAgICAgICAgdmFyIGJ0bkZpbmRQZXJzb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VhcmNoUGhvbmUnKTtcblx0XG5cdCAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGN1cjIpIHtcblx0ICAgICAgICAgICAgaWYgKGN1cjIudmFsdWUudHJpbSgpLmxlbmd0aCA9PSAwICYmIChjdXIyLm5hbWUgPT0gJ2xhc3QtbmFtZScgfHwgY3VyMi5uYW1lID09ICdmaXJzdC1uYW1lJykpIHtcblx0ICAgICAgICAgICAgICAgIGJsblJlbW92ZVN1bWJpdCA9IGZhbHNlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGJsblJlbW92ZVN1bWJpdCA9PT0gZmFsc2UgPyBidG5TdW1iaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpIDogbnVsbDtcblx0XG5cdCAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGN1cikge1xuXHQgICAgICAgICAgICBjdXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgYmxuU3VtYml0ID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgIHZhciBpbnRSaWdodCA9IDA7XG5cdFxuXHQgICAgICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGN1clBsYWNlZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGN1clBsYWNlZC52YWx1ZS50cmltKCkubGVuZ3RoICE9IDAgJiYgKGN1clBsYWNlZC5uYW1lID09ICdsYXN0LW5hbWUnIHx8IGN1clBsYWNlZC5uYW1lID09ICdET0InIHx8IGN1clBsYWNlZC5uYW1lID09ICdmaXJzdC1uYW1lJykgPyBpbnRSaWdodCsrIDogbnVsbDtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKGludFJpZ2h0ID09PSAzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGJsblN1bWJpdCA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGJ0bkZpbmRQZXJzb24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4LCBhcnJheSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IDw9IDIpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ215RXJyb3InKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgYmxuU3VtYml0ID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCwgYXJyYXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA8PSAyKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdteUVycm9yJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBidG5GaW5kUGVyc29uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICBibG5TdW1iaXQgPT09IHRydWUgPyBidG5TdW1iaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpIDogYnRuU3VtYml0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGJ0bkZpbmRQZXJzb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0ICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FjdGlvbicpLnZhbHVlID0gXCJzZWFyY2hCeVBob25lXCI7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNidG5DbGVhcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChjdXIpIHtcblx0ICAgICAgICAgICAgICAgIGN1ci52YWx1ZSA9ICcnO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICB9KTtcblx0ICAgIH0pKCk7XG5cdH0gLypcblx0ICBmdW5jdGlvbiBjaGVja1ZhbHVlcyAoZWxtTmFtZSkge1xuXHQgICAgICBhbGVydChlbG1OYW1lKTtcblx0ICB9XG5cdCAgXG5cdCAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3NlYXJjaFBlcnNvbiBpbnB1dCcpLmZvckVhY2goKGN1cikgPT4ge1xuXHQgICAgICBjdXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBjaGVja1ZhbHVlcygnI3NlYXJjaFBlcnNvbicpKTtcblx0ICB9KTsqL1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKGdsb2JhbCkgey8vIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB2Mi4wLjQgfCDCqSBkbnBfdGhlbWUgfCBNSVQtTGljZW5zZVxuXHQoZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcblx0ICBpZiAodHJ1ZSkge1xuXHQgICAgLy8gQU1EIHN1cHBvcnQ6XG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID0gKGZhY3RvcnkpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9ICh0eXBlb2YgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID09PSAnZnVuY3Rpb24nID8gKF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXy5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSkgOiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuXHQgICAgLy8gQ29tbW9uSlMtbGlrZTpcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuXHQgICAgdmFyIGJzbiA9IGZhY3RvcnkoKTtcblx0ICAgIHJvb3QuQWZmaXggPSBic24uQWZmaXg7XG5cdCAgICByb290LkFsZXJ0ID0gYnNuLkFsZXJ0O1xuXHQgICAgcm9vdC5CdXR0b24gPSBic24uQnV0dG9uO1xuXHQgICAgcm9vdC5DYXJvdXNlbCA9IGJzbi5DYXJvdXNlbDtcblx0ICAgIHJvb3QuQ29sbGFwc2UgPSBic24uQ29sbGFwc2U7XG5cdCAgICByb290LkRyb3Bkb3duID0gYnNuLkRyb3Bkb3duO1xuXHQgICAgcm9vdC5Nb2RhbCA9IGJzbi5Nb2RhbDtcblx0ICAgIHJvb3QuUG9wb3ZlciA9IGJzbi5Qb3BvdmVyO1xuXHQgICAgcm9vdC5TY3JvbGxTcHkgPSBic24uU2Nyb2xsU3B5O1xuXHQgICAgcm9vdC5UYWIgPSBic24uVGFiO1xuXHQgICAgcm9vdC5Ub29sdGlwID0gYnNuLlRvb2x0aXA7XG5cdCAgfVxuXHR9KHRoaXMsIGZ1bmN0aW9uICgpIHtcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBJbnRlcm5hbCBVdGlsaXR5IEZ1bmN0aW9uc1xuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIGdsb2JhbHNcblx0ICB2YXIgZ2xvYmFsT2JqZWN0ID0gdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0aGlzfHx3aW5kb3csXG5cdCAgICBkb2MgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIGJvZHkgPSBkb2N1bWVudC5ib2R5LFxuXHQgIFxuXHQgICAgLy8gSUUgYnJvd3NlciBkZXRlY3Rcblx0ICAgIGlzSUUgPSAobmV3IFJlZ0V4cChcIk1TSUUgKFswLTldezEsfVtcXC4wLTldezAsfSlcIikuZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KSAhPSBudWxsKSA/IHBhcnNlRmxvYXQoIFJlZ0V4cC4kMSApIDogZmFsc2UsICBcblx0ICBcblx0ICAgIC8vIGZ1bmN0aW9uIHRvZ2dsZSBhdHRyaWJ1dGVzXG5cdCAgICBkYXRhVG9nZ2xlICAgID0gJ2RhdGEtdG9nZ2xlJyxcblx0ICAgIGRhdGFEaXNtaXNzICAgPSAnZGF0YS1kaXNtaXNzJyxcblx0ICAgIGRhdGFTcHkgICAgICAgPSAnZGF0YS1zcHknLFxuXHQgICAgZGF0YVJpZGUgICAgICA9ICdkYXRhLXJpZGUnLFxuXHQgICAgXG5cdCAgICAvLyBjb21wb25lbnRzXG5cdCAgICBzdHJpbmdBZmZpeCAgICAgPSAnQWZmaXgnLFxuXHQgICAgc3RyaW5nQWxlcnQgICAgID0gJ0FsZXJ0Jyxcblx0ICAgIHN0cmluZ0J1dHRvbiAgICA9ICdCdXR0b24nLFxuXHQgICAgc3RyaW5nQ2Fyb3VzZWwgID0gJ0Nhcm91c2VsJyxcblx0ICAgIHN0cmluZ0NvbGxhcHNlICA9ICdDb2xsYXBzZScsXG5cdCAgICBzdHJpbmdEcm9wZG93biAgPSAnRHJvcGRvd24nLFxuXHQgICAgc3RyaW5nTW9kYWwgICAgID0gJ01vZGFsJyxcblx0ICAgIHN0cmluZ1BvcG92ZXIgICA9ICdQb3BvdmVyJyxcblx0ICAgIHN0cmluZ1Njcm9sbFNweSA9ICdTY3JvbGxTcHknLFxuXHQgICAgc3RyaW5nVGFiICAgICAgID0gJ1RhYicsXG5cdCAgICBzdHJpbmdUb29sdGlwICAgPSAnVG9vbHRpcCcsXG5cdCAgXG5cdCAgICAvLyBvcHRpb25zIERBVEEgQVBJXG5cdCAgICBkYXRhYmFja2Ryb3AgICAgICA9ICdkYXRhLWJhY2tkcm9wJyxcblx0ICAgIGRhdGFLZXlib2FyZCAgICAgID0gJ2RhdGEta2V5Ym9hcmQnLFxuXHQgICAgZGF0YVRhcmdldCAgICAgICAgPSAnZGF0YS10YXJnZXQnLFxuXHQgICAgZGF0YUludGVydmFsICAgICAgPSAnZGF0YS1pbnRlcnZhbCcsXG5cdCAgICBkYXRhSGVpZ2h0ICAgICAgICA9ICdkYXRhLWhlaWdodCcsXG5cdCAgICBkYXRhUGF1c2UgICAgICAgICA9ICdkYXRhLXBhdXNlJyxcblx0ICAgIGRhdGFPcmlnaW5hbFRpdGxlID0gJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLFxuXHQgICAgZGF0YU9yaWdpbmFsVGV4dCAgPSAnZGF0YS1vcmlnaW5hbC10ZXh0Jyxcblx0ICAgIGRhdGFEaXNtaXNzaWJsZSAgID0gJ2RhdGEtZGlzbWlzc2libGUnLFxuXHQgICAgZGF0YVRyaWdnZXIgICAgICAgPSAnZGF0YS10cmlnZ2VyJyxcblx0ICAgIGRhdGFBbmltYXRpb24gICAgID0gJ2RhdGEtYW5pbWF0aW9uJyxcblx0ICAgIGRhdGFDb250YWluZXIgICAgID0gJ2RhdGEtY29udGFpbmVyJyxcblx0ICAgIGRhdGFQbGFjZW1lbnQgICAgID0gJ2RhdGEtcGxhY2VtZW50Jyxcblx0ICAgIGRhdGFEZWxheSAgICAgICAgID0gJ2RhdGEtZGVsYXknLFxuXHQgICAgZGF0YU9mZnNldFRvcCAgICAgPSAnZGF0YS1vZmZzZXQtdG9wJyxcblx0ICAgIGRhdGFPZmZzZXRCb3R0b20gID0gJ2RhdGEtb2Zmc2V0LWJvdHRvbScsXG5cdCAgXG5cdCAgICAvLyBvcHRpb24ga2V5c1xuXHQgICAgYmFja2Ryb3AgPSAnYmFja2Ryb3AnLCBrZXlib2FyZCA9ICdrZXlib2FyZCcsIGRlbGF5ID0gJ2RlbGF5Jyxcblx0ICAgIGR1cmF0aW9uID0gJ2R1cmF0aW9uJywgY29udGVudCA9ICdjb250ZW50JywgdGFyZ2V0ID0gJ3RhcmdldCcsIFxuXHQgICAgaW50ZXJ2YWwgPSAnaW50ZXJ2YWwnLCBwYXVzZSA9ICdwYXVzZScsIGFuaW1hdGlvbiA9ICdhbmltYXRpb24nLFxuXHQgICAgcGxhY2VtZW50ID0gJ3BsYWNlbWVudCcsIGNvbnRhaW5lciA9ICdjb250YWluZXInLCBcblx0ICBcblx0ICAgIC8vIGJveCBtb2RlbFxuXHQgICAgb2Zmc2V0VG9wICAgID0gJ29mZnNldFRvcCcsICAgICAgb2Zmc2V0Qm90dG9tICAgPSAnb2Zmc2V0Qm90dG9tJyxcblx0ICAgIG9mZnNldExlZnQgICA9ICdvZmZzZXRMZWZ0Jyxcblx0ICAgIHNjcm9sbFRvcCAgICA9ICdzY3JvbGxUb3AnLCAgICAgIHNjcm9sbExlZnQgICAgID0gJ3Njcm9sbExlZnQnLFxuXHQgICAgY2xpZW50V2lkdGggID0gJ2NsaWVudFdpZHRoJywgICAgY2xpZW50SGVpZ2h0ICAgPSAnY2xpZW50SGVpZ2h0Jyxcblx0ICAgIG9mZnNldFdpZHRoICA9ICdvZmZzZXRXaWR0aCcsICAgIG9mZnNldEhlaWdodCAgID0gJ29mZnNldEhlaWdodCcsXG5cdCAgICBpbm5lcldpZHRoICAgPSAnaW5uZXJXaWR0aCcsICAgICBpbm5lckhlaWdodCAgICA9ICdpbm5lckhlaWdodCcsXG5cdCAgICBzY3JvbGxIZWlnaHQgPSAnc2Nyb2xsSGVpZ2h0JywgICBoZWlnaHQgICAgICAgICA9ICdoZWlnaHQnLFxuXHQgIFxuXHQgICAgLy8gYXJpYVxuXHQgICAgYXJpYUV4cGFuZGVkID0gJ2FyaWEtZXhwYW5kZWQnLFxuXHQgICAgYXJpYUhpZGRlbiAgID0gJ2FyaWEtaGlkZGVuJyxcblx0ICBcblx0ICAgIC8vIGV2ZW50IG5hbWVzXG5cdCAgICBjbGlja0V2ZW50ICAgID0gJ2NsaWNrJyxcblx0ICAgIGhvdmVyRXZlbnQgICAgPSAnaG92ZXInLFxuXHQgICAga2V5ZG93bkV2ZW50ICA9ICdrZXlkb3duJyxcblx0ICAgIHJlc2l6ZUV2ZW50ICAgPSAncmVzaXplJyxcblx0ICAgIHNjcm9sbEV2ZW50ICAgPSAnc2Nyb2xsJyxcblx0ICAgIC8vIG9yaWdpbmFsRXZlbnRzXG5cdCAgICBzaG93RXZlbnQgICAgID0gJ3Nob3cnLFxuXHQgICAgc2hvd25FdmVudCAgICA9ICdzaG93bicsXG5cdCAgICBoaWRlRXZlbnQgICAgID0gJ2hpZGUnLFxuXHQgICAgaGlkZGVuRXZlbnQgICA9ICdoaWRkZW4nLFxuXHQgICAgY2xvc2VFdmVudCAgICA9ICdjbG9zZScsXG5cdCAgICBjbG9zZWRFdmVudCAgID0gJ2Nsb3NlZCcsXG5cdCAgICBzbGlkRXZlbnQgICAgID0gJ3NsaWQnLFxuXHQgICAgc2xpZGVFdmVudCAgICA9ICdzbGlkZScsXG5cdCAgICBjaGFuZ2VFdmVudCAgID0gJ2NoYW5nZScsXG5cdCAgXG5cdCAgICAvLyBvdGhlclxuXHQgICAgZ2V0QXR0cmlidXRlICAgICAgICAgPSAnZ2V0QXR0cmlidXRlJyxcblx0ICAgIHNldEF0dHJpYnV0ZSAgICAgICAgID0gJ3NldEF0dHJpYnV0ZScsXG5cdCAgICBoYXNBdHRyaWJ1dGUgICAgICAgICA9ICdoYXNBdHRyaWJ1dGUnLFxuXHQgICAgZ2V0RWxlbWVudHNCeVRhZ05hbWUgPSAnZ2V0RWxlbWVudHNCeVRhZ05hbWUnLFxuXHQgICAgZ2V0Qm91bmRpbmdDbGllbnRSZWN0PSAnZ2V0Qm91bmRpbmdDbGllbnRSZWN0Jyxcblx0ICAgIHF1ZXJ5U2VsZWN0b3JBbGwgICAgID0gJ3F1ZXJ5U2VsZWN0b3JBbGwnLFxuXHQgICAgZ2V0RWxlbWVudHNCeUNMQVNTTkFNRSA9ICdnZXRFbGVtZW50c0J5Q2xhc3NOYW1lJyxcblx0ICBcblx0ICAgIGluZGV4T2YgICAgICA9ICdpbmRleE9mJyxcblx0ICAgIHBhcmVudE5vZGUgICA9ICdwYXJlbnROb2RlJyxcblx0ICAgIGxlbmd0aCAgICAgICA9ICdsZW5ndGgnLFxuXHQgICAgdG9Mb3dlckNhc2UgID0gJ3RvTG93ZXJDYXNlJyxcblx0ICAgIFRyYW5zaXRpb24gICA9ICdUcmFuc2l0aW9uJyxcblx0ICAgIFdlYmtpdCAgICAgICA9ICdXZWJraXQnLFxuXHQgICAgc3R5bGUgICAgICAgID0gJ3N0eWxlJyxcblx0ICAgIFxuXHQgICAgYWN0aXZlICAgICA9ICdhY3RpdmUnLFxuXHQgICAgaW5DbGFzcyAgICA9ICdpbicsXG5cdCAgICBjb2xsYXBzaW5nID0gJ2NvbGxhcHNpbmcnLFxuXHQgICAgZGlzYWJsZWQgICA9ICdkaXNhYmxlZCcsXG5cdCAgICBsb2FkaW5nICAgID0gJ2xvYWRpbmcnLFxuXHQgICAgbGVmdCAgICAgICA9ICdsZWZ0Jyxcblx0ICAgIHJpZ2h0ICAgICAgPSAncmlnaHQnLFxuXHQgICAgdG9wICAgICAgICA9ICd0b3AnLFxuXHQgICAgYm90dG9tICAgICA9ICdib3R0b20nLFxuXHQgIFxuXHQgICAgLy8gdG9vbHRpcCAvIHBvcG92ZXJcblx0ICAgIG1vdXNlSG92ZXIgPSAoJ29ubW91c2VsZWF2ZScgaW4gZG9jdW1lbnQpID8gWyAnbW91c2VlbnRlcicsICdtb3VzZWxlYXZlJ10gOiBbICdtb3VzZW92ZXInLCAnbW91c2VvdXQnIF0sXG5cdCAgICB0aXBQb3NpdGlvbnMgPSAvXFxiKHRvcHxib3R0b218bGVmdHx0b3ApKy8sXG5cdCAgXG5cdCAgICAvLyB0cmFuc2l0aW9uRW5kIHNpbmNlIDIuMC40XG5cdCAgICBzdXBwb3J0VHJhbnNpdGlvbnMgPSBXZWJraXQrVHJhbnNpdGlvbiBpbiBkb2Nbc3R5bGVdIHx8IFRyYW5zaXRpb25bdG9Mb3dlckNhc2VdKCkgaW4gZG9jW3N0eWxlXSxcblx0ICAgIHRyYW5zaXRpb25FbmRFdmVudCA9IFdlYmtpdCtUcmFuc2l0aW9uIGluIGRvY1tzdHlsZV0gPyBXZWJraXRbdG9Mb3dlckNhc2VdKCkrVHJhbnNpdGlvbisnRW5kJyA6IFRyYW5zaXRpb25bdG9Mb3dlckNhc2VdKCkrJ2VuZCcsXG5cdCAgICBcblx0ICBcblx0ICAgIC8vIHNldCBuZXcgZm9jdXMgZWxlbWVudCBzaW5jZSAyLjAuM1xuXHQgICAgc2V0Rm9jdXMgPSBmdW5jdGlvbihlbGVtZW50KXtcblx0ICAgICAgZWxlbWVudC5mb2N1cyA/IGVsZW1lbnQuZm9jdXMoKSA6IGVsZW1lbnQuc2V0QWN0aXZlKCk7XG5cdCAgICB9LFxuXHQgIFxuXHQgICAgLy8gY2xhc3MgbWFuaXB1bGF0aW9uLCBzaW5jZSAyLjAuMCByZXF1aXJlcyBwb2x5ZmlsbC5qc1xuXHQgICAgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LGNsYXNzTkFNRSkge1xuXHQgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOQU1FKTtcblx0ICAgIH0sXG5cdCAgICByZW1vdmVDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKSB7XG5cdCAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05BTUUpO1xuXHQgICAgfSxcblx0ICAgIGhhc0NsYXNzID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpeyAvLyBzaW5jZSAyLjAuMFxuXHQgICAgICByZXR1cm4gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOQU1FKTtcblx0ICAgIH0sXG5cdCAgXG5cdCAgICAvLyBzZWxlY3Rpb24gbWV0aG9kc1xuXHQgICAgbm9kZUxpc3RUb0FycmF5ID0gZnVuY3Rpb24obm9kZUxpc3Qpe1xuXHQgICAgICB2YXIgY2hpbGRJdGVtcyA9IFtdOyBmb3IgKHZhciBpID0gMCwgbmxsID0gbm9kZUxpc3RbbGVuZ3RoXTsgaTxubGw7IGkrKykgeyBjaGlsZEl0ZW1zLnB1c2goIG5vZGVMaXN0W2ldICkgfVxuXHQgICAgICByZXR1cm4gY2hpbGRJdGVtcztcblx0ICAgIH0sXG5cdCAgICBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpIHsgLy8gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSBJRTgrXG5cdCAgICAgIHZhciBzZWxlY3Rpb25NZXRob2QgPSBpc0lFID09PSA4ID8gcXVlcnlTZWxlY3RvckFsbCA6IGdldEVsZW1lbnRzQnlDTEFTU05BTUU7ICAgICAgXG5cdCAgICAgIHJldHVybiBub2RlTGlzdFRvQXJyYXkoZWxlbWVudFtzZWxlY3Rpb25NZXRob2RdKCBpc0lFID09PSA4ID8gJy4nICsgY2xhc3NOQU1FLnJlcGxhY2UoL1xccyg/PVthLXpdKS9nLCcuJykgOiBjbGFzc05BTUUgKSk7XG5cdCAgICB9LFxuXHQgICAgcXVlcnlFbGVtZW50ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBwYXJlbnQpIHtcblx0ICAgICAgdmFyIGxvb2tVcCA9IHBhcmVudCA/IHBhcmVudCA6IGRvY3VtZW50O1xuXHQgICAgICByZXR1cm4gdHlwZW9mIHNlbGVjdG9yID09PSAnb2JqZWN0JyA/IHNlbGVjdG9yIDogbG9va1VwLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuXHQgICAgfSxcblx0ICAgIGdldENsb3Nlc3QgPSBmdW5jdGlvbiAoZWxlbWVudCwgc2VsZWN0b3IpIHsgLy9lbGVtZW50IGlzIHRoZSBlbGVtZW50IGFuZCBzZWxlY3RvciBpcyBmb3IgdGhlIGNsb3Nlc3QgcGFyZW50IGVsZW1lbnQgdG8gZmluZFxuXHQgICAgLy8gc291cmNlIGh0dHA6Ly9nb21ha2V0aGluZ3MuY29tL2NsaW1iaW5nLXVwLWFuZC1kb3duLXRoZS1kb20tdHJlZS13aXRoLXZhbmlsbGEtamF2YXNjcmlwdC9cblx0ICAgICAgdmFyIGZpcnN0Q2hhciA9IHNlbGVjdG9yLmNoYXJBdCgwKTtcblx0ICAgICAgZm9yICggOyBlbGVtZW50ICYmIGVsZW1lbnQgIT09IGRvY3VtZW50OyBlbGVtZW50ID0gZWxlbWVudFtwYXJlbnROb2RlXSApIHsvLyBHZXQgY2xvc2VzdCBtYXRjaFxuXHQgICAgICAgIGlmICggZmlyc3RDaGFyID09PSAnLicgfHwgZmlyc3RDaGFyICE9PSAnIycpIHsvLyBJZiBzZWxlY3RvciBpcyBhIGNsYXNzXG5cdCAgICAgICAgICBpZiAoIHF1ZXJ5RWxlbWVudChzZWxlY3RvcixlbGVtZW50W3BhcmVudE5vZGVdKSAhPT0gbnVsbCApIHsgcmV0dXJuIGVsZW1lbnQ7IH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKCBmaXJzdENoYXIgPT09ICcjJyApIHsgLy8gSWYgc2VsZWN0b3IgaXMgYW4gSURcblx0ICAgICAgICAgIGlmICggZWxlbWVudC5pZCA9PT0gc2VsZWN0b3Iuc3Vic3RyKDEpICkgeyByZXR1cm4gZWxlbWVudDsgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9LFxuXHQgIFxuXHQgICAgLy8gZXZlbnQgYXR0YWNoIGpRdWVyeSBzdHlsZSAvIHRyaWdnZXIgIHNpbmNlIDEuMi4wXG5cdCAgICBvbiA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudCwgaGFuZGxlcikge1xuXHQgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIGZhbHNlKTtcblx0ICAgIH0sXG5cdCAgICBvZmYgPSBmdW5jdGlvbihlbGVtZW50LCBldmVudCwgaGFuZGxlcikge1xuXHQgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIGZhbHNlKTtcblx0ICAgIH0sXG5cdCAgICBvbmUgPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHsgLy8gb25lIHNpbmNlIDIuMC40XG5cdCAgICAgIG9uKGVsZW1lbnQsIGV2ZW50LCBmdW5jdGlvbiBoYW5kbGVyV3JhcHBlcigpe1xuXHQgICAgICAgIGhhbmRsZXIoKTtcblx0ICAgICAgICBvZmYoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXJXcmFwcGVyKTtcblx0ICAgICAgfSk7XG5cdCAgICB9LFxuXHQgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbihlbGVtZW50LGhhbmRsZXIpeyAvLyBlbXVsYXRlVHJhbnNpdGlvbkVuZCBzaW5jZSAyLjAuNFxuXHQgICAgICBpZiAoc3VwcG9ydFRyYW5zaXRpb25zKSB7IG9uZShlbGVtZW50LHRyYW5zaXRpb25FbmRFdmVudCwgaGFuZGxlcik7IH1cblx0ICAgICAgZWxzZSB7IGhhbmRsZXIoKTsgfVxuXHQgICAgfSwgIFxuXHQgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjb21wb25lbnROYW1lLCByZWxhdGVkKSB7XG5cdCAgICAgIHZhciBPcmlnaW5hbEN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCBldmVudE5hbWUgKyAnLmJzLicgKyBjb21wb25lbnROYW1lKTtcblx0ICAgICAgT3JpZ2luYWxDdXN0b21FdmVudC5yZWxhdGVkVGFyZ2V0ID0gcmVsYXRlZDtcblx0ICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KE9yaWdpbmFsQ3VzdG9tRXZlbnQpO1xuXHQgICAgfSxcblx0ICBcblx0ICAgIC8vIHJlZmVyZW5jZSBhIGxpdmUgY29sbGVjdGlvbiBvZiB0aGUgRE9NXG5cdCAgICBBbGxET01FbGVtZW50cyA9IGRvY3VtZW50W2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnKicpLFxuXHQgIFxuXHQgICAgLy8gSW5pdCBEQVRBIEFQSVxuXHQgICAgaW5pdGlhbGl6ZURhdGFBUEkgPSBmdW5jdGlvbiggY29tcG9uZW50LCBjb25zdHJ1Y3RvciwgZGF0YUF0dHJpYnV0ZSwgY29sbGVjdGlvbiApe1xuXHQgICAgICB2YXIgbG9va1VwID0gY29sbGVjdGlvbiAmJiBjb2xsZWN0aW9uW2xlbmd0aF0gPyBjb2xsZWN0aW9uIDogQWxsRE9NRWxlbWVudHM7XG5cdCAgICAgIGZvciAodmFyIGk9MDsgaSA8IGxvb2tVcFtsZW5ndGhdOyBpKyspIHtcblx0ICAgICAgICB2YXIgYXR0clZhbHVlID0gbG9va1VwW2ldW2dldEF0dHJpYnV0ZV0oZGF0YUF0dHJpYnV0ZSksIGV4cGVjdGVkQXR0clZhbHVlID0gY29tcG9uZW50LnJlcGxhY2UoL3NweS9pLCcnKVt0b0xvd2VyQ2FzZV0oKTtcblx0ICAgICAgICBpZiAoIGF0dHJWYWx1ZSAmJiBjb21wb25lbnQgPT09IHN0cmluZ0J1dHRvbiAmJiAoIGF0dHJWYWx1ZVtpbmRleE9mXShleHBlY3RlZEF0dHJWYWx1ZSkgPiAtMSApIC8vIGRhdGEtdG9nZ2xlPVwiYnV0dG9uc1wiXG5cdCAgICAgICAgICAgIHx8IGF0dHJWYWx1ZSA9PT0gZXhwZWN0ZWRBdHRyVmFsdWUgKSB7IC8vIGFsbCBvdGhlciBjb21wb25lbnRzXG5cdCAgICAgICAgICBuZXcgY29uc3RydWN0b3IobG9va1VwW2ldKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0sICBcblx0ICBcblx0ICAgIC8vIHRhYiAvIGNvbGxhcHNlIHN0dWZmXG5cdCAgICBnZXRPdXRlckhlaWdodCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuXHQgICAgICB2YXIgY2hpbGRTdHlsZSA9IGNoaWxkICYmIChjaGlsZC5jdXJyZW50U3R5bGUgfHwgZ2xvYmFsT2JqZWN0LmdldENvbXB1dGVkU3R5bGUoY2hpbGQpKSwgXG5cdCAgICAgICAgYnRwID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUuYm9yZGVyVG9wV2lkdGgpID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLmJvcmRlclRvcFdpZHRoLnJlcGxhY2UoJ3B4JywnJykpIDogMCxcblx0ICAgICAgICBidGIgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5ib3JkZXJCb3R0b21XaWR0aCkgPyBNYXRoLnJvdW5kKGNoaWxkU3R5bGUuYm9yZGVyQm90dG9tV2lkdGgucmVwbGFjZSgncHgnLCcnKSkgOiAwLFxuXHQgICAgICAgIG10cCA9IC9weC8udGVzdChjaGlsZFN0eWxlLm1hcmdpblRvcCkgPyBNYXRoLnJvdW5kKGNoaWxkU3R5bGUubWFyZ2luVG9wLnJlcGxhY2UoJ3B4JywnJykpIDogMCxcblx0ICAgICAgICBtYnAgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5tYXJnaW5Cb3R0b20pID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLm1hcmdpbkJvdHRvbS5yZXBsYWNlKCdweCcsJycpKSA6IDA7XG5cdCAgICAgIHJldHVybiBjaGlsZFtjbGllbnRIZWlnaHRdICsgcGFyc2VJbnQoIGJ0cCApICsgcGFyc2VJbnQoIGJ0YiApICsgcGFyc2VJbnQoIG10cCApICsgcGFyc2VJbnQoIG1icCApO1xuXHQgICAgfSxcblx0ICAgIGdldE1heEhlaWdodCA9IGZ1bmN0aW9uKHBhcmVudCkgeyAvLyBnZXQgY29sbGFwc2UgdHJ1ZUhlaWdodCBhbmQgYm9yZGVyXG5cdCAgICAgIHZhciBwYXJlbnRIZWlnaHQgPSAwO1xuXHQgICAgICBmb3IgKHZhciBrID0gMCwgbGwgPSBwYXJlbnQuY2hpbGRyZW5bbGVuZ3RoXTsgayA8IGxsOyBrKyspIHtcblx0ICAgICAgICBwYXJlbnRIZWlnaHQgKz0gZ2V0T3V0ZXJIZWlnaHQocGFyZW50LmNoaWxkcmVuW2tdKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gcGFyZW50SGVpZ2h0O1xuXHQgICAgfSxcblx0ICBcblx0ICAgIC8vIHRvb2x0aXAgLyBwb3BvdmVyIHN0dWZmXG5cdCAgICBpc0VsZW1lbnRJblZpZXdwb3J0ID0gZnVuY3Rpb24oZWxlbWVudCkgeyAvLyBjaGVjayBpZiB0aGlzLnRvb2x0aXAgaXMgaW4gdmlld3BvcnRcblx0ICAgICAgdmFyIHJlY3QgPSBlbGVtZW50W2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKTtcblx0ICAgICAgcmV0dXJuICggcmVjdFt0b3BdID49IDAgJiYgcmVjdFtsZWZ0XSA+PSAwICYmXG5cdCAgICAgICAgcmVjdFtib3R0b21dIDw9IChnbG9iYWxPYmplY3RbaW5uZXJIZWlnaHRdIHx8IGRvY1tjbGllbnRIZWlnaHRdKSAmJlxuXHQgICAgICAgIHJlY3RbcmlnaHRdIDw9IChnbG9iYWxPYmplY3RbaW5uZXJXaWR0aF0gfHwgZG9jW2NsaWVudFdpZHRoXSkgKVxuXHQgICAgfSxcblx0ICAgIGdldFNjcm9sbCA9IGZ1bmN0aW9uKCkgeyAvLyBhbHNvIEFmZml4IGFuZCBTY3JvbGxTcHkgdXNlcyBpdFxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIHkgOiBnbG9iYWxPYmplY3QucGFnZVlPZmZzZXQgfHwgZG9jW3Njcm9sbFRvcF0sXG5cdCAgICAgICAgeCA6IGdsb2JhbE9iamVjdC5wYWdlWE9mZnNldCB8fCBkb2Nbc2Nyb2xsTGVmdF1cblx0ICAgICAgfVxuXHQgICAgfSxcblx0ICAgIHN0eWxlVGlwID0gZnVuY3Rpb24obGluayxlbGVtZW50LHBvc2l0aW9uLGNvbnRhaW5lcikgeyAvLyBib3RoIHBvcG92ZXJzIGFuZCB0b29sdGlwc1xuXHQgICAgICB2YXIgcmVjdCA9IGxpbmtbZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpLCBcblx0ICAgICAgICAgIHNjcm9sbCA9IGNvbnRhaW5lciA9PT0gYm9keSA/IGdldFNjcm9sbCgpIDogeyB4OiBjb250YWluZXJbb2Zmc2V0TGVmdF0gKyBjb250YWluZXJbc2Nyb2xsTGVmdF0sIHk6IGNvbnRhaW5lcltvZmZzZXRUb3BdICsgY29udGFpbmVyW3Njcm9sbFRvcF0gfSxcblx0ICAgICAgICAgIGxpbmtEaW1lbnNpb25zID0geyB3OiByZWN0W3JpZ2h0XSAtIHJlY3RbbGVmdF0sIGg6IHJlY3RbYm90dG9tXSAtIHJlY3RbdG9wXSB9LFxuXHQgICAgICAgICAgZWxlbWVudERpbWVuc2lvbnMgPSB7IHcgOiBlbGVtZW50W29mZnNldFdpZHRoXSwgaDogZWxlbWVudFtvZmZzZXRIZWlnaHRdIH07XG5cdCAgXG5cdCAgICAgIC8vIGFwcGx5IHN0eWxpbmcgdG8gdG9vbHRpcCBvciBwb3BvdmVyXG5cdCAgICAgIGlmICggcG9zaXRpb24gPT09IHRvcCApIHsgLy8gVE9QXG5cdCAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaCArICdweCc7XG5cdCAgICAgICAgZWxlbWVudFtzdHlsZV1bbGVmdF0gPSByZWN0W2xlZnRdICsgc2Nyb2xsLnggLSBlbGVtZW50RGltZW5zaW9ucy53LzIgKyBsaW5rRGltZW5zaW9ucy53LzIgKyAncHgnXG5cdCAgXG5cdCAgICAgIH0gZWxzZSBpZiAoIHBvc2l0aW9uID09PSBib3R0b20gKSB7IC8vIEJPVFRPTVxuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW3RvcF0gPSByZWN0W3RvcF0gKyBzY3JvbGwueSArIGxpbmtEaW1lbnNpb25zLmggKyAncHgnO1xuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54IC0gZWxlbWVudERpbWVuc2lvbnMudy8yICsgbGlua0RpbWVuc2lvbnMudy8yICsgJ3B4Jztcblx0ICBcblx0ICAgICAgfSBlbHNlIGlmICggcG9zaXRpb24gPT09IGxlZnQgKSB7IC8vIExFRlRcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgLSBlbGVtZW50RGltZW5zaW9ucy5oLzIgKyBsaW5rRGltZW5zaW9ucy5oLzIgKyAncHgnO1xuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54IC0gZWxlbWVudERpbWVuc2lvbnMudyArICdweCc7XG5cdCAgXG5cdCAgICAgIH0gZWxzZSBpZiAoIHBvc2l0aW9uID09PSByaWdodCApIHsgLy8gUklHSFRcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgLSBlbGVtZW50RGltZW5zaW9ucy5oLzIgKyBsaW5rRGltZW5zaW9ucy5oLzIgKyAncHgnO1xuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54ICsgbGlua0RpbWVuc2lvbnMudyArICdweCc7XG5cdCAgICAgIH1cblx0ICAgICAgZWxlbWVudC5jbGFzc05hbWVbaW5kZXhPZl0ocG9zaXRpb24pID09PSAtMSAmJiAoZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKHRpcFBvc2l0aW9ucyxwb3NpdGlvbikpO1xuXHQgICAgfSxcblx0ICAgIHVwZGF0ZVBsYWNlbWVudCA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG5cdCAgICAgIHJldHVybiBwb3NpdGlvbiA9PT0gdG9wID8gYm90dG9tIDogLy8gdG9wXG5cdCAgICAgICAgICAgICBwb3NpdGlvbiA9PT0gYm90dG9tID8gdG9wIDogLy8gYm90dG9tXG5cdCAgICAgICAgICAgICBwb3NpdGlvbiA9PT0gbGVmdCA/IHJpZ2h0IDogLy8gbGVmdFxuXHQgICAgICAgICAgICAgcG9zaXRpb24gPT09IHJpZ2h0ID8gbGVmdCA6IHBvc2l0aW9uOyAvLyByaWdodFxuXHQgICAgfTtcblx0ICBcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBBZmZpeFxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vQUZGSVggREVGSU5JVElPTlxuXHQgIHZhciBBZmZpeCA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgXG5cdCAgICAvLyByZWFkIERBVEEgQVBJXG5cdCAgICB2YXIgdGFyZ2V0RGF0YSAgICAgICAgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCksXG5cdCAgICAgICAgb2Zmc2V0VG9wRGF0YSAgICAgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9mZnNldFRvcCksXG5cdCAgICAgICAgb2Zmc2V0Qm90dG9tRGF0YSAgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9mZnNldEJvdHRvbSksXG5cdCAgICAgICAgXG5cdCAgICAgICAgLy8gY29tcG9uZW50IHNwZWNpZmljIHN0cmluZ3Ncblx0ICAgICAgICBhZmZpeCA9ICdhZmZpeCcsIGFmZml4ZWQgPSAnYWZmaXhlZCcsIGZuID0gJ2Z1bmN0aW9uJywgdXBkYXRlID0gJ3VwZGF0ZScsXG5cdCAgICAgICAgYWZmaXhUb3AgPSAnYWZmaXgtdG9wJywgYWZmaXhlZFRvcCA9ICdhZmZpeGVkLXRvcCcsXG5cdCAgICAgICAgYWZmaXhCb3R0b20gPSAnYWZmaXgtYm90dG9tJywgYWZmaXhlZEJvdHRvbSA9ICdhZmZpeGVkLWJvdHRvbSc7XG5cdCAgXG5cdCAgICB0aGlzW3RhcmdldF0gPSBvcHRpb25zW3RhcmdldF0gPyBxdWVyeUVsZW1lbnQob3B0aW9uc1t0YXJnZXRdKSA6IHF1ZXJ5RWxlbWVudCh0YXJnZXREYXRhKSB8fCBudWxsOyAvLyB0YXJnZXQgaXMgYW4gb2JqZWN0XG5cdCAgICB0aGlzW29mZnNldFRvcF0gPSBvcHRpb25zW29mZnNldFRvcF0gPyBvcHRpb25zW29mZnNldFRvcF0gOiBwYXJzZUludChvZmZzZXRUb3BEYXRhKSB8fCAwOyAvLyBvZmZzZXQgb3B0aW9uIGlzIGFuIGludGVnZXIgbnVtYmVyIG9yIGZ1bmN0aW9uIHRvIGRldGVybWluZSB0aGF0IG51bWJlclxuXHQgICAgdGhpc1tvZmZzZXRCb3R0b21dID0gb3B0aW9uc1tvZmZzZXRCb3R0b21dID8gb3B0aW9uc1tvZmZzZXRCb3R0b21dOiBwYXJzZUludChvZmZzZXRCb3R0b21EYXRhKSB8fCAwO1xuXHQgIFxuXHQgICAgaWYgKCAhdGhpc1t0YXJnZXRdICYmICEoIHRoaXNbb2Zmc2V0VG9wXSB8fCB0aGlzW29mZnNldEJvdHRvbV0gKSApIHsgcmV0dXJuOyB9IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIGludGVybmFsIGJpbmRcblx0ICAgIHZhciBzZWxmID0gdGhpcyxcblx0ICBcblx0ICAgICAgLy8gY29uc3RhbnRzXG5cdCAgICAgIHJlc2l6ZURlbGF5ID0gKGlzSUUgJiYgaXNJRSA8IDEwKSA/IDUwMCA6IDUwLCAvLyBmb3IgbGVnYWN5IGJyb3dzZXJzIHdlIHRyeSB0byBsaW1pdCB0aGUgaW50ZXJ2YWwgZm9yIHVwZGF0aW5nIHRoZSBBZmZpeFxuXHQgICAgICBwaW5PZmZzZXRUb3AsIHBpbk9mZnNldEJvdHRvbSwgbWF4U2Nyb2xsLCBzY3JvbGxZLCBwaW5uZWRUb3AsIHBpbm5lZEJvdHRvbSxcblx0ICAgICAgYWZmaXhlZFRvVG9wID0gZmFsc2UsIGFmZml4ZWRUb0JvdHRvbSA9IGZhbHNlLFxuXHQgICAgICBcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzIFxuXHQgICAgICBnZXRNYXhTY3JvbGwgPSBmdW5jdGlvbigpe1xuXHQgICAgICAgIHJldHVybiBNYXRoLm1heCggYm9keVtzY3JvbGxIZWlnaHRdLCBib2R5W29mZnNldEhlaWdodF0sIGRvY1tjbGllbnRIZWlnaHRdLCBkb2Nbc2Nyb2xsSGVpZ2h0XSwgZG9jW29mZnNldEhlaWdodF0gKTtcblx0ICAgICAgfSxcblx0ICAgICAgZ2V0T2Zmc2V0VG9wID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggc2VsZlt0YXJnZXRdICE9PSBudWxsICkge1xuXHQgICAgICAgICAgcmV0dXJuIHNlbGZbdGFyZ2V0XVtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKClbdG9wXSArIHNjcm9sbFk7XG5cdCAgICAgICAgfSBlbHNlIGlmICggc2VsZltvZmZzZXRUb3BdICkge1xuXHQgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHR5cGVvZiBzZWxmW29mZnNldFRvcF0gPT09IGZuID8gc2VsZltvZmZzZXRUb3BdKCkgOiBzZWxmW29mZnNldFRvcF0gfHwgMCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBnZXRPZmZzZXRCb3R0b20gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCBzZWxmW29mZnNldEJvdHRvbV0gKSB7XG5cdCAgICAgICAgICByZXR1cm4gbWF4U2Nyb2xsIC0gZWxlbWVudFtvZmZzZXRIZWlnaHRdIC0gcGFyc2VJbnQoIHR5cGVvZiBzZWxmW29mZnNldEJvdHRvbV0gPT09IGZuID8gc2VsZltvZmZzZXRCb3R0b21dKCkgOiBzZWxmW29mZnNldEJvdHRvbV0gfHwgMCApO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgY2hlY2tQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBtYXhTY3JvbGwgPSBnZXRNYXhTY3JvbGwoKTtcblx0ICAgICAgICBzY3JvbGxZID0gcGFyc2VJbnQoZ2V0U2Nyb2xsKCkueSwwKTtcblx0ICAgICAgICBwaW5PZmZzZXRUb3AgPSBnZXRPZmZzZXRUb3AoKTtcblx0ICAgICAgICBwaW5PZmZzZXRCb3R0b20gPSBnZXRPZmZzZXRCb3R0b20oKTsgXG5cdCAgICAgICAgcGlubmVkVG9wID0gKCBwYXJzZUludChwaW5PZmZzZXRUb3ApIC0gc2Nyb2xsWSA8IDApICYmIChzY3JvbGxZID4gcGFyc2VJbnQocGluT2Zmc2V0VG9wKSApO1xuXHQgICAgICAgIHBpbm5lZEJvdHRvbSA9ICggcGFyc2VJbnQocGluT2Zmc2V0Qm90dG9tKSAtIHNjcm9sbFkgPCAwKSAmJiAoc2Nyb2xsWSA+IHBhcnNlSW50KHBpbk9mZnNldEJvdHRvbSkgKTtcblx0ICAgICAgfSxcblx0ICAgICAgcGluVG9wID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggIWFmZml4ZWRUb1RvcCAmJiAhaGFzQ2xhc3MoZWxlbWVudCxhZmZpeCkgKSB7IC8vIG9uIGxvYWRpbmcgYSBwYWdlIGhhbGZ3YXkgc2Nyb2xsZWQgdGhlc2UgZXZlbnRzIGRvbid0IHRyaWdnZXIgaW4gQ2hyb21lXG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4LCBhZmZpeCk7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4VG9wLCBhZmZpeCk7XG5cdCAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LGFmZml4KTtcblx0ICAgICAgICAgIGFmZml4ZWRUb1RvcCA9IHRydWU7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWQsIGFmZml4KTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhlZFRvcCwgYWZmaXgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgdW5QaW5Ub3AgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCBhZmZpeGVkVG9Ub3AgJiYgaGFzQ2xhc3MoZWxlbWVudCxhZmZpeCkgKSB7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGFmZml4KTtcblx0ICAgICAgICAgIGFmZml4ZWRUb1RvcCA9IGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgcGluQm90dG9tID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggIWFmZml4ZWRUb0JvdHRvbSAmJiAhaGFzQ2xhc3MoZWxlbWVudCwgYWZmaXhCb3R0b20pICkge1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeCwgYWZmaXgpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeEJvdHRvbSwgYWZmaXgpO1xuXHQgICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCxhZmZpeEJvdHRvbSk7XG5cdCAgICAgICAgICBhZmZpeGVkVG9Cb3R0b20gPSB0cnVlO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkLCBhZmZpeCk7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWRCb3R0b20sIGFmZml4KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHVuUGluQm90dG9tID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggYWZmaXhlZFRvQm90dG9tICYmIGhhc0NsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pICkge1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxhZmZpeEJvdHRvbSk7XG5cdCAgICAgICAgICBhZmZpeGVkVG9Cb3R0b20gPSBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHVwZGF0ZVBpbiA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIHBpbm5lZEJvdHRvbSApIHtcblx0ICAgICAgICAgIGlmICggcGlubmVkVG9wICkgeyB1blBpblRvcCgpOyB9XG5cdCAgICAgICAgICBwaW5Cb3R0b20oKTsgXG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHVuUGluQm90dG9tKCk7XG5cdCAgICAgICAgICBpZiAoIHBpbm5lZFRvcCApIHsgcGluVG9wKCk7IH0gXG5cdCAgICAgICAgICBlbHNlIHsgdW5QaW5Ub3AoKTsgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICBcblx0ICAgIC8vIHB1YmxpYyBtZXRob2Rcblx0ICAgIHRoaXNbdXBkYXRlXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgY2hlY2tQb3NpdGlvbigpO1xuXHQgICAgICB1cGRhdGVQaW4oKTsgXG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ0FmZml4IGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgb24oIGdsb2JhbE9iamVjdCwgc2Nyb2xsRXZlbnQsIHRoaXNbdXBkYXRlXSApO1xuXHQgICAgICBvbiggZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgZnVuY3Rpb24oKSB7IHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgc2VsZlt1cGRhdGVdKCk7IH0sIHJlc2l6ZURlbGF5KTsgfSk7XG5cdCAgICB9XG5cdCAgICBlbGVtZW50W3N0cmluZ0FmZml4XSA9IHRoaXM7XG5cdCAgXG5cdCAgICB0aGlzW3VwZGF0ZV0oKTtcblx0ICB9O1xuXHQgIFxuXHQgIC8vIEFGRklYIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQWZmaXgsIEFmZml4LCBkYXRhU3B5ICk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQWxlcnRcblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBBTEVSVCBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT09PVxuXHQgIHZhciBBbGVydCA9IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuXHQgICAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gYmluZCwgdGFyZ2V0IGFsZXJ0LCBkdXJhdGlvbiBhbmQgc3R1ZmZcblx0ICAgIHZhciBzZWxmID0gdGhpcywgY29tcG9uZW50ID0gJ2FsZXJ0Jyxcblx0ICAgICAgYWxlcnQgPSBnZXRDbG9zZXN0KGVsZW1lbnQsJy4nK2NvbXBvbmVudCksXG5cdCAgICAgIC8vIGhhbmRsZXJzXG5cdCAgICAgIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGUpe1xuXHQgICAgICAgIHZhciBldmVudFRhcmdldCA9IGVbdGFyZ2V0XTtcblx0ICAgICAgICBldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0W2hhc0F0dHJpYnV0ZV0oZGF0YURpc21pc3MpID8gZXZlbnRUYXJnZXQgOiBldmVudFRhcmdldFtwYXJlbnROb2RlXTtcblx0ICAgICAgICBpZiAoZXZlbnRUYXJnZXQgJiYgZXZlbnRUYXJnZXRbaGFzQXR0cmlidXRlXShkYXRhRGlzbWlzcykpIHsgLy8gd2UgZG91YmxlIGNoZWNrIHRoZSBkYXRhIGF0dHJpYnV0ZSwgaXQncyBpbXBvcnRhbnRcblx0ICAgICAgICAgIGFsZXJ0ID0gZ2V0Q2xvc2VzdChldmVudFRhcmdldCwnLicrY29tcG9uZW50KTtcblx0ICAgICAgICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoJ1snK2RhdGFEaXNtaXNzKyc9XCInK2NvbXBvbmVudCsnXCJdJyxhbGVydCk7XG5cdCAgICAgICAgICAoZWxlbWVudCA9PT0gZXZlbnRUYXJnZXQgfHwgZWxlbWVudCA9PT0gZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV0pICYmIGFsZXJ0ICYmIHNlbGYuY2xvc2UoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHRyYW5zaXRpb25FbmRIYW5kbGVyID0gZnVuY3Rpb24oKXtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFsZXJ0LCBjbG9zZWRFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICBvZmYoZWxlbWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTsgLy8gZGV0YWNoIGl0J3MgbGlzdGVuZXJcblx0ICAgICAgICBhbGVydFtwYXJlbnROb2RlXS5yZW1vdmVDaGlsZChhbGVydCk7XG5cdCAgICAgIH07XG5cdCAgICBcblx0ICAgIC8vIHB1YmxpYyBtZXRob2Rcblx0ICAgIHRoaXMuY2xvc2UgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKCBhbGVydCAmJiBlbGVtZW50ICYmIGhhc0NsYXNzKGFsZXJ0LGluQ2xhc3MpICkge1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoYWxlcnQsIGNsb3NlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgcmVtb3ZlQ2xhc3MoYWxlcnQsaW5DbGFzcyk7XG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGlmIChhbGVydCkge1xuXHQgICAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChhbGVydCx0cmFuc2l0aW9uRW5kSGFuZGxlcik7XG5cdCAgICAgICAgICB9IFxuXHQgICAgICAgIH0sIGR1cmF0aW9uKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdBbGVydCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7XG5cdCAgICB9XG5cdCAgICBlbGVtZW50W3N0cmluZ0FsZXJ0XSA9IHRoaXM7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBBTEVSVCBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PT09XG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkgKCBzdHJpbmdBbGVydCwgQWxlcnQsIGRhdGFEaXNtaXNzICk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQnV0dG9uXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBCVVRUT04gREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PT1cblx0ICB2YXIgQnV0dG9uID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbiApIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uXG5cdCAgICBvcHRpb24gPSBvcHRpb24gfHwgbnVsbDtcblx0ICBcblx0ICAgIC8vIGNvbnN0YW50XG5cdCAgICB2YXIgdG9nZ2xlZCA9IGZhbHNlLCAvLyB0b2dnbGVkIG1ha2VzIHN1cmUgdG8gcHJldmVudCB0cmlnZ2VyaW5nIHR3aWNlIHRoZSBjaGFuZ2UuYnMuYnV0dG9uIGV2ZW50c1xuXHQgIFxuXHQgICAgICAgIC8vIHN0cmluZ3Ncblx0ICAgICAgICBjb21wb25lbnQgPSAnYnV0dG9uJyxcblx0ICAgICAgICBjaGVja2VkID0gJ2NoZWNrZWQnLFxuXHQgICAgICAgIHJlc2V0ID0gJ3Jlc2V0Jyxcblx0ICAgICAgICBMQUJFTCA9ICdMQUJFTCcsXG5cdCAgICAgICAgSU5QVVQgPSAnSU5QVVQnLFxuXHQgIFxuXHQgICAgICAvLyBwcml2YXRlIG1ldGhvZHNcblx0ICAgICAgc2V0U3RhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoICEhIG9wdGlvbiAmJiBvcHRpb24gIT09IHJlc2V0ICkge1xuXHQgICAgICAgICAgaWYgKCBvcHRpb24gPT09IGxvYWRpbmcgKSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQsZGlzYWJsZWQpO1xuXHQgICAgICAgICAgICBlbGVtZW50W3NldEF0dHJpYnV0ZV0oZGlzYWJsZWQsZGlzYWJsZWQpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgZWxlbWVudFtzZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRleHQsIGVsZW1lbnQuaW5uZXJIVE1MLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKSk7IC8vIHRyaW0gdGhlIHRleHRcblx0ICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdkYXRhLScrb3B0aW9uKyctdGV4dCcpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgcmVzZXRTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmIChlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGV4dCkpIHtcblx0ICAgICAgICAgIGlmICggaGFzQ2xhc3MoZWxlbWVudCxkaXNhYmxlZCkgfHwgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRpc2FibGVkKSA9PT0gZGlzYWJsZWQgKSB7XG5cdCAgICAgICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsZGlzYWJsZWQpO1xuXHQgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShkaXNhYmxlZCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUZXh0KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHRvZ2dsZSA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICB2YXIgcGFyZW50ID0gZVt0YXJnZXRdW3BhcmVudE5vZGVdLFxuXHQgICAgICAgICAgbGFiZWwgPSBlW3RhcmdldF0udGFnTmFtZSA9PT0gTEFCRUwgPyBlW3RhcmdldF0gOiBwYXJlbnQudGFnTmFtZSA9PT0gTEFCRUwgPyBwYXJlbnQgOiBudWxsOyAvLyB0aGUgLmJ0biBsYWJlbFxuXHQgIFxuXHQgICAgICAgIGlmICggIWxhYmVsICkgcmV0dXJuOyAvL3JlYWN0IGlmIGEgbGFiZWwgb3IgaXRzIGltbWVkaWF0ZSBjaGlsZCBpcyBjbGlja2VkXG5cdCAgXG5cdCAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gdGhpcywgLy8gdGhlIGJ1dHRvbiBncm91cCwgdGhlIHRhcmdldCBvZiB0aGUgaGFuZGxlciBmdW5jdGlvblxuXHQgICAgICAgICAgbGFiZWxzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShldmVudFRhcmdldCwnYnRuJyksIC8vIGFsbCB0aGUgYnV0dG9uIGdyb3VwIGJ1dHRvbnNcblx0ICAgICAgICAgIGlucHV0ID0gbGFiZWxbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKElOUFVUKVswXTtcblx0ICBcblx0ICAgICAgICBpZiAoICFpbnB1dCApIHJldHVybjsgLy9yZXR1cm4gaWYgbm8gaW5wdXQgZm91bmRcblx0ICBcblx0ICAgICAgICAvLyBtYW5hZ2UgdGhlIGRvbSBtYW5pcHVsYXRpb25cblx0ICAgICAgICBpZiAoIGlucHV0LnR5cGUgPT09ICdjaGVja2JveCcgKSB7IC8vY2hlY2tib3hlc1xuXHQgICAgICAgICAgaWYgKCAhaW5wdXRbY2hlY2tlZF0gKSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKGxhYmVsLGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIGlucHV0W2dldEF0dHJpYnV0ZV0oY2hlY2tlZCk7XG5cdCAgICAgICAgICAgIGlucHV0W3NldEF0dHJpYnV0ZV0oY2hlY2tlZCxjaGVja2VkKTtcblx0ICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSB0cnVlO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgcmVtb3ZlQ2xhc3MobGFiZWwsYWN0aXZlKTtcblx0ICAgICAgICAgICAgaW5wdXRbZ2V0QXR0cmlidXRlXShjaGVja2VkKTtcblx0ICAgICAgICAgICAgaW5wdXQucmVtb3ZlQXR0cmlidXRlKGNoZWNrZWQpO1xuXHQgICAgICAgICAgICBpbnB1dFtjaGVja2VkXSA9IGZhbHNlO1xuXHQgICAgICAgICAgfVxuXHQgIFxuXHQgICAgICAgICAgaWYgKCF0b2dnbGVkKSB7IC8vIHByZXZlbnQgdHJpZ2dlcmluZyB0aGUgZXZlbnQgdHdpY2Vcblx0ICAgICAgICAgICAgdG9nZ2xlZCA9IHRydWU7XG5cdCAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoaW5wdXQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGlucHV0XG5cdCAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgY2hhbmdlRXZlbnQsIGNvbXBvbmVudCk7IC8vdHJpZ2dlciB0aGUgY2hhbmdlIGZvciB0aGUgYnRuLWdyb3VwXG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgIFxuXHQgICAgICAgIGlmICggaW5wdXQudHlwZSA9PT0gJ3JhZGlvJyAmJiAhdG9nZ2xlZCApIHsgLy8gcmFkaW8gYnV0dG9uc1xuXHQgICAgICAgICAgaWYgKCAhaW5wdXRbY2hlY2tlZF0gKSB7IC8vIGRvbid0IHRyaWdnZXIgaWYgYWxyZWFkeSBhY3RpdmVcblx0ICAgICAgICAgICAgYWRkQ2xhc3MobGFiZWwsYWN0aXZlKTtcblx0ICAgICAgICAgICAgaW5wdXRbc2V0QXR0cmlidXRlXShjaGVja2VkLGNoZWNrZWQpO1xuXHQgICAgICAgICAgICBpbnB1dFtjaGVja2VkXSA9IHRydWU7XG5cdCAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoaW5wdXQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGlucHV0XG5cdCAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgY2hhbmdlRXZlbnQsIGNvbXBvbmVudCk7IC8vdHJpZ2dlciB0aGUgY2hhbmdlIGZvciB0aGUgYnRuLWdyb3VwXG5cdCAgXG5cdCAgICAgICAgICAgIHRvZ2dsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGwgPSBsYWJlbHNbbGVuZ3RoXTsgaTxsbDsgaSsrKSB7XG5cdCAgICAgICAgICAgICAgdmFyIG90aGVyTGFiZWwgPSBsYWJlbHNbaV0sIG90aGVySW5wdXQgPSBvdGhlckxhYmVsW2dldEVsZW1lbnRzQnlUYWdOYW1lXShJTlBVVClbMF07XG5cdCAgICAgICAgICAgICAgaWYgKCBvdGhlckxhYmVsICE9PSBsYWJlbCAmJiBoYXNDbGFzcyhvdGhlckxhYmVsLGFjdGl2ZSkgKSAge1xuXHQgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3Mob3RoZXJMYWJlbCxhY3RpdmUpO1xuXHQgICAgICAgICAgICAgICAgb3RoZXJJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoY2hlY2tlZCk7XG5cdCAgICAgICAgICAgICAgICBvdGhlcklucHV0W2NoZWNrZWRdID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG90aGVySW5wdXQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvLyB0cmlnZ2VyIHRoZSBjaGFuZ2Vcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7IHRvZ2dsZWQgPSBmYWxzZTsgfSwgNTAgKTtcblx0ICAgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggaGFzQ2xhc3MoZWxlbWVudCwnYnRuJykgKSB7IC8vIHdoZW4gQnV0dG9uIHRleHQgaXMgdXNlZCB3ZSBleGVjdXRlIGl0IGFzIGFuIGluc3RhbmNlIG1ldGhvZFxuXHQgICAgICBpZiAoIG9wdGlvbiAhPT0gbnVsbCApIHtcblx0ICAgICAgICBpZiAoIG9wdGlvbiAhPT0gcmVzZXQgKSB7IHNldFN0YXRlKCk7IH0gXG5cdCAgICAgICAgZWxzZSB7IHJlc2V0U3RhdGUoKTsgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ2J0bi1ncm91cCcpICkge1xuXHQgICAgICBpZiAoICEoIHN0cmluZ0J1dHRvbiBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgICAgb24oIGVsZW1lbnQsIGNsaWNrRXZlbnQsIHRvZ2dsZSApO1xuXHQgICAgICB9XG5cdCAgICAgIGVsZW1lbnRbc3RyaW5nQnV0dG9uXSA9IHRoaXM7XG5cdCAgICB9XG5cdCAgfTtcblx0ICBcblx0ICAvLyBCVVRUT04gREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdCdXR0b24sIEJ1dHRvbiwgZGF0YVRvZ2dsZSApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IENhcm91c2VsXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gQ0FST1VTRUwgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PT1cblx0ICB2YXIgQ2Fyb3VzZWwgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoIGVsZW1lbnQgKTtcblx0ICBcblx0ICAgIC8vIHNldCBvcHRpb25zXG5cdCAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0ICBcblx0ICAgIC8vIERBVEEgQVBJXG5cdCAgICB2YXIgaW50ZXJ2YWxEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFJbnRlcnZhbCkgPT09ICdmYWxzZScgPyBmYWxzZSA6IHBhcnNlSW50KGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhSW50ZXJ2YWwpKSB8fCA1MDAwLCAvLyBib290c3RyYXAgY2Fyb3VzZWwgZGVmYXVsdCBpbnRlcnZhbFxuXHQgICAgICAgIHBhdXNlRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhUGF1c2UpID09PSBob3ZlckV2ZW50IHx8IGZhbHNlLFxuXHQgICAgICAgIGtleWJvYXJkRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhS2V5Ym9hcmQpID09PSAndHJ1ZScgfHwgZmFsc2UsXG5cdCAgICAgIFxuXHQgICAgICAgIC8vIHN0cmluZ3Ncblx0ICAgICAgICBjb21wb25lbnQgPSAnY2Fyb3VzZWwnLFxuXHQgICAgICAgIHBhdXNlZCA9ICdwYXVzZWQnLFxuXHQgICAgICAgIGRpcmVjdGlvbiA9ICdkaXJlY3Rpb24nLFxuXHQgICAgICAgIGRhdGFTbGlkZVRvID0gJ2RhdGEtc2xpZGUtdG8nOyBcblx0ICBcblx0ICAgIHRoaXNba2V5Ym9hcmRdID0gb3B0aW9uc1trZXlib2FyZF0gPT09IHRydWUgfHwga2V5Ym9hcmREYXRhO1xuXHQgICAgdGhpc1twYXVzZV0gPSAob3B0aW9uc1twYXVzZV0gPT09IGhvdmVyRXZlbnQgfHwgcGF1c2VEYXRhKSA/IGhvdmVyRXZlbnQgOiBmYWxzZTsgLy8gZmFsc2UgLyBob3ZlclxuXHQgIFxuXHQgICAgaWYgKCAhKCBvcHRpb25zW2ludGVydmFsXSB8fCBpbnRlcnZhbERhdGEgKSApIHsgLy8gZGV0ZXJtaW5lIHNsaWRlIGludGVydmFsXG5cdCAgICAgIHRoaXNbaW50ZXJ2YWxdID0gZmFsc2U7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aGlzW2ludGVydmFsXSA9IHBhcnNlSW50KG9wdGlvbnNbaW50ZXJ2YWxdKSB8fCBpbnRlcnZhbERhdGE7IC8vIGRlZmF1bHQgc2xpZGUgaW50ZXJ2YWxcblx0ICAgIH1cblx0ICBcblx0ICAgIC8vIGJpbmQsIGV2ZW50IHRhcmdldHNcblx0ICAgIHZhciBzZWxmID0gdGhpcywgaW5kZXggPSBlbGVtZW50LmluZGV4ID0gMCwgdGltZXIgPSBlbGVtZW50LnRpbWVyID0gMCwgXG5cdCAgICAgIGlzU2xpZGluZyA9IGZhbHNlLCAvLyBpc1NsaWRpbmcgcHJldmVudHMgY2xpY2sgZXZlbnQgaGFuZGxlcnMgd2hlbiBhbmltYXRpb24gaXMgcnVubmluZ1xuXHQgICAgICBzbGlkZXMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW1lbnQsJ2l0ZW0nKSwgdG90YWwgPSBzbGlkZXNbbGVuZ3RoXSxcblx0ICAgICAgc2xpZGVEaXJlY3Rpb24gPSB0aGlzW2RpcmVjdGlvbl0gPSBsZWZ0LFxuXHQgICAgICBjb250cm9scyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZWxlbWVudCxjb21wb25lbnQrJy1jb250cm9sJyksXG5cdCAgICAgIGxlZnRBcnJvdyA9IGNvbnRyb2xzWzBdLCByaWdodEFycm93ID0gY29udHJvbHNbMV0sXG5cdCAgICAgIGluZGljYXRvciA9IHF1ZXJ5RWxlbWVudCggJy4nK2NvbXBvbmVudCsnLWluZGljYXRvcnMnLCBlbGVtZW50ICksXG5cdCAgICAgIGluZGljYXRvcnMgPSBpbmRpY2F0b3JbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKCBcIkxJXCIgKTtcblx0ICBcblx0ICAgIC8vIGhhbmRsZXJzXG5cdCAgICB2YXIgcGF1c2VIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggc2VsZltpbnRlcnZhbF0gIT09ZmFsc2UgJiYgIWhhc0NsYXNzKGVsZW1lbnQscGF1c2VkKSApIHtcblx0ICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQscGF1c2VkKTtcblx0ICAgICAgICAgICFpc1NsaWRpbmcgJiYgY2xlYXJJbnRlcnZhbCggdGltZXIgKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlc3VtZUhhbmRsZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICE9PSBmYWxzZSAmJiBoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LHBhdXNlZCk7XG5cdCAgICAgICAgICAhaXNTbGlkaW5nICYmIGNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG5cdCAgICAgICAgICAhaXNTbGlkaW5nICYmIHNlbGYuY3ljbGUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGluZGljYXRvckhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgICAgIGlmIChpc1NsaWRpbmcpIHJldHVybjtcblx0ICBcblx0ICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlW3RhcmdldF0sIGFjdGl2ZUluZGljYXRvciA9IHNlbGYuZ2V0QWN0aXZlSW5kZXgoKTsgLy8gZXZlbnQgdGFyZ2V0IHwgdGhlIGN1cnJlbnQgYWN0aXZlIGl0ZW1cblx0ICBcblx0ICAgICAgICBpZiAoIGV2ZW50VGFyZ2V0ICYmICFoYXNDbGFzcyhldmVudFRhcmdldCxhY3RpdmUpICYmIGV2ZW50VGFyZ2V0W2dldEF0dHJpYnV0ZV0oZGF0YVNsaWRlVG8pICkge1xuXHQgICAgICAgICAgaW5kZXggPSBwYXJzZUludCggZXZlbnRUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhU2xpZGVUbyksIDEwICk7XG5cdCAgXG5cdCAgICAgICAgICAvL2RldGVybWluZSBkaXJlY3Rpb24gZmlyc3Rcblx0ICAgICAgICAgIGlmICAoIChhY3RpdmVJbmRpY2F0b3IgPCBpbmRleCApIHx8IChhY3RpdmVJbmRpY2F0b3IgPT09IDAgJiYgaW5kZXggPT09IHRvdGFsIC0xICkgKSB7XG5cdCAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDsgLy8gbmV4dFxuXHQgICAgICAgICAgfSBlbHNlIGlmICAoIChhY3RpdmVJbmRpY2F0b3IgPiBpbmRleCkgfHwgKGFjdGl2ZUluZGljYXRvciA9PT0gdG90YWwgLSAxICYmIGluZGV4ID09PSAwICkgKSB7XG5cdCAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gcmlnaHQ7IC8vIHByZXZcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH1cblx0ICBcblx0ICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7IC8vRG8gdGhlIHNsaWRlXG5cdCAgICAgIH0sXG5cdCAgICAgIGNvbnRyb2xzSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgICAgIGlmIChpc1NsaWRpbmcpIHJldHVybjtcblx0ICBcblx0ICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlLmN1cnJlbnRUYXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuXHQgIFxuXHQgICAgICAgIGlmICggZXZlbnRUYXJnZXQgPT09IHJpZ2h0QXJyb3cgKSB7XG5cdCAgICAgICAgICBpbmRleCsrO1xuXHQgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSBsZWZ0OyAvL3NldCBkaXJlY3Rpb24gZmlyc3Rcblx0ICBcblx0ICAgICAgICAgIGlmKCBpbmRleCA9PT0gdG90YWwgLSAxICkge1xuXHQgICAgICAgICAgICBpbmRleCA9IHRvdGFsIC0gMTtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAoIGluZGV4ID09PSB0b3RhbCApe1xuXHQgICAgICAgICAgICBpbmRleCA9IDA7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIGlmICggZXZlbnRUYXJnZXQgPT09IGxlZnRBcnJvdyApIHtcblx0ICAgICAgICAgIGluZGV4LS07XG5cdCAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IHJpZ2h0OyAvL3NldCBkaXJlY3Rpb24gZmlyc3Rcblx0ICBcblx0ICAgICAgICAgIGlmKCBpbmRleCA9PT0gMCApIHtcblx0ICAgICAgICAgICAgaW5kZXggPSAwO1xuXHQgICAgICAgICAgfSBlbHNlIGlmICggaW5kZXggPCAwICl7XG5cdCAgICAgICAgICAgIGluZGV4ID0gdG90YWwgLSAxXG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgIFxuXHQgICAgICAgIHNlbGYuc2xpZGVUbyggaW5kZXggKTsgLy9EbyB0aGUgc2xpZGVcblx0ICAgICAgfSxcblx0ICAgICAga2V5SGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgaWYgKGlzU2xpZGluZykgcmV0dXJuO1xuXHQgICAgICAgIHN3aXRjaCAoZS53aGljaCkge1xuXHQgICAgICAgICAgY2FzZSAzOTpcblx0ICAgICAgICAgICAgaW5kZXgrKztcblx0ICAgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSBsZWZ0O1xuXHQgICAgICAgICAgICBpZiggaW5kZXggPT0gdG90YWwgLSAxICkgeyBpbmRleCA9IHRvdGFsIC0gMTsgfSBlbHNlXG5cdCAgICAgICAgICAgIGlmICggaW5kZXggPT0gdG90YWwgKXsgaW5kZXggPSAwIH1cblx0ICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICBjYXNlIDM3OlxuXHQgICAgICAgICAgICBpbmRleC0tO1xuXHQgICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IHJpZ2h0O1xuXHQgICAgICAgICAgICBpZiAoIGluZGV4ID09IDAgKSB7IGluZGV4ID0gMDsgfSBlbHNlXG5cdCAgICAgICAgICAgIGlmICggaW5kZXggPCAwICkgeyBpbmRleCA9IHRvdGFsIC0gMSB9XG5cdCAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgZGVmYXVsdDogcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7IC8vRG8gdGhlIHNsaWRlXG5cdCAgICAgIH0sXG5cdCAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgICBzZXRBY3RpdmVQYWdlID0gZnVuY3Rpb24oIHBhZ2VJbmRleCApIHsgLy9pbmRpY2F0b3JzXG5cdCAgICAgICAgZm9yICggdmFyIGkgPSAwLCBpY2wgPSBpbmRpY2F0b3JzW2xlbmd0aF07IGkgPCBpY2w7IGkrKyApIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGluZGljYXRvcnNbaV0sYWN0aXZlKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGluZGljYXRvcnNbcGFnZUluZGV4XSkgYWRkQ2xhc3MoaW5kaWNhdG9yc1twYWdlSW5kZXhdLCBhY3RpdmUpO1xuXHQgICAgICB9O1xuXHQgIFxuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMuY3ljbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgc2xpZGVEaXJlY3Rpb24gPSB0aGlzW2RpcmVjdGlvbl0gPSBsZWZ0OyAvLyBtYWtlIHN1cmUgdG8gYWx3YXlzIGNvbWUgYmFjayB0byBkZWZhdWx0IHNsaWRlRGlyZWN0aW9uXG5cdCAgICAgIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaW5kZXgrKztcblx0ICBcblx0ICAgICAgICBpbmRleCA9IGluZGV4ID09PSB0b3RhbCA/IDAgOiBpbmRleDtcblx0ICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7XG5cdCAgICAgIH0sIHRoaXNbaW50ZXJ2YWxdKTtcblx0ICAgIH07XG5cdCAgICB0aGlzLnNsaWRlVG8gPSBmdW5jdGlvbiggbmV4dCApIHtcblx0ICAgICAgdmFyIGFjdGl2ZUl0ZW0gPSB0aGlzLmdldEFjdGl2ZUluZGV4KCksIC8vIHRoZSBjdXJyZW50IGFjdGl2ZVxuXHQgICAgICAgICAgb3JpZW50YXRpb24gPSBzbGlkZURpcmVjdGlvbiA9PT0gbGVmdCA/ICduZXh0JyA6ICdwcmV2JzsgLy9kZXRlcm1pbmUgdHlwZVxuXHQgIFxuXHQgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNsaWRlRXZlbnQsIGNvbXBvbmVudCwgc2xpZGVzW25leHRdKTsgLy8gaGVyZSB3ZSBnbyB3aXRoIHRoZSBzbGlkZVxuXHQgIFxuXHQgICAgICBpc1NsaWRpbmcgPSB0aGlzLmlzU2xpZGluZyA9IHRydWU7XG5cdCAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xuXHQgICAgICBzZXRBY3RpdmVQYWdlKCBuZXh0ICk7XG5cdCAgXG5cdCAgICAgIGlmICggc3VwcG9ydFRyYW5zaXRpb25zICYmIGhhc0NsYXNzKGVsZW1lbnQsJ3NsaWRlJykgKSB7XG5cdCAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLG9yaWVudGF0aW9uKTtcblx0ICAgICAgICBzbGlkZXNbbmV4dF1bb2Zmc2V0V2lkdGhdOyAgXG5cdCAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLHNsaWRlRGlyZWN0aW9uKTtcblx0ICAgICAgICBhZGRDbGFzcyhzbGlkZXNbYWN0aXZlSXRlbV0sc2xpZGVEaXJlY3Rpb24pO1xuXHQgIFxuXHQgICAgICAgIG9uZShzbGlkZXNbbmV4dF0sIHRyYW5zaXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7IC8vd2UncmUgZ29ubmEgZmFrZSB3YWl0aW5nIGZvciB0aGUgYW5pbWF0aW9uIHRvIGZpbmlzaCwgY2xlYW5lciBhbmQgYmV0dGVyXG5cdCAgICAgICAgICBpc1NsaWRpbmcgPSBzZWxmLmlzU2xpZGluZyA9IGZhbHNlO1xuXHQgIFxuXHQgICAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLGFjdGl2ZSk7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbYWN0aXZlSXRlbV0sYWN0aXZlKTtcblx0ICBcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1tuZXh0XSxvcmllbnRhdGlvbik7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbbmV4dF0sc2xpZGVEaXJlY3Rpb24pO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLHNsaWRlRGlyZWN0aW9uKTtcblx0ICBcblx0ICAgICAgICAgIGlmICggc2VsZltpbnRlcnZhbF0gJiYgIWhhc0NsYXNzKGVsZW1lbnQscGF1c2VkKSApIHtcblx0ICAgICAgICAgICAgc2VsZi5jeWNsZSgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzbGlkRXZlbnQsIGNvbXBvbmVudCwgc2xpZGVzW25leHRdKTsgLy8gaGVyZSB3ZSBnbyB3aXRoIHRoZSBzbGlkIGV2ZW50XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgXG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLGFjdGl2ZSk7XG5cdCAgICAgICAgc2xpZGVzW25leHRdW29mZnNldFdpZHRoXTtcblx0ICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbYWN0aXZlSXRlbV0sYWN0aXZlKTtcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgaXNTbGlkaW5nID0gZmFsc2U7XG5cdCAgICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG5cdCAgICAgICAgICAgIHNlbGYuY3ljbGUoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2xpZEV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZCBldmVudFxuXHQgICAgICAgIH0sIDEwMCApO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgdGhpcy5nZXRBY3RpdmVJbmRleCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIHNsaWRlc1tpbmRleE9mXShnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW1lbnQsJ2l0ZW0gYWN0aXZlJylbMF0pIHx8IDA7XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ0Nhcm91c2VsIGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICBcblx0ICAgICAgaWYgKCB0aGlzW3BhdXNlXSAmJiB0aGlzW2ludGVydmFsXSApIHtcblx0ICAgICAgICBvbiggZWxlbWVudCwgbW91c2VIb3ZlclswXSwgcGF1c2VIYW5kbGVyICk7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsIG1vdXNlSG92ZXJbMV0sIHJlc3VtZUhhbmRsZXIgKTtcblx0ICAgICAgICBvbiggZWxlbWVudCwgJ3RvdWNoc3RhcnQnLCBwYXVzZUhhbmRsZXIgKTtcblx0ICAgICAgICBvbiggZWxlbWVudCwgJ3RvdWNoZW5kJywgcmVzdW1lSGFuZGxlciApO1xuXHQgICAgICB9XG5cdCAgICBcblx0ICAgICAgcmlnaHRBcnJvdyAmJiBvbiggcmlnaHRBcnJvdywgY2xpY2tFdmVudCwgY29udHJvbHNIYW5kbGVyICk7XG5cdCAgICAgIGxlZnRBcnJvdyAmJiBvbiggbGVmdEFycm93LCBjbGlja0V2ZW50LCBjb250cm9sc0hhbmRsZXIgKTtcblx0ICAgIFxuXHQgICAgICBpbmRpY2F0b3IgJiYgb24oIGluZGljYXRvciwgY2xpY2tFdmVudCwgaW5kaWNhdG9ySGFuZGxlciwgZmFsc2UpO1xuXHQgICAgICB0aGlzW2tleWJvYXJkXSA9PT0gdHJ1ZSAmJiBvbiggZ2xvYmFsT2JqZWN0LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIsIGZhbHNlKTtcblx0ICBcblx0ICAgIH1cblx0ICAgIGlmICh0aGlzLmdldEFjdGl2ZUluZGV4KCk8MCkge1xuXHQgICAgICBzbGlkZXNbbGVuZ3RoXSAmJiBhZGRDbGFzcyhzbGlkZXNbMF0sYWN0aXZlKTtcblx0ICAgICAgaW5kaWNhdG9yc1tsZW5ndGhdICYmIHNldEFjdGl2ZVBhZ2UoMCk7XG5cdCAgICB9XG5cdCAgXG5cdCAgICBpZiAoIHRoaXNbaW50ZXJ2YWxdICl7IHRoaXMuY3ljbGUoKTsgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdDYXJvdXNlbF0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gQ0FST1VTRUwgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdDYXJvdXNlbCwgQ2Fyb3VzZWwsIGRhdGFSaWRlICk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQ29sbGFwc2Vcblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gQ09MTEFQU0UgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PT1cblx0ICB2YXIgQ29sbGFwc2UgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgXG5cdCAgXG5cdCAgICAvLyBldmVudCB0YXJnZXRzIGFuZCBjb25zdGFudHNcblx0ICAgIHZhciBhY2NvcmRpb24gPSBudWxsLCBjb2xsYXBzZSA9IG51bGwsIHNlbGYgPSB0aGlzLCBcblx0ICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZSwgLy8gd2hlbiB0cnVlIGl0IHdpbGwgcHJldmVudCBjbGljayBoYW5kbGVyc1xuXHQgICAgICBhY2NvcmRpb25EYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdkYXRhLXBhcmVudCcpLFxuXHQgIFxuXHQgICAgICAvLyBjb21wb25lbnQgc3RyaW5nc1xuXHQgICAgICBjb21wb25lbnQgPSAnY29sbGFwc2UnLFxuXHQgICAgICBjb2xsYXBzZWQgPSAnY29sbGFwc2VkJyxcblx0ICBcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIG9wZW5BY3Rpb24gPSBmdW5jdGlvbihjb2xsYXBzZUVsZW1lbnQpIHtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGNvbGxhcHNlRWxlbWVudCwgc2hvd0V2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgIGlzQW5pbWF0aW5nID0gdHJ1ZTtcblx0ICAgICAgICBhZGRDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG5cdCAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGluQ2xhc3MpO1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQoY29sbGFwc2VFbGVtZW50KSArICdweCc7XG5cdCAgICAgICAgfSwgMCk7XG5cdCAgXG5cdCAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoY29sbGFwc2VFbGVtZW50LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxjb2xsYXBzaW5nKTtcblx0ICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9ICcnO1xuXHQgICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTtcblx0ICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzZXRBdHRyaWJ1dGVdKGFyaWFFeHBhbmRlZCwndHJ1ZScpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0sXG5cdCAgICAgIGNsb3NlQWN0aW9uID0gZnVuY3Rpb24oY29sbGFwc2VFbGVtZW50KSB7XG5cdCAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIGhpZGVFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7XG5cdCAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGNvbGxhcHNlRWxlbWVudCkgKyAncHgnO1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBhZGRDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG5cdCAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSAnMHB4Jztcblx0ICAgICAgICB9LCAwKTtcblx0ICBcblx0ICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChjb2xsYXBzZUVsZW1lbnQsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoY29sbGFwc2VFbGVtZW50LGluQ2xhc3MpO1xuXHQgICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gJyc7XG5cdCAgICAgICAgICBpc0FuaW1hdGluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgY29sbGFwc2VFbGVtZW50W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLCdmYWxzZScpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9LFxuXHQgICAgICBnZXRUYXJnZXQgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgaHJlZiA9IGVsZW1lbnQuaHJlZiAmJiBlbGVtZW50W2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSxcblx0ICAgICAgICAgIHBhcmVudCA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGFyZ2V0KSxcblx0ICAgICAgICAgIGlkID0gaHJlZiB8fCAoIHBhcmVudCAmJiAvIy8udGVzdChwYXJlbnQpICkgJiYgcGFyZW50O1xuXHQgICAgICAgIHJldHVybiBpZCAmJiBxdWVyeUVsZW1lbnQoaWQpO1xuXHQgICAgICB9O1xuXHQgICAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kc1xuXHQgICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgaWYgKGlzQW5pbWF0aW5nKSByZXR1cm47XG5cdCAgICAgIGlmICghaGFzQ2xhc3MoY29sbGFwc2UsaW5DbGFzcykpIHsgc2VsZi5zaG93KCk7IH0gXG5cdCAgICAgIGVsc2UgeyBzZWxmLmhpZGUoKTsgfVxuXHQgICAgfTtcblx0ICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbG9zZUFjdGlvbihjb2xsYXBzZSk7XG5cdCAgICAgIGFkZENsYXNzKGVsZW1lbnQsY29sbGFwc2VkKTtcblx0ICAgIH07XG5cdCAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgb3BlbkFjdGlvbihjb2xsYXBzZSk7XG5cdCAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsY29sbGFwc2VkKTtcblx0ICBcblx0ICAgICAgaWYgKCBhY2NvcmRpb24gIT09IG51bGwgKSB7XG5cdCAgICAgICAgdmFyIGFjdGl2ZUNvbGxhcHNlcyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoYWNjb3JkaW9uLGNvbXBvbmVudCsnICcraW5DbGFzcyk7XG5cdCAgICAgICAgZm9yICh2YXIgaT0wLCBhbD1hY3RpdmVDb2xsYXBzZXNbbGVuZ3RoXTsgaTxhbDsgaSsrKSB7XG5cdCAgICAgICAgICBpZiAoIGFjdGl2ZUNvbGxhcHNlc1tpXSAhPT0gY29sbGFwc2UpIGNsb3NlQWN0aW9uKGFjdGl2ZUNvbGxhcHNlc1tpXSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ0NvbGxhcHNlIGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgb24oZWxlbWVudCwgY2xpY2tFdmVudCwgdGhpcy50b2dnbGUpO1xuXHQgICAgfVxuXHQgICAgY29sbGFwc2UgPSBnZXRUYXJnZXQoKTtcblx0ICAgIGFjY29yZGlvbiA9IHF1ZXJ5RWxlbWVudChvcHRpb25zLnBhcmVudCkgfHwgYWNjb3JkaW9uRGF0YSAmJiBnZXRDbG9zZXN0KGVsZW1lbnQsIGFjY29yZGlvbkRhdGEpO1xuXHQgICAgZWxlbWVudFtzdHJpbmdDb2xsYXBzZV0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gQ09MTEFQU0UgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ0NvbGxhcHNlLCBDb2xsYXBzZSwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgRHJvcGRvd25cblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBEUk9QRE9XTiBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT09PT09PVxuXHQgIHZhciBEcm9wZG93biA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb24gKSB7XG5cdCAgICAgIFxuXHQgICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuXHQgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcblx0ICBcblx0ICAgIC8vIHNldCBvcHRpb25cblx0ICAgIHRoaXMucGVyc2lzdCA9IG9wdGlvbiA9PT0gdHJ1ZSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oJ2RhdGEtcGVyc2lzdCcpID09PSAndHJ1ZScgfHwgZmFsc2U7XG5cdCAgXG5cdCAgICAvLyBjb25zdGFudHMsIGV2ZW50IHRhcmdldHMsIHN0cmluZ3Ncblx0ICAgIHZhciBzZWxmID0gdGhpcywgaXNPcGVuID0gZmFsc2UsXG5cdCAgICAgIHBhcmVudCA9IGVsZW1lbnRbcGFyZW50Tm9kZV0sXG5cdCAgICAgIGNvbXBvbmVudCA9ICdkcm9wZG93bicsIG9wZW4gPSAnb3BlbicsXG5cdCAgICAgIHJlbGF0ZWRUYXJnZXQgPSBudWxsLFxuXHQgICAgICBtZW51ID0gcXVlcnlFbGVtZW50KCcuZHJvcGRvd24tbWVudScsIHBhcmVudCksXG5cdCAgICAgIGNoaWxkcmVuID0gbm9kZUxpc3RUb0FycmF5KCBtZW51W2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnKicpKSxcblx0ICBcblx0ICAgICAgLy8gaGFuZGxlcnNcblx0ICAgICAga2V5SGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICBpZiAoaXNPcGVuICYmIChlLndoaWNoID09IDI3IHx8IGUua2V5Q29kZSA9PSAyNykpIHsgcmVsYXRlZFRhcmdldCA9IG51bGw7IGhpZGUoKTsgfSAvLyBlLmtleUNvZGUgZm9yIElFOFxuXHQgICAgICB9LFxuXHQgICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZVt0YXJnZXRdLCBoYXNEYXRhO1xuXHQgICAgICAgIGhhc0RhdGEgPSAoIGV2ZW50VGFyZ2V0Lm5vZGVUeXBlICE9PSAxICYmIChldmVudFRhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFUb2dnbGUpIHx8IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdW2dldEF0dHJpYnV0ZV0oZGF0YVRvZ2dsZSkpICk7XG5cdCAgICAgICAgaWYgKCBldmVudFRhcmdldCA9PT0gZWxlbWVudCB8fCBldmVudFRhcmdldCA9PT0gcGFyZW50IHx8IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdID09PSBlbGVtZW50ICkge1xuXHQgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBjb21tZW50IHRoaXMgbGluZSB0byBzdG9wIHByZXZlbnRpbmcgbmF2aWdhdGlvbiB3aGVuIGNsaWNrIHRhcmdldCBpcyBhIGxpbmsgXG5cdCAgICAgICAgICByZWxhdGVkVGFyZ2V0ID0gZWxlbWVudDtcblx0ICAgICAgICAgIHNlbGYudG9nZ2xlKCk7XG5cdCAgICAgICAgfSBlbHNlIGlmICggaXNPcGVuICkge1xuXHQgICAgICAgICAgaWYgKCAoZXZlbnRUYXJnZXQgPT09IG1lbnUgfHwgY2hpbGRyZW4gJiYgY2hpbGRyZW5baW5kZXhPZl0oZXZlbnRUYXJnZXQpID4gLTEpICYmICggc2VsZi5wZXJzaXN0IHx8IGhhc0RhdGEgKSApIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgfSBlbHNlIHsgcmVsYXRlZFRhcmdldCA9IG51bGw7IGhpZGUoKTsgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICAoL1xcIyQvLnRlc3QoZXZlbnRUYXJnZXQuaHJlZikgfHwgZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV0gJiYgL1xcIyQvLnRlc3QoZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV0uaHJlZikpICYmIGUucHJldmVudERlZmF1bHQoKTsgLy8gc2hvdWxkIGJlIGhlcmUgdG8gcHJldmVudCBqdW1wc1xuXHQgICAgICB9LFxuXHQgICAgICAvLyBwcml2YXRlIG1ldGhvZHNcblx0ICAgICAgc2hvdyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG5cdCAgICAgICAgYWRkQ2xhc3MocGFyZW50LG9wZW4pO1xuXHQgICAgICAgIG1lbnVbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsdHJ1ZSk7XG5cdCAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChwYXJlbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG5cdCAgICAgICAgb24oZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG5cdCAgICAgICAgaXNPcGVuID0gdHJ1ZTtcblx0ICAgICAgfSxcblx0ICAgICAgaGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG5cdCAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50LG9wZW4pO1xuXHQgICAgICAgIG1lbnVbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsZmFsc2UpO1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcblx0ICAgICAgICBvZmYoZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG5cdCAgICAgICAgaXNPcGVuID0gZmFsc2U7XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kc1xuXHQgICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKGhhc0NsYXNzKHBhcmVudCxvcGVuKSAmJiBpc09wZW4pIHsgaGlkZSgpOyB9IFxuXHQgICAgICBlbHNlIHsgc2hvdygpOyB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ0Ryb3Bkb3duIGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICBtZW51W3NldEF0dHJpYnV0ZV0oJ3RhYmluZGV4JywgJzAnKTsgLy8gRml4IG9uYmx1ciBvbiBDaHJvbWUgfCBTYWZhcmlcblx0ICAgICAgb24oZG9jdW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7XG5cdCAgICB9XG5cdCAgICBlbGVtZW50W3N0cmluZ0Ryb3Bkb3duXSA9IHRoaXM7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBEUk9QRE9XTiBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PT09PT09XG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkoIHN0cmluZ0Ryb3Bkb3duLCBEcm9wZG93biwgZGF0YVRvZ2dsZSApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IE1vZGFsXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgICBcblx0ICAvLyBNT0RBTCBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT09XG5cdCAgdmFyIE1vZGFsID0gZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucykgeyAvLyBlbGVtZW50IGNhbiBiZSB0aGUgbW9kYWwvdHJpZ2dlcmluZyBidXR0b25cblx0ICBcblx0ICAgIC8vIHRoZSBtb2RhbCAoYm90aCBKYXZhU2NyaXB0IC8gREFUQSBBUEkgaW5pdCkgLyB0cmlnZ2VyaW5nIGJ1dHRvbiBlbGVtZW50IChEQVRBIEFQSSlcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBkZXRlcm1pbmUgbW9kYWwsIHRyaWdnZXJpbmcgZWxlbWVudCBcblx0ICAgIHZhciBidG5DaGVjayA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGFyZ2V0KXx8ZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdocmVmJyksXG5cdCAgICAgIGNoZWNrTW9kYWwgPSBxdWVyeUVsZW1lbnQoIGJ0bkNoZWNrICksXG5cdCAgICAgIG1vZGFsID0gaGFzQ2xhc3MoZWxlbWVudCwnbW9kYWwnKSA/IGVsZW1lbnQgOiBjaGVja01vZGFsLFxuXHQgIFxuXHQgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgIGNvbXBvbmVudCA9ICdtb2RhbCcsXG5cdCAgICAgIHN0YXRpY1N0cmluZyA9ICdzdGF0aWMnLFxuXHQgICAgICBwYWRkaW5nTGVmdCA9ICdwYWRkaW5nTGVmdCcsXG5cdCAgICAgIHBhZGRpbmdSaWdodCA9ICdwYWRkaW5nUmlnaHQnLFxuXHQgICAgICBtb2RhbEJhY2tkcm9wU3RyaW5nID0gJ21vZGFsLWJhY2tkcm9wJztcblx0ICBcblx0ICAgIGlmICggaGFzQ2xhc3MoZWxlbWVudCwnbW9kYWwnKSApIHsgZWxlbWVudCA9IG51bGw7IH0gLy8gbW9kYWwgaXMgbm93IGluZGVwZW5kZW50IG9mIGl0J3MgdHJpZ2dlcmluZyBlbGVtZW50XG5cdCAgXG5cdCAgICBpZiAoICFtb2RhbCApIHsgcmV0dXJuOyB9IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIHNldCBvcHRpb25zXG5cdCAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0ICBcblx0ICAgIHRoaXNba2V5Ym9hcmRdID0gb3B0aW9uc1trZXlib2FyZF0gPT09IGZhbHNlIHx8IG1vZGFsW2dldEF0dHJpYnV0ZV0oZGF0YUtleWJvYXJkKSA9PT0gJ2ZhbHNlJyA/IGZhbHNlIDogdHJ1ZTtcblx0ICAgIHRoaXNbYmFja2Ryb3BdID0gb3B0aW9uc1tiYWNrZHJvcF0gPT09IHN0YXRpY1N0cmluZyB8fCBtb2RhbFtnZXRBdHRyaWJ1dGVdKGRhdGFiYWNrZHJvcCkgPT09IHN0YXRpY1N0cmluZyA/IHN0YXRpY1N0cmluZyA6IHRydWU7XG5cdCAgICB0aGlzW2JhY2tkcm9wXSA9IG9wdGlvbnNbYmFja2Ryb3BdID09PSBmYWxzZSB8fCBtb2RhbFtnZXRBdHRyaWJ1dGVdKGRhdGFiYWNrZHJvcCkgPT09ICdmYWxzZScgPyBmYWxzZSA6IHRoaXNbYmFja2Ryb3BdO1xuXHQgICAgdGhpc1tjb250ZW50XSAgPSBvcHRpb25zW2NvbnRlbnRdOyAvLyBKYXZhU2NyaXB0IG9ubHlcblx0ICBcblx0ICAgIC8vIGJpbmQsIGNvbnN0YW50cywgZXZlbnQgdGFyZ2V0cyBhbmQgb3RoZXIgdmFyc1xuXHQgICAgdmFyIHNlbGYgPSB0aGlzLCBvcGVuID0gdGhpcy5vcGVuID0gZmFsc2UsIHJlbGF0ZWRUYXJnZXQgPSBudWxsLFxuXHQgICAgICBib2R5SXNPdmVyZmxvd2luZywgbW9kYWxJc092ZXJmbG93aW5nLCBzY3JvbGxiYXJXaWR0aCwgb3ZlcmxheSxcblx0ICBcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIGdldFdpbmRvd1dpZHRoID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGh0bWxSZWN0ID0gZG9jW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKTtcblx0ICAgICAgICByZXR1cm4gZ2xvYmFsT2JqZWN0W2lubmVyV2lkdGhdIHx8IChodG1sUmVjdFtyaWdodF0gLSBNYXRoLmFicyhodG1sUmVjdFtsZWZ0XSkpO1xuXHQgICAgICB9LFxuXHQgICAgICBzZXRTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGJvZHlTdHlsZSA9IGJvZHkuY3VycmVudFN0eWxlIHx8IGdsb2JhbE9iamVjdC5nZXRDb21wdXRlZFN0eWxlKGJvZHkpLCBib2R5UGFkID0gcGFyc2VJbnQoKGJvZHlTdHlsZVtwYWRkaW5nUmlnaHRdKSwgMTApO1xuXHQgICAgICAgIGlmIChib2R5SXNPdmVyZmxvd2luZykgeyBib2R5W3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gKGJvZHlQYWQgKyBzY3JvbGxiYXJXaWR0aCkgKyAncHgnOyB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlc2V0U2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGJvZHlbc3R5bGVdW3BhZGRpbmdSaWdodF0gPSAnJztcblx0ICAgICAgfSxcblx0ICAgICAgbWVhc3VyZVNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHsgLy8gdGh4IHdhbHNoXG5cdCAgICAgICAgdmFyIHNjcm9sbERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCBzY3JvbGxCYXJXaWR0aDtcblx0ICAgICAgICBzY3JvbGxEaXYuY2xhc3NOYW1lID0gY29tcG9uZW50Kyctc2Nyb2xsYmFyLW1lYXN1cmUnOyAvLyB0aGlzIGlzIGhlcmUgdG8gc3RheVxuXHQgICAgICAgIGJvZHkuYXBwZW5kQ2hpbGQoc2Nyb2xsRGl2KTtcblx0ICAgICAgICBzY3JvbGxCYXJXaWR0aCA9IHNjcm9sbERpdltvZmZzZXRXaWR0aF0gLSBzY3JvbGxEaXZbY2xpZW50V2lkdGhdO1xuXHQgICAgICAgIGJvZHkucmVtb3ZlQ2hpbGQoc2Nyb2xsRGl2KTtcblx0ICAgICAgICByZXR1cm4gc2Nyb2xsQmFyV2lkdGg7XG5cdCAgICAgIH0sXG5cdCAgICAgIGNoZWNrU2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGJvZHlJc092ZXJmbG93aW5nID0gYm9keVtjbGllbnRXaWR0aF0gPCBnZXRXaW5kb3dXaWR0aCgpO1xuXHQgICAgICAgIG1vZGFsSXNPdmVyZmxvd2luZyA9IG1vZGFsW3Njcm9sbEhlaWdodF0gPiBkb2NbY2xpZW50SGVpZ2h0XTtcblx0ICAgICAgICBzY3JvbGxiYXJXaWR0aCA9IG1lYXN1cmVTY3JvbGxiYXIoKTtcblx0ICAgICAgfSxcblx0ICAgICAgYWRqdXN0RGlhbG9nID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nTGVmdF0gPSAhYm9keUlzT3ZlcmZsb3dpbmcgJiYgbW9kYWxJc092ZXJmbG93aW5nID8gc2Nyb2xsYmFyV2lkdGggKyAncHgnIDogJyc7XG5cdCAgICAgICAgbW9kYWxbc3R5bGVdW3BhZGRpbmdSaWdodF0gPSBib2R5SXNPdmVyZmxvd2luZyAmJiAhbW9kYWxJc092ZXJmbG93aW5nID8gc2Nyb2xsYmFyV2lkdGggKyAncHgnIDogJyc7XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlc2V0QWRqdXN0bWVudHMgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgbW9kYWxbc3R5bGVdW3BhZGRpbmdMZWZ0XSA9ICcnO1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gJyc7XG5cdCAgICAgIH0sXG5cdCAgICAgIGNyZWF0ZU92ZXJsYXkgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgbmV3T3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHQgICAgICAgIG92ZXJsYXkgPSBxdWVyeUVsZW1lbnQoJy4nK21vZGFsQmFja2Ryb3BTdHJpbmcpO1xuXHQgIFxuXHQgICAgICAgIGlmICggb3ZlcmxheSA9PT0gbnVsbCApIHtcblx0ICAgICAgICAgIG5ld092ZXJsYXlbc2V0QXR0cmlidXRlXSgnY2xhc3MnLG1vZGFsQmFja2Ryb3BTdHJpbmcrJyBmYWRlJyk7XG5cdCAgICAgICAgICBvdmVybGF5ID0gbmV3T3ZlcmxheTtcblx0ICAgICAgICAgIGJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICByZW1vdmVPdmVybGF5ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgb3ZlcmxheSA9IHF1ZXJ5RWxlbWVudCgnLicrbW9kYWxCYWNrZHJvcFN0cmluZyk7IFxuXHQgICAgICAgIGlmICggb3ZlcmxheSAmJiBvdmVybGF5ICE9PSBudWxsICYmIHR5cGVvZiBvdmVybGF5ID09PSAnb2JqZWN0JyApIHtcblx0ICAgICAgICAgIGJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7IG92ZXJsYXkgPSBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAga2V5ZG93bkhhbmRsZXJUb2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoIWhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7XG5cdCAgICAgICAgICBvbihkb2N1bWVudCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgb2ZmKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgcmVzaXplSGFuZGxlclRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICghaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHtcblx0ICAgICAgICAgIG9uKGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIHNlbGYudXBkYXRlKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgb2ZmKGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIHNlbGYudXBkYXRlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGRpc21pc3NIYW5kbGVyVG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSkge1xuXHQgICAgICAgICAgb24obW9kYWwsIGNsaWNrRXZlbnQsIGRpc21pc3NIYW5kbGVyKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgb2ZmKG1vZGFsLCBjbGlja0V2ZW50LCBkaXNtaXNzSGFuZGxlcik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvLyBoYW5kbGVyc1xuXHQgICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIGNsaWNrVGFyZ2V0ID0gZVt0YXJnZXRdOyBcblx0ICAgICAgICBjbGlja1RhcmdldCA9IGNsaWNrVGFyZ2V0W2hhc0F0dHJpYnV0ZV0oZGF0YVRhcmdldCkgfHwgY2xpY2tUYXJnZXRbaGFzQXR0cmlidXRlXSgnaHJlZicpID8gY2xpY2tUYXJnZXQgOiBjbGlja1RhcmdldFtwYXJlbnROb2RlXTtcblx0ICAgICAgICBpZiAoICFvcGVuICYmIGNsaWNrVGFyZ2V0ID09PSBlbGVtZW50ICYmICFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSApIHtcblx0ICAgICAgICAgIG1vZGFsLm1vZGFsVHJpZ2dlciA9IGVsZW1lbnQ7XG5cdCAgICAgICAgICByZWxhdGVkVGFyZ2V0ID0gZWxlbWVudDtcblx0ICAgICAgICAgIHNlbGYuc2hvdygpO1xuXHQgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAga2V5SGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICB2YXIga2V5ID0gZS53aGljaCB8fCBlLmtleUNvZGU7IC8vIGtleUNvZGUgZm9yIElFOFxuXHQgICAgICAgIGlmIChzZWxmW2tleWJvYXJkXSAmJiBrZXkgPT0gMjcgJiYgb3Blbikge1xuXHQgICAgICAgICAgc2VsZi5oaWRlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBkaXNtaXNzSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICB2YXIgY2xpY2tUYXJnZXQgPSBlW3RhcmdldF07XG5cdCAgICAgICAgaWYgKCBvcGVuICYmIChjbGlja1RhcmdldFtwYXJlbnROb2RlXVtnZXRBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSA9PT0gY29tcG9uZW50IFxuXHQgICAgICAgICAgICB8fCBjbGlja1RhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSA9PT0gY29tcG9uZW50XG5cdCAgICAgICAgICAgIHx8IChjbGlja1RhcmdldCA9PT0gbW9kYWwgJiYgc2VsZltiYWNrZHJvcF0gIT09IHN0YXRpY1N0cmluZykgKSApIHtcblx0ICAgICAgICAgIHNlbGYuaGlkZSgpOyByZWxhdGVkVGFyZ2V0ID0gbnVsbDtcblx0ICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kc1xuXHQgICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKG9wZW4gJiYgaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHt0aGlzLmhpZGUoKTt9IGVsc2Uge3RoaXMuc2hvdygpO31cblx0ICAgIH07XG5cdCAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChtb2RhbCwgc2hvd0V2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgIFxuXHQgICAgICAvLyB3ZSBlbGVnYW50bHkgaGlkZSBhbnkgb3BlbmVkIG1vZGFsXG5cdCAgICAgIHZhciBjdXJyZW50T3BlbiA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZG9jdW1lbnQsY29tcG9uZW50KycgaW4nKVswXTtcblx0ICAgICAgY3VycmVudE9wZW4gJiYgY3VycmVudE9wZW4gIT09IG1vZGFsICYmIGN1cnJlbnRPcGVuLm1vZGFsVHJpZ2dlcltzdHJpbmdNb2RhbF0uaGlkZSgpOyBcblx0ICBcblx0ICAgICAgaWYgKCB0aGlzW2JhY2tkcm9wXSApIHtcblx0ICAgICAgICBjcmVhdGVPdmVybGF5KCk7XG5cdCAgICAgIH1cblx0ICBcblx0ICAgICAgaWYgKCBvdmVybGF5ICYmICFoYXNDbGFzcyhvdmVybGF5LGluQ2xhc3MpKSB7XG5cdCAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7IGFkZENsYXNzKG92ZXJsYXksaW5DbGFzcyk7IH0sIDApO1xuXHQgICAgICB9XG5cdCAgXG5cdCAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0ICBcblx0ICAgICAgICBjaGVja1Njcm9sbGJhcigpO1xuXHQgICAgICAgIHNldFNjcm9sbGJhcigpO1xuXHQgICAgICAgIGFkanVzdERpYWxvZygpO1xuXHQgIFxuXHQgICAgICAgIHJlc2l6ZUhhbmRsZXJUb2dnbGUoKTtcblx0ICAgICAgICBkaXNtaXNzSGFuZGxlclRvZ2dsZSgpO1xuXHQgICAgICAgIGtleWRvd25IYW5kbGVyVG9nZ2xlKCk7XG5cdCAgXG5cdCAgICAgICAgYWRkQ2xhc3MoYm9keSxjb21wb25lbnQrJy1vcGVuJyk7XG5cdCAgICAgICAgYWRkQ2xhc3MobW9kYWwsaW5DbGFzcyk7XG5cdCAgICAgICAgbW9kYWxbc2V0QXR0cmlidXRlXShhcmlhSGlkZGVuLCBmYWxzZSk7XG5cdCAgICAgIH0sIDApO1xuXHQgIFxuXHQgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChtb2RhbCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgb3BlbiA9IHNlbGYub3BlbiA9IHRydWU7XG5cdCAgICAgICAgc2V0Rm9jdXMobW9kYWwpO1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIHNob3duRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG5cdCAgICAgIH0pO1xuXHQgICAgfTtcblx0ICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgIG92ZXJsYXkgPSBxdWVyeUVsZW1lbnQoJy4nK21vZGFsQmFja2Ryb3BTdHJpbmcpO1xuXHQgIFxuXHQgICAgICBpZiAoIG92ZXJsYXkgIT09IG51bGwgKSB7XG5cdCAgICAgICAgcmVtb3ZlQ2xhc3Mob3ZlcmxheSxpbkNsYXNzKTtcblx0ICAgICAgfVxuXHQgICAgICByZW1vdmVDbGFzcyhtb2RhbCxpbkNsYXNzKTtcblx0ICAgICAgbW9kYWxbc2V0QXR0cmlidXRlXShhcmlhSGlkZGVuLCB0cnVlKTtcblx0ICBcblx0ICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQobW9kYWwsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKGJvZHksY29tcG9uZW50Kyctb3BlbicpO1xuXHQgICAgICAgIHJlc2l6ZUhhbmRsZXJUb2dnbGUoKTtcblx0ICAgICAgICBkaXNtaXNzSGFuZGxlclRvZ2dsZSgpO1xuXHQgICAgICAgIGtleWRvd25IYW5kbGVyVG9nZ2xlKCk7XG5cdCAgXG5cdCAgICAgICAgcmVzZXRBZGp1c3RtZW50cygpO1xuXHQgICAgICAgIHJlc2V0U2Nyb2xsYmFyKCk7XG5cdCAgICAgICAgbW9kYWxbc3R5bGVdLmRpc3BsYXkgPSAnJztcblx0ICBcblx0ICAgICAgICBpZiAoIWdldEVsZW1lbnRzQnlDbGFzc05hbWUoZG9jdW1lbnQsY29tcG9uZW50KycgJytpbkNsYXNzKVswXSkgeyByZW1vdmVPdmVybGF5KCk7IH1cblx0ICAgICAgICBvcGVuID0gc2VsZi5vcGVuID0gZmFsc2U7XG5cdCAgICAgICAgZWxlbWVudCAmJiAoc2V0Rm9jdXMoZWxlbWVudCkpO1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICB9KTtcblx0ICAgIH07XG5cdCAgICB0aGlzLnNldENvbnRlbnQgPSBmdW5jdGlvbiggY29udGVudCApIHtcblx0ICAgICAgcXVlcnlFbGVtZW50KCcuJytjb21wb25lbnQrJy1jb250ZW50Jyxtb2RhbCkuaW5uZXJIVE1MID0gY29udGVudDtcblx0ICAgIH07XG5cdCAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBpZiAob3Blbikge1xuXHQgICAgICAgIGNoZWNrU2Nyb2xsYmFyKCk7XG5cdCAgICAgICAgc2V0U2Nyb2xsYmFyKCk7XG5cdCAgICAgICAgYWRqdXN0RGlhbG9nKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyBvdmVyIGFuZCBvdmVyXG5cdCAgICAvLyBtb2RhbCBpcyBpbmRlcGVuZGVudCBvZiBhIHRyaWdnZXJpbmcgZWxlbWVudCBcblx0ICAgIGlmICggISFlbGVtZW50ICYmICEoc3RyaW5nTW9kYWwgaW4gZWxlbWVudCkgKSB7XG5cdCAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7XG5cdCAgICB9XG5cdCAgICBpZiAoICEhdGhpc1tjb250ZW50XSApIHsgdGhpcy5zZXRDb250ZW50KCB0aGlzW2NvbnRlbnRdICk7IH1cblx0ICAgICEhZWxlbWVudCAmJiAoZWxlbWVudFtzdHJpbmdNb2RhbF0gPSB0aGlzKTtcblx0ICB9O1xuXHQgIFxuXHQgIC8vIERBVEEgQVBJXG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nTW9kYWwsIE1vZGFsLCBkYXRhVG9nZ2xlKTtcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBQb3BvdmVyXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gUE9QT1ZFUiBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIFBvcG92ZXIgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBEQVRBIEFQSVxuXHQgICAgdmFyIHRyaWdnZXJEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUcmlnZ2VyKSwgLy8gY2xpY2sgLyBob3ZlciAvIGZvY3VzXG5cdCAgICAgICAgYW5pbWF0aW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQW5pbWF0aW9uKSwgLy8gdHJ1ZSAvIGZhbHNlXG5cdCAgICAgICAgcGxhY2VtZW50RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhUGxhY2VtZW50KSxcblx0ICAgICAgICBkaXNtaXNzaWJsZURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YURpc21pc3NpYmxlKSxcblx0ICAgICAgICBkZWxheURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YURlbGF5KSxcblx0ICAgICAgICBjb250YWluZXJEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250YWluZXIpLFxuXHQgIFxuXHQgICAgICAgIC8vIGludGVybmFsIHN0cmluZ3Ncblx0ICAgICAgICBjb21wb25lbnQgPSAncG9wb3ZlcicsXG5cdCAgICAgICAgdGVtcGxhdGUgPSAndGVtcGxhdGUnLFxuXHQgICAgICAgIHRyaWdnZXIgPSAndHJpZ2dlcicsXG5cdCAgICAgICAgY2xhc3NTdHJpbmcgPSAnY2xhc3MnLFxuXHQgICAgICAgIGRpdiA9ICdkaXYnLFxuXHQgICAgICAgIGZhZGUgPSAnZmFkZScsXG5cdCAgICAgICAgdGl0bGUgPSAndGl0bGUnLFxuXHQgICAgICAgIGNvbnRlbnQgPSAnY29udGVudCcsXG5cdCAgICAgICAgZGF0YVRpdGxlID0gJ2RhdGEtdGl0bGUnLFxuXHQgICAgICAgIGRhdGFDb250ZW50ID0gJ2RhdGEtY29udGVudCcsXG5cdCAgICAgICAgZGlzbWlzc2libGUgPSAnZGlzbWlzc2libGUnLFxuXHQgICAgICAgIGNsb3NlQnRuID0gJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIj7DlzwvYnV0dG9uPic7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICB0aGlzW3RlbXBsYXRlXSA9IG9wdGlvbnNbdGVtcGxhdGVdID8gb3B0aW9uc1t0ZW1wbGF0ZV0gOiBudWxsOyAvLyBKYXZhU2NyaXB0IG9ubHlcblx0ICAgIHRoaXNbdHJpZ2dlcl0gPSBvcHRpb25zW3RyaWdnZXJdID8gb3B0aW9uc1t0cmlnZ2VyXSA6IHRyaWdnZXJEYXRhIHx8IGhvdmVyRXZlbnQ7XG5cdCAgICB0aGlzW2FuaW1hdGlvbl0gPSBvcHRpb25zW2FuaW1hdGlvbl0gJiYgb3B0aW9uc1thbmltYXRpb25dICE9PSBmYWRlID8gb3B0aW9uc1thbmltYXRpb25dIDogYW5pbWF0aW9uRGF0YSB8fCBmYWRlO1xuXHQgICAgdGhpc1twbGFjZW1lbnRdID0gb3B0aW9uc1twbGFjZW1lbnRdID8gb3B0aW9uc1twbGFjZW1lbnRdIDogcGxhY2VtZW50RGF0YSB8fCB0b3A7XG5cdCAgICB0aGlzW2RlbGF5XSA9IHBhcnNlSW50KG9wdGlvbnNbZGVsYXldIHx8IGRlbGF5RGF0YSkgfHwgMjAwO1xuXHQgICAgdGhpc1tkaXNtaXNzaWJsZV0gPSBvcHRpb25zW2Rpc21pc3NpYmxlXSB8fCBkaXNtaXNzaWJsZURhdGEgPT09ICd0cnVlJyA/IHRydWUgOiBmYWxzZTtcblx0ICAgIHRoaXNbY29udGFpbmVyXSA9IHF1ZXJ5RWxlbWVudChvcHRpb25zW2NvbnRhaW5lcl0pIHx8IHF1ZXJ5RWxlbWVudChjb250YWluZXJEYXRhKSB8fCBib2R5O1xuXHQgICAgXG5cdCAgICAvLyBiaW5kLCBjb250ZW50XG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIFxuXHQgICAgICB0aXRsZVN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGl0bGUpIHx8IG51bGwsXG5cdCAgICAgIGNvbnRlbnRTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUNvbnRlbnQpIHx8IG51bGw7XG5cdCAgXG5cdCAgICBpZiAoICFjb250ZW50U3RyaW5nICYmICF0aGlzW3RlbXBsYXRlXSApIHJldHVybjsgLy8gaW52YWxpZGF0ZVxuXHQgIFxuXHQgICAgLy8gY29uc3RhbnRzLCB2YXJzXG5cdCAgICB2YXIgcG9wb3ZlciA9IG51bGwsIHRpbWVyID0gMCwgcGxhY2VtZW50U2V0dGluZyA9IHRoaXNbcGxhY2VtZW50XSxcblx0ICAgICAgXG5cdCAgICAgIC8vIGhhbmRsZXJzXG5cdCAgICAgIGRpc21pc3NpYmxlSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICBpZiAocG9wb3ZlciAhPT0gbnVsbCAmJiBlW3RhcmdldF0gPT09IHF1ZXJ5RWxlbWVudCgnLmNsb3NlJyxwb3BvdmVyKSkge1xuXHQgICAgICAgICAgc2VsZi5oaWRlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgIFxuXHQgICAgICAvLyBwcml2YXRlIG1ldGhvZHNcblx0ICAgICAgcmVtb3ZlUG9wb3ZlciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNlbGZbY29udGFpbmVyXS5yZW1vdmVDaGlsZChwb3BvdmVyKTtcblx0ICAgICAgICB0aW1lciA9IG51bGw7IHBvcG92ZXIgPSBudWxsOyBcblx0ICAgICAgfSxcblx0ICAgICAgY3JlYXRlUG9wb3ZlciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUaXRsZSk7IC8vIGNoZWNrIGNvbnRlbnQgYWdhaW5cblx0ICAgICAgICBjb250ZW50U3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250ZW50KTtcblx0ICBcblx0ICAgICAgICBwb3BvdmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuXHQgIFxuXHQgICAgICAgIGlmICggY29udGVudFN0cmluZyAhPT0gbnVsbCAmJiBzZWxmW3RlbXBsYXRlXSA9PT0gbnVsbCApIHsgLy9jcmVhdGUgdGhlIHBvcG92ZXIgZnJvbSBkYXRhIGF0dHJpYnV0ZXNcblx0ICBcblx0ICAgICAgICAgIHBvcG92ZXJbc2V0QXR0cmlidXRlXSgncm9sZScsJ3Rvb2x0aXAnKTtcblx0ICBcblx0ICAgICAgICAgIGlmICh0aXRsZVN0cmluZyAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICB2YXIgcG9wb3ZlclRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcblx0ICAgICAgICAgICAgcG9wb3ZlclRpdGxlW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsY29tcG9uZW50KyctdGl0bGUnKTtcblx0ICBcblx0ICAgICAgICAgICAgcG9wb3ZlclRpdGxlLmlubmVySFRNTCA9IHNlbGZbZGlzbWlzc2libGVdID8gdGl0bGVTdHJpbmcgKyBjbG9zZUJ0biA6IHRpdGxlU3RyaW5nO1xuXHQgICAgICAgICAgICBwb3BvdmVyLmFwcGVuZENoaWxkKHBvcG92ZXJUaXRsZSk7XG5cdCAgICAgICAgICB9XG5cdCAgXG5cdCAgICAgICAgICB2YXIgcG9wb3ZlckFycm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpLCBwb3BvdmVyQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcblx0ICAgICAgICAgIHBvcG92ZXJBcnJvd1tzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCdhcnJvdycpOyBwb3BvdmVyQ29udGVudFtzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLGNvbXBvbmVudCsnLWNvbnRlbnQnKTtcblx0ICAgICAgICAgIHBvcG92ZXIuYXBwZW5kQ2hpbGQocG9wb3ZlckFycm93KTsgcG9wb3Zlci5hcHBlbmRDaGlsZChwb3BvdmVyQ29udGVudCk7XG5cdCAgXG5cdCAgICAgICAgICAvL3NldCBwb3BvdmVyIGNvbnRlbnRcblx0ICAgICAgICAgIHBvcG92ZXJDb250ZW50LmlubmVySFRNTCA9IHNlbGZbZGlzbWlzc2libGVdICYmIHRpdGxlU3RyaW5nID09PSBudWxsID8gY29udGVudFN0cmluZyArIGNsb3NlQnRuIDogY29udGVudFN0cmluZztcblx0ICBcblx0ICAgICAgICB9IGVsc2UgeyAgLy8gb3IgY3JlYXRlIHRoZSBwb3BvdmVyIGZyb20gdGVtcGxhdGVcblx0ICAgICAgICAgIHZhciBwb3BvdmVyVGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG5cdCAgICAgICAgICBwb3BvdmVyVGVtcGxhdGUuaW5uZXJIVE1MID0gc2VsZlt0ZW1wbGF0ZV07XG5cdCAgICAgICAgICBwb3BvdmVyLmlubmVySFRNTCA9IHBvcG92ZXJUZW1wbGF0ZS5maXJzdENoaWxkLmlubmVySFRNTDtcblx0ICAgICAgICB9XG5cdCAgXG5cdCAgICAgICAgLy9hcHBlbmQgdG8gdGhlIGNvbnRhaW5lclxuXHQgICAgICAgIHNlbGZbY29udGFpbmVyXS5hcHBlbmRDaGlsZChwb3BvdmVyKTtcblx0ICAgICAgICBwb3BvdmVyW3N0eWxlXS5kaXNwbGF5ID0gJ2Jsb2NrJztcblx0ICAgICAgICBwb3BvdmVyW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsIGNvbXBvbmVudCsgJyAnICsgcGxhY2VtZW50U2V0dGluZyArICcgJyArIHNlbGZbYW5pbWF0aW9uXSk7XG5cdCAgICAgIH0sXG5cdCAgICAgIHNob3dQb3BvdmVyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICFoYXNDbGFzcyhwb3BvdmVyLGluQ2xhc3MpICYmICggYWRkQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSApO1xuXHQgICAgICB9LFxuXHQgICAgICB1cGRhdGVQb3BvdmVyID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgc3R5bGVUaXAoZWxlbWVudCxwb3BvdmVyLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTtcblx0ICAgICAgICBpZiAoIWlzRWxlbWVudEluVmlld3BvcnQocG9wb3ZlcikgKSB7IFxuXHQgICAgICAgICAgcGxhY2VtZW50U2V0dGluZyA9IHVwZGF0ZVBsYWNlbWVudChwbGFjZW1lbnRTZXR0aW5nKTsgXG5cdCAgICAgICAgICBzdHlsZVRpcChlbGVtZW50LHBvcG92ZXIscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pOyBcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kcyAvIGhhbmRsZXJzXG5cdCAgICB0aGlzLnRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBpZiAocG9wb3ZlciA9PT0gbnVsbCkgeyBzZWxmLnNob3coKTsgfSBcblx0ICAgICAgZWxzZSB7IHNlbGYuaGlkZSgpOyB9XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG5cdCAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKHBvcG92ZXIgPT09IG51bGwpIHtcblx0ICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSBzZWxmW3BsYWNlbWVudF07IC8vIHdlIHJlc2V0IHBsYWNlbWVudCBpbiBhbGwgY2FzZXNcblx0ICAgICAgICAgIGNyZWF0ZVBvcG92ZXIoKTtcblx0ICAgICAgICAgIHVwZGF0ZVBvcG92ZXIoKTtcblx0ICAgICAgICAgIHNob3dQb3BvdmVyKCk7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3dFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHBvcG92ZXIsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sIDIwICk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG5cdCAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKHBvcG92ZXIgJiYgcG9wb3ZlciAhPT0gbnVsbCAmJiBoYXNDbGFzcyhwb3BvdmVyLGluQ2xhc3MpKSB7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGVFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKHBvcG92ZXIsaW5DbGFzcyk7XG5cdCAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChwb3BvdmVyLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgcmVtb3ZlUG9wb3ZlcigpO1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBzZWxmW2RlbGF5XSApO1xuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdQb3BvdmVyIGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICBpZiAoc2VsZlt0cmlnZ2VyXSA9PT0gaG92ZXJFdmVudCkge1xuXHQgICAgICAgIG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzBdLCBzZWxmLnNob3cgKTtcblx0ICAgICAgICBpZiAoIXNlbGZbZGlzbWlzc2libGVdKSB7IG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzFdLCBzZWxmLmhpZGUgKTsgfVxuXHQgICAgICB9IGVsc2UgaWYgKC9eKGNsaWNrfGZvY3VzKSQvLnRlc3Qoc2VsZlt0cmlnZ2VyXSkpIHtcblx0ICAgICAgICBvbiggZWxlbWVudCwgc2VsZlt0cmlnZ2VyXSwgc2VsZi50b2dnbGUgKTtcblx0ICAgICAgICBpZiAoIXNlbGZbZGlzbWlzc2libGVdKSB7IG9uKCBlbGVtZW50LCAnYmx1cicsIHNlbGYuaGlkZSApOyB9XG5cdCAgICAgIH1cblx0ICAgICAgXG5cdCAgICAgIGlmIChzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZG9jdW1lbnQsIGNsaWNrRXZlbnQsIGRpc21pc3NpYmxlSGFuZGxlciApOyB9XG5cdCAgICBcblx0ICAgICAgLy8gZGlzbWlzcyBvbiB3aW5kb3cgcmVzaXplXG5cdCAgICAgIGlmICggIShpc0lFICYmIGlzSUUgPCA5KSApIHsgb24oIGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIHNlbGYuaGlkZSApOyB9XG5cdCAgXG5cdCAgICB9XG5cdCAgICBlbGVtZW50W3N0cmluZ1BvcG92ZXJdID0gc2VsZjtcblx0ICB9O1xuXHQgIFxuXHQgIC8vIFBPUE9WRVIgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09XG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nUG9wb3ZlciwgUG9wb3ZlciwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgU2Nyb2xsU3B5XG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIFNDUk9MTFNQWSBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT09PT09PT1cblx0ICB2YXIgU2Nyb2xsU3B5ID0gZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucykge1xuXHQgIFxuXHQgICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudCwgdGhlIGVsZW1lbnQgd2Ugc3B5IG9uXG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpOyBcblx0ICBcblx0ICAgIC8vIERBVEEgQVBJXG5cdCAgICB2YXIgdGFyZ2V0RGF0YSA9IHF1ZXJ5RWxlbWVudChlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCkpO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvbnNcblx0ICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgICAgaWYgKCAhb3B0aW9uc1t0YXJnZXRdICYmICF0YXJnZXREYXRhICkgeyByZXR1cm47IH0gLy8gaW52YWxpZGF0ZVxuXHQgIFxuXHQgICAgLy8gZXZlbnQgdGFyZ2V0cywgY29uc3RhbnRzXG5cdCAgICB2YXIgc3B5VGFyZ2V0ID0gb3B0aW9uc1t0YXJnZXRdICYmIHF1ZXJ5RWxlbWVudChvcHRpb25zW3RhcmdldF0pIHx8IHRhcmdldERhdGEsXG5cdCAgICAgICAgbGlua3MgPSBzcHlUYXJnZXQgJiYgc3B5VGFyZ2V0W2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnQScpLCBcblx0ICAgICAgICBpdGVtcyA9IFtdLCB0YXJnZXRJdGVtcyA9IFtdLCBzY3JvbGxPZmZzZXQsXG5cdCAgICAgICAgc2Nyb2xsVGFyZ2V0ID0gZWxlbWVudFtvZmZzZXRIZWlnaHRdIDwgZWxlbWVudFtzY3JvbGxIZWlnaHRdID8gZWxlbWVudCA6IGdsb2JhbE9iamVjdCwgLy8gZGV0ZXJtaW5lIHdoaWNoIGlzIHRoZSByZWFsIHNjcm9sbFRhcmdldFxuXHQgICAgICAgIGlzV2luZG93ID0gc2Nyb2xsVGFyZ2V0ID09PSBnbG9iYWxPYmplY3Q7ICBcblx0ICBcblx0ICAgIC8vIHBvcHVsYXRlIGl0ZW1zIGFuZCB0YXJnZXRzXG5cdCAgICBmb3IgKHZhciBpPTAsIGlsPWxpbmtzW2xlbmd0aF07IGk8aWw7IGkrKykge1xuXHQgICAgICB2YXIgaHJlZiA9IGxpbmtzW2ldW2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSwgXG5cdCAgICAgICAgICB0YXJnZXRJdGVtID0gaHJlZiAmJiAvI1thLXowLTldKyQvaS50ZXN0KGhyZWYpICYmIHF1ZXJ5RWxlbWVudChocmVmKTtcblx0ICAgICAgaWYgKCAhIXRhcmdldEl0ZW0gKSB7XG5cdCAgICAgICAgaXRlbXMucHVzaChsaW5rc1tpXSk7XG5cdCAgICAgICAgdGFyZ2V0SXRlbXMucHVzaCh0YXJnZXRJdGVtKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIFxuXHQgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICB2YXIgdXBkYXRlSXRlbSA9IGZ1bmN0aW9uKGluZGV4KSB7XG5cdCAgICAgICAgdmFyIHBhcmVudCA9IGl0ZW1zW2luZGV4XVtwYXJlbnROb2RlXSwgLy8gaXRlbSdzIHBhcmVudCBMSSBlbGVtZW50XG5cdCAgICAgICAgICB0YXJnZXRJdGVtID0gdGFyZ2V0SXRlbXNbaW5kZXhdLCAvLyB0aGUgbWVudSBpdGVtIHRhcmdldHMgdGhpcyBlbGVtZW50XG5cdCAgICAgICAgICBkcm9wZG93biA9IGdldENsb3Nlc3QocGFyZW50LCcuZHJvcGRvd24nKSxcblx0ICAgICAgICAgIHRhcmdldFJlY3QgPSBpc1dpbmRvdyAmJiB0YXJnZXRJdGVtW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKSxcblx0ICBcblx0ICAgICAgICAgIGlzQWN0aXZlID0gaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgfHwgZmFsc2UsXG5cdCAgXG5cdCAgICAgICAgICB0b3BFZGdlID0gaXNXaW5kb3cgPyB0YXJnZXRSZWN0W3RvcF0gKyBzY3JvbGxPZmZzZXQgOiB0YXJnZXRJdGVtW29mZnNldFRvcF0gLSAodGFyZ2V0SXRlbXNbaW5kZXgtMV0gPyAwIDogMTApLFxuXHQgICAgICAgICAgYm90dG9tRWRnZSA9IGlzV2luZG93ID8gdGFyZ2V0UmVjdFtib3R0b21dICsgc2Nyb2xsT2Zmc2V0IDogdGFyZ2V0SXRlbXNbaW5kZXgrMV0gPyB0YXJnZXRJdGVtc1tpbmRleCsxXVtvZmZzZXRUb3BdIDogZWxlbWVudFtzY3JvbGxIZWlnaHRdLFxuXHQgIFxuXHQgICAgICAgICAgaW5zaWRlID0gc2Nyb2xsT2Zmc2V0ID49IHRvcEVkZ2UgJiYgYm90dG9tRWRnZSA+IHNjcm9sbE9mZnNldDtcblx0ICBcblx0ICAgICAgICBpZiAoICFpc0FjdGl2ZSAmJiBpbnNpZGUgKSB7XG5cdCAgICAgICAgICBpZiAoIHBhcmVudC50YWdOYW1lID09PSAnTEknICYmICFoYXNDbGFzcyhwYXJlbnQsYWN0aXZlKSApIHtcblx0ICAgICAgICAgICAgYWRkQ2xhc3MocGFyZW50LGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIGlzQWN0aXZlID0gdHJ1ZTtcblx0ICAgICAgICAgICAgaWYgKGRyb3Bkb3duICYmICFoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpICkge1xuXHQgICAgICAgICAgICAgIGFkZENsYXNzKGRyb3Bkb3duLGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCAnYWN0aXZhdGUnLCAnc2Nyb2xsc3B5JywgaXRlbXNbaW5kZXhdKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9IGVsc2UgaWYgKCAhaW5zaWRlICkge1xuXHQgICAgICAgICAgaWYgKCBwYXJlbnQudGFnTmFtZSA9PT0gJ0xJJyAmJiBoYXNDbGFzcyhwYXJlbnQsYWN0aXZlKSApIHtcblx0ICAgICAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50LGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIGlzQWN0aXZlID0gZmFsc2U7XG5cdCAgICAgICAgICAgIGlmIChkcm9wZG93biAmJiBoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpICYmICFnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHBhcmVudFtwYXJlbnROb2RlXSxhY3RpdmUpLmxlbmd0aCApIHtcblx0ICAgICAgICAgICAgICByZW1vdmVDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIGlmICggIWluc2lkZSAmJiAhaXNBY3RpdmUgfHwgaXNBY3RpdmUgJiYgaW5zaWRlICkge1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgdXBkYXRlSXRlbXMgPSBmdW5jdGlvbigpe1xuXHQgICAgICAgIHNjcm9sbE9mZnNldCA9IGlzV2luZG93ID8gZ2V0U2Nyb2xsKCkueSA6IGVsZW1lbnRbc2Nyb2xsVG9wXTtcblx0ICAgICAgICBmb3IgKHZhciBpbmRleD0wLCBpdGw9aXRlbXNbbGVuZ3RoXTsgaW5kZXg8aXRsOyBpbmRleCsrKSB7XG5cdCAgICAgICAgICB1cGRhdGVJdGVtKGluZGV4KVxuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICBcblx0ICAgIC8vIHB1YmxpYyBtZXRob2Rcblx0ICAgIHRoaXMucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdXBkYXRlSXRlbXMoKTtcblx0ICAgIH1cblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdTY3JvbGxTcHkgaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIG9uKCBzY3JvbGxUYXJnZXQsIHNjcm9sbEV2ZW50LCB0aGlzLnJlZnJlc2ggKTtcblx0ICAgICAgaWYgKCAhKGlzSUUgJiYgaXNJRSA8IDkpKSB7IFxuXHQgICAgICAgIG9uKCBnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCB0aGlzLnJlZnJlc2ggKTsgXG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHRoaXMucmVmcmVzaCgpO1xuXHQgICAgZWxlbWVudFtzdHJpbmdTY3JvbGxTcHldID0gdGhpcztcblx0ICB9O1xuXHQgIFxuXHQgIC8vIFNDUk9MTFNQWSBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1Njcm9sbFNweSwgU2Nyb2xsU3B5LCBkYXRhU3B5KTtcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBUYWJcblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gVEFCIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PVxuXHQgIHZhciBUYWIgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBEQVRBIEFQSVxuXHQgICAgdmFyIGhlaWdodERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUhlaWdodCksXG5cdCAgICAgIFxuXHQgICAgICAgIC8vIHN0cmluZ3Ncblx0ICAgICAgICBjb21wb25lbnQgPSAndGFiJywgaGVpZ2h0ID0gJ2hlaWdodCcsIGlzQW5pbWF0aW5nID0gJ2lzQW5pbWF0aW5nJztcblx0ICBcblx0ICAgIC8vIHNldCBkZWZhdWx0IGFuaW1hdGlvbiBzdGF0ZVxuXHQgICAgZWxlbWVudFtpc0FuaW1hdGluZ10gPSBmYWxzZTtcblx0ICBcblx0ICAgIC8vIHNldCBvcHRpb25zXG5cdCAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0ICAgIHRoaXNbaGVpZ2h0XSA9IHN1cHBvcnRUcmFuc2l0aW9ucyA/IChvcHRpb25zW2hlaWdodF0gfHwgaGVpZ2h0RGF0YSA9PT0gJ3RydWUnKSA6IGZhbHNlOyAvLyBmaWx0ZXIgbGVnYWN5IGJyb3dzZXJzXG5cdCAgXG5cdCAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIG5leHQsXG5cdCAgICAgIHRhYnMgPSBnZXRDbG9zZXN0KGVsZW1lbnQsJy5uYXYnKSxcblx0ICAgICAgdGFic0NvbnRlbnRDb250YWluZXIsXG5cdCAgICAgIGRyb3Bkb3duID0gcXVlcnlFbGVtZW50KCcuZHJvcGRvd24nLHRhYnMpO1xuXHQgIFxuXHQgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICB2YXIgZ2V0QWN0aXZlVGFiID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGFjdGl2ZVRhYnMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRhYnMsYWN0aXZlKSwgYWN0aXZlVGFiO1xuXHQgICAgICAgIGlmICggYWN0aXZlVGFic1tsZW5ndGhdID09PSAxICYmICFoYXNDbGFzcyhhY3RpdmVUYWJzWzBdLCdkcm9wZG93bicpICkge1xuXHQgICAgICAgICAgYWN0aXZlVGFiID0gYWN0aXZlVGFic1swXTtcblx0ICAgICAgICB9IGVsc2UgaWYgKCBhY3RpdmVUYWJzW2xlbmd0aF0gPiAxICkge1xuXHQgICAgICAgICAgYWN0aXZlVGFiID0gYWN0aXZlVGFic1thY3RpdmVUYWJzW2xlbmd0aF0tMV07XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBhY3RpdmVUYWJbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKCdBJylbMF07XG5cdCAgICAgIH0sXG5cdCAgICAgIGdldEFjdGl2ZUNvbnRlbnQgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZXR1cm4gcXVlcnlFbGVtZW50KGdldEFjdGl2ZVRhYigpW2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSk7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8vIGhhbmRsZXIgXG5cdCAgICAgIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgbmV4dCA9IGVbdGFyZ2V0XTtcblx0ICAgICAgICBzZWxmLnNob3coKTtcblx0ICAgICAgfTtcblx0ICBcblx0ICAgIC8vIHB1YmxpYyBtZXRob2Rcblx0ICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgeyAvLyB0aGUgdGFiIHdlIGNsaWNrZWQgaXMgbm93IHRoZSBuZXh0IHRhYlxuXHQgICAgICB2YXIgbmV4dENvbnRlbnQgPSBxdWVyeUVsZW1lbnQobmV4dFtnZXRBdHRyaWJ1dGVdKCdocmVmJykpLCAvL3RoaXMgaXMgdGhlIGFjdHVhbCBvYmplY3QsIHRoZSBuZXh0IHRhYiBjb250ZW50IHRvIGFjdGl2YXRlXG5cdCAgICAgICAgYWN0aXZlVGFiID0gZ2V0QWN0aXZlVGFiKCksIGFjdGl2ZUNvbnRlbnQgPSBnZXRBY3RpdmVDb250ZW50KCk7XG5cdCAgICAgIFxuXHQgICAgICBpZiAoICghYWN0aXZlVGFiW2lzQW5pbWF0aW5nXSB8fCAhbmV4dFtpc0FuaW1hdGluZ10pICYmICFoYXNDbGFzcyhuZXh0W3BhcmVudE5vZGVdLGFjdGl2ZSkgKSB7XG5cdCAgICAgICAgYWN0aXZlVGFiW2lzQW5pbWF0aW5nXSA9IG5leHRbaXNBbmltYXRpbmddID0gdHJ1ZTtcblx0ICAgICAgICByZW1vdmVDbGFzcyhhY3RpdmVUYWJbcGFyZW50Tm9kZV0sYWN0aXZlKTtcblx0ICAgICAgICBhZGRDbGFzcyhuZXh0W3BhcmVudE5vZGVdLGFjdGl2ZSk7XG5cdCAgXG5cdCAgICAgICAgaWYgKCBkcm9wZG93biApIHtcblx0ICAgICAgICAgIGlmICggIWhhc0NsYXNzKGVsZW1lbnRbcGFyZW50Tm9kZV1bcGFyZW50Tm9kZV0sJ2Ryb3Bkb3duLW1lbnUnKSApIHtcblx0ICAgICAgICAgICAgaWYgKGhhc0NsYXNzKGRyb3Bkb3duLGFjdGl2ZSkpIHJlbW92ZUNsYXNzKGRyb3Bkb3duLGFjdGl2ZSk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBpZiAoIWhhc0NsYXNzKGRyb3Bkb3duLGFjdGl2ZSkpIGFkZENsYXNzKGRyb3Bkb3duLGFjdGl2ZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIFxuXHQgICAgICAgIGlmICh0YWJzQ29udGVudENvbnRhaW5lcikgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQoYWN0aXZlQ29udGVudCkgKyAncHgnOyAvLyBoZWlnaHQgYW5pbWF0aW9uXG5cdCAgXG5cdCAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhY3RpdmVUYWIsIGhpZGVFdmVudCwgY29tcG9uZW50LCBuZXh0KTtcblx0ICBcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlQ29udGVudCxpbkNsYXNzKTtcblx0ICAgICAgICB9LCAwKTtcblx0ICBcblx0ICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChhY3RpdmVDb250ZW50LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGlmICh0YWJzQ29udGVudENvbnRhaW5lcikgYWRkQ2xhc3ModGFic0NvbnRlbnRDb250YWluZXIsY29sbGFwc2luZyk7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhhY3RpdmVDb250ZW50LGFjdGl2ZSk7XG5cdCAgICAgICAgICBhZGRDbGFzcyhuZXh0Q29udGVudCxhY3RpdmUpO1xuXHQgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgYWRkQ2xhc3MobmV4dENvbnRlbnQsaW5DbGFzcyk7XG5cdCAgICAgICAgICAgIGlmKHRhYnNDb250ZW50Q29udGFpbmVyKSB0YWJzQ29udGVudENvbnRhaW5lcltzdHlsZV1baGVpZ2h0XSA9IGdldE1heEhlaWdodChuZXh0Q29udGVudCkgKyAncHgnOyAvLyBoZWlnaHQgYW5pbWF0aW9uXG5cdCAgICAgICAgICB9LCAwKTtcblx0ICBcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobmV4dCwgc2hvd0V2ZW50LCBjb21wb25lbnQsIGFjdGl2ZVRhYik7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFjdGl2ZVRhYiwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCwgbmV4dCk7XG5cdCAgXG5cdCAgICAgICAgfSk7XG5cdCAgXG5cdCAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQobmV4dENvbnRlbnQsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChuZXh0LCBzaG93bkV2ZW50LCBjb21wb25lbnQsIGFjdGl2ZVRhYik7XG5cdCAgICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIHsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuXHQgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQodGFic0NvbnRlbnRDb250YWluZXIsIGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgICAgICAgICB0YWJzQ29udGVudENvbnRhaW5lcltzdHlsZV1baGVpZ2h0XSA9ICAnJztcblx0ICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKHRhYnNDb250ZW50Q29udGFpbmVyLGNvbGxhcHNpbmcpO1xuXHQgICAgICAgICAgICAgICAgYWN0aXZlVGFiW2lzQW5pbWF0aW5nXSA9IG5leHRbaXNBbmltYXRpbmddID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgfSlcblx0ICAgICAgICAgICAgfSwwKTtcblx0ICAgICAgICAgIH0gZWxzZSB7IGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IGZhbHNlOyB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nVGFiIGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuXHQgICAgfVxuXHQgICAgaWYgKHRoaXNbaGVpZ2h0XSkgeyB0YWJzQ29udGVudENvbnRhaW5lciA9IGdldEFjdGl2ZUNvbnRlbnQoKVtwYXJlbnROb2RlXTsgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdUYWJdID0gdGhpcztcblx0ICB9O1xuXHQgIFxuXHQgIC8vIFRBQiBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1RhYiwgVGFiLCBkYXRhVG9nZ2xlKTtcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBUb29sdGlwXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBUT09MVElQIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PT09PT1cblx0ICB2YXIgVG9vbHRpcCA9IGZ1bmN0aW9uKCBlbGVtZW50LG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gREFUQSBBUElcblx0ICAgIHZhciBhbmltYXRpb25EYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFBbmltYXRpb24pO1xuXHQgICAgICAgIHBsYWNlbWVudERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBsYWNlbWVudCk7XG5cdCAgICAgICAgZGVsYXlEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEZWxheSksXG5cdCAgICAgICAgY29udGFpbmVyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGFpbmVyKSxcblx0ICAgICAgICBcblx0ICAgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ3Rvb2x0aXAnLFxuXHQgICAgICAgIGNsYXNzU3RyaW5nID0gJ2NsYXNzJyxcblx0ICAgICAgICB0aXRsZSA9ICd0aXRsZScsXG5cdCAgICAgICAgZmFkZSA9ICdmYWRlJyxcblx0ICAgICAgICBkaXYgPSAnZGl2Jztcblx0ICBcblx0ICAgIC8vIHNldCBvcHRpb25zXG5cdCAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0ICAgIHRoaXNbYW5pbWF0aW9uXSA9IG9wdGlvbnNbYW5pbWF0aW9uXSAmJiBvcHRpb25zW2FuaW1hdGlvbl0gIT09IGZhZGUgPyBvcHRpb25zW2FuaW1hdGlvbl0gOiBhbmltYXRpb25EYXRhIHx8IGZhZGU7XG5cdCAgICB0aGlzW3BsYWNlbWVudF0gPSBvcHRpb25zW3BsYWNlbWVudF0gPyBvcHRpb25zW3BsYWNlbWVudF0gOiBwbGFjZW1lbnREYXRhIHx8IHRvcDtcblx0ICAgIHRoaXNbZGVsYXldID0gcGFyc2VJbnQob3B0aW9uc1tkZWxheV0gfHwgZGVsYXlEYXRhKSB8fCAyMDA7XG5cdCAgICB0aGlzW2NvbnRhaW5lcl0gPSBxdWVyeUVsZW1lbnQob3B0aW9uc1tjb250YWluZXJdKSB8fCBxdWVyeUVsZW1lbnQoY29udGFpbmVyRGF0YSkgfHwgYm9keTtcblx0ICBcblx0ICAgIC8vIGJpbmQsIGV2ZW50IHRhcmdldHMsIHRpdGxlIGFuZCBjb25zdGFudHNcblx0ICAgIHZhciBzZWxmID0gdGhpcywgdGltZXIgPSAwLCBwbGFjZW1lbnRTZXR0aW5nID0gdGhpc1twbGFjZW1lbnRdLCB0b29sdGlwID0gbnVsbCxcblx0ICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0odGl0bGUpIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUaXRsZSk7XG5cdCAgXG5cdCAgICBpZiAoICF0aXRsZVN0cmluZyApIHJldHVybjsgLy8gaW52YWxpZGF0ZVxuXHQgIFxuXHQgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICB2YXIgcmVtb3ZlVG9vbFRpcCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHNlbGZbY29udGFpbmVyXS5yZW1vdmVDaGlsZCh0b29sdGlwKTtcblx0ICAgICAgICB0b29sdGlwID0gbnVsbDsgdGltZXIgPSBudWxsO1xuXHQgICAgICB9LFxuXHQgICAgICBjcmVhdGVUb29sVGlwID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0odGl0bGUpIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUaXRsZSk7IC8vIHJlYWQgdGhlIHRpdGxlIGFnYWluXG5cdCAgICAgICAgdG9vbHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcblx0ICAgICAgICB0b29sdGlwW3NldEF0dHJpYnV0ZV0oJ3JvbGUnLGNvbXBvbmVudCk7XG5cdCAgXG5cdCAgICAgICAgdmFyIHRvb2x0aXBBcnJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KSwgdG9vbHRpcElubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuXHQgICAgICAgIHRvb2x0aXBBcnJvd1tzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCBjb21wb25lbnQrJy1hcnJvdycpOyB0b29sdGlwSW5uZXJbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZyxjb21wb25lbnQrJy1pbm5lcicpO1xuXHQgIFxuXHQgICAgICAgIHRvb2x0aXAuYXBwZW5kQ2hpbGQodG9vbHRpcEFycm93KTsgdG9vbHRpcC5hcHBlbmRDaGlsZCh0b29sdGlwSW5uZXIpO1xuXHQgIFxuXHQgICAgICAgIHRvb2x0aXBJbm5lci5pbm5lckhUTUwgPSB0aXRsZVN0cmluZztcblx0ICBcblx0ICAgICAgICBzZWxmW2NvbnRhaW5lcl0uYXBwZW5kQ2hpbGQodG9vbHRpcCk7XG5cdCAgICAgICAgdG9vbHRpcFtzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCBjb21wb25lbnQgKyAnICcgKyBwbGFjZW1lbnRTZXR0aW5nICsgJyAnICsgc2VsZlthbmltYXRpb25dKTtcblx0ICAgICAgfSxcblx0ICAgICAgdXBkYXRlVG9vbHRpcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBzdHlsZVRpcChlbGVtZW50LHRvb2x0aXAscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pO1xuXHQgICAgICAgIGlmICghaXNFbGVtZW50SW5WaWV3cG9ydCh0b29sdGlwKSApIHsgXG5cdCAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gdXBkYXRlUGxhY2VtZW50KHBsYWNlbWVudFNldHRpbmcpOyBcblx0ICAgICAgICAgIHN0eWxlVGlwKGVsZW1lbnQsdG9vbHRpcCxwbGFjZW1lbnRTZXR0aW5nLHNlbGZbY29udGFpbmVyXSk7IFxuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgc2hvd1Rvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgIWhhc0NsYXNzKHRvb2x0aXAsaW5DbGFzcykgJiYgKCBhZGRDbGFzcyh0b29sdGlwLGluQ2xhc3MpICk7XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kc1xuXHQgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG5cdCAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKHRvb2x0aXAgPT09IG51bGwpIHtcblx0ICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSBzZWxmW3BsYWNlbWVudF07IC8vIHdlIHJlc2V0IHBsYWNlbWVudCBpbiBhbGwgY2FzZXNcblx0ICAgICAgICAgIGNyZWF0ZVRvb2xUaXAoKTtcblx0ICAgICAgICAgIHVwZGF0ZVRvb2x0aXAoKTtcblx0ICAgICAgICAgIHNob3dUb29sdGlwKCk7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3dFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHRvb2x0aXAsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sIDIwICk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG5cdCAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKHRvb2x0aXAgJiYgdG9vbHRpcCAhPT0gbnVsbCAmJiBoYXNDbGFzcyh0b29sdGlwLGluQ2xhc3MpKSB7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGVFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKHRvb2x0aXAsaW5DbGFzcyk7XG5cdCAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZCh0b29sdGlwLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgcmVtb3ZlVG9vbFRpcCgpO1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBzZWxmW2RlbGF5XSk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKCF0b29sdGlwKSB7IHNlbGYuc2hvdygpOyB9IFxuXHQgICAgICBlbHNlIHsgc2VsZi5oaWRlKCk7IH1cblx0ICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nVG9vbHRpcCBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgZWxlbWVudFtzZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRpdGxlLHRpdGxlU3RyaW5nKTtcblx0ICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUodGl0bGUpO1xuXHQgICAgICBvbihlbGVtZW50LCBtb3VzZUhvdmVyWzBdLCB0aGlzLnNob3cpO1xuXHQgICAgICBvbihlbGVtZW50LCBtb3VzZUhvdmVyWzFdLCB0aGlzLmhpZGUpO1xuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdUb29sdGlwXSA9IHRoaXM7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBUT09MVElQIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdUb29sdGlwLCBUb29sdGlwLCBkYXRhVG9nZ2xlKTtcblx0ICBcblx0ICBcblx0ICByZXR1cm4ge1xuXHQgICAgQWZmaXg6IEFmZml4LFxuXHQgICAgQWxlcnQ6IEFsZXJ0LFxuXHQgICAgQnV0dG9uOiBCdXR0b24sXG5cdCAgICBDYXJvdXNlbDogQ2Fyb3VzZWwsXG5cdCAgICBDb2xsYXBzZTogQ29sbGFwc2UsXG5cdCAgICBEcm9wZG93bjogRHJvcGRvd24sXG5cdCAgICBNb2RhbDogTW9kYWwsXG5cdCAgICBQb3BvdmVyOiBQb3BvdmVyLFxuXHQgICAgU2Nyb2xsU3B5OiBTY3JvbGxTcHksXG5cdCAgICBUYWI6IFRhYixcblx0ICAgIFRvb2x0aXA6IFRvb2x0aXBcblx0ICB9O1xuXHR9KSk7XG5cdFxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpXG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBteS1jb20uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA4MjdkZGZiOTgwNTMxNmNhY2E5OCIsIi8qXG5mdW5jdGlvbiBjaGVja1ZhbHVlcyAoZWxtTmFtZSkge1xuICAgIGFsZXJ0KGVsbU5hbWUpO1xufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjc2VhcmNoUGVyc29uIGlucHV0JykuZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgY3VyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgY2hlY2tWYWx1ZXMoJyNzZWFyY2hQZXJzb24nKSk7XG59KTsqL1xuaW1wb3J0IGJzbiBmcm9tICdib290c3RyYXAubmF0aXZlJztcblxuaWYoZG9jdW1lbnQuYm9keS5pZCA9PSAnZmluZFBlcnNvbkJvZHknKSB7XG4gICAgbGV0IGJsblJlbW92ZVN1bWJpdCA9IHRydWU7XG4gICAgY29uc3QgZWxtSW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3NlYXJjaFBlcnNvbiBpbnB1dCcpO1xuICAgIGNvbnN0IGJ0blN1bWJpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZmluZFBlcnNvblwiKTtcbiAgICBjb25zdCBidG5GaW5kUGVyc29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlYXJjaFBob25lJyk7XG5cbiAgICBlbG1JbnB1dHMuZm9yRWFjaCgoY3VyMikgPT4ge1xuICAgICAgICBpZigoY3VyMi52YWx1ZS50cmltKCkubGVuZ3RoID09IDApICYmICgoY3VyMi5uYW1lID09ICdsYXN0LW5hbWUnKSB8fCAoY3VyMi5uYW1lID09ICdmaXJzdC1uYW1lJykpKSB7XG4gICAgICAgICAgICBibG5SZW1vdmVTdW1iaXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgYmxuUmVtb3ZlU3VtYml0ID09PSBmYWxzZSA/IGJ0blN1bWJpdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywnZGlzYWJsZWQnKSA6IG51bGw7XG5cbiAgICBlbG1JbnB1dHMuZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgICAgIGN1ci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBibG5TdW1iaXQgPSB0cnVlO1xuICAgICAgICAgICAgbGV0IGludFJpZ2h0ID0gMDtcblxuICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goKGN1clBsYWNlZCkgPT4ge1xuICAgICAgICAgICAgICAgIChjdXJQbGFjZWQudmFsdWUudHJpbSgpLmxlbmd0aCAhPSAwKSAmJiAoKGN1clBsYWNlZC5uYW1lID09ICdsYXN0LW5hbWUnKSB8fCAoY3VyUGxhY2VkLm5hbWUgPT0gJ0RPQicpIHx8IChjdXJQbGFjZWQubmFtZSA9PSAnZmlyc3QtbmFtZScpKSA/IGludFJpZ2h0KysgOiBudWxsO1xuXG4gICAgICAgICAgICAgICAgaWYoaW50UmlnaHQgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgYmxuU3VtYml0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnRuRmluZFBlcnNvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goKGVsZW1lbnQsIGluZGV4LCBhcnJheSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRleCA8PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ215RXJyb3InKTtcbiAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBibG5TdW1iaXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goKGVsZW1lbnQsIGluZGV4LCBhcnJheSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPD0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbXlFcnJvcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnRuRmluZFBlcnNvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYmxuU3VtYml0ID09PSB0cnVlID8gYnRuU3VtYml0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKSA6IGJ0blN1bWJpdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywnZGlzYWJsZWQnKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBidG5GaW5kUGVyc29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhY3Rpb24nKS52YWx1ZSA9IFwic2VhcmNoQnlQaG9uZVwiO1xuICAgIH0pO1xuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2J0bkNsZWFyJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goKGN1cikgPT4ge1xuICAgICAgICAgICAgY3VyLnZhbHVlID0gJyc7XG4gICAgICAgIH0pO1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vanMvbGF5b3V0LmpzIiwiLy8gTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHYyLjAuNCB8IMKpIGRucF90aGVtZSB8IE1JVC1MaWNlbnNlXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEFNRCBzdXBwb3J0OlxuICAgIGRlZmluZShbXSwgZmFjdG9yeSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgICAvLyBDb21tb25KUy1saWtlOlxuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2Uge1xuICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpXG4gICAgdmFyIGJzbiA9IGZhY3RvcnkoKTtcbiAgICByb290LkFmZml4ID0gYnNuLkFmZml4O1xuICAgIHJvb3QuQWxlcnQgPSBic24uQWxlcnQ7XG4gICAgcm9vdC5CdXR0b24gPSBic24uQnV0dG9uO1xuICAgIHJvb3QuQ2Fyb3VzZWwgPSBic24uQ2Fyb3VzZWw7XG4gICAgcm9vdC5Db2xsYXBzZSA9IGJzbi5Db2xsYXBzZTtcbiAgICByb290LkRyb3Bkb3duID0gYnNuLkRyb3Bkb3duO1xuICAgIHJvb3QuTW9kYWwgPSBic24uTW9kYWw7XG4gICAgcm9vdC5Qb3BvdmVyID0gYnNuLlBvcG92ZXI7XG4gICAgcm9vdC5TY3JvbGxTcHkgPSBic24uU2Nyb2xsU3B5O1xuICAgIHJvb3QuVGFiID0gYnNuLlRhYjtcbiAgICByb290LlRvb2x0aXAgPSBic24uVG9vbHRpcDtcbiAgfVxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBJbnRlcm5hbCBVdGlsaXR5IEZ1bmN0aW9uc1xuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIGdsb2JhbHNcbiAgdmFyIGdsb2JhbE9iamVjdCA9IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdGhpc3x8d2luZG93LFxuICAgIGRvYyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgYm9keSA9IGRvY3VtZW50LmJvZHksXG4gIFxuICAgIC8vIElFIGJyb3dzZXIgZGV0ZWN0XG4gICAgaXNJRSA9IChuZXcgUmVnRXhwKFwiTVNJRSAoWzAtOV17MSx9W1xcLjAtOV17MCx9KVwiKS5leGVjKG5hdmlnYXRvci51c2VyQWdlbnQpICE9IG51bGwpID8gcGFyc2VGbG9hdCggUmVnRXhwLiQxICkgOiBmYWxzZSwgIFxuICBcbiAgICAvLyBmdW5jdGlvbiB0b2dnbGUgYXR0cmlidXRlc1xuICAgIGRhdGFUb2dnbGUgICAgPSAnZGF0YS10b2dnbGUnLFxuICAgIGRhdGFEaXNtaXNzICAgPSAnZGF0YS1kaXNtaXNzJyxcbiAgICBkYXRhU3B5ICAgICAgID0gJ2RhdGEtc3B5JyxcbiAgICBkYXRhUmlkZSAgICAgID0gJ2RhdGEtcmlkZScsXG4gICAgXG4gICAgLy8gY29tcG9uZW50c1xuICAgIHN0cmluZ0FmZml4ICAgICA9ICdBZmZpeCcsXG4gICAgc3RyaW5nQWxlcnQgICAgID0gJ0FsZXJ0JyxcbiAgICBzdHJpbmdCdXR0b24gICAgPSAnQnV0dG9uJyxcbiAgICBzdHJpbmdDYXJvdXNlbCAgPSAnQ2Fyb3VzZWwnLFxuICAgIHN0cmluZ0NvbGxhcHNlICA9ICdDb2xsYXBzZScsXG4gICAgc3RyaW5nRHJvcGRvd24gID0gJ0Ryb3Bkb3duJyxcbiAgICBzdHJpbmdNb2RhbCAgICAgPSAnTW9kYWwnLFxuICAgIHN0cmluZ1BvcG92ZXIgICA9ICdQb3BvdmVyJyxcbiAgICBzdHJpbmdTY3JvbGxTcHkgPSAnU2Nyb2xsU3B5JyxcbiAgICBzdHJpbmdUYWIgICAgICAgPSAnVGFiJyxcbiAgICBzdHJpbmdUb29sdGlwICAgPSAnVG9vbHRpcCcsXG4gIFxuICAgIC8vIG9wdGlvbnMgREFUQSBBUElcbiAgICBkYXRhYmFja2Ryb3AgICAgICA9ICdkYXRhLWJhY2tkcm9wJyxcbiAgICBkYXRhS2V5Ym9hcmQgICAgICA9ICdkYXRhLWtleWJvYXJkJyxcbiAgICBkYXRhVGFyZ2V0ICAgICAgICA9ICdkYXRhLXRhcmdldCcsXG4gICAgZGF0YUludGVydmFsICAgICAgPSAnZGF0YS1pbnRlcnZhbCcsXG4gICAgZGF0YUhlaWdodCAgICAgICAgPSAnZGF0YS1oZWlnaHQnLFxuICAgIGRhdGFQYXVzZSAgICAgICAgID0gJ2RhdGEtcGF1c2UnLFxuICAgIGRhdGFPcmlnaW5hbFRpdGxlID0gJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLFxuICAgIGRhdGFPcmlnaW5hbFRleHQgID0gJ2RhdGEtb3JpZ2luYWwtdGV4dCcsXG4gICAgZGF0YURpc21pc3NpYmxlICAgPSAnZGF0YS1kaXNtaXNzaWJsZScsXG4gICAgZGF0YVRyaWdnZXIgICAgICAgPSAnZGF0YS10cmlnZ2VyJyxcbiAgICBkYXRhQW5pbWF0aW9uICAgICA9ICdkYXRhLWFuaW1hdGlvbicsXG4gICAgZGF0YUNvbnRhaW5lciAgICAgPSAnZGF0YS1jb250YWluZXInLFxuICAgIGRhdGFQbGFjZW1lbnQgICAgID0gJ2RhdGEtcGxhY2VtZW50JyxcbiAgICBkYXRhRGVsYXkgICAgICAgICA9ICdkYXRhLWRlbGF5JyxcbiAgICBkYXRhT2Zmc2V0VG9wICAgICA9ICdkYXRhLW9mZnNldC10b3AnLFxuICAgIGRhdGFPZmZzZXRCb3R0b20gID0gJ2RhdGEtb2Zmc2V0LWJvdHRvbScsXG4gIFxuICAgIC8vIG9wdGlvbiBrZXlzXG4gICAgYmFja2Ryb3AgPSAnYmFja2Ryb3AnLCBrZXlib2FyZCA9ICdrZXlib2FyZCcsIGRlbGF5ID0gJ2RlbGF5JyxcbiAgICBkdXJhdGlvbiA9ICdkdXJhdGlvbicsIGNvbnRlbnQgPSAnY29udGVudCcsIHRhcmdldCA9ICd0YXJnZXQnLCBcbiAgICBpbnRlcnZhbCA9ICdpbnRlcnZhbCcsIHBhdXNlID0gJ3BhdXNlJywgYW5pbWF0aW9uID0gJ2FuaW1hdGlvbicsXG4gICAgcGxhY2VtZW50ID0gJ3BsYWNlbWVudCcsIGNvbnRhaW5lciA9ICdjb250YWluZXInLCBcbiAgXG4gICAgLy8gYm94IG1vZGVsXG4gICAgb2Zmc2V0VG9wICAgID0gJ29mZnNldFRvcCcsICAgICAgb2Zmc2V0Qm90dG9tICAgPSAnb2Zmc2V0Qm90dG9tJyxcbiAgICBvZmZzZXRMZWZ0ICAgPSAnb2Zmc2V0TGVmdCcsXG4gICAgc2Nyb2xsVG9wICAgID0gJ3Njcm9sbFRvcCcsICAgICAgc2Nyb2xsTGVmdCAgICAgPSAnc2Nyb2xsTGVmdCcsXG4gICAgY2xpZW50V2lkdGggID0gJ2NsaWVudFdpZHRoJywgICAgY2xpZW50SGVpZ2h0ICAgPSAnY2xpZW50SGVpZ2h0JyxcbiAgICBvZmZzZXRXaWR0aCAgPSAnb2Zmc2V0V2lkdGgnLCAgICBvZmZzZXRIZWlnaHQgICA9ICdvZmZzZXRIZWlnaHQnLFxuICAgIGlubmVyV2lkdGggICA9ICdpbm5lcldpZHRoJywgICAgIGlubmVySGVpZ2h0ICAgID0gJ2lubmVySGVpZ2h0JyxcbiAgICBzY3JvbGxIZWlnaHQgPSAnc2Nyb2xsSGVpZ2h0JywgICBoZWlnaHQgICAgICAgICA9ICdoZWlnaHQnLFxuICBcbiAgICAvLyBhcmlhXG4gICAgYXJpYUV4cGFuZGVkID0gJ2FyaWEtZXhwYW5kZWQnLFxuICAgIGFyaWFIaWRkZW4gICA9ICdhcmlhLWhpZGRlbicsXG4gIFxuICAgIC8vIGV2ZW50IG5hbWVzXG4gICAgY2xpY2tFdmVudCAgICA9ICdjbGljaycsXG4gICAgaG92ZXJFdmVudCAgICA9ICdob3ZlcicsXG4gICAga2V5ZG93bkV2ZW50ICA9ICdrZXlkb3duJyxcbiAgICByZXNpemVFdmVudCAgID0gJ3Jlc2l6ZScsXG4gICAgc2Nyb2xsRXZlbnQgICA9ICdzY3JvbGwnLFxuICAgIC8vIG9yaWdpbmFsRXZlbnRzXG4gICAgc2hvd0V2ZW50ICAgICA9ICdzaG93JyxcbiAgICBzaG93bkV2ZW50ICAgID0gJ3Nob3duJyxcbiAgICBoaWRlRXZlbnQgICAgID0gJ2hpZGUnLFxuICAgIGhpZGRlbkV2ZW50ICAgPSAnaGlkZGVuJyxcbiAgICBjbG9zZUV2ZW50ICAgID0gJ2Nsb3NlJyxcbiAgICBjbG9zZWRFdmVudCAgID0gJ2Nsb3NlZCcsXG4gICAgc2xpZEV2ZW50ICAgICA9ICdzbGlkJyxcbiAgICBzbGlkZUV2ZW50ICAgID0gJ3NsaWRlJyxcbiAgICBjaGFuZ2VFdmVudCAgID0gJ2NoYW5nZScsXG4gIFxuICAgIC8vIG90aGVyXG4gICAgZ2V0QXR0cmlidXRlICAgICAgICAgPSAnZ2V0QXR0cmlidXRlJyxcbiAgICBzZXRBdHRyaWJ1dGUgICAgICAgICA9ICdzZXRBdHRyaWJ1dGUnLFxuICAgIGhhc0F0dHJpYnV0ZSAgICAgICAgID0gJ2hhc0F0dHJpYnV0ZScsXG4gICAgZ2V0RWxlbWVudHNCeVRhZ05hbWUgPSAnZ2V0RWxlbWVudHNCeVRhZ05hbWUnLFxuICAgIGdldEJvdW5kaW5nQ2xpZW50UmVjdD0gJ2dldEJvdW5kaW5nQ2xpZW50UmVjdCcsXG4gICAgcXVlcnlTZWxlY3RvckFsbCAgICAgPSAncXVlcnlTZWxlY3RvckFsbCcsXG4gICAgZ2V0RWxlbWVudHNCeUNMQVNTTkFNRSA9ICdnZXRFbGVtZW50c0J5Q2xhc3NOYW1lJyxcbiAgXG4gICAgaW5kZXhPZiAgICAgID0gJ2luZGV4T2YnLFxuICAgIHBhcmVudE5vZGUgICA9ICdwYXJlbnROb2RlJyxcbiAgICBsZW5ndGggICAgICAgPSAnbGVuZ3RoJyxcbiAgICB0b0xvd2VyQ2FzZSAgPSAndG9Mb3dlckNhc2UnLFxuICAgIFRyYW5zaXRpb24gICA9ICdUcmFuc2l0aW9uJyxcbiAgICBXZWJraXQgICAgICAgPSAnV2Via2l0JyxcbiAgICBzdHlsZSAgICAgICAgPSAnc3R5bGUnLFxuICAgIFxuICAgIGFjdGl2ZSAgICAgPSAnYWN0aXZlJyxcbiAgICBpbkNsYXNzICAgID0gJ2luJyxcbiAgICBjb2xsYXBzaW5nID0gJ2NvbGxhcHNpbmcnLFxuICAgIGRpc2FibGVkICAgPSAnZGlzYWJsZWQnLFxuICAgIGxvYWRpbmcgICAgPSAnbG9hZGluZycsXG4gICAgbGVmdCAgICAgICA9ICdsZWZ0JyxcbiAgICByaWdodCAgICAgID0gJ3JpZ2h0JyxcbiAgICB0b3AgICAgICAgID0gJ3RvcCcsXG4gICAgYm90dG9tICAgICA9ICdib3R0b20nLFxuICBcbiAgICAvLyB0b29sdGlwIC8gcG9wb3ZlclxuICAgIG1vdXNlSG92ZXIgPSAoJ29ubW91c2VsZWF2ZScgaW4gZG9jdW1lbnQpID8gWyAnbW91c2VlbnRlcicsICdtb3VzZWxlYXZlJ10gOiBbICdtb3VzZW92ZXInLCAnbW91c2VvdXQnIF0sXG4gICAgdGlwUG9zaXRpb25zID0gL1xcYih0b3B8Ym90dG9tfGxlZnR8dG9wKSsvLFxuICBcbiAgICAvLyB0cmFuc2l0aW9uRW5kIHNpbmNlIDIuMC40XG4gICAgc3VwcG9ydFRyYW5zaXRpb25zID0gV2Via2l0K1RyYW5zaXRpb24gaW4gZG9jW3N0eWxlXSB8fCBUcmFuc2l0aW9uW3RvTG93ZXJDYXNlXSgpIGluIGRvY1tzdHlsZV0sXG4gICAgdHJhbnNpdGlvbkVuZEV2ZW50ID0gV2Via2l0K1RyYW5zaXRpb24gaW4gZG9jW3N0eWxlXSA/IFdlYmtpdFt0b0xvd2VyQ2FzZV0oKStUcmFuc2l0aW9uKydFbmQnIDogVHJhbnNpdGlvblt0b0xvd2VyQ2FzZV0oKSsnZW5kJyxcbiAgICBcbiAgXG4gICAgLy8gc2V0IG5ldyBmb2N1cyBlbGVtZW50IHNpbmNlIDIuMC4zXG4gICAgc2V0Rm9jdXMgPSBmdW5jdGlvbihlbGVtZW50KXtcbiAgICAgIGVsZW1lbnQuZm9jdXMgPyBlbGVtZW50LmZvY3VzKCkgOiBlbGVtZW50LnNldEFjdGl2ZSgpO1xuICAgIH0sXG4gIFxuICAgIC8vIGNsYXNzIG1hbmlwdWxhdGlvbiwgc2luY2UgMi4wLjAgcmVxdWlyZXMgcG9seWZpbGwuanNcbiAgICBhZGRDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKSB7XG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOQU1FKTtcbiAgICB9LFxuICAgIHJlbW92ZUNsYXNzID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05BTUUpO1xuICAgIH0sXG4gICAgaGFzQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LGNsYXNzTkFNRSl7IC8vIHNpbmNlIDIuMC4wXG4gICAgICByZXR1cm4gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOQU1FKTtcbiAgICB9LFxuICBcbiAgICAvLyBzZWxlY3Rpb24gbWV0aG9kc1xuICAgIG5vZGVMaXN0VG9BcnJheSA9IGZ1bmN0aW9uKG5vZGVMaXN0KXtcbiAgICAgIHZhciBjaGlsZEl0ZW1zID0gW107IGZvciAodmFyIGkgPSAwLCBubGwgPSBub2RlTGlzdFtsZW5ndGhdOyBpPG5sbDsgaSsrKSB7IGNoaWxkSXRlbXMucHVzaCggbm9kZUxpc3RbaV0gKSB9XG4gICAgICByZXR1cm4gY2hpbGRJdGVtcztcbiAgICB9LFxuICAgIGdldEVsZW1lbnRzQnlDbGFzc05hbWUgPSBmdW5jdGlvbihlbGVtZW50LGNsYXNzTkFNRSkgeyAvLyBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIElFOCtcbiAgICAgIHZhciBzZWxlY3Rpb25NZXRob2QgPSBpc0lFID09PSA4ID8gcXVlcnlTZWxlY3RvckFsbCA6IGdldEVsZW1lbnRzQnlDTEFTU05BTUU7ICAgICAgXG4gICAgICByZXR1cm4gbm9kZUxpc3RUb0FycmF5KGVsZW1lbnRbc2VsZWN0aW9uTWV0aG9kXSggaXNJRSA9PT0gOCA/ICcuJyArIGNsYXNzTkFNRS5yZXBsYWNlKC9cXHMoPz1bYS16XSkvZywnLicpIDogY2xhc3NOQU1FICkpO1xuICAgIH0sXG4gICAgcXVlcnlFbGVtZW50ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBwYXJlbnQpIHtcbiAgICAgIHZhciBsb29rVXAgPSBwYXJlbnQgPyBwYXJlbnQgOiBkb2N1bWVudDtcbiAgICAgIHJldHVybiB0eXBlb2Ygc2VsZWN0b3IgPT09ICdvYmplY3QnID8gc2VsZWN0b3IgOiBsb29rVXAucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgfSxcbiAgICBnZXRDbG9zZXN0ID0gZnVuY3Rpb24gKGVsZW1lbnQsIHNlbGVjdG9yKSB7IC8vZWxlbWVudCBpcyB0aGUgZWxlbWVudCBhbmQgc2VsZWN0b3IgaXMgZm9yIHRoZSBjbG9zZXN0IHBhcmVudCBlbGVtZW50IHRvIGZpbmRcbiAgICAvLyBzb3VyY2UgaHR0cDovL2dvbWFrZXRoaW5ncy5jb20vY2xpbWJpbmctdXAtYW5kLWRvd24tdGhlLWRvbS10cmVlLXdpdGgtdmFuaWxsYS1qYXZhc2NyaXB0L1xuICAgICAgdmFyIGZpcnN0Q2hhciA9IHNlbGVjdG9yLmNoYXJBdCgwKTtcbiAgICAgIGZvciAoIDsgZWxlbWVudCAmJiBlbGVtZW50ICE9PSBkb2N1bWVudDsgZWxlbWVudCA9IGVsZW1lbnRbcGFyZW50Tm9kZV0gKSB7Ly8gR2V0IGNsb3Nlc3QgbWF0Y2hcbiAgICAgICAgaWYgKCBmaXJzdENoYXIgPT09ICcuJyB8fCBmaXJzdENoYXIgIT09ICcjJykgey8vIElmIHNlbGVjdG9yIGlzIGEgY2xhc3NcbiAgICAgICAgICBpZiAoIHF1ZXJ5RWxlbWVudChzZWxlY3RvcixlbGVtZW50W3BhcmVudE5vZGVdKSAhPT0gbnVsbCApIHsgcmV0dXJuIGVsZW1lbnQ7IH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIGZpcnN0Q2hhciA9PT0gJyMnICkgeyAvLyBJZiBzZWxlY3RvciBpcyBhbiBJRFxuICAgICAgICAgIGlmICggZWxlbWVudC5pZCA9PT0gc2VsZWN0b3Iuc3Vic3RyKDEpICkgeyByZXR1cm4gZWxlbWVudDsgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSxcbiAgXG4gICAgLy8gZXZlbnQgYXR0YWNoIGpRdWVyeSBzdHlsZSAvIHRyaWdnZXIgIHNpbmNlIDEuMi4wXG4gICAgb24gPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcbiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpO1xuICAgIH0sXG4gICAgb2ZmID0gZnVuY3Rpb24oZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcbiAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpO1xuICAgIH0sXG4gICAgb25lID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7IC8vIG9uZSBzaW5jZSAyLjAuNFxuICAgICAgb24oZWxlbWVudCwgZXZlbnQsIGZ1bmN0aW9uIGhhbmRsZXJXcmFwcGVyKCl7XG4gICAgICAgIGhhbmRsZXIoKTtcbiAgICAgICAgb2ZmKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyV3JhcHBlcik7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24oZWxlbWVudCxoYW5kbGVyKXsgLy8gZW11bGF0ZVRyYW5zaXRpb25FbmQgc2luY2UgMi4wLjRcbiAgICAgIGlmIChzdXBwb3J0VHJhbnNpdGlvbnMpIHsgb25lKGVsZW1lbnQsdHJhbnNpdGlvbkVuZEV2ZW50LCBoYW5kbGVyKTsgfVxuICAgICAgZWxzZSB7IGhhbmRsZXIoKTsgfVxuICAgIH0sICBcbiAgICBib290c3RyYXBDdXN0b21FdmVudCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNvbXBvbmVudE5hbWUsIHJlbGF0ZWQpIHtcbiAgICAgIHZhciBPcmlnaW5hbEN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCBldmVudE5hbWUgKyAnLmJzLicgKyBjb21wb25lbnROYW1lKTtcbiAgICAgIE9yaWdpbmFsQ3VzdG9tRXZlbnQucmVsYXRlZFRhcmdldCA9IHJlbGF0ZWQ7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoT3JpZ2luYWxDdXN0b21FdmVudCk7XG4gICAgfSxcbiAgXG4gICAgLy8gcmVmZXJlbmNlIGEgbGl2ZSBjb2xsZWN0aW9uIG9mIHRoZSBET01cbiAgICBBbGxET01FbGVtZW50cyA9IGRvY3VtZW50W2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnKicpLFxuICBcbiAgICAvLyBJbml0IERBVEEgQVBJXG4gICAgaW5pdGlhbGl6ZURhdGFBUEkgPSBmdW5jdGlvbiggY29tcG9uZW50LCBjb25zdHJ1Y3RvciwgZGF0YUF0dHJpYnV0ZSwgY29sbGVjdGlvbiApe1xuICAgICAgdmFyIGxvb2tVcCA9IGNvbGxlY3Rpb24gJiYgY29sbGVjdGlvbltsZW5ndGhdID8gY29sbGVjdGlvbiA6IEFsbERPTUVsZW1lbnRzO1xuICAgICAgZm9yICh2YXIgaT0wOyBpIDwgbG9va1VwW2xlbmd0aF07IGkrKykge1xuICAgICAgICB2YXIgYXR0clZhbHVlID0gbG9va1VwW2ldW2dldEF0dHJpYnV0ZV0oZGF0YUF0dHJpYnV0ZSksIGV4cGVjdGVkQXR0clZhbHVlID0gY29tcG9uZW50LnJlcGxhY2UoL3NweS9pLCcnKVt0b0xvd2VyQ2FzZV0oKTtcbiAgICAgICAgaWYgKCBhdHRyVmFsdWUgJiYgY29tcG9uZW50ID09PSBzdHJpbmdCdXR0b24gJiYgKCBhdHRyVmFsdWVbaW5kZXhPZl0oZXhwZWN0ZWRBdHRyVmFsdWUpID4gLTEgKSAvLyBkYXRhLXRvZ2dsZT1cImJ1dHRvbnNcIlxuICAgICAgICAgICAgfHwgYXR0clZhbHVlID09PSBleHBlY3RlZEF0dHJWYWx1ZSApIHsgLy8gYWxsIG90aGVyIGNvbXBvbmVudHNcbiAgICAgICAgICBuZXcgY29uc3RydWN0b3IobG9va1VwW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sICBcbiAgXG4gICAgLy8gdGFiIC8gY29sbGFwc2Ugc3R1ZmZcbiAgICBnZXRPdXRlckhlaWdodCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgdmFyIGNoaWxkU3R5bGUgPSBjaGlsZCAmJiAoY2hpbGQuY3VycmVudFN0eWxlIHx8IGdsb2JhbE9iamVjdC5nZXRDb21wdXRlZFN0eWxlKGNoaWxkKSksIFxuICAgICAgICBidHAgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5ib3JkZXJUb3BXaWR0aCkgPyBNYXRoLnJvdW5kKGNoaWxkU3R5bGUuYm9yZGVyVG9wV2lkdGgucmVwbGFjZSgncHgnLCcnKSkgOiAwLFxuICAgICAgICBidGIgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5ib3JkZXJCb3R0b21XaWR0aCkgPyBNYXRoLnJvdW5kKGNoaWxkU3R5bGUuYm9yZGVyQm90dG9tV2lkdGgucmVwbGFjZSgncHgnLCcnKSkgOiAwLFxuICAgICAgICBtdHAgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5tYXJnaW5Ub3ApID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLm1hcmdpblRvcC5yZXBsYWNlKCdweCcsJycpKSA6IDAsXG4gICAgICAgIG1icCA9IC9weC8udGVzdChjaGlsZFN0eWxlLm1hcmdpbkJvdHRvbSkgPyBNYXRoLnJvdW5kKGNoaWxkU3R5bGUubWFyZ2luQm90dG9tLnJlcGxhY2UoJ3B4JywnJykpIDogMDtcbiAgICAgIHJldHVybiBjaGlsZFtjbGllbnRIZWlnaHRdICsgcGFyc2VJbnQoIGJ0cCApICsgcGFyc2VJbnQoIGJ0YiApICsgcGFyc2VJbnQoIG10cCApICsgcGFyc2VJbnQoIG1icCApO1xuICAgIH0sXG4gICAgZ2V0TWF4SGVpZ2h0ID0gZnVuY3Rpb24ocGFyZW50KSB7IC8vIGdldCBjb2xsYXBzZSB0cnVlSGVpZ2h0IGFuZCBib3JkZXJcbiAgICAgIHZhciBwYXJlbnRIZWlnaHQgPSAwO1xuICAgICAgZm9yICh2YXIgayA9IDAsIGxsID0gcGFyZW50LmNoaWxkcmVuW2xlbmd0aF07IGsgPCBsbDsgaysrKSB7XG4gICAgICAgIHBhcmVudEhlaWdodCArPSBnZXRPdXRlckhlaWdodChwYXJlbnQuY2hpbGRyZW5ba10pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBhcmVudEhlaWdodDtcbiAgICB9LFxuICBcbiAgICAvLyB0b29sdGlwIC8gcG9wb3ZlciBzdHVmZlxuICAgIGlzRWxlbWVudEluVmlld3BvcnQgPSBmdW5jdGlvbihlbGVtZW50KSB7IC8vIGNoZWNrIGlmIHRoaXMudG9vbHRpcCBpcyBpbiB2aWV3cG9ydFxuICAgICAgdmFyIHJlY3QgPSBlbGVtZW50W2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKTtcbiAgICAgIHJldHVybiAoIHJlY3RbdG9wXSA+PSAwICYmIHJlY3RbbGVmdF0gPj0gMCAmJlxuICAgICAgICByZWN0W2JvdHRvbV0gPD0gKGdsb2JhbE9iamVjdFtpbm5lckhlaWdodF0gfHwgZG9jW2NsaWVudEhlaWdodF0pICYmXG4gICAgICAgIHJlY3RbcmlnaHRdIDw9IChnbG9iYWxPYmplY3RbaW5uZXJXaWR0aF0gfHwgZG9jW2NsaWVudFdpZHRoXSkgKVxuICAgIH0sXG4gICAgZ2V0U2Nyb2xsID0gZnVuY3Rpb24oKSB7IC8vIGFsc28gQWZmaXggYW5kIFNjcm9sbFNweSB1c2VzIGl0XG4gICAgICByZXR1cm4ge1xuICAgICAgICB5IDogZ2xvYmFsT2JqZWN0LnBhZ2VZT2Zmc2V0IHx8IGRvY1tzY3JvbGxUb3BdLFxuICAgICAgICB4IDogZ2xvYmFsT2JqZWN0LnBhZ2VYT2Zmc2V0IHx8IGRvY1tzY3JvbGxMZWZ0XVxuICAgICAgfVxuICAgIH0sXG4gICAgc3R5bGVUaXAgPSBmdW5jdGlvbihsaW5rLGVsZW1lbnQscG9zaXRpb24sY29udGFpbmVyKSB7IC8vIGJvdGggcG9wb3ZlcnMgYW5kIHRvb2x0aXBzXG4gICAgICB2YXIgcmVjdCA9IGxpbmtbZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpLCBcbiAgICAgICAgICBzY3JvbGwgPSBjb250YWluZXIgPT09IGJvZHkgPyBnZXRTY3JvbGwoKSA6IHsgeDogY29udGFpbmVyW29mZnNldExlZnRdICsgY29udGFpbmVyW3Njcm9sbExlZnRdLCB5OiBjb250YWluZXJbb2Zmc2V0VG9wXSArIGNvbnRhaW5lcltzY3JvbGxUb3BdIH0sXG4gICAgICAgICAgbGlua0RpbWVuc2lvbnMgPSB7IHc6IHJlY3RbcmlnaHRdIC0gcmVjdFtsZWZ0XSwgaDogcmVjdFtib3R0b21dIC0gcmVjdFt0b3BdIH0sXG4gICAgICAgICAgZWxlbWVudERpbWVuc2lvbnMgPSB7IHcgOiBlbGVtZW50W29mZnNldFdpZHRoXSwgaDogZWxlbWVudFtvZmZzZXRIZWlnaHRdIH07XG4gIFxuICAgICAgLy8gYXBwbHkgc3R5bGluZyB0byB0b29sdGlwIG9yIHBvcG92ZXJcbiAgICAgIGlmICggcG9zaXRpb24gPT09IHRvcCApIHsgLy8gVE9QXG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW3RvcF0gPSByZWN0W3RvcF0gKyBzY3JvbGwueSAtIGVsZW1lbnREaW1lbnNpb25zLmggKyAncHgnO1xuICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCAtIGVsZW1lbnREaW1lbnNpb25zLncvMiArIGxpbmtEaW1lbnNpb25zLncvMiArICdweCdcbiAgXG4gICAgICB9IGVsc2UgaWYgKCBwb3NpdGlvbiA9PT0gYm90dG9tICkgeyAvLyBCT1RUT01cbiAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55ICsgbGlua0RpbWVuc2lvbnMuaCArICdweCc7XG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54IC0gZWxlbWVudERpbWVuc2lvbnMudy8yICsgbGlua0RpbWVuc2lvbnMudy8yICsgJ3B4JztcbiAgXG4gICAgICB9IGVsc2UgaWYgKCBwb3NpdGlvbiA9PT0gbGVmdCApIHsgLy8gTEVGVFxuICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgLSBlbGVtZW50RGltZW5zaW9ucy5oLzIgKyBsaW5rRGltZW5zaW9ucy5oLzIgKyAncHgnO1xuICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCAtIGVsZW1lbnREaW1lbnNpb25zLncgKyAncHgnO1xuICBcbiAgICAgIH0gZWxzZSBpZiAoIHBvc2l0aW9uID09PSByaWdodCApIHsgLy8gUklHSFRcbiAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaC8yICsgbGlua0RpbWVuc2lvbnMuaC8yICsgJ3B4JztcbiAgICAgICAgZWxlbWVudFtzdHlsZV1bbGVmdF0gPSByZWN0W2xlZnRdICsgc2Nyb2xsLnggKyBsaW5rRGltZW5zaW9ucy53ICsgJ3B4JztcbiAgICAgIH1cbiAgICAgIGVsZW1lbnQuY2xhc3NOYW1lW2luZGV4T2ZdKHBvc2l0aW9uKSA9PT0gLTEgJiYgKGVsZW1lbnQuY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZSh0aXBQb3NpdGlvbnMscG9zaXRpb24pKTtcbiAgICB9LFxuICAgIHVwZGF0ZVBsYWNlbWVudCA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XG4gICAgICByZXR1cm4gcG9zaXRpb24gPT09IHRvcCA/IGJvdHRvbSA6IC8vIHRvcFxuICAgICAgICAgICAgIHBvc2l0aW9uID09PSBib3R0b20gPyB0b3AgOiAvLyBib3R0b21cbiAgICAgICAgICAgICBwb3NpdGlvbiA9PT0gbGVmdCA/IHJpZ2h0IDogLy8gbGVmdFxuICAgICAgICAgICAgIHBvc2l0aW9uID09PSByaWdodCA/IGxlZnQgOiBwb3NpdGlvbjsgLy8gcmlnaHRcbiAgICB9O1xuICBcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBBZmZpeFxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vQUZGSVggREVGSU5JVElPTlxuICB2YXIgQWZmaXggPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBcbiAgICAvLyByZWFkIERBVEEgQVBJXG4gICAgdmFyIHRhcmdldERhdGEgICAgICAgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpLFxuICAgICAgICBvZmZzZXRUb3BEYXRhICAgICA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT2Zmc2V0VG9wKSxcbiAgICAgICAgb2Zmc2V0Qm90dG9tRGF0YSAgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9mZnNldEJvdHRvbSksXG4gICAgICAgIFxuICAgICAgICAvLyBjb21wb25lbnQgc3BlY2lmaWMgc3RyaW5nc1xuICAgICAgICBhZmZpeCA9ICdhZmZpeCcsIGFmZml4ZWQgPSAnYWZmaXhlZCcsIGZuID0gJ2Z1bmN0aW9uJywgdXBkYXRlID0gJ3VwZGF0ZScsXG4gICAgICAgIGFmZml4VG9wID0gJ2FmZml4LXRvcCcsIGFmZml4ZWRUb3AgPSAnYWZmaXhlZC10b3AnLFxuICAgICAgICBhZmZpeEJvdHRvbSA9ICdhZmZpeC1ib3R0b20nLCBhZmZpeGVkQm90dG9tID0gJ2FmZml4ZWQtYm90dG9tJztcbiAgXG4gICAgdGhpc1t0YXJnZXRdID0gb3B0aW9uc1t0YXJnZXRdID8gcXVlcnlFbGVtZW50KG9wdGlvbnNbdGFyZ2V0XSkgOiBxdWVyeUVsZW1lbnQodGFyZ2V0RGF0YSkgfHwgbnVsbDsgLy8gdGFyZ2V0IGlzIGFuIG9iamVjdFxuICAgIHRoaXNbb2Zmc2V0VG9wXSA9IG9wdGlvbnNbb2Zmc2V0VG9wXSA/IG9wdGlvbnNbb2Zmc2V0VG9wXSA6IHBhcnNlSW50KG9mZnNldFRvcERhdGEpIHx8IDA7IC8vIG9mZnNldCBvcHRpb24gaXMgYW4gaW50ZWdlciBudW1iZXIgb3IgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHRoYXQgbnVtYmVyXG4gICAgdGhpc1tvZmZzZXRCb3R0b21dID0gb3B0aW9uc1tvZmZzZXRCb3R0b21dID8gb3B0aW9uc1tvZmZzZXRCb3R0b21dOiBwYXJzZUludChvZmZzZXRCb3R0b21EYXRhKSB8fCAwO1xuICBcbiAgICBpZiAoICF0aGlzW3RhcmdldF0gJiYgISggdGhpc1tvZmZzZXRUb3BdIHx8IHRoaXNbb2Zmc2V0Qm90dG9tXSApICkgeyByZXR1cm47IH0gLy8gaW52YWxpZGF0ZVxuICBcbiAgICAvLyBpbnRlcm5hbCBiaW5kXG4gICAgdmFyIHNlbGYgPSB0aGlzLFxuICBcbiAgICAgIC8vIGNvbnN0YW50c1xuICAgICAgcmVzaXplRGVsYXkgPSAoaXNJRSAmJiBpc0lFIDwgMTApID8gNTAwIDogNTAsIC8vIGZvciBsZWdhY3kgYnJvd3NlcnMgd2UgdHJ5IHRvIGxpbWl0IHRoZSBpbnRlcnZhbCBmb3IgdXBkYXRpbmcgdGhlIEFmZml4XG4gICAgICBwaW5PZmZzZXRUb3AsIHBpbk9mZnNldEJvdHRvbSwgbWF4U2Nyb2xsLCBzY3JvbGxZLCBwaW5uZWRUb3AsIHBpbm5lZEJvdHRvbSxcbiAgICAgIGFmZml4ZWRUb1RvcCA9IGZhbHNlLCBhZmZpeGVkVG9Cb3R0b20gPSBmYWxzZSxcbiAgICAgIFxuICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzIFxuICAgICAgZ2V0TWF4U2Nyb2xsID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KCBib2R5W3Njcm9sbEhlaWdodF0sIGJvZHlbb2Zmc2V0SGVpZ2h0XSwgZG9jW2NsaWVudEhlaWdodF0sIGRvY1tzY3JvbGxIZWlnaHRdLCBkb2Nbb2Zmc2V0SGVpZ2h0XSApO1xuICAgICAgfSxcbiAgICAgIGdldE9mZnNldFRvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCBzZWxmW3RhcmdldF0gIT09IG51bGwgKSB7XG4gICAgICAgICAgcmV0dXJuIHNlbGZbdGFyZ2V0XVtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKClbdG9wXSArIHNjcm9sbFk7XG4gICAgICAgIH0gZWxzZSBpZiAoIHNlbGZbb2Zmc2V0VG9wXSApIHtcbiAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodHlwZW9mIHNlbGZbb2Zmc2V0VG9wXSA9PT0gZm4gPyBzZWxmW29mZnNldFRvcF0oKSA6IHNlbGZbb2Zmc2V0VG9wXSB8fCAwKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGdldE9mZnNldEJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCBzZWxmW29mZnNldEJvdHRvbV0gKSB7XG4gICAgICAgICAgcmV0dXJuIG1heFNjcm9sbCAtIGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSAtIHBhcnNlSW50KCB0eXBlb2Ygc2VsZltvZmZzZXRCb3R0b21dID09PSBmbiA/IHNlbGZbb2Zmc2V0Qm90dG9tXSgpIDogc2VsZltvZmZzZXRCb3R0b21dIHx8IDAgKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGNoZWNrUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG1heFNjcm9sbCA9IGdldE1heFNjcm9sbCgpO1xuICAgICAgICBzY3JvbGxZID0gcGFyc2VJbnQoZ2V0U2Nyb2xsKCkueSwwKTtcbiAgICAgICAgcGluT2Zmc2V0VG9wID0gZ2V0T2Zmc2V0VG9wKCk7XG4gICAgICAgIHBpbk9mZnNldEJvdHRvbSA9IGdldE9mZnNldEJvdHRvbSgpOyBcbiAgICAgICAgcGlubmVkVG9wID0gKCBwYXJzZUludChwaW5PZmZzZXRUb3ApIC0gc2Nyb2xsWSA8IDApICYmIChzY3JvbGxZID4gcGFyc2VJbnQocGluT2Zmc2V0VG9wKSApO1xuICAgICAgICBwaW5uZWRCb3R0b20gPSAoIHBhcnNlSW50KHBpbk9mZnNldEJvdHRvbSkgLSBzY3JvbGxZIDwgMCkgJiYgKHNjcm9sbFkgPiBwYXJzZUludChwaW5PZmZzZXRCb3R0b20pICk7XG4gICAgICB9LFxuICAgICAgcGluVG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoICFhZmZpeGVkVG9Ub3AgJiYgIWhhc0NsYXNzKGVsZW1lbnQsYWZmaXgpICkgeyAvLyBvbiBsb2FkaW5nIGEgcGFnZSBoYWxmd2F5IHNjcm9sbGVkIHRoZXNlIGV2ZW50cyBkb24ndCB0cmlnZ2VyIGluIENocm9tZVxuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXgsIGFmZml4KTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4VG9wLCBhZmZpeCk7XG4gICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCxhZmZpeCk7XG4gICAgICAgICAgYWZmaXhlZFRvVG9wID0gdHJ1ZTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWQsIGFmZml4KTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWRUb3AsIGFmZml4KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVuUGluVG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIGFmZml4ZWRUb1RvcCAmJiBoYXNDbGFzcyhlbGVtZW50LGFmZml4KSApIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGFmZml4KTtcbiAgICAgICAgICBhZmZpeGVkVG9Ub3AgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHBpbkJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCAhYWZmaXhlZFRvQm90dG9tICYmICFoYXNDbGFzcyhlbGVtZW50LCBhZmZpeEJvdHRvbSkgKSB7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeCwgYWZmaXgpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhCb3R0b20sIGFmZml4KTtcbiAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LGFmZml4Qm90dG9tKTtcbiAgICAgICAgICBhZmZpeGVkVG9Cb3R0b20gPSB0cnVlO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhlZCwgYWZmaXgpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhlZEJvdHRvbSwgYWZmaXgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdW5QaW5Cb3R0b20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggYWZmaXhlZFRvQm90dG9tICYmIGhhc0NsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pICkge1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pO1xuICAgICAgICAgIGFmZml4ZWRUb0JvdHRvbSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdXBkYXRlUGluID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIHBpbm5lZEJvdHRvbSApIHtcbiAgICAgICAgICBpZiAoIHBpbm5lZFRvcCApIHsgdW5QaW5Ub3AoKTsgfVxuICAgICAgICAgIHBpbkJvdHRvbSgpOyBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1blBpbkJvdHRvbSgpO1xuICAgICAgICAgIGlmICggcGlubmVkVG9wICkgeyBwaW5Ub3AoKTsgfSBcbiAgICAgICAgICBlbHNlIHsgdW5QaW5Ub3AoKTsgfVxuICAgICAgICB9XG4gICAgICB9O1xuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kXG4gICAgdGhpc1t1cGRhdGVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgY2hlY2tQb3NpdGlvbigpO1xuICAgICAgdXBkYXRlUGluKCk7IFxuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nQWZmaXggaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgb24oIGdsb2JhbE9iamVjdCwgc2Nyb2xsRXZlbnQsIHRoaXNbdXBkYXRlXSApO1xuICAgICAgb24oIGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIGZ1bmN0aW9uKCkgeyBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IHNlbGZbdXBkYXRlXSgpOyB9LCByZXNpemVEZWxheSk7IH0pO1xuICAgIH1cbiAgICBlbGVtZW50W3N0cmluZ0FmZml4XSA9IHRoaXM7XG4gIFxuICAgIHRoaXNbdXBkYXRlXSgpO1xuICB9O1xuICBcbiAgLy8gQUZGSVggREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoIHN0cmluZ0FmZml4LCBBZmZpeCwgZGF0YVNweSApO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEFsZXJ0XG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gQUxFUlQgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09XG4gIHZhciBBbGVydCA9IGZ1bmN0aW9uKCBlbGVtZW50ICkge1xuICAgIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBiaW5kLCB0YXJnZXQgYWxlcnQsIGR1cmF0aW9uIGFuZCBzdHVmZlxuICAgIHZhciBzZWxmID0gdGhpcywgY29tcG9uZW50ID0gJ2FsZXJ0JyxcbiAgICAgIGFsZXJ0ID0gZ2V0Q2xvc2VzdChlbGVtZW50LCcuJytjb21wb25lbnQpLFxuICAgICAgLy8gaGFuZGxlcnNcbiAgICAgIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlW3RhcmdldF07XG4gICAgICAgIGV2ZW50VGFyZ2V0ID0gZXZlbnRUYXJnZXRbaGFzQXR0cmlidXRlXShkYXRhRGlzbWlzcykgPyBldmVudFRhcmdldCA6IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdO1xuICAgICAgICBpZiAoZXZlbnRUYXJnZXQgJiYgZXZlbnRUYXJnZXRbaGFzQXR0cmlidXRlXShkYXRhRGlzbWlzcykpIHsgLy8gd2UgZG91YmxlIGNoZWNrIHRoZSBkYXRhIGF0dHJpYnV0ZSwgaXQncyBpbXBvcnRhbnRcbiAgICAgICAgICBhbGVydCA9IGdldENsb3Nlc3QoZXZlbnRUYXJnZXQsJy4nK2NvbXBvbmVudCk7XG4gICAgICAgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudCgnWycrZGF0YURpc21pc3MrJz1cIicrY29tcG9uZW50KydcIl0nLGFsZXJ0KTtcbiAgICAgICAgICAoZWxlbWVudCA9PT0gZXZlbnRUYXJnZXQgfHwgZWxlbWVudCA9PT0gZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV0pICYmIGFsZXJ0ICYmIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHRyYW5zaXRpb25FbmRIYW5kbGVyID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhbGVydCwgY2xvc2VkRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgIG9mZihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpOyAvLyBkZXRhY2ggaXQncyBsaXN0ZW5lclxuICAgICAgICBhbGVydFtwYXJlbnROb2RlXS5yZW1vdmVDaGlsZChhbGVydCk7XG4gICAgICB9O1xuICAgIFxuICAgIC8vIHB1YmxpYyBtZXRob2RcbiAgICB0aGlzLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIGFsZXJ0ICYmIGVsZW1lbnQgJiYgaGFzQ2xhc3MoYWxlcnQsaW5DbGFzcykgKSB7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoYWxlcnQsIGNsb3NlRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgIHJlbW92ZUNsYXNzKGFsZXJ0LGluQ2xhc3MpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmIChhbGVydCkge1xuICAgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoYWxlcnQsdHJhbnNpdGlvbkVuZEhhbmRsZXIpO1xuICAgICAgICAgIH0gXG4gICAgICAgIH0sIGR1cmF0aW9uKTtcbiAgICAgIH1cbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ0FsZXJ0IGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7XG4gICAgfVxuICAgIGVsZW1lbnRbc3RyaW5nQWxlcnRdID0gdGhpcztcbiAgfTtcbiAgXG4gIC8vIEFMRVJUIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJICggc3RyaW5nQWxlcnQsIEFsZXJ0LCBkYXRhRGlzbWlzcyApO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEJ1dHRvblxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gQlVUVE9OIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PVxuICB2YXIgQnV0dG9uID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbiApIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIHNldCBvcHRpb25cbiAgICBvcHRpb24gPSBvcHRpb24gfHwgbnVsbDtcbiAgXG4gICAgLy8gY29uc3RhbnRcbiAgICB2YXIgdG9nZ2xlZCA9IGZhbHNlLCAvLyB0b2dnbGVkIG1ha2VzIHN1cmUgdG8gcHJldmVudCB0cmlnZ2VyaW5nIHR3aWNlIHRoZSBjaGFuZ2UuYnMuYnV0dG9uIGV2ZW50c1xuICBcbiAgICAgICAgLy8gc3RyaW5nc1xuICAgICAgICBjb21wb25lbnQgPSAnYnV0dG9uJyxcbiAgICAgICAgY2hlY2tlZCA9ICdjaGVja2VkJyxcbiAgICAgICAgcmVzZXQgPSAncmVzZXQnLFxuICAgICAgICBMQUJFTCA9ICdMQUJFTCcsXG4gICAgICAgIElOUFVUID0gJ0lOUFVUJyxcbiAgXG4gICAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICAgIHNldFN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICggISEgb3B0aW9uICYmIG9wdGlvbiAhPT0gcmVzZXQgKSB7XG4gICAgICAgICAgaWYgKCBvcHRpb24gPT09IGxvYWRpbmcgKSB7XG4gICAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LGRpc2FibGVkKTtcbiAgICAgICAgICAgIGVsZW1lbnRbc2V0QXR0cmlidXRlXShkaXNhYmxlZCxkaXNhYmxlZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsZW1lbnRbc2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUZXh0LCBlbGVtZW50LmlubmVySFRNTC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJykpOyAvLyB0cmltIHRoZSB0ZXh0XG4gICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oJ2RhdGEtJytvcHRpb24rJy10ZXh0Jyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZXNldFN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGV4dCkpIHtcbiAgICAgICAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsZGlzYWJsZWQpIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkaXNhYmxlZCkgPT09IGRpc2FibGVkICkge1xuICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxkaXNhYmxlZCk7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShkaXNhYmxlZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRleHQpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdG9nZ2xlID0gZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgcGFyZW50ID0gZVt0YXJnZXRdW3BhcmVudE5vZGVdLFxuICAgICAgICAgIGxhYmVsID0gZVt0YXJnZXRdLnRhZ05hbWUgPT09IExBQkVMID8gZVt0YXJnZXRdIDogcGFyZW50LnRhZ05hbWUgPT09IExBQkVMID8gcGFyZW50IDogbnVsbDsgLy8gdGhlIC5idG4gbGFiZWxcbiAgXG4gICAgICAgIGlmICggIWxhYmVsICkgcmV0dXJuOyAvL3JlYWN0IGlmIGEgbGFiZWwgb3IgaXRzIGltbWVkaWF0ZSBjaGlsZCBpcyBjbGlja2VkXG4gIFxuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSB0aGlzLCAvLyB0aGUgYnV0dG9uIGdyb3VwLCB0aGUgdGFyZ2V0IG9mIHRoZSBoYW5kbGVyIGZ1bmN0aW9uXG4gICAgICAgICAgbGFiZWxzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShldmVudFRhcmdldCwnYnRuJyksIC8vIGFsbCB0aGUgYnV0dG9uIGdyb3VwIGJ1dHRvbnNcbiAgICAgICAgICBpbnB1dCA9IGxhYmVsW2dldEVsZW1lbnRzQnlUYWdOYW1lXShJTlBVVClbMF07XG4gIFxuICAgICAgICBpZiAoICFpbnB1dCApIHJldHVybjsgLy9yZXR1cm4gaWYgbm8gaW5wdXQgZm91bmRcbiAgXG4gICAgICAgIC8vIG1hbmFnZSB0aGUgZG9tIG1hbmlwdWxhdGlvblxuICAgICAgICBpZiAoIGlucHV0LnR5cGUgPT09ICdjaGVja2JveCcgKSB7IC8vY2hlY2tib3hlc1xuICAgICAgICAgIGlmICggIWlucHV0W2NoZWNrZWRdICkge1xuICAgICAgICAgICAgYWRkQ2xhc3MobGFiZWwsYWN0aXZlKTtcbiAgICAgICAgICAgIGlucHV0W2dldEF0dHJpYnV0ZV0oY2hlY2tlZCk7XG4gICAgICAgICAgICBpbnB1dFtzZXRBdHRyaWJ1dGVdKGNoZWNrZWQsY2hlY2tlZCk7XG4gICAgICAgICAgICBpbnB1dFtjaGVja2VkXSA9IHRydWU7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzKGxhYmVsLGFjdGl2ZSk7XG4gICAgICAgICAgICBpbnB1dFtnZXRBdHRyaWJ1dGVdKGNoZWNrZWQpO1xuICAgICAgICAgICAgaW5wdXQucmVtb3ZlQXR0cmlidXRlKGNoZWNrZWQpO1xuICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSBmYWxzZTtcbiAgICAgICAgICB9XG4gIFxuICAgICAgICAgIGlmICghdG9nZ2xlZCkgeyAvLyBwcmV2ZW50IHRyaWdnZXJpbmcgdGhlIGV2ZW50IHR3aWNlXG4gICAgICAgICAgICB0b2dnbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoaW5wdXQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGlucHV0XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGJ0bi1ncm91cFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICBcbiAgICAgICAgaWYgKCBpbnB1dC50eXBlID09PSAncmFkaW8nICYmICF0b2dnbGVkICkgeyAvLyByYWRpbyBidXR0b25zXG4gICAgICAgICAgaWYgKCAhaW5wdXRbY2hlY2tlZF0gKSB7IC8vIGRvbid0IHRyaWdnZXIgaWYgYWxyZWFkeSBhY3RpdmVcbiAgICAgICAgICAgIGFkZENsYXNzKGxhYmVsLGFjdGl2ZSk7XG4gICAgICAgICAgICBpbnB1dFtzZXRBdHRyaWJ1dGVdKGNoZWNrZWQsY2hlY2tlZCk7XG4gICAgICAgICAgICBpbnB1dFtjaGVja2VkXSA9IHRydWU7XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGlucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBpbnB1dFxuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBidG4tZ3JvdXBcbiAgXG4gICAgICAgICAgICB0b2dnbGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsbCA9IGxhYmVsc1tsZW5ndGhdOyBpPGxsOyBpKyspIHtcbiAgICAgICAgICAgICAgdmFyIG90aGVyTGFiZWwgPSBsYWJlbHNbaV0sIG90aGVySW5wdXQgPSBvdGhlckxhYmVsW2dldEVsZW1lbnRzQnlUYWdOYW1lXShJTlBVVClbMF07XG4gICAgICAgICAgICAgIGlmICggb3RoZXJMYWJlbCAhPT0gbGFiZWwgJiYgaGFzQ2xhc3Mob3RoZXJMYWJlbCxhY3RpdmUpICkgIHtcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhvdGhlckxhYmVsLGFjdGl2ZSk7XG4gICAgICAgICAgICAgICAgb3RoZXJJbnB1dC5yZW1vdmVBdHRyaWJ1dGUoY2hlY2tlZCk7XG4gICAgICAgICAgICAgICAgb3RoZXJJbnB1dFtjaGVja2VkXSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwob3RoZXJJbnB1dCwgY2hhbmdlRXZlbnQsIGNvbXBvbmVudCk7IC8vIHRyaWdnZXIgdGhlIGNoYW5nZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgeyB0b2dnbGVkID0gZmFsc2U7IH0sIDUwICk7XG4gICAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCBoYXNDbGFzcyhlbGVtZW50LCdidG4nKSApIHsgLy8gd2hlbiBCdXR0b24gdGV4dCBpcyB1c2VkIHdlIGV4ZWN1dGUgaXQgYXMgYW4gaW5zdGFuY2UgbWV0aG9kXG4gICAgICBpZiAoIG9wdGlvbiAhPT0gbnVsbCApIHtcbiAgICAgICAgaWYgKCBvcHRpb24gIT09IHJlc2V0ICkgeyBzZXRTdGF0ZSgpOyB9IFxuICAgICAgICBlbHNlIHsgcmVzZXRTdGF0ZSgpOyB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmICggaGFzQ2xhc3MoZWxlbWVudCwnYnRuLWdyb3VwJykgKSB7XG4gICAgICBpZiAoICEoIHN0cmluZ0J1dHRvbiBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICAgIG9uKCBlbGVtZW50LCBjbGlja0V2ZW50LCB0b2dnbGUgKTtcbiAgICAgIH1cbiAgICAgIGVsZW1lbnRbc3RyaW5nQnV0dG9uXSA9IHRoaXM7XG4gICAgfVxuICB9O1xuICBcbiAgLy8gQlVUVE9OIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdCdXR0b24sIEJ1dHRvbiwgZGF0YVRvZ2dsZSApO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IENhcm91c2VsXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gQ0FST1VTRUwgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09XG4gIHZhciBDYXJvdXNlbCA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zICkge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudCggZWxlbWVudCApO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBcbiAgICAvLyBEQVRBIEFQSVxuICAgIHZhciBpbnRlcnZhbERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUludGVydmFsKSA9PT0gJ2ZhbHNlJyA/IGZhbHNlIDogcGFyc2VJbnQoZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFJbnRlcnZhbCkpIHx8IDUwMDAsIC8vIGJvb3RzdHJhcCBjYXJvdXNlbCBkZWZhdWx0IGludGVydmFsXG4gICAgICAgIHBhdXNlRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhUGF1c2UpID09PSBob3ZlckV2ZW50IHx8IGZhbHNlLFxuICAgICAgICBrZXlib2FyZERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUtleWJvYXJkKSA9PT0gJ3RydWUnIHx8IGZhbHNlLFxuICAgICAgXG4gICAgICAgIC8vIHN0cmluZ3NcbiAgICAgICAgY29tcG9uZW50ID0gJ2Nhcm91c2VsJyxcbiAgICAgICAgcGF1c2VkID0gJ3BhdXNlZCcsXG4gICAgICAgIGRpcmVjdGlvbiA9ICdkaXJlY3Rpb24nLFxuICAgICAgICBkYXRhU2xpZGVUbyA9ICdkYXRhLXNsaWRlLXRvJzsgXG4gIFxuICAgIHRoaXNba2V5Ym9hcmRdID0gb3B0aW9uc1trZXlib2FyZF0gPT09IHRydWUgfHwga2V5Ym9hcmREYXRhO1xuICAgIHRoaXNbcGF1c2VdID0gKG9wdGlvbnNbcGF1c2VdID09PSBob3ZlckV2ZW50IHx8IHBhdXNlRGF0YSkgPyBob3ZlckV2ZW50IDogZmFsc2U7IC8vIGZhbHNlIC8gaG92ZXJcbiAgXG4gICAgaWYgKCAhKCBvcHRpb25zW2ludGVydmFsXSB8fCBpbnRlcnZhbERhdGEgKSApIHsgLy8gZGV0ZXJtaW5lIHNsaWRlIGludGVydmFsXG4gICAgICB0aGlzW2ludGVydmFsXSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzW2ludGVydmFsXSA9IHBhcnNlSW50KG9wdGlvbnNbaW50ZXJ2YWxdKSB8fCBpbnRlcnZhbERhdGE7IC8vIGRlZmF1bHQgc2xpZGUgaW50ZXJ2YWxcbiAgICB9XG4gIFxuICAgIC8vIGJpbmQsIGV2ZW50IHRhcmdldHNcbiAgICB2YXIgc2VsZiA9IHRoaXMsIGluZGV4ID0gZWxlbWVudC5pbmRleCA9IDAsIHRpbWVyID0gZWxlbWVudC50aW1lciA9IDAsIFxuICAgICAgaXNTbGlkaW5nID0gZmFsc2UsIC8vIGlzU2xpZGluZyBwcmV2ZW50cyBjbGljayBldmVudCBoYW5kbGVycyB3aGVuIGFuaW1hdGlvbiBpcyBydW5uaW5nXG4gICAgICBzbGlkZXMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW1lbnQsJ2l0ZW0nKSwgdG90YWwgPSBzbGlkZXNbbGVuZ3RoXSxcbiAgICAgIHNsaWRlRGlyZWN0aW9uID0gdGhpc1tkaXJlY3Rpb25dID0gbGVmdCxcbiAgICAgIGNvbnRyb2xzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlbGVtZW50LGNvbXBvbmVudCsnLWNvbnRyb2wnKSxcbiAgICAgIGxlZnRBcnJvdyA9IGNvbnRyb2xzWzBdLCByaWdodEFycm93ID0gY29udHJvbHNbMV0sXG4gICAgICBpbmRpY2F0b3IgPSBxdWVyeUVsZW1lbnQoICcuJytjb21wb25lbnQrJy1pbmRpY2F0b3JzJywgZWxlbWVudCApLFxuICAgICAgaW5kaWNhdG9ycyA9IGluZGljYXRvcltnZXRFbGVtZW50c0J5VGFnTmFtZV0oIFwiTElcIiApO1xuICBcbiAgICAvLyBoYW5kbGVyc1xuICAgIHZhciBwYXVzZUhhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggc2VsZltpbnRlcnZhbF0gIT09ZmFsc2UgJiYgIWhhc0NsYXNzKGVsZW1lbnQscGF1c2VkKSApIHtcbiAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LHBhdXNlZCk7XG4gICAgICAgICAgIWlzU2xpZGluZyAmJiBjbGVhckludGVydmFsKCB0aW1lciApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVzdW1lSGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICE9PSBmYWxzZSAmJiBoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxwYXVzZWQpO1xuICAgICAgICAgICFpc1NsaWRpbmcgJiYgY2xlYXJJbnRlcnZhbCggdGltZXIgKTtcbiAgICAgICAgICAhaXNTbGlkaW5nICYmIHNlbGYuY3ljbGUoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGluZGljYXRvckhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKGlzU2xpZGluZykgcmV0dXJuO1xuICBcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZVt0YXJnZXRdLCBhY3RpdmVJbmRpY2F0b3IgPSBzZWxmLmdldEFjdGl2ZUluZGV4KCk7IC8vIGV2ZW50IHRhcmdldCB8IHRoZSBjdXJyZW50IGFjdGl2ZSBpdGVtXG4gIFxuICAgICAgICBpZiAoIGV2ZW50VGFyZ2V0ICYmICFoYXNDbGFzcyhldmVudFRhcmdldCxhY3RpdmUpICYmIGV2ZW50VGFyZ2V0W2dldEF0dHJpYnV0ZV0oZGF0YVNsaWRlVG8pICkge1xuICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoIGV2ZW50VGFyZ2V0W2dldEF0dHJpYnV0ZV0oZGF0YVNsaWRlVG8pLCAxMCApO1xuICBcbiAgICAgICAgICAvL2RldGVybWluZSBkaXJlY3Rpb24gZmlyc3RcbiAgICAgICAgICBpZiAgKCAoYWN0aXZlSW5kaWNhdG9yIDwgaW5kZXggKSB8fCAoYWN0aXZlSW5kaWNhdG9yID09PSAwICYmIGluZGV4ID09PSB0b3RhbCAtMSApICkge1xuICAgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSBsZWZ0OyAvLyBuZXh0XG4gICAgICAgICAgfSBlbHNlIGlmICAoIChhY3RpdmVJbmRpY2F0b3IgPiBpbmRleCkgfHwgKGFjdGl2ZUluZGljYXRvciA9PT0gdG90YWwgLSAxICYmIGluZGV4ID09PSAwICkgKSB7XG4gICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IHJpZ2h0OyAvLyBwcmV2XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH1cbiAgXG4gICAgICAgIHNlbGYuc2xpZGVUbyggaW5kZXggKTsgLy9EbyB0aGUgc2xpZGVcbiAgICAgIH0sXG4gICAgICBjb250cm9sc0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmIChpc1NsaWRpbmcpIHJldHVybjtcbiAgXG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGUuY3VycmVudFRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG4gIFxuICAgICAgICBpZiAoIGV2ZW50VGFyZ2V0ID09PSByaWdodEFycm93ICkge1xuICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSBsZWZ0OyAvL3NldCBkaXJlY3Rpb24gZmlyc3RcbiAgXG4gICAgICAgICAgaWYoIGluZGV4ID09PSB0b3RhbCAtIDEgKSB7XG4gICAgICAgICAgICBpbmRleCA9IHRvdGFsIC0gMTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCBpbmRleCA9PT0gdG90YWwgKXtcbiAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIGV2ZW50VGFyZ2V0ID09PSBsZWZ0QXJyb3cgKSB7XG4gICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IHJpZ2h0OyAvL3NldCBkaXJlY3Rpb24gZmlyc3RcbiAgXG4gICAgICAgICAgaWYoIGluZGV4ID09PSAwICkge1xuICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIGluZGV4IDwgMCApe1xuICAgICAgICAgICAgaW5kZXggPSB0b3RhbCAtIDFcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgXG4gICAgICAgIHNlbGYuc2xpZGVUbyggaW5kZXggKTsgLy9EbyB0aGUgc2xpZGVcbiAgICAgIH0sXG4gICAgICBrZXlIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKGlzU2xpZGluZykgcmV0dXJuO1xuICAgICAgICBzd2l0Y2ggKGUud2hpY2gpIHtcbiAgICAgICAgICBjYXNlIDM5OlxuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDtcbiAgICAgICAgICAgIGlmKCBpbmRleCA9PSB0b3RhbCAtIDEgKSB7IGluZGV4ID0gdG90YWwgLSAxOyB9IGVsc2VcbiAgICAgICAgICAgIGlmICggaW5kZXggPT0gdG90YWwgKXsgaW5kZXggPSAwIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgICBpbmRleC0tO1xuICAgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSByaWdodDtcbiAgICAgICAgICAgIGlmICggaW5kZXggPT0gMCApIHsgaW5kZXggPSAwOyB9IGVsc2VcbiAgICAgICAgICAgIGlmICggaW5kZXggPCAwICkgeyBpbmRleCA9IHRvdGFsIC0gMSB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OiByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApOyAvL0RvIHRoZSBzbGlkZVxuICAgICAgfSxcbiAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgICAgc2V0QWN0aXZlUGFnZSA9IGZ1bmN0aW9uKCBwYWdlSW5kZXggKSB7IC8vaW5kaWNhdG9yc1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDAsIGljbCA9IGluZGljYXRvcnNbbGVuZ3RoXTsgaSA8IGljbDsgaSsrICkge1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGluZGljYXRvcnNbaV0sYWN0aXZlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kaWNhdG9yc1twYWdlSW5kZXhdKSBhZGRDbGFzcyhpbmRpY2F0b3JzW3BhZ2VJbmRleF0sIGFjdGl2ZSk7XG4gICAgICB9O1xuICBcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICB0aGlzLmN5Y2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICBzbGlkZURpcmVjdGlvbiA9IHRoaXNbZGlyZWN0aW9uXSA9IGxlZnQ7IC8vIG1ha2Ugc3VyZSB0byBhbHdheXMgY29tZSBiYWNrIHRvIGRlZmF1bHQgc2xpZGVEaXJlY3Rpb25cbiAgICAgIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgIGluZGV4Kys7XG4gIFxuICAgICAgICBpbmRleCA9IGluZGV4ID09PSB0b3RhbCA/IDAgOiBpbmRleDtcbiAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApO1xuICAgICAgfSwgdGhpc1tpbnRlcnZhbF0pO1xuICAgIH07XG4gICAgdGhpcy5zbGlkZVRvID0gZnVuY3Rpb24oIG5leHQgKSB7XG4gICAgICB2YXIgYWN0aXZlSXRlbSA9IHRoaXMuZ2V0QWN0aXZlSW5kZXgoKSwgLy8gdGhlIGN1cnJlbnQgYWN0aXZlXG4gICAgICAgICAgb3JpZW50YXRpb24gPSBzbGlkZURpcmVjdGlvbiA9PT0gbGVmdCA/ICduZXh0JyA6ICdwcmV2JzsgLy9kZXRlcm1pbmUgdHlwZVxuICBcbiAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2xpZGVFdmVudCwgY29tcG9uZW50LCBzbGlkZXNbbmV4dF0pOyAvLyBoZXJlIHdlIGdvIHdpdGggdGhlIHNsaWRlXG4gIFxuICAgICAgaXNTbGlkaW5nID0gdGhpcy5pc1NsaWRpbmcgPSB0cnVlO1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XG4gICAgICBzZXRBY3RpdmVQYWdlKCBuZXh0ICk7XG4gIFxuICAgICAgaWYgKCBzdXBwb3J0VHJhbnNpdGlvbnMgJiYgaGFzQ2xhc3MoZWxlbWVudCwnc2xpZGUnKSApIHtcbiAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLG9yaWVudGF0aW9uKTtcbiAgICAgICAgc2xpZGVzW25leHRdW29mZnNldFdpZHRoXTsgIFxuICAgICAgICBhZGRDbGFzcyhzbGlkZXNbbmV4dF0sc2xpZGVEaXJlY3Rpb24pO1xuICAgICAgICBhZGRDbGFzcyhzbGlkZXNbYWN0aXZlSXRlbV0sc2xpZGVEaXJlY3Rpb24pO1xuICBcbiAgICAgICAgb25lKHNsaWRlc1tuZXh0XSwgdHJhbnNpdGlvbkVuZEV2ZW50LCBmdW5jdGlvbigpIHsgLy93ZSdyZSBnb25uYSBmYWtlIHdhaXRpbmcgZm9yIHRoZSBhbmltYXRpb24gdG8gZmluaXNoLCBjbGVhbmVyIGFuZCBiZXR0ZXJcbiAgICAgICAgICBpc1NsaWRpbmcgPSBzZWxmLmlzU2xpZGluZyA9IGZhbHNlO1xuICBcbiAgICAgICAgICBhZGRDbGFzcyhzbGlkZXNbbmV4dF0sYWN0aXZlKTtcbiAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbYWN0aXZlSXRlbV0sYWN0aXZlKTtcbiAgXG4gICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW25leHRdLG9yaWVudGF0aW9uKTtcbiAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbbmV4dF0sc2xpZGVEaXJlY3Rpb24pO1xuICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1thY3RpdmVJdGVtXSxzbGlkZURpcmVjdGlvbik7XG4gIFxuICAgICAgICAgIGlmICggc2VsZltpbnRlcnZhbF0gJiYgIWhhc0NsYXNzKGVsZW1lbnQscGF1c2VkKSApIHtcbiAgICAgICAgICAgIHNlbGYuY3ljbGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzbGlkRXZlbnQsIGNvbXBvbmVudCwgc2xpZGVzW25leHRdKTsgLy8gaGVyZSB3ZSBnbyB3aXRoIHRoZSBzbGlkIGV2ZW50XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxhY3RpdmUpO1xuICAgICAgICBzbGlkZXNbbmV4dF1bb2Zmc2V0V2lkdGhdO1xuICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbYWN0aXZlSXRlbV0sYWN0aXZlKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBpc1NsaWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG4gICAgICAgICAgICBzZWxmLmN5Y2xlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2xpZEV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZCBldmVudFxuICAgICAgICB9LCAxMDAgKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuZ2V0QWN0aXZlSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gc2xpZGVzW2luZGV4T2ZdKGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZWxlbWVudCwnaXRlbSBhY3RpdmUnKVswXSkgfHwgMDtcbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ0Nhcm91c2VsIGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgXG4gICAgICBpZiAoIHRoaXNbcGF1c2VdICYmIHRoaXNbaW50ZXJ2YWxdICkge1xuICAgICAgICBvbiggZWxlbWVudCwgbW91c2VIb3ZlclswXSwgcGF1c2VIYW5kbGVyICk7XG4gICAgICAgIG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzFdLCByZXN1bWVIYW5kbGVyICk7XG4gICAgICAgIG9uKCBlbGVtZW50LCAndG91Y2hzdGFydCcsIHBhdXNlSGFuZGxlciApO1xuICAgICAgICBvbiggZWxlbWVudCwgJ3RvdWNoZW5kJywgcmVzdW1lSGFuZGxlciApO1xuICAgICAgfVxuICAgIFxuICAgICAgcmlnaHRBcnJvdyAmJiBvbiggcmlnaHRBcnJvdywgY2xpY2tFdmVudCwgY29udHJvbHNIYW5kbGVyICk7XG4gICAgICBsZWZ0QXJyb3cgJiYgb24oIGxlZnRBcnJvdywgY2xpY2tFdmVudCwgY29udHJvbHNIYW5kbGVyICk7XG4gICAgXG4gICAgICBpbmRpY2F0b3IgJiYgb24oIGluZGljYXRvciwgY2xpY2tFdmVudCwgaW5kaWNhdG9ySGFuZGxlciwgZmFsc2UpO1xuICAgICAgdGhpc1trZXlib2FyZF0gPT09IHRydWUgJiYgb24oIGdsb2JhbE9iamVjdCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyLCBmYWxzZSk7XG4gIFxuICAgIH1cbiAgICBpZiAodGhpcy5nZXRBY3RpdmVJbmRleCgpPDApIHtcbiAgICAgIHNsaWRlc1tsZW5ndGhdICYmIGFkZENsYXNzKHNsaWRlc1swXSxhY3RpdmUpO1xuICAgICAgaW5kaWNhdG9yc1tsZW5ndGhdICYmIHNldEFjdGl2ZVBhZ2UoMCk7XG4gICAgfVxuICBcbiAgICBpZiAoIHRoaXNbaW50ZXJ2YWxdICl7IHRoaXMuY3ljbGUoKTsgfVxuICAgIGVsZW1lbnRbc3RyaW5nQ2Fyb3VzZWxdID0gdGhpcztcbiAgfTtcbiAgXG4gIC8vIENBUk9VU0VMIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdDYXJvdXNlbCwgQ2Fyb3VzZWwsIGRhdGFSaWRlICk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQ29sbGFwc2VcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gQ09MTEFQU0UgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09XG4gIHZhciBDb2xsYXBzZSA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zICkge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgXG4gIFxuICAgIC8vIGV2ZW50IHRhcmdldHMgYW5kIGNvbnN0YW50c1xuICAgIHZhciBhY2NvcmRpb24gPSBudWxsLCBjb2xsYXBzZSA9IG51bGwsIHNlbGYgPSB0aGlzLCBcbiAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2UsIC8vIHdoZW4gdHJ1ZSBpdCB3aWxsIHByZXZlbnQgY2xpY2sgaGFuZGxlcnNcbiAgICAgIGFjY29yZGlvbkRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oJ2RhdGEtcGFyZW50JyksXG4gIFxuICAgICAgLy8gY29tcG9uZW50IHN0cmluZ3NcbiAgICAgIGNvbXBvbmVudCA9ICdjb2xsYXBzZScsXG4gICAgICBjb2xsYXBzZWQgPSAnY29sbGFwc2VkJyxcbiAgXG4gICAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICAgIG9wZW5BY3Rpb24gPSBmdW5jdGlvbihjb2xsYXBzZUVsZW1lbnQpIHtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIHNob3dFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgaXNBbmltYXRpbmcgPSB0cnVlO1xuICAgICAgICBhZGRDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG4gICAgICAgIGFkZENsYXNzKGNvbGxhcHNlRWxlbWVudCxpbkNsYXNzKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQoY29sbGFwc2VFbGVtZW50KSArICdweCc7XG4gICAgICAgIH0sIDApO1xuICBcbiAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoY29sbGFwc2VFbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG4gICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gJyc7XG4gICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsJ3RydWUnKTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGNvbGxhcHNlRWxlbWVudCwgc2hvd25FdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgY2xvc2VBY3Rpb24gPSBmdW5jdGlvbihjb2xsYXBzZUVsZW1lbnQpIHtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIGhpZGVFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgaXNBbmltYXRpbmcgPSB0cnVlO1xuICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQoY29sbGFwc2VFbGVtZW50KSArICdweCc7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9ICcwcHgnO1xuICAgICAgICB9LCAwKTtcbiAgXG4gICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKGNvbGxhcHNlRWxlbWVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxpbkNsYXNzKTtcbiAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSAnJztcbiAgICAgICAgICBpc0FuaW1hdGluZyA9IGZhbHNlO1xuICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzZXRBdHRyaWJ1dGVdKGFyaWFFeHBhbmRlZCwnZmFsc2UnKTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGNvbGxhcHNlRWxlbWVudCwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGdldFRhcmdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaHJlZiA9IGVsZW1lbnQuaHJlZiAmJiBlbGVtZW50W2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSxcbiAgICAgICAgICBwYXJlbnQgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCksXG4gICAgICAgICAgaWQgPSBocmVmIHx8ICggcGFyZW50ICYmIC8jLy50ZXN0KHBhcmVudCkgKSAmJiBwYXJlbnQ7XG4gICAgICAgIHJldHVybiBpZCAmJiBxdWVyeUVsZW1lbnQoaWQpO1xuICAgICAgfTtcbiAgICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKGlzQW5pbWF0aW5nKSByZXR1cm47XG4gICAgICBpZiAoIWhhc0NsYXNzKGNvbGxhcHNlLGluQ2xhc3MpKSB7IHNlbGYuc2hvdygpOyB9IFxuICAgICAgZWxzZSB7IHNlbGYuaGlkZSgpOyB9XG4gICAgfTtcbiAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNsb3NlQWN0aW9uKGNvbGxhcHNlKTtcbiAgICAgIGFkZENsYXNzKGVsZW1lbnQsY29sbGFwc2VkKTtcbiAgICB9O1xuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgb3BlbkFjdGlvbihjb2xsYXBzZSk7XG4gICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGNvbGxhcHNlZCk7XG4gIFxuICAgICAgaWYgKCBhY2NvcmRpb24gIT09IG51bGwgKSB7XG4gICAgICAgIHZhciBhY3RpdmVDb2xsYXBzZXMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGFjY29yZGlvbixjb21wb25lbnQrJyAnK2luQ2xhc3MpO1xuICAgICAgICBmb3IgKHZhciBpPTAsIGFsPWFjdGl2ZUNvbGxhcHNlc1tsZW5ndGhdOyBpPGFsOyBpKyspIHtcbiAgICAgICAgICBpZiAoIGFjdGl2ZUNvbGxhcHNlc1tpXSAhPT0gY29sbGFwc2UpIGNsb3NlQWN0aW9uKGFjdGl2ZUNvbGxhcHNlc1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ0NvbGxhcHNlIGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIHRoaXMudG9nZ2xlKTtcbiAgICB9XG4gICAgY29sbGFwc2UgPSBnZXRUYXJnZXQoKTtcbiAgICBhY2NvcmRpb24gPSBxdWVyeUVsZW1lbnQob3B0aW9ucy5wYXJlbnQpIHx8IGFjY29yZGlvbkRhdGEgJiYgZ2V0Q2xvc2VzdChlbGVtZW50LCBhY2NvcmRpb25EYXRhKTtcbiAgICBlbGVtZW50W3N0cmluZ0NvbGxhcHNlXSA9IHRoaXM7XG4gIH07XG4gIFxuICAvLyBDT0xMQVBTRSBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdDb2xsYXBzZSwgQ29sbGFwc2UsIGRhdGFUb2dnbGUpO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IERyb3Bkb3duXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gRFJPUERPV04gREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09XG4gIHZhciBEcm9wZG93biA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb24gKSB7XG4gICAgICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gc2V0IG9wdGlvblxuICAgIHRoaXMucGVyc2lzdCA9IG9wdGlvbiA9PT0gdHJ1ZSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oJ2RhdGEtcGVyc2lzdCcpID09PSAndHJ1ZScgfHwgZmFsc2U7XG4gIFxuICAgIC8vIGNvbnN0YW50cywgZXZlbnQgdGFyZ2V0cywgc3RyaW5nc1xuICAgIHZhciBzZWxmID0gdGhpcywgaXNPcGVuID0gZmFsc2UsXG4gICAgICBwYXJlbnQgPSBlbGVtZW50W3BhcmVudE5vZGVdLFxuICAgICAgY29tcG9uZW50ID0gJ2Ryb3Bkb3duJywgb3BlbiA9ICdvcGVuJyxcbiAgICAgIHJlbGF0ZWRUYXJnZXQgPSBudWxsLFxuICAgICAgbWVudSA9IHF1ZXJ5RWxlbWVudCgnLmRyb3Bkb3duLW1lbnUnLCBwYXJlbnQpLFxuICAgICAgY2hpbGRyZW4gPSBub2RlTGlzdFRvQXJyYXkoIG1lbnVbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKCcqJykpLFxuICBcbiAgICAgIC8vIGhhbmRsZXJzXG4gICAgICBrZXlIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoaXNPcGVuICYmIChlLndoaWNoID09IDI3IHx8IGUua2V5Q29kZSA9PSAyNykpIHsgcmVsYXRlZFRhcmdldCA9IG51bGw7IGhpZGUoKTsgfSAvLyBlLmtleUNvZGUgZm9yIElFOFxuICAgICAgfSxcbiAgICAgIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZVt0YXJnZXRdLCBoYXNEYXRhO1xuICAgICAgICBoYXNEYXRhID0gKCBldmVudFRhcmdldC5ub2RlVHlwZSAhPT0gMSAmJiAoZXZlbnRUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhVG9nZ2xlKSB8fCBldmVudFRhcmdldFtwYXJlbnROb2RlXVtnZXRBdHRyaWJ1dGVdKGRhdGFUb2dnbGUpKSApO1xuICAgICAgICBpZiAoIGV2ZW50VGFyZ2V0ID09PSBlbGVtZW50IHx8IGV2ZW50VGFyZ2V0ID09PSBwYXJlbnQgfHwgZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV0gPT09IGVsZW1lbnQgKSB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBjb21tZW50IHRoaXMgbGluZSB0byBzdG9wIHByZXZlbnRpbmcgbmF2aWdhdGlvbiB3aGVuIGNsaWNrIHRhcmdldCBpcyBhIGxpbmsgXG4gICAgICAgICAgcmVsYXRlZFRhcmdldCA9IGVsZW1lbnQ7XG4gICAgICAgICAgc2VsZi50b2dnbGUoKTtcbiAgICAgICAgfSBlbHNlIGlmICggaXNPcGVuICkge1xuICAgICAgICAgIGlmICggKGV2ZW50VGFyZ2V0ID09PSBtZW51IHx8IGNoaWxkcmVuICYmIGNoaWxkcmVuW2luZGV4T2ZdKGV2ZW50VGFyZ2V0KSA+IC0xKSAmJiAoIHNlbGYucGVyc2lzdCB8fCBoYXNEYXRhICkgKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIHsgcmVsYXRlZFRhcmdldCA9IG51bGw7IGhpZGUoKTsgfVxuICAgICAgICB9XG4gICAgICAgICgvXFwjJC8udGVzdChldmVudFRhcmdldC5ocmVmKSB8fCBldmVudFRhcmdldFtwYXJlbnROb2RlXSAmJiAvXFwjJC8udGVzdChldmVudFRhcmdldFtwYXJlbnROb2RlXS5ocmVmKSkgJiYgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBzaG91bGQgYmUgaGVyZSB0byBwcmV2ZW50IGp1bXBzXG4gICAgICB9LFxuICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgICBzaG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG4gICAgICAgIGFkZENsYXNzKHBhcmVudCxvcGVuKTtcbiAgICAgICAgbWVudVtzZXRBdHRyaWJ1dGVdKGFyaWFFeHBhbmRlZCx0cnVlKTtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChwYXJlbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG4gICAgICAgIG9uKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuICAgICAgICBpc09wZW4gPSB0cnVlO1xuICAgICAgfSxcbiAgICAgIGhpZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChwYXJlbnQsIGhpZGVFdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcbiAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50LG9wZW4pO1xuICAgICAgICBtZW51W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLGZhbHNlKTtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChwYXJlbnQsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuICAgICAgICBvZmYoZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG4gICAgICAgIGlzT3BlbiA9IGZhbHNlO1xuICAgICAgfTtcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICB0aGlzLnRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGhhc0NsYXNzKHBhcmVudCxvcGVuKSAmJiBpc09wZW4pIHsgaGlkZSgpOyB9IFxuICAgICAgZWxzZSB7IHNob3coKTsgfVxuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nRHJvcGRvd24gaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBtZW51W3NldEF0dHJpYnV0ZV0oJ3RhYmluZGV4JywgJzAnKTsgLy8gRml4IG9uYmx1ciBvbiBDaHJvbWUgfCBTYWZhcmlcbiAgICAgIG9uKGRvY3VtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuICAgIH1cbiAgICBlbGVtZW50W3N0cmluZ0Ryb3Bkb3duXSA9IHRoaXM7XG4gIH07XG4gIFxuICAvLyBEUk9QRE9XTiBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nRHJvcGRvd24sIERyb3Bkb3duLCBkYXRhVG9nZ2xlICk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgTW9kYWxcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gICAgXG4gIC8vIE1PREFMIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09XG4gIHZhciBNb2RhbCA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHsgLy8gZWxlbWVudCBjYW4gYmUgdGhlIG1vZGFsL3RyaWdnZXJpbmcgYnV0dG9uXG4gIFxuICAgIC8vIHRoZSBtb2RhbCAoYm90aCBKYXZhU2NyaXB0IC8gREFUQSBBUEkgaW5pdCkgLyB0cmlnZ2VyaW5nIGJ1dHRvbiBlbGVtZW50IChEQVRBIEFQSSlcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBkZXRlcm1pbmUgbW9kYWwsIHRyaWdnZXJpbmcgZWxlbWVudCBcbiAgICB2YXIgYnRuQ2hlY2sgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCl8fGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnaHJlZicpLFxuICAgICAgY2hlY2tNb2RhbCA9IHF1ZXJ5RWxlbWVudCggYnRuQ2hlY2sgKSxcbiAgICAgIG1vZGFsID0gaGFzQ2xhc3MoZWxlbWVudCwnbW9kYWwnKSA/IGVsZW1lbnQgOiBjaGVja01vZGFsLFxuICBcbiAgICAgIC8vIHN0cmluZ3NcbiAgICAgIGNvbXBvbmVudCA9ICdtb2RhbCcsXG4gICAgICBzdGF0aWNTdHJpbmcgPSAnc3RhdGljJyxcbiAgICAgIHBhZGRpbmdMZWZ0ID0gJ3BhZGRpbmdMZWZ0JyxcbiAgICAgIHBhZGRpbmdSaWdodCA9ICdwYWRkaW5nUmlnaHQnLFxuICAgICAgbW9kYWxCYWNrZHJvcFN0cmluZyA9ICdtb2RhbC1iYWNrZHJvcCc7XG4gIFxuICAgIGlmICggaGFzQ2xhc3MoZWxlbWVudCwnbW9kYWwnKSApIHsgZWxlbWVudCA9IG51bGw7IH0gLy8gbW9kYWwgaXMgbm93IGluZGVwZW5kZW50IG9mIGl0J3MgdHJpZ2dlcmluZyBlbGVtZW50XG4gIFxuICAgIGlmICggIW1vZGFsICkgeyByZXR1cm47IH0gLy8gaW52YWxpZGF0ZVxuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBcbiAgICB0aGlzW2tleWJvYXJkXSA9IG9wdGlvbnNba2V5Ym9hcmRdID09PSBmYWxzZSB8fCBtb2RhbFtnZXRBdHRyaWJ1dGVdKGRhdGFLZXlib2FyZCkgPT09ICdmYWxzZScgPyBmYWxzZSA6IHRydWU7XG4gICAgdGhpc1tiYWNrZHJvcF0gPSBvcHRpb25zW2JhY2tkcm9wXSA9PT0gc3RhdGljU3RyaW5nIHx8IG1vZGFsW2dldEF0dHJpYnV0ZV0oZGF0YWJhY2tkcm9wKSA9PT0gc3RhdGljU3RyaW5nID8gc3RhdGljU3RyaW5nIDogdHJ1ZTtcbiAgICB0aGlzW2JhY2tkcm9wXSA9IG9wdGlvbnNbYmFja2Ryb3BdID09PSBmYWxzZSB8fCBtb2RhbFtnZXRBdHRyaWJ1dGVdKGRhdGFiYWNrZHJvcCkgPT09ICdmYWxzZScgPyBmYWxzZSA6IHRoaXNbYmFja2Ryb3BdO1xuICAgIHRoaXNbY29udGVudF0gID0gb3B0aW9uc1tjb250ZW50XTsgLy8gSmF2YVNjcmlwdCBvbmx5XG4gIFxuICAgIC8vIGJpbmQsIGNvbnN0YW50cywgZXZlbnQgdGFyZ2V0cyBhbmQgb3RoZXIgdmFyc1xuICAgIHZhciBzZWxmID0gdGhpcywgb3BlbiA9IHRoaXMub3BlbiA9IGZhbHNlLCByZWxhdGVkVGFyZ2V0ID0gbnVsbCxcbiAgICAgIGJvZHlJc092ZXJmbG93aW5nLCBtb2RhbElzT3ZlcmZsb3dpbmcsIHNjcm9sbGJhcldpZHRoLCBvdmVybGF5LFxuICBcbiAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgICAgZ2V0V2luZG93V2lkdGggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGh0bWxSZWN0ID0gZG9jW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKTtcbiAgICAgICAgcmV0dXJuIGdsb2JhbE9iamVjdFtpbm5lcldpZHRoXSB8fCAoaHRtbFJlY3RbcmlnaHRdIC0gTWF0aC5hYnMoaHRtbFJlY3RbbGVmdF0pKTtcbiAgICAgIH0sXG4gICAgICBzZXRTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBib2R5U3R5bGUgPSBib2R5LmN1cnJlbnRTdHlsZSB8fCBnbG9iYWxPYmplY3QuZ2V0Q29tcHV0ZWRTdHlsZShib2R5KSwgYm9keVBhZCA9IHBhcnNlSW50KChib2R5U3R5bGVbcGFkZGluZ1JpZ2h0XSksIDEwKTtcbiAgICAgICAgaWYgKGJvZHlJc092ZXJmbG93aW5nKSB7IGJvZHlbc3R5bGVdW3BhZGRpbmdSaWdodF0gPSAoYm9keVBhZCArIHNjcm9sbGJhcldpZHRoKSArICdweCc7IH1cbiAgICAgIH0sXG4gICAgICByZXNldFNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYm9keVtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9ICcnO1xuICAgICAgfSxcbiAgICAgIG1lYXN1cmVTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7IC8vIHRoeCB3YWxzaFxuICAgICAgICB2YXIgc2Nyb2xsRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksIHNjcm9sbEJhcldpZHRoO1xuICAgICAgICBzY3JvbGxEaXYuY2xhc3NOYW1lID0gY29tcG9uZW50Kyctc2Nyb2xsYmFyLW1lYXN1cmUnOyAvLyB0aGlzIGlzIGhlcmUgdG8gc3RheVxuICAgICAgICBib2R5LmFwcGVuZENoaWxkKHNjcm9sbERpdik7XG4gICAgICAgIHNjcm9sbEJhcldpZHRoID0gc2Nyb2xsRGl2W29mZnNldFdpZHRoXSAtIHNjcm9sbERpdltjbGllbnRXaWR0aF07XG4gICAgICAgIGJvZHkucmVtb3ZlQ2hpbGQoc2Nyb2xsRGl2KTtcbiAgICAgICAgcmV0dXJuIHNjcm9sbEJhcldpZHRoO1xuICAgICAgfSxcbiAgICAgIGNoZWNrU2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBib2R5SXNPdmVyZmxvd2luZyA9IGJvZHlbY2xpZW50V2lkdGhdIDwgZ2V0V2luZG93V2lkdGgoKTtcbiAgICAgICAgbW9kYWxJc092ZXJmbG93aW5nID0gbW9kYWxbc2Nyb2xsSGVpZ2h0XSA+IGRvY1tjbGllbnRIZWlnaHRdO1xuICAgICAgICBzY3JvbGxiYXJXaWR0aCA9IG1lYXN1cmVTY3JvbGxiYXIoKTtcbiAgICAgIH0sXG4gICAgICBhZGp1c3REaWFsb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nTGVmdF0gPSAhYm9keUlzT3ZlcmZsb3dpbmcgJiYgbW9kYWxJc092ZXJmbG93aW5nID8gc2Nyb2xsYmFyV2lkdGggKyAncHgnIDogJyc7XG4gICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gYm9keUlzT3ZlcmZsb3dpbmcgJiYgIW1vZGFsSXNPdmVyZmxvd2luZyA/IHNjcm9sbGJhcldpZHRoICsgJ3B4JyA6ICcnO1xuICAgICAgfSxcbiAgICAgIHJlc2V0QWRqdXN0bWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nTGVmdF0gPSAnJztcbiAgICAgICAgbW9kYWxbc3R5bGVdW3BhZGRpbmdSaWdodF0gPSAnJztcbiAgICAgIH0sXG4gICAgICBjcmVhdGVPdmVybGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBuZXdPdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIG92ZXJsYXkgPSBxdWVyeUVsZW1lbnQoJy4nK21vZGFsQmFja2Ryb3BTdHJpbmcpO1xuICBcbiAgICAgICAgaWYgKCBvdmVybGF5ID09PSBudWxsICkge1xuICAgICAgICAgIG5ld092ZXJsYXlbc2V0QXR0cmlidXRlXSgnY2xhc3MnLG1vZGFsQmFja2Ryb3BTdHJpbmcrJyBmYWRlJyk7XG4gICAgICAgICAgb3ZlcmxheSA9IG5ld092ZXJsYXk7XG4gICAgICAgICAgYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlbW92ZU92ZXJsYXkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgb3ZlcmxheSA9IHF1ZXJ5RWxlbWVudCgnLicrbW9kYWxCYWNrZHJvcFN0cmluZyk7IFxuICAgICAgICBpZiAoIG92ZXJsYXkgJiYgb3ZlcmxheSAhPT0gbnVsbCAmJiB0eXBlb2Ygb3ZlcmxheSA9PT0gJ29iamVjdCcgKSB7XG4gICAgICAgICAgYm9keS5yZW1vdmVDaGlsZChvdmVybGF5KTsgb3ZlcmxheSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBrZXlkb3duSGFuZGxlclRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIWhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7XG4gICAgICAgICAgb24oZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2ZmKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVzaXplSGFuZGxlclRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIWhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7XG4gICAgICAgICAgb24oZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgc2VsZi51cGRhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9mZihnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLnVwZGF0ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkaXNtaXNzSGFuZGxlclRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIWhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7XG4gICAgICAgICAgb24obW9kYWwsIGNsaWNrRXZlbnQsIGRpc21pc3NIYW5kbGVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvZmYobW9kYWwsIGNsaWNrRXZlbnQsIGRpc21pc3NIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIGhhbmRsZXJzXG4gICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBjbGlja1RhcmdldCA9IGVbdGFyZ2V0XTsgXG4gICAgICAgIGNsaWNrVGFyZ2V0ID0gY2xpY2tUYXJnZXRbaGFzQXR0cmlidXRlXShkYXRhVGFyZ2V0KSB8fCBjbGlja1RhcmdldFtoYXNBdHRyaWJ1dGVdKCdocmVmJykgPyBjbGlja1RhcmdldCA6IGNsaWNrVGFyZ2V0W3BhcmVudE5vZGVdO1xuICAgICAgICBpZiAoICFvcGVuICYmIGNsaWNrVGFyZ2V0ID09PSBlbGVtZW50ICYmICFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSApIHtcbiAgICAgICAgICBtb2RhbC5tb2RhbFRyaWdnZXIgPSBlbGVtZW50O1xuICAgICAgICAgIHJlbGF0ZWRUYXJnZXQgPSBlbGVtZW50O1xuICAgICAgICAgIHNlbGYuc2hvdygpO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBrZXkgPSBlLndoaWNoIHx8IGUua2V5Q29kZTsgLy8ga2V5Q29kZSBmb3IgSUU4XG4gICAgICAgIGlmIChzZWxmW2tleWJvYXJkXSAmJiBrZXkgPT0gMjcgJiYgb3Blbikge1xuICAgICAgICAgIHNlbGYuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGlzbWlzc0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBjbGlja1RhcmdldCA9IGVbdGFyZ2V0XTtcbiAgICAgICAgaWYgKCBvcGVuICYmIChjbGlja1RhcmdldFtwYXJlbnROb2RlXVtnZXRBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSA9PT0gY29tcG9uZW50IFxuICAgICAgICAgICAgfHwgY2xpY2tUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhRGlzbWlzcykgPT09IGNvbXBvbmVudFxuICAgICAgICAgICAgfHwgKGNsaWNrVGFyZ2V0ID09PSBtb2RhbCAmJiBzZWxmW2JhY2tkcm9wXSAhPT0gc3RhdGljU3RyaW5nKSApICkge1xuICAgICAgICAgIHNlbGYuaGlkZSgpOyByZWxhdGVkVGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChvcGVuICYmIGhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7dGhpcy5oaWRlKCk7fSBlbHNlIHt0aGlzLnNob3coKTt9XG4gICAgfTtcbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHtcbiAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIHNob3dFdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcbiAgXG4gICAgICAvLyB3ZSBlbGVnYW50bHkgaGlkZSBhbnkgb3BlbmVkIG1vZGFsXG4gICAgICB2YXIgY3VycmVudE9wZW4gPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGRvY3VtZW50LGNvbXBvbmVudCsnIGluJylbMF07XG4gICAgICBjdXJyZW50T3BlbiAmJiBjdXJyZW50T3BlbiAhPT0gbW9kYWwgJiYgY3VycmVudE9wZW4ubW9kYWxUcmlnZ2VyW3N0cmluZ01vZGFsXS5oaWRlKCk7IFxuICBcbiAgICAgIGlmICggdGhpc1tiYWNrZHJvcF0gKSB7XG4gICAgICAgIGNyZWF0ZU92ZXJsYXkoKTtcbiAgICAgIH1cbiAgXG4gICAgICBpZiAoIG92ZXJsYXkgJiYgIWhhc0NsYXNzKG92ZXJsYXksaW5DbGFzcykpIHtcbiAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7IGFkZENsYXNzKG92ZXJsYXksaW5DbGFzcyk7IH0sIDApO1xuICAgICAgfVxuICBcbiAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBtb2RhbFtzdHlsZV0uZGlzcGxheSA9ICdibG9jayc7XG4gIFxuICAgICAgICBjaGVja1Njcm9sbGJhcigpO1xuICAgICAgICBzZXRTY3JvbGxiYXIoKTtcbiAgICAgICAgYWRqdXN0RGlhbG9nKCk7XG4gIFxuICAgICAgICByZXNpemVIYW5kbGVyVG9nZ2xlKCk7XG4gICAgICAgIGRpc21pc3NIYW5kbGVyVG9nZ2xlKCk7XG4gICAgICAgIGtleWRvd25IYW5kbGVyVG9nZ2xlKCk7XG4gIFxuICAgICAgICBhZGRDbGFzcyhib2R5LGNvbXBvbmVudCsnLW9wZW4nKTtcbiAgICAgICAgYWRkQ2xhc3MobW9kYWwsaW5DbGFzcyk7XG4gICAgICAgIG1vZGFsW3NldEF0dHJpYnV0ZV0oYXJpYUhpZGRlbiwgZmFsc2UpO1xuICAgICAgfSwgMCk7XG4gIFxuICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQobW9kYWwsIGZ1bmN0aW9uKCkge1xuICAgICAgICBvcGVuID0gc2VsZi5vcGVuID0gdHJ1ZTtcbiAgICAgICAgc2V0Rm9jdXMobW9kYWwpO1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBzaG93bkV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIGhpZGVFdmVudCwgY29tcG9uZW50KTtcbiAgICAgIG92ZXJsYXkgPSBxdWVyeUVsZW1lbnQoJy4nK21vZGFsQmFja2Ryb3BTdHJpbmcpO1xuICBcbiAgICAgIGlmICggb3ZlcmxheSAhPT0gbnVsbCApIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3Mob3ZlcmxheSxpbkNsYXNzKTtcbiAgICAgIH1cbiAgICAgIHJlbW92ZUNsYXNzKG1vZGFsLGluQ2xhc3MpO1xuICAgICAgbW9kYWxbc2V0QXR0cmlidXRlXShhcmlhSGlkZGVuLCB0cnVlKTtcbiAgXG4gICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChtb2RhbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKGJvZHksY29tcG9uZW50Kyctb3BlbicpO1xuICAgICAgICByZXNpemVIYW5kbGVyVG9nZ2xlKCk7XG4gICAgICAgIGRpc21pc3NIYW5kbGVyVG9nZ2xlKCk7XG4gICAgICAgIGtleWRvd25IYW5kbGVyVG9nZ2xlKCk7XG4gIFxuICAgICAgICByZXNldEFkanVzdG1lbnRzKCk7XG4gICAgICAgIHJlc2V0U2Nyb2xsYmFyKCk7XG4gICAgICAgIG1vZGFsW3N0eWxlXS5kaXNwbGF5ID0gJyc7XG4gIFxuICAgICAgICBpZiAoIWdldEVsZW1lbnRzQnlDbGFzc05hbWUoZG9jdW1lbnQsY29tcG9uZW50KycgJytpbkNsYXNzKVswXSkgeyByZW1vdmVPdmVybGF5KCk7IH1cbiAgICAgICAgb3BlbiA9IHNlbGYub3BlbiA9IGZhbHNlO1xuICAgICAgICBlbGVtZW50ICYmIChzZXRGb2N1cyhlbGVtZW50KSk7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICB0aGlzLnNldENvbnRlbnQgPSBmdW5jdGlvbiggY29udGVudCApIHtcbiAgICAgIHF1ZXJ5RWxlbWVudCgnLicrY29tcG9uZW50KyctY29udGVudCcsbW9kYWwpLmlubmVySFRNTCA9IGNvbnRlbnQ7XG4gICAgfTtcbiAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKG9wZW4pIHtcbiAgICAgICAgY2hlY2tTY3JvbGxiYXIoKTtcbiAgICAgICAgc2V0U2Nyb2xsYmFyKCk7XG4gICAgICAgIGFkanVzdERpYWxvZygpO1xuICAgICAgfVxuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyBvdmVyIGFuZCBvdmVyXG4gICAgLy8gbW9kYWwgaXMgaW5kZXBlbmRlbnQgb2YgYSB0cmlnZ2VyaW5nIGVsZW1lbnQgXG4gICAgaWYgKCAhIWVsZW1lbnQgJiYgIShzdHJpbmdNb2RhbCBpbiBlbGVtZW50KSApIHtcbiAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7XG4gICAgfVxuICAgIGlmICggISF0aGlzW2NvbnRlbnRdICkgeyB0aGlzLnNldENvbnRlbnQoIHRoaXNbY29udGVudF0gKTsgfVxuICAgICEhZWxlbWVudCAmJiAoZWxlbWVudFtzdHJpbmdNb2RhbF0gPSB0aGlzKTtcbiAgfTtcbiAgXG4gIC8vIERBVEEgQVBJXG4gIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ01vZGFsLCBNb2RhbCwgZGF0YVRvZ2dsZSk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgUG9wb3ZlclxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIFBPUE9WRVIgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT1cbiAgdmFyIFBvcG92ZXIgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIERBVEEgQVBJXG4gICAgdmFyIHRyaWdnZXJEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUcmlnZ2VyKSwgLy8gY2xpY2sgLyBob3ZlciAvIGZvY3VzXG4gICAgICAgIGFuaW1hdGlvbkRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUFuaW1hdGlvbiksIC8vIHRydWUgLyBmYWxzZVxuICAgICAgICBwbGFjZW1lbnREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFQbGFjZW1lbnQpLFxuICAgICAgICBkaXNtaXNzaWJsZURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YURpc21pc3NpYmxlKSxcbiAgICAgICAgZGVsYXlEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEZWxheSksXG4gICAgICAgIGNvbnRhaW5lckRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUNvbnRhaW5lciksXG4gIFxuICAgICAgICAvLyBpbnRlcm5hbCBzdHJpbmdzXG4gICAgICAgIGNvbXBvbmVudCA9ICdwb3BvdmVyJyxcbiAgICAgICAgdGVtcGxhdGUgPSAndGVtcGxhdGUnLFxuICAgICAgICB0cmlnZ2VyID0gJ3RyaWdnZXInLFxuICAgICAgICBjbGFzc1N0cmluZyA9ICdjbGFzcycsXG4gICAgICAgIGRpdiA9ICdkaXYnLFxuICAgICAgICBmYWRlID0gJ2ZhZGUnLFxuICAgICAgICB0aXRsZSA9ICd0aXRsZScsXG4gICAgICAgIGNvbnRlbnQgPSAnY29udGVudCcsXG4gICAgICAgIGRhdGFUaXRsZSA9ICdkYXRhLXRpdGxlJyxcbiAgICAgICAgZGF0YUNvbnRlbnQgPSAnZGF0YS1jb250ZW50JyxcbiAgICAgICAgZGlzbWlzc2libGUgPSAnZGlzbWlzc2libGUnLFxuICAgICAgICBjbG9zZUJ0biA9ICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCI+w5c8L2J1dHRvbj4nO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIHRoaXNbdGVtcGxhdGVdID0gb3B0aW9uc1t0ZW1wbGF0ZV0gPyBvcHRpb25zW3RlbXBsYXRlXSA6IG51bGw7IC8vIEphdmFTY3JpcHQgb25seVxuICAgIHRoaXNbdHJpZ2dlcl0gPSBvcHRpb25zW3RyaWdnZXJdID8gb3B0aW9uc1t0cmlnZ2VyXSA6IHRyaWdnZXJEYXRhIHx8IGhvdmVyRXZlbnQ7XG4gICAgdGhpc1thbmltYXRpb25dID0gb3B0aW9uc1thbmltYXRpb25dICYmIG9wdGlvbnNbYW5pbWF0aW9uXSAhPT0gZmFkZSA/IG9wdGlvbnNbYW5pbWF0aW9uXSA6IGFuaW1hdGlvbkRhdGEgfHwgZmFkZTtcbiAgICB0aGlzW3BsYWNlbWVudF0gPSBvcHRpb25zW3BsYWNlbWVudF0gPyBvcHRpb25zW3BsYWNlbWVudF0gOiBwbGFjZW1lbnREYXRhIHx8IHRvcDtcbiAgICB0aGlzW2RlbGF5XSA9IHBhcnNlSW50KG9wdGlvbnNbZGVsYXldIHx8IGRlbGF5RGF0YSkgfHwgMjAwO1xuICAgIHRoaXNbZGlzbWlzc2libGVdID0gb3B0aW9uc1tkaXNtaXNzaWJsZV0gfHwgZGlzbWlzc2libGVEYXRhID09PSAndHJ1ZScgPyB0cnVlIDogZmFsc2U7XG4gICAgdGhpc1tjb250YWluZXJdID0gcXVlcnlFbGVtZW50KG9wdGlvbnNbY29udGFpbmVyXSkgfHwgcXVlcnlFbGVtZW50KGNvbnRhaW5lckRhdGEpIHx8IGJvZHk7XG4gICAgXG4gICAgLy8gYmluZCwgY29udGVudFxuICAgIHZhciBzZWxmID0gdGhpcywgXG4gICAgICB0aXRsZVN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGl0bGUpIHx8IG51bGwsXG4gICAgICBjb250ZW50U3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250ZW50KSB8fCBudWxsO1xuICBcbiAgICBpZiAoICFjb250ZW50U3RyaW5nICYmICF0aGlzW3RlbXBsYXRlXSApIHJldHVybjsgLy8gaW52YWxpZGF0ZVxuICBcbiAgICAvLyBjb25zdGFudHMsIHZhcnNcbiAgICB2YXIgcG9wb3ZlciA9IG51bGwsIHRpbWVyID0gMCwgcGxhY2VtZW50U2V0dGluZyA9IHRoaXNbcGxhY2VtZW50XSxcbiAgICAgIFxuICAgICAgLy8gaGFuZGxlcnNcbiAgICAgIGRpc21pc3NpYmxlSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKHBvcG92ZXIgIT09IG51bGwgJiYgZVt0YXJnZXRdID09PSBxdWVyeUVsZW1lbnQoJy5jbG9zZScscG9wb3ZlcikpIHtcbiAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgXG4gICAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICAgIHJlbW92ZVBvcG92ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZltjb250YWluZXJdLnJlbW92ZUNoaWxkKHBvcG92ZXIpO1xuICAgICAgICB0aW1lciA9IG51bGw7IHBvcG92ZXIgPSBudWxsOyBcbiAgICAgIH0sXG4gICAgICBjcmVhdGVQb3BvdmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUaXRsZSk7IC8vIGNoZWNrIGNvbnRlbnQgYWdhaW5cbiAgICAgICAgY29udGVudFN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGVudCk7XG4gIFxuICAgICAgICBwb3BvdmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuICBcbiAgICAgICAgaWYgKCBjb250ZW50U3RyaW5nICE9PSBudWxsICYmIHNlbGZbdGVtcGxhdGVdID09PSBudWxsICkgeyAvL2NyZWF0ZSB0aGUgcG9wb3ZlciBmcm9tIGRhdGEgYXR0cmlidXRlc1xuICBcbiAgICAgICAgICBwb3BvdmVyW3NldEF0dHJpYnV0ZV0oJ3JvbGUnLCd0b29sdGlwJyk7XG4gIFxuICAgICAgICAgIGlmICh0aXRsZVN0cmluZyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdmFyIHBvcG92ZXJUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgICAgICAgICBwb3BvdmVyVGl0bGVbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZyxjb21wb25lbnQrJy10aXRsZScpO1xuICBcbiAgICAgICAgICAgIHBvcG92ZXJUaXRsZS5pbm5lckhUTUwgPSBzZWxmW2Rpc21pc3NpYmxlXSA/IHRpdGxlU3RyaW5nICsgY2xvc2VCdG4gOiB0aXRsZVN0cmluZztcbiAgICAgICAgICAgIHBvcG92ZXIuYXBwZW5kQ2hpbGQocG9wb3ZlclRpdGxlKTtcbiAgICAgICAgICB9XG4gIFxuICAgICAgICAgIHZhciBwb3BvdmVyQXJyb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdiksIHBvcG92ZXJDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuICAgICAgICAgIHBvcG92ZXJBcnJvd1tzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCdhcnJvdycpOyBwb3BvdmVyQ29udGVudFtzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLGNvbXBvbmVudCsnLWNvbnRlbnQnKTtcbiAgICAgICAgICBwb3BvdmVyLmFwcGVuZENoaWxkKHBvcG92ZXJBcnJvdyk7IHBvcG92ZXIuYXBwZW5kQ2hpbGQocG9wb3ZlckNvbnRlbnQpO1xuICBcbiAgICAgICAgICAvL3NldCBwb3BvdmVyIGNvbnRlbnRcbiAgICAgICAgICBwb3BvdmVyQ29udGVudC5pbm5lckhUTUwgPSBzZWxmW2Rpc21pc3NpYmxlXSAmJiB0aXRsZVN0cmluZyA9PT0gbnVsbCA/IGNvbnRlbnRTdHJpbmcgKyBjbG9zZUJ0biA6IGNvbnRlbnRTdHJpbmc7XG4gIFxuICAgICAgICB9IGVsc2UgeyAgLy8gb3IgY3JlYXRlIHRoZSBwb3BvdmVyIGZyb20gdGVtcGxhdGVcbiAgICAgICAgICB2YXIgcG9wb3ZlclRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuICAgICAgICAgIHBvcG92ZXJUZW1wbGF0ZS5pbm5lckhUTUwgPSBzZWxmW3RlbXBsYXRlXTtcbiAgICAgICAgICBwb3BvdmVyLmlubmVySFRNTCA9IHBvcG92ZXJUZW1wbGF0ZS5maXJzdENoaWxkLmlubmVySFRNTDtcbiAgICAgICAgfVxuICBcbiAgICAgICAgLy9hcHBlbmQgdG8gdGhlIGNvbnRhaW5lclxuICAgICAgICBzZWxmW2NvbnRhaW5lcl0uYXBwZW5kQ2hpbGQocG9wb3Zlcik7XG4gICAgICAgIHBvcG92ZXJbc3R5bGVdLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICBwb3BvdmVyW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsIGNvbXBvbmVudCsgJyAnICsgcGxhY2VtZW50U2V0dGluZyArICcgJyArIHNlbGZbYW5pbWF0aW9uXSk7XG4gICAgICB9LFxuICAgICAgc2hvd1BvcG92ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICFoYXNDbGFzcyhwb3BvdmVyLGluQ2xhc3MpICYmICggYWRkQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSApO1xuICAgICAgfSxcbiAgICAgIHVwZGF0ZVBvcG92ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc3R5bGVUaXAoZWxlbWVudCxwb3BvdmVyLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTtcbiAgICAgICAgaWYgKCFpc0VsZW1lbnRJblZpZXdwb3J0KHBvcG92ZXIpICkgeyBcbiAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gdXBkYXRlUGxhY2VtZW50KHBsYWNlbWVudFNldHRpbmcpOyBcbiAgICAgICAgICBzdHlsZVRpcChlbGVtZW50LHBvcG92ZXIscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pOyBcbiAgICAgICAgfVxuICAgICAgfTtcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZHMgLyBoYW5kbGVyc1xuICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAocG9wb3ZlciA9PT0gbnVsbCkgeyBzZWxmLnNob3coKTsgfSBcbiAgICAgIGVsc2UgeyBzZWxmLmhpZGUoKTsgfVxuICAgIH07XG4gICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHBvcG92ZXIgPT09IG51bGwpIHtcbiAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gc2VsZltwbGFjZW1lbnRdOyAvLyB3ZSByZXNldCBwbGFjZW1lbnQgaW4gYWxsIGNhc2VzXG4gICAgICAgICAgY3JlYXRlUG9wb3ZlcigpO1xuICAgICAgICAgIHVwZGF0ZVBvcG92ZXIoKTtcbiAgICAgICAgICBzaG93UG9wb3ZlcigpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2hvd0V2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHBvcG92ZXIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCAyMCApO1xuICAgIH07XG4gICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHBvcG92ZXIgJiYgcG9wb3ZlciAhPT0gbnVsbCAmJiBoYXNDbGFzcyhwb3BvdmVyLGluQ2xhc3MpKSB7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MocG9wb3ZlcixpbkNsYXNzKTtcbiAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChwb3BvdmVyLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJlbW92ZVBvcG92ZXIoKTtcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sIHNlbGZbZGVsYXldICk7XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdQb3BvdmVyIGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgaWYgKHNlbGZbdHJpZ2dlcl0gPT09IGhvdmVyRXZlbnQpIHtcbiAgICAgICAgb24oIGVsZW1lbnQsIG1vdXNlSG92ZXJbMF0sIHNlbGYuc2hvdyApO1xuICAgICAgICBpZiAoIXNlbGZbZGlzbWlzc2libGVdKSB7IG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzFdLCBzZWxmLmhpZGUgKTsgfVxuICAgICAgfSBlbHNlIGlmICgvXihjbGlja3xmb2N1cykkLy50ZXN0KHNlbGZbdHJpZ2dlcl0pKSB7XG4gICAgICAgIG9uKCBlbGVtZW50LCBzZWxmW3RyaWdnZXJdLCBzZWxmLnRvZ2dsZSApO1xuICAgICAgICBpZiAoIXNlbGZbZGlzbWlzc2libGVdKSB7IG9uKCBlbGVtZW50LCAnYmx1cicsIHNlbGYuaGlkZSApOyB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZG9jdW1lbnQsIGNsaWNrRXZlbnQsIGRpc21pc3NpYmxlSGFuZGxlciApOyB9XG4gICAgXG4gICAgICAvLyBkaXNtaXNzIG9uIHdpbmRvdyByZXNpemVcbiAgICAgIGlmICggIShpc0lFICYmIGlzSUUgPCA5KSApIHsgb24oIGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIHNlbGYuaGlkZSApOyB9XG4gIFxuICAgIH1cbiAgICBlbGVtZW50W3N0cmluZ1BvcG92ZXJdID0gc2VsZjtcbiAgfTtcbiAgXG4gIC8vIFBPUE9WRVIgREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdQb3BvdmVyLCBQb3BvdmVyLCBkYXRhVG9nZ2xlKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBTY3JvbGxTcHlcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gU0NST0xMU1BZIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT1cbiAgdmFyIFNjcm9sbFNweSA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudCwgdGhlIGVsZW1lbnQgd2Ugc3B5IG9uXG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTsgXG4gIFxuICAgIC8vIERBVEEgQVBJXG4gICAgdmFyIHRhcmdldERhdGEgPSBxdWVyeUVsZW1lbnQoZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpKTtcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBpZiAoICFvcHRpb25zW3RhcmdldF0gJiYgIXRhcmdldERhdGEgKSB7IHJldHVybjsgfSAvLyBpbnZhbGlkYXRlXG4gIFxuICAgIC8vIGV2ZW50IHRhcmdldHMsIGNvbnN0YW50c1xuICAgIHZhciBzcHlUYXJnZXQgPSBvcHRpb25zW3RhcmdldF0gJiYgcXVlcnlFbGVtZW50KG9wdGlvbnNbdGFyZ2V0XSkgfHwgdGFyZ2V0RGF0YSxcbiAgICAgICAgbGlua3MgPSBzcHlUYXJnZXQgJiYgc3B5VGFyZ2V0W2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnQScpLCBcbiAgICAgICAgaXRlbXMgPSBbXSwgdGFyZ2V0SXRlbXMgPSBbXSwgc2Nyb2xsT2Zmc2V0LFxuICAgICAgICBzY3JvbGxUYXJnZXQgPSBlbGVtZW50W29mZnNldEhlaWdodF0gPCBlbGVtZW50W3Njcm9sbEhlaWdodF0gPyBlbGVtZW50IDogZ2xvYmFsT2JqZWN0LCAvLyBkZXRlcm1pbmUgd2hpY2ggaXMgdGhlIHJlYWwgc2Nyb2xsVGFyZ2V0XG4gICAgICAgIGlzV2luZG93ID0gc2Nyb2xsVGFyZ2V0ID09PSBnbG9iYWxPYmplY3Q7ICBcbiAgXG4gICAgLy8gcG9wdWxhdGUgaXRlbXMgYW5kIHRhcmdldHNcbiAgICBmb3IgKHZhciBpPTAsIGlsPWxpbmtzW2xlbmd0aF07IGk8aWw7IGkrKykge1xuICAgICAgdmFyIGhyZWYgPSBsaW5rc1tpXVtnZXRBdHRyaWJ1dGVdKCdocmVmJyksIFxuICAgICAgICAgIHRhcmdldEl0ZW0gPSBocmVmICYmIC8jW2EtejAtOV0rJC9pLnRlc3QoaHJlZikgJiYgcXVlcnlFbGVtZW50KGhyZWYpO1xuICAgICAgaWYgKCAhIXRhcmdldEl0ZW0gKSB7XG4gICAgICAgIGl0ZW1zLnB1c2gobGlua3NbaV0pO1xuICAgICAgICB0YXJnZXRJdGVtcy5wdXNoKHRhcmdldEl0ZW0pO1xuICAgICAgfVxuICAgIH1cbiAgXG4gICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgdmFyIHVwZGF0ZUl0ZW0gPSBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gaXRlbXNbaW5kZXhdW3BhcmVudE5vZGVdLCAvLyBpdGVtJ3MgcGFyZW50IExJIGVsZW1lbnRcbiAgICAgICAgICB0YXJnZXRJdGVtID0gdGFyZ2V0SXRlbXNbaW5kZXhdLCAvLyB0aGUgbWVudSBpdGVtIHRhcmdldHMgdGhpcyBlbGVtZW50XG4gICAgICAgICAgZHJvcGRvd24gPSBnZXRDbG9zZXN0KHBhcmVudCwnLmRyb3Bkb3duJyksXG4gICAgICAgICAgdGFyZ2V0UmVjdCA9IGlzV2luZG93ICYmIHRhcmdldEl0ZW1bZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpLFxuICBcbiAgICAgICAgICBpc0FjdGl2ZSA9IGhhc0NsYXNzKHBhcmVudCxhY3RpdmUpIHx8IGZhbHNlLFxuICBcbiAgICAgICAgICB0b3BFZGdlID0gaXNXaW5kb3cgPyB0YXJnZXRSZWN0W3RvcF0gKyBzY3JvbGxPZmZzZXQgOiB0YXJnZXRJdGVtW29mZnNldFRvcF0gLSAodGFyZ2V0SXRlbXNbaW5kZXgtMV0gPyAwIDogMTApLFxuICAgICAgICAgIGJvdHRvbUVkZ2UgPSBpc1dpbmRvdyA/IHRhcmdldFJlY3RbYm90dG9tXSArIHNjcm9sbE9mZnNldCA6IHRhcmdldEl0ZW1zW2luZGV4KzFdID8gdGFyZ2V0SXRlbXNbaW5kZXgrMV1bb2Zmc2V0VG9wXSA6IGVsZW1lbnRbc2Nyb2xsSGVpZ2h0XSxcbiAgXG4gICAgICAgICAgaW5zaWRlID0gc2Nyb2xsT2Zmc2V0ID49IHRvcEVkZ2UgJiYgYm90dG9tRWRnZSA+IHNjcm9sbE9mZnNldDtcbiAgXG4gICAgICAgIGlmICggIWlzQWN0aXZlICYmIGluc2lkZSApIHtcbiAgICAgICAgICBpZiAoIHBhcmVudC50YWdOYW1lID09PSAnTEknICYmICFoYXNDbGFzcyhwYXJlbnQsYWN0aXZlKSApIHtcbiAgICAgICAgICAgIGFkZENsYXNzKHBhcmVudCxhY3RpdmUpO1xuICAgICAgICAgICAgaXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGRyb3Bkb3duICYmICFoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpICkge1xuICAgICAgICAgICAgICBhZGRDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCAnYWN0aXZhdGUnLCAnc2Nyb2xsc3B5JywgaXRlbXNbaW5kZXhdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoICFpbnNpZGUgKSB7XG4gICAgICAgICAgaWYgKCBwYXJlbnQudGFnTmFtZSA9PT0gJ0xJJyAmJiBoYXNDbGFzcyhwYXJlbnQsYWN0aXZlKSApIHtcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzKHBhcmVudCxhY3RpdmUpO1xuICAgICAgICAgICAgaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChkcm9wZG93biAmJiBoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpICYmICFnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHBhcmVudFtwYXJlbnROb2RlXSxhY3RpdmUpLmxlbmd0aCApIHtcbiAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoZHJvcGRvd24sYWN0aXZlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoICFpbnNpZGUgJiYgIWlzQWN0aXZlIHx8IGlzQWN0aXZlICYmIGluc2lkZSApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1cGRhdGVJdGVtcyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHNjcm9sbE9mZnNldCA9IGlzV2luZG93ID8gZ2V0U2Nyb2xsKCkueSA6IGVsZW1lbnRbc2Nyb2xsVG9wXTtcbiAgICAgICAgZm9yICh2YXIgaW5kZXg9MCwgaXRsPWl0ZW1zW2xlbmd0aF07IGluZGV4PGl0bDsgaW5kZXgrKykge1xuICAgICAgICAgIHVwZGF0ZUl0ZW0oaW5kZXgpXG4gICAgICAgIH1cbiAgICAgIH07XG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RcbiAgICB0aGlzLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICB1cGRhdGVJdGVtcygpO1xuICAgIH1cbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdTY3JvbGxTcHkgaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBvbiggc2Nyb2xsVGFyZ2V0LCBzY3JvbGxFdmVudCwgdGhpcy5yZWZyZXNoICk7XG4gICAgICBpZiAoICEoaXNJRSAmJiBpc0lFIDwgOSkpIHsgXG4gICAgICAgIG9uKCBnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCB0aGlzLnJlZnJlc2ggKTsgXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIGVsZW1lbnRbc3RyaW5nU2Nyb2xsU3B5XSA9IHRoaXM7XG4gIH07XG4gIFxuICAvLyBTQ1JPTExTUFkgREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1Njcm9sbFNweSwgU2Nyb2xsU3B5LCBkYXRhU3B5KTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBUYWJcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gVEFCIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT1cbiAgdmFyIFRhYiA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zICkge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gREFUQSBBUElcbiAgICB2YXIgaGVpZ2h0RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhSGVpZ2h0KSxcbiAgICAgIFxuICAgICAgICAvLyBzdHJpbmdzXG4gICAgICAgIGNvbXBvbmVudCA9ICd0YWInLCBoZWlnaHQgPSAnaGVpZ2h0JywgaXNBbmltYXRpbmcgPSAnaXNBbmltYXRpbmcnO1xuICBcbiAgICAvLyBzZXQgZGVmYXVsdCBhbmltYXRpb24gc3RhdGVcbiAgICBlbGVtZW50W2lzQW5pbWF0aW5nXSA9IGZhbHNlO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIHRoaXNbaGVpZ2h0XSA9IHN1cHBvcnRUcmFuc2l0aW9ucyA/IChvcHRpb25zW2hlaWdodF0gfHwgaGVpZ2h0RGF0YSA9PT0gJ3RydWUnKSA6IGZhbHNlOyAvLyBmaWx0ZXIgbGVnYWN5IGJyb3dzZXJzXG4gIFxuICAgIC8vIGJpbmQsIGV2ZW50IHRhcmdldHNcbiAgICB2YXIgc2VsZiA9IHRoaXMsIG5leHQsXG4gICAgICB0YWJzID0gZ2V0Q2xvc2VzdChlbGVtZW50LCcubmF2JyksXG4gICAgICB0YWJzQ29udGVudENvbnRhaW5lcixcbiAgICAgIGRyb3Bkb3duID0gcXVlcnlFbGVtZW50KCcuZHJvcGRvd24nLHRhYnMpO1xuICBcbiAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICB2YXIgZ2V0QWN0aXZlVGFiID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhY3RpdmVUYWJzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0YWJzLGFjdGl2ZSksIGFjdGl2ZVRhYjtcbiAgICAgICAgaWYgKCBhY3RpdmVUYWJzW2xlbmd0aF0gPT09IDEgJiYgIWhhc0NsYXNzKGFjdGl2ZVRhYnNbMF0sJ2Ryb3Bkb3duJykgKSB7XG4gICAgICAgICAgYWN0aXZlVGFiID0gYWN0aXZlVGFic1swXTtcbiAgICAgICAgfSBlbHNlIGlmICggYWN0aXZlVGFic1tsZW5ndGhdID4gMSApIHtcbiAgICAgICAgICBhY3RpdmVUYWIgPSBhY3RpdmVUYWJzW2FjdGl2ZVRhYnNbbGVuZ3RoXS0xXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWN0aXZlVGFiW2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnQScpWzBdO1xuICAgICAgfSxcbiAgICAgIGdldEFjdGl2ZUNvbnRlbnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5RWxlbWVudChnZXRBY3RpdmVUYWIoKVtnZXRBdHRyaWJ1dGVdKCdocmVmJykpO1xuICAgICAgfSxcbiAgICAgIC8vIGhhbmRsZXIgXG4gICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgbmV4dCA9IGVbdGFyZ2V0XTtcbiAgICAgICAgc2VsZi5zaG93KCk7XG4gICAgICB9O1xuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kXG4gICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7IC8vIHRoZSB0YWIgd2UgY2xpY2tlZCBpcyBub3cgdGhlIG5leHQgdGFiXG4gICAgICB2YXIgbmV4dENvbnRlbnQgPSBxdWVyeUVsZW1lbnQobmV4dFtnZXRBdHRyaWJ1dGVdKCdocmVmJykpLCAvL3RoaXMgaXMgdGhlIGFjdHVhbCBvYmplY3QsIHRoZSBuZXh0IHRhYiBjb250ZW50IHRvIGFjdGl2YXRlXG4gICAgICAgIGFjdGl2ZVRhYiA9IGdldEFjdGl2ZVRhYigpLCBhY3RpdmVDb250ZW50ID0gZ2V0QWN0aXZlQ29udGVudCgpO1xuICAgICAgXG4gICAgICBpZiAoICghYWN0aXZlVGFiW2lzQW5pbWF0aW5nXSB8fCAhbmV4dFtpc0FuaW1hdGluZ10pICYmICFoYXNDbGFzcyhuZXh0W3BhcmVudE5vZGVdLGFjdGl2ZSkgKSB7XG4gICAgICAgIGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IHRydWU7XG4gICAgICAgIHJlbW92ZUNsYXNzKGFjdGl2ZVRhYltwYXJlbnROb2RlXSxhY3RpdmUpO1xuICAgICAgICBhZGRDbGFzcyhuZXh0W3BhcmVudE5vZGVdLGFjdGl2ZSk7XG4gIFxuICAgICAgICBpZiAoIGRyb3Bkb3duICkge1xuICAgICAgICAgIGlmICggIWhhc0NsYXNzKGVsZW1lbnRbcGFyZW50Tm9kZV1bcGFyZW50Tm9kZV0sJ2Ryb3Bkb3duLW1lbnUnKSApIHtcbiAgICAgICAgICAgIGlmIChoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpKSByZW1vdmVDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIWhhc0NsYXNzKGRyb3Bkb3duLGFjdGl2ZSkpIGFkZENsYXNzKGRyb3Bkb3duLGFjdGl2ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIHRhYnNDb250ZW50Q29udGFpbmVyW3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGFjdGl2ZUNvbnRlbnQpICsgJ3B4JzsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuICBcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhY3RpdmVUYWIsIGhpZGVFdmVudCwgY29tcG9uZW50LCBuZXh0KTtcbiAgXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlQ29udGVudCxpbkNsYXNzKTtcbiAgICAgICAgfSwgMCk7XG4gIFxuICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChhY3RpdmVDb250ZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIGFkZENsYXNzKHRhYnNDb250ZW50Q29udGFpbmVyLGNvbGxhcHNpbmcpO1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGFjdGl2ZUNvbnRlbnQsYWN0aXZlKTtcbiAgICAgICAgICBhZGRDbGFzcyhuZXh0Q29udGVudCxhY3RpdmUpO1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBhZGRDbGFzcyhuZXh0Q29udGVudCxpbkNsYXNzKTtcbiAgICAgICAgICAgIGlmKHRhYnNDb250ZW50Q29udGFpbmVyKSB0YWJzQ29udGVudENvbnRhaW5lcltzdHlsZV1baGVpZ2h0XSA9IGdldE1heEhlaWdodChuZXh0Q29udGVudCkgKyAncHgnOyAvLyBoZWlnaHQgYW5pbWF0aW9uXG4gICAgICAgICAgfSwgMCk7XG4gIFxuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobmV4dCwgc2hvd0V2ZW50LCBjb21wb25lbnQsIGFjdGl2ZVRhYik7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhY3RpdmVUYWIsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQsIG5leHQpO1xuICBcbiAgICAgICAgfSk7XG4gIFxuICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChuZXh0Q29udGVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChuZXh0LCBzaG93bkV2ZW50LCBjb21wb25lbnQsIGFjdGl2ZVRhYik7XG4gICAgICAgICAgaWYgKHRhYnNDb250ZW50Q29udGFpbmVyKSB7IC8vIGhlaWdodCBhbmltYXRpb25cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQodGFic0NvbnRlbnRDb250YWluZXIsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSAgJyc7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3ModGFic0NvbnRlbnRDb250YWluZXIsY29sbGFwc2luZyk7XG4gICAgICAgICAgICAgICAgYWN0aXZlVGFiW2lzQW5pbWF0aW5nXSA9IG5leHRbaXNBbmltYXRpbmddID0gZmFsc2U7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9LDApO1xuICAgICAgICAgIH0gZWxzZSB7IGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IGZhbHNlOyB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nVGFiIGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgb24oZWxlbWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTtcbiAgICB9XG4gICAgaWYgKHRoaXNbaGVpZ2h0XSkgeyB0YWJzQ29udGVudENvbnRhaW5lciA9IGdldEFjdGl2ZUNvbnRlbnQoKVtwYXJlbnROb2RlXTsgfVxuICAgIGVsZW1lbnRbc3RyaW5nVGFiXSA9IHRoaXM7XG4gIH07XG4gIFxuICAvLyBUQUIgREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1RhYiwgVGFiLCBkYXRhVG9nZ2xlKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBUb29sdGlwXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBUT09MVElQIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09XG4gIHZhciBUb29sdGlwID0gZnVuY3Rpb24oIGVsZW1lbnQsb3B0aW9ucyApIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIERBVEEgQVBJXG4gICAgdmFyIGFuaW1hdGlvbkRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUFuaW1hdGlvbik7XG4gICAgICAgIHBsYWNlbWVudERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBsYWNlbWVudCk7XG4gICAgICAgIGRlbGF5RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhRGVsYXkpLFxuICAgICAgICBjb250YWluZXJEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250YWluZXIpLFxuICAgICAgICBcbiAgICAgICAgLy8gc3RyaW5nc1xuICAgICAgICBjb21wb25lbnQgPSAndG9vbHRpcCcsXG4gICAgICAgIGNsYXNzU3RyaW5nID0gJ2NsYXNzJyxcbiAgICAgICAgdGl0bGUgPSAndGl0bGUnLFxuICAgICAgICBmYWRlID0gJ2ZhZGUnLFxuICAgICAgICBkaXYgPSAnZGl2JztcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICB0aGlzW2FuaW1hdGlvbl0gPSBvcHRpb25zW2FuaW1hdGlvbl0gJiYgb3B0aW9uc1thbmltYXRpb25dICE9PSBmYWRlID8gb3B0aW9uc1thbmltYXRpb25dIDogYW5pbWF0aW9uRGF0YSB8fCBmYWRlO1xuICAgIHRoaXNbcGxhY2VtZW50XSA9IG9wdGlvbnNbcGxhY2VtZW50XSA/IG9wdGlvbnNbcGxhY2VtZW50XSA6IHBsYWNlbWVudERhdGEgfHwgdG9wO1xuICAgIHRoaXNbZGVsYXldID0gcGFyc2VJbnQob3B0aW9uc1tkZWxheV0gfHwgZGVsYXlEYXRhKSB8fCAyMDA7XG4gICAgdGhpc1tjb250YWluZXJdID0gcXVlcnlFbGVtZW50KG9wdGlvbnNbY29udGFpbmVyXSkgfHwgcXVlcnlFbGVtZW50KGNvbnRhaW5lckRhdGEpIHx8IGJvZHk7XG4gIFxuICAgIC8vIGJpbmQsIGV2ZW50IHRhcmdldHMsIHRpdGxlIGFuZCBjb25zdGFudHNcbiAgICB2YXIgc2VsZiA9IHRoaXMsIHRpbWVyID0gMCwgcGxhY2VtZW50U2V0dGluZyA9IHRoaXNbcGxhY2VtZW50XSwgdG9vbHRpcCA9IG51bGwsXG4gICAgICB0aXRsZVN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSh0aXRsZSkgfHwgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRpdGxlKTtcbiAgXG4gICAgaWYgKCAhdGl0bGVTdHJpbmcgKSByZXR1cm47IC8vIGludmFsaWRhdGVcbiAgXG4gICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgdmFyIHJlbW92ZVRvb2xUaXAgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgc2VsZltjb250YWluZXJdLnJlbW92ZUNoaWxkKHRvb2x0aXApO1xuICAgICAgICB0b29sdGlwID0gbnVsbDsgdGltZXIgPSBudWxsO1xuICAgICAgfSxcbiAgICAgIGNyZWF0ZVRvb2xUaXAgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0odGl0bGUpIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUaXRsZSk7IC8vIHJlYWQgdGhlIHRpdGxlIGFnYWluXG4gICAgICAgIHRvb2x0aXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG4gICAgICAgIHRvb2x0aXBbc2V0QXR0cmlidXRlXSgncm9sZScsY29tcG9uZW50KTtcbiAgXG4gICAgICAgIHZhciB0b29sdGlwQXJyb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdiksIHRvb2x0aXBJbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcbiAgICAgICAgdG9vbHRpcEFycm93W3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsIGNvbXBvbmVudCsnLWFycm93Jyk7IHRvb2x0aXBJbm5lcltzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLGNvbXBvbmVudCsnLWlubmVyJyk7XG4gIFxuICAgICAgICB0b29sdGlwLmFwcGVuZENoaWxkKHRvb2x0aXBBcnJvdyk7IHRvb2x0aXAuYXBwZW5kQ2hpbGQodG9vbHRpcElubmVyKTtcbiAgXG4gICAgICAgIHRvb2x0aXBJbm5lci5pbm5lckhUTUwgPSB0aXRsZVN0cmluZztcbiAgXG4gICAgICAgIHNlbGZbY29udGFpbmVyXS5hcHBlbmRDaGlsZCh0b29sdGlwKTtcbiAgICAgICAgdG9vbHRpcFtzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCBjb21wb25lbnQgKyAnICcgKyBwbGFjZW1lbnRTZXR0aW5nICsgJyAnICsgc2VsZlthbmltYXRpb25dKTtcbiAgICAgIH0sXG4gICAgICB1cGRhdGVUb29sdGlwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBzdHlsZVRpcChlbGVtZW50LHRvb2x0aXAscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pO1xuICAgICAgICBpZiAoIWlzRWxlbWVudEluVmlld3BvcnQodG9vbHRpcCkgKSB7IFxuICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSB1cGRhdGVQbGFjZW1lbnQocGxhY2VtZW50U2V0dGluZyk7IFxuICAgICAgICAgIHN0eWxlVGlwKGVsZW1lbnQsdG9vbHRpcCxwbGFjZW1lbnRTZXR0aW5nLHNlbGZbY29udGFpbmVyXSk7IFxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc2hvd1Rvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICFoYXNDbGFzcyh0b29sdGlwLGluQ2xhc3MpICYmICggYWRkQ2xhc3ModG9vbHRpcCxpbkNsYXNzKSApO1xuICAgICAgfTtcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodG9vbHRpcCA9PT0gbnVsbCkge1xuICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSBzZWxmW3BsYWNlbWVudF07IC8vIHdlIHJlc2V0IHBsYWNlbWVudCBpbiBhbGwgY2FzZXNcbiAgICAgICAgICBjcmVhdGVUb29sVGlwKCk7XG4gICAgICAgICAgdXBkYXRlVG9vbHRpcCgpO1xuICAgICAgICAgIHNob3dUb29sdGlwKCk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQodG9vbHRpcCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sIDIwICk7XG4gICAgfTtcbiAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodG9vbHRpcCAmJiB0b29sdGlwICE9PSBudWxsICYmIGhhc0NsYXNzKHRvb2x0aXAsaW5DbGFzcykpIHtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGVFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICByZW1vdmVDbGFzcyh0b29sdGlwLGluQ2xhc3MpO1xuICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHRvb2x0aXAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmVtb3ZlVG9vbFRpcCgpO1xuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgc2VsZltkZWxheV0pO1xuICAgIH07XG4gICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICghdG9vbHRpcCkgeyBzZWxmLnNob3coKTsgfSBcbiAgICAgIGVsc2UgeyBzZWxmLmhpZGUoKTsgfVxuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nVG9vbHRpcCBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIGVsZW1lbnRbc2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUaXRsZSx0aXRsZVN0cmluZyk7XG4gICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSh0aXRsZSk7XG4gICAgICBvbihlbGVtZW50LCBtb3VzZUhvdmVyWzBdLCB0aGlzLnNob3cpO1xuICAgICAgb24oZWxlbWVudCwgbW91c2VIb3ZlclsxXSwgdGhpcy5oaWRlKTtcbiAgICB9XG4gICAgZWxlbWVudFtzdHJpbmdUb29sdGlwXSA9IHRoaXM7XG4gIH07XG4gIFxuICAvLyBUT09MVElQIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1Rvb2x0aXAsIFRvb2x0aXAsIGRhdGFUb2dnbGUpO1xuICBcbiAgXG4gIHJldHVybiB7XG4gICAgQWZmaXg6IEFmZml4LFxuICAgIEFsZXJ0OiBBbGVydCxcbiAgICBCdXR0b246IEJ1dHRvbixcbiAgICBDYXJvdXNlbDogQ2Fyb3VzZWwsXG4gICAgQ29sbGFwc2U6IENvbGxhcHNlLFxuICAgIERyb3Bkb3duOiBEcm9wZG93bixcbiAgICBNb2RhbDogTW9kYWwsXG4gICAgUG9wb3ZlcjogUG9wb3ZlcixcbiAgICBTY3JvbGxTcHk6IFNjcm9sbFNweSxcbiAgICBUYWI6IFRhYixcbiAgICBUb29sdGlwOiBUb29sdGlwXG4gIH07XG59KSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL34vYm9vdHN0cmFwLm5hdGl2ZS9kaXN0L2Jvb3RzdHJhcC1uYXRpdmUuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==