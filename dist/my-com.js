!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(1);i(o);"findPersonBody"==document.body.id&&!function(){var t=!0,e=document.querySelectorAll("#searchPerson input"),n=document.querySelector("#findPerson"),i=document.querySelector("#searchPhone");e.forEach(function(e){0!=e.value.trim().length||"last-name"!=e.name&&"first-name"!=e.name||(t=!1)}),t===!1?n.setAttribute("disabled","disabled"):null,e.forEach(function(t){t.addEventListener("input",function(){var t=!0;e.forEach(function(n){0!=n.value.trim().length||"last-name"!=n.name&&"first-name"!=n.name?n.classList.remove("myError"):e[0].value.trim().length<8||"phone-number"!=e[0].name?(t=!1,n.classList.add("myError"),i.setAttribute("disabled","disabled")):(t=!0,n.classList.remove("myError"),i.removeAttribute("disabled"))}),t===!0?n.removeAttribute("disabled"):n.setAttribute("disabled","disabled")})}),i.addEventListener("click",function(t){document.querySelector("#action").value="searchByPhone"}),document.querySelector("#btnClear").addEventListener("click",function(t){e.forEach(function(t){t.value=""}),t.preventDefault()})}()},function(t,e,n){var i,o,a;(function(n){!function(n,r){o=[],i=r,a="function"==typeof i?i.apply(e,o):i,!(void 0!==a&&(t.exports=a))}(this,function(){var t="undefined"!=typeof n?n:this||window,e=document.documentElement,i=document.body,o=null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&parseFloat(RegExp.$1),a="data-toggle",r="data-dismiss",l="data-spy",c="data-ride",u="Affix",s="Alert",f="Button",d="Carousel",h="Collapse",p="Dropdown",m="Modal",v="Popover",g="ScrollSpy",b="Tab",y="Tooltip",x="data-backdrop",T="data-keyboard",w="data-target",E="data-interval",I="data-height",C="data-pause",L="data-original-title",A="data-original-text",S="data-dismissible",M="data-trigger",k="data-animation",D="data-container",H="data-placement",B="data-delay",N="data-offset-top",P="data-offset-bottom",W="backdrop",q="keyboard",$="delay",R="duration",z="content",O="target",j="interval",_="pause",F="animation",U="placement",X="container",Y="offsetTop",G="offsetBottom",J="offsetLeft",K="scrollTop",Q="scrollLeft",V="clientWidth",Z="clientHeight",tt="offsetWidth",et="offsetHeight",nt="innerWidth",it="innerHeight",ot="scrollHeight",at="height",rt="aria-expanded",lt="aria-hidden",ct="click",ut="hover",st="keydown",ft="resize",dt="scroll",ht="show",pt="shown",mt="hide",vt="hidden",gt="close",bt="closed",yt="slid",xt="slide",Tt="change",wt="getAttribute",Et="setAttribute",It="hasAttribute",Ct="getElementsByTagName",Lt="getBoundingClientRect",At="querySelectorAll",St="getElementsByClassName",Mt="indexOf",kt="parentNode",Dt="length",Ht="toLowerCase",Bt="Transition",Nt="Webkit",Pt="style",Wt="active",qt="in",$t="collapsing",Rt="disabled",zt="loading",Ot="left",jt="right",_t="top",Ft="bottom",Ut="onmouseleave"in document?["mouseenter","mouseleave"]:["mouseover","mouseout"],Xt=/\b(top|bottom|left|top)+/,Yt=Nt+Bt in e[Pt]||Bt[Ht]()in e[Pt],Gt=Nt+Bt in e[Pt]?Nt[Ht]()+Bt+"End":Bt[Ht]()+"end",Jt=function(t){t.focus?t.focus():t.setActive()},Kt=function(t,e){t.classList.add(e)},Qt=function(t,e){t.classList.remove(e)},Vt=function(t,e){return t.classList.contains(e)},Zt=function(t){for(var e=[],n=0,i=t[Dt];n<i;n++)e.push(t[n]);return e},te=function(t,e){var n=8===o?At:St;return Zt(t[n](8===o?"."+e.replace(/\s(?=[a-z])/g,"."):e))},ee=function(t,e){var n=e?e:document;return"object"==typeof t?t:n.querySelector(t)},ne=function(t,e){for(var n=e.charAt(0);t&&t!==document;t=t[kt]){if(("."===n||"#"!==n)&&null!==ee(e,t[kt]))return t;if("#"===n&&t.id===e.substr(1))return t}return!1},ie=function(t,e,n){t.addEventListener(e,n,!1)},oe=function(t,e,n){t.removeEventListener(e,n,!1)},ae=function(t,e,n){ie(t,e,function i(){n(),oe(t,e,i)})},re=function(t,e){Yt?ae(t,Gt,e):e()},le=function(t,e,n){var i=new CustomEvent(t+".bs."+e);i.relatedTarget=n,this.dispatchEvent(i)},ce=document[Ct]("*"),ue=function(t,e,n,i){for(var o=i&&i[Dt]?i:ce,a=0;a<o[Dt];a++){var r=o[a][wt](n),l=t.replace(/spy/i,"")[Ht]();(r&&t===f&&r[Mt](l)>-1||r===l)&&new e(o[a])}},se=function(e){var n=e&&(e.currentStyle||t.getComputedStyle(e)),i=/px/.test(n.borderTopWidth)?Math.round(n.borderTopWidth.replace("px","")):0,o=/px/.test(n.borderBottomWidth)?Math.round(n.borderBottomWidth.replace("px","")):0,a=/px/.test(n.marginTop)?Math.round(n.marginTop.replace("px","")):0,r=/px/.test(n.marginBottom)?Math.round(n.marginBottom.replace("px","")):0;return e[Z]+parseInt(i)+parseInt(o)+parseInt(a)+parseInt(r)},fe=function(t){for(var e=0,n=0,i=t.children[Dt];n<i;n++)e+=se(t.children[n]);return e},de=function(n){var i=n[Lt]();return i[_t]>=0&&i[Ot]>=0&&i[Ft]<=(t[it]||e[Z])&&i[jt]<=(t[nt]||e[V])},he=function(){return{y:t.pageYOffset||e[K],x:t.pageXOffset||e[Q]}},pe=function(t,e,n,o){var a=t[Lt](),r=o===i?he():{x:o[J]+o[Q],y:o[Y]+o[K]},l={w:a[jt]-a[Ot],h:a[Ft]-a[_t]},c={w:e[tt],h:e[et]};n===_t?(e[Pt][_t]=a[_t]+r.y-c.h+"px",e[Pt][Ot]=a[Ot]+r.x-c.w/2+l.w/2+"px"):n===Ft?(e[Pt][_t]=a[_t]+r.y+l.h+"px",e[Pt][Ot]=a[Ot]+r.x-c.w/2+l.w/2+"px"):n===Ot?(e[Pt][_t]=a[_t]+r.y-c.h/2+l.h/2+"px",e[Pt][Ot]=a[Ot]+r.x-c.w+"px"):n===jt&&(e[Pt][_t]=a[_t]+r.y-c.h/2+l.h/2+"px",e[Pt][Ot]=a[Ot]+r.x+l.w+"px"),e.className[Mt](n)===-1&&(e.className=e.className.replace(Xt,n))},me=function(t){return t===_t?Ft:t===Ft?_t:t===Ot?jt:t===jt?Ot:t},ve=function(n,a){n=ee(n),a=a||{};var r=n[wt](w),l=n[wt](N),c=n[wt](P),s="affix",f="affixed",d="function",h="update",p="affix-top",m="affixed-top",v="affix-bottom",g="affixed-bottom";if(this[O]=a[O]?ee(a[O]):ee(r)||null,this[Y]=a[Y]?a[Y]:parseInt(l)||0,this[G]=a[G]?a[G]:parseInt(c)||0,this[O]||this[Y]||this[G]){var b,y,x,T,E,I,C=this,L=o&&o<10?500:50,A=!1,S=!1,M=function(){return Math.max(i[ot],i[et],e[Z],e[ot],e[et])},k=function(){return null!==C[O]?C[O][Lt]()[_t]+T:C[Y]?parseInt(typeof C[Y]===d?C[Y]():C[Y]||0):void 0},D=function(){if(C[G])return x-n[et]-parseInt(typeof C[G]===d?C[G]():C[G]||0)},H=function(){x=M(),T=parseInt(he().y,0),b=k(),y=D(),E=parseInt(b)-T<0&&T>parseInt(b),I=parseInt(y)-T<0&&T>parseInt(y)},B=function(){A||Vt(n,s)||(le.call(n,s,s),le.call(n,p,s),Kt(n,s),A=!0,le.call(n,f,s),le.call(n,m,s))},W=function(){A&&Vt(n,s)&&(Qt(n,s),A=!1)},q=function(){S||Vt(n,v)||(le.call(n,s,s),le.call(n,v,s),Kt(n,v),S=!0,le.call(n,f,s),le.call(n,g,s))},$=function(){S&&Vt(n,v)&&(Qt(n,v),S=!1)},R=function(){I?(E&&W(),q()):($(),E?B():W())};this[h]=function(){H(),R()},u in n||(ie(t,dt,this[h]),ie(t,ft,function(){setTimeout(function(){C[h]()},L)})),n[u]=this,this[h]()}};ue(u,ve,l);var ge=function(t){t=ee(t);var e=this,n="alert",i=ne(t,"."+n),o=function(o){var a=o[O];a=a[It](r)?a:a[kt],a&&a[It](r)&&(i=ne(a,"."+n),t=ee("["+r+'="'+n+'"]',i),(t===a||t===a[kt])&&i&&e.close())},a=function(){le.call(i,bt,n),oe(t,ct,o),i[kt].removeChild(i)};this.close=function(){i&&t&&Vt(i,qt)&&(le.call(i,gt,n),Qt(i,qt),setTimeout(function(){i&&re(i,a)},R))},s in t||ie(t,ct,o),t[s]=this};ue(s,ge,r);var be=function(t,e){t=ee(t),e=e||null;var n=!1,i="button",o="checked",a="reset",r="LABEL",l="INPUT",c=function(){e&&e!==a&&(e===zt&&(Kt(t,Rt),t[Et](Rt,Rt)),t[Et](A,t.innerHTML.replace(/^\s+|\s+$/g,"")),t.innerHTML=t[wt]("data-"+e+"-text"))},u=function(){t[wt](A)&&((Vt(t,Rt)||t[wt](Rt)===Rt)&&(Qt(t,Rt),t.removeAttribute(Rt)),t.innerHTML=t[wt](A))},s=function(e){var a=e[O][kt],c=e[O].tagName===r?e[O]:a.tagName===r?a:null;if(c){var u=this,s=te(u,"btn"),f=c[Ct](l)[0];if(f){if("checkbox"===f.type&&(f[o]?(Qt(c,Wt),f[wt](o),f.removeAttribute(o),f[o]=!1):(Kt(c,Wt),f[wt](o),f[Et](o,o),f[o]=!0),n||(n=!0,le.call(f,Tt,i),le.call(t,Tt,i))),"radio"===f.type&&!n&&!f[o]){Kt(c,Wt),f[Et](o,o),f[o]=!0,le.call(f,Tt,i),le.call(t,Tt,i),n=!0;for(var d=0,h=s[Dt];d<h;d++){var p=s[d],m=p[Ct](l)[0];p!==c&&Vt(p,Wt)&&(Qt(p,Wt),m.removeAttribute(o),m[o]=!1,le.call(m,Tt,i))}}setTimeout(function(){n=!1},50)}}};Vt(t,"btn")&&null!==e&&(e!==a?c():u()),Vt(t,"btn-group")&&(f in t||ie(t,ct,s),t[f]=this)};ue(f,be,a);var ye=function(e,n){e=ee(e),n=n||{};var i="false"!==e[wt](E)&&(parseInt(e[wt](E))||5e3),o=e[wt](C)===ut||!1,a="true"===e[wt](T)||!1,r="carousel",l="paused",c="direction",u="data-slide-to";this[q]=n[q]===!0||a,this[_]=!(n[_]!==ut&&!o)&&ut,n[j]||i?this[j]=parseInt(n[j])||i:this[j]=!1;var s=this,f=e.index=0,h=e.timer=0,p=!1,m=te(e,"item"),v=m[Dt],g=this[c]=Ot,b=te(e,r+"-control"),y=b[0],x=b[1],w=ee("."+r+"-indicators",e),I=w[Ct]("LI"),L=function(){s[j]===!1||Vt(e,l)||(Kt(e,l),!p&&clearInterval(h))},A=function(){s[j]!==!1&&Vt(e,l)&&(Qt(e,l),!p&&clearInterval(h),!p&&s.cycle())},S=function(t){if(t.preventDefault(),!p){var e=t[O],n=s.getActiveIndex();if(!e||Vt(e,Wt)||!e[wt](u))return!1;f=parseInt(e[wt](u),10),n<f||0===n&&f===v-1?g=s[c]=Ot:(n>f||n===v-1&&0===f)&&(g=s[c]=jt),s.slideTo(f)}},M=function(t){if(t.preventDefault(),!p){var e=t.currentTarget||t.srcElement;e===x?(f++,g=s[c]=Ot,f===v-1?f=v-1:f===v&&(f=0)):e===y&&(f--,g=s[c]=jt,0===f?f=0:f<0&&(f=v-1)),s.slideTo(f)}},k=function(t){if(!p){switch(t.which){case 39:f++,g=s[c]=Ot,f==v-1?f=v-1:f==v&&(f=0);break;case 37:f--,g=s[c]=jt,0==f?f=0:f<0&&(f=v-1);break;default:return}s.slideTo(f)}},D=function(t){for(var e=0,n=I[Dt];e<n;e++)Qt(I[e],Wt);I[t]&&Kt(I[t],Wt)};this.cycle=function(){g=this[c]=Ot,h=setInterval(function(){f++,f=f===v?0:f,s.slideTo(f)},this[j])},this.slideTo=function(t){var n=this.getActiveIndex(),i=g===Ot?"next":"prev";le.call(e,xt,r,m[t]),p=this.isSliding=!0,clearInterval(h),D(t),Yt&&Vt(e,"slide")?(Kt(m[t],i),m[t][tt],Kt(m[t],g),Kt(m[n],g),ae(m[t],Gt,function(){p=s.isSliding=!1,Kt(m[t],Wt),Qt(m[n],Wt),Qt(m[t],i),Qt(m[t],g),Qt(m[n],g),s[j]&&!Vt(e,l)&&s.cycle(),le.call(e,yt,r,m[t])})):(Kt(m[t],Wt),m[t][tt],Qt(m[n],Wt),setTimeout(function(){p=!1,s[j]&&!Vt(e,l)&&s.cycle(),le.call(e,yt,r,m[t])},100))},this.getActiveIndex=function(){return m[Mt](te(e,"item active")[0])||0},d in e||(this[_]&&this[j]&&(ie(e,Ut[0],L),ie(e,Ut[1],A),ie(e,"touchstart",L),ie(e,"touchend",A)),x&&ie(x,ct,M),y&&ie(y,ct,M),w&&ie(w,ct,S,!1),this[q]===!0&&ie(t,st,k,!1)),this.getActiveIndex()<0&&(m[Dt]&&Kt(m[0],Wt),I[Dt]&&D(0)),this[j]&&this.cycle(),e[d]=this};ue(d,ye,c);var xe=function(t,e){t=ee(t),e=e||{};var n=null,i=null,o=this,a=!1,r=t[wt]("data-parent"),l="collapse",c="collapsed",u=function(t){le.call(t,ht,l),a=!0,Kt(t,$t),Kt(t,qt),setTimeout(function(){t[Pt][at]=fe(t)+"px"},0),re(t,function(){Qt(t,$t),t[Pt][at]="",a=!1,t[Et](rt,"true"),le.call(t,pt,l)})},s=function(t){le.call(t,mt,l),a=!0,t[Pt][at]=fe(t)+"px",setTimeout(function(){Kt(t,$t),t[Pt][at]="0px"},0),re(t,function(){Qt(t,$t),Qt(t,qt),t[Pt][at]="",a=!1,t[Et](rt,"false"),le.call(t,vt,l)})},f=function(){var e=t.href&&t[wt]("href"),n=t[wt](w),i=e||n&&/#/.test(n)&&n;return i&&ee(i)};this.toggle=function(t){t.preventDefault(),a||(Vt(i,qt)?o.hide():o.show())},this.hide=function(){s(i),Kt(t,c)},this.show=function(){if(u(i),Qt(t,c),null!==n)for(var e=te(n,l+" "+qt),o=0,a=e[Dt];o<a;o++)e[o]!==i&&s(e[o])},h in t||ie(t,ct,this.toggle),i=f(),n=ee(e.parent)||r&&ne(t,r),t[h]=this};ue(h,xe,a);var Te=function(t,e){t=ee(t),this.persist=e===!0||"true"===t[wt]("data-persist")||!1;var n=this,i=!1,o=t[kt],r="dropdown",l="open",c=null,u=ee(".dropdown-menu",o),s=Zt(u[Ct]("*")),f=function(t){!i||27!=t.which&&27!=t.keyCode||(c=null,m())},d=function(e){var r,l=e[O];if(r=1!==l.nodeType&&(l[wt](a)||l[kt][wt](a)),l===t||l===o||l[kt]===t)e.preventDefault(),c=t,n.toggle();else if(i){if((l===u||s&&s[Mt](l)>-1)&&(n.persist||r))return;c=null,m()}(/\#$/.test(l.href)||l[kt]&&/\#$/.test(l[kt].href))&&e.preventDefault()},h=function(){le.call(o,ht,r,c),Kt(o,l),u[Et](rt,!0),le.call(o,pt,r,c),ie(document,st,f),i=!0},m=function(){le.call(o,mt,r,c),Qt(o,l),u[Et](rt,!1),le.call(o,vt,r,c),oe(document,st,f),i=!1};this.toggle=function(){Vt(o,l)&&i?m():h()},p in t||(u[Et]("tabindex","0"),ie(document,ct,d)),t[p]=this};ue(p,Te,a);var we=function(n,o){n=ee(n);var a=n[wt](w)||n[wt]("href"),l=ee(a),c=Vt(n,"modal")?n:l,u="modal",s="static",f="paddingLeft",d="paddingRight",h="modal-backdrop";if(Vt(n,"modal")&&(n=null),c){o=o||{},this[q]=o[q]!==!1&&"false"!==c[wt](T),this[W]=o[W]!==s&&c[wt](x)!==s||s,this[W]=o[W]!==!1&&"false"!==c[wt](x)&&this[W],this[z]=o[z];var p,v,g,b,y=this,E=this.open=!1,I=null,C=function(){var n=e[Lt]();return t[nt]||n[jt]-Math.abs(n[Ot])},L=function(){var e=i.currentStyle||t.getComputedStyle(i),n=parseInt(e[d],10);p&&(i[Pt][d]=n+g+"px")},A=function(){i[Pt][d]=""},S=function(){var t,e=document.createElement("div");return e.className=u+"-scrollbar-measure",i.appendChild(e),t=e[tt]-e[V],i.removeChild(e),t},M=function(){p=i[V]<C(),v=c[ot]>e[Z],g=S()},k=function(){c[Pt][f]=!p&&v?g+"px":"",c[Pt][d]=p&&!v?g+"px":""},D=function(){c[Pt][f]="",c[Pt][d]=""},H=function(){var t=document.createElement("div");b=ee("."+h),null===b&&(t[Et]("class",h+" fade"),b=t,i.appendChild(b))},B=function(){b=ee("."+h),b&&null!==b&&"object"==typeof b&&(i.removeChild(b),b=null)},N=function(){Vt(c,qt)?oe(document,st,j):ie(document,st,j)},P=function(){Vt(c,qt)?oe(t,ft,y.update):ie(t,ft,y.update)},$=function(){Vt(c,qt)?oe(c,ct,_):ie(c,ct,_)},R=function(t){var e=t[O];e=e[It](w)||e[It]("href")?e:e[kt],E||e!==n||Vt(c,qt)||(c.modalTrigger=n,I=n,y.show(),t.preventDefault())},j=function(t){var e=t.which||t.keyCode;y[q]&&27==e&&E&&y.hide()},_=function(t){var e=t[O];E&&(e[kt][wt](r)===u||e[wt](r)===u||e===c&&y[W]!==s)&&(y.hide(),I=null,t.preventDefault())};this.toggle=function(){E&&Vt(c,qt)?this.hide():this.show()},this.show=function(){le.call(c,ht,u,I);var t=te(document,u+" in")[0];t&&t!==c&&t.modalTrigger[m].hide(),this[W]&&H(),b&&!Vt(b,qt)&&setTimeout(function(){Kt(b,qt)},0),setTimeout(function(){c[Pt].display="block",M(),L(),k(),P(),$(),N(),Kt(i,u+"-open"),Kt(c,qt),c[Et](lt,!1)},0),re(c,function(){E=y.open=!0,Jt(c),le.call(c,pt,u,I)})},this.hide=function(){le.call(c,mt,u),b=ee("."+h),null!==b&&Qt(b,qt),Qt(c,qt),c[Et](lt,!0),re(c,function(){Qt(i,u+"-open"),P(),$(),N(),D(),A(),c[Pt].display="",te(document,u+" "+qt)[0]||B(),E=y.open=!1,n&&Jt(n),le.call(c,vt,u)})},this.setContent=function(t){ee("."+u+"-content",c).innerHTML=t},this.update=function(){E&&(M(),L(),k())},!n||m in n||ie(n,ct,R),this[z]&&this.setContent(this[z]),!!n&&(n[m]=this)}};ue(m,we,a);var Ee=function(e,n){e=ee(e);var a=e[wt](M),r=e[wt](k),l=e[wt](H),c=e[wt](S),u=e[wt](B),s=e[wt](D),f="popover",d="template",h="trigger",p="class",m="div",g="fade",b="data-title",y="data-content",x="dismissible",T='<button type="button" class="close">Ã—</button>';n=n||{},this[d]=n[d]?n[d]:null,this[h]=n[h]?n[h]:a||ut,this[F]=n[F]&&n[F]!==g?n[F]:r||g,this[U]=n[U]?n[U]:l||_t,this[$]=parseInt(n[$]||u)||200,this[x]=!(!n[x]&&"true"!==c),this[X]=ee(n[X])||ee(s)||i;var w=this,E=e[wt](b)||null,I=e[wt](y)||null;if(I||this[d]){var C=null,L=0,A=this[U],N=function(t){null!==C&&t[O]===ee(".close",C)&&w.hide()},P=function(){w[X].removeChild(C),L=null,C=null},W=function(){if(E=e[wt](b),I=e[wt](y),C=document.createElement(m),null!==I&&null===w[d]){if(C[Et]("role","tooltip"),null!==E){var t=document.createElement("h3");t[Et](p,f+"-title"),t.innerHTML=w[x]?E+T:E,C.appendChild(t)}var n=document.createElement(m),i=document.createElement(m);n[Et](p,"arrow"),i[Et](p,f+"-content"),C.appendChild(n),C.appendChild(i),i.innerHTML=w[x]&&null===E?I+T:I}else{var o=document.createElement(m);o.innerHTML=w[d],C.innerHTML=o.firstChild.innerHTML}w[X].appendChild(C),C[Pt].display="block",C[Et](p,f+" "+A+" "+w[F])},q=function(){!Vt(C,qt)&&Kt(C,qt)},R=function(){pe(e,C,A,w[X]),de(C)||(A=me(A),pe(e,C,A,w[X]))};this.toggle=function(){null===C?w.show():w.hide()},this.show=function(){clearTimeout(L),L=setTimeout(function(){null===C&&(A=w[U],W(),R(),q(),le.call(e,ht,f),re(C,function(){le.call(e,pt,f)}))},20)},this.hide=function(){clearTimeout(L),L=setTimeout(function(){C&&null!==C&&Vt(C,qt)&&(le.call(e,mt,f),Qt(C,qt),re(C,function(){P(),le.call(e,vt,f)}))},w[$])},v in e||(w[h]===ut?(ie(e,Ut[0],w.show),w[x]||ie(e,Ut[1],w.hide)):/^(click|focus)$/.test(w[h])&&(ie(e,w[h],w.toggle),w[x]||ie(e,"blur",w.hide)),w[x]&&ie(document,ct,N),o&&o<9||ie(t,ft,w.hide)),e[v]=w}};ue(v,Ee,a);var Ie=function(e,n){e=ee(e);var i=ee(e[wt](w));if(n=n||{},n[O]||i){for(var a,r=n[O]&&ee(n[O])||i,l=r&&r[Ct]("A"),c=[],u=[],s=e[et]<e[ot]?e:t,f=s===t,d=0,h=l[Dt];d<h;d++){var p=l[d][wt]("href"),m=p&&/#[a-z0-9]+$/i.test(p)&&ee(p);m&&(c.push(l[d]),u.push(m))}var v=function(t){var n=c[t][kt],i=u[t],o=ne(n,".dropdown"),r=f&&i[Lt](),l=Vt(n,Wt)||!1,s=f?r[_t]+a:i[Y]-(u[t-1]?0:10),d=f?r[Ft]+a:u[t+1]?u[t+1][Y]:e[ot],h=a>=s&&d>a;if(!l&&h)"LI"!==n.tagName||Vt(n,Wt)||(Kt(n,Wt),l=!0,o&&!Vt(o,Wt)&&Kt(o,Wt),le.call(e,"activate","scrollspy",c[t]));else if(h){if(!h&&!l||l&&h)return}else"LI"===n.tagName&&Vt(n,Wt)&&(Qt(n,Wt),l=!1,o&&Vt(o,Wt)&&!te(n[kt],Wt).length&&Qt(o,Wt))},b=function(){a=f?he().y:e[K];for(var t=0,n=c[Dt];t<n;t++)v(t)};this.refresh=function(){b()},g in e||(ie(s,dt,this.refresh),o&&o<9||ie(t,ft,this.refresh)),this.refresh(),e[g]=this}};ue(g,Ie,l);var Ce=function(t,e){t=ee(t);var n=t[wt](I),i="tab",o="height",a="isAnimating";t[a]=!1,e=e||{},this[o]=!!Yt&&(e[o]||"true"===n);var r,l,c=this,u=ne(t,".nav"),s=ee(".dropdown",u),f=function(){var t,e=te(u,Wt);return 1!==e[Dt]||Vt(e[0],"dropdown")?e[Dt]>1&&(t=e[e[Dt]-1]):t=e[0],t[Ct]("A")[0]},d=function(){return ee(f()[wt]("href"))},h=function(t){t.preventDefault(),r=t[O],c.show()};this.show=function(){var e=ee(r[wt]("href")),n=f(),c=d();n[a]&&r[a]||Vt(r[kt],Wt)||(n[a]=r[a]=!0,Qt(n[kt],Wt),Kt(r[kt],Wt),s&&(Vt(t[kt][kt],"dropdown-menu")?Vt(s,Wt)||Kt(s,Wt):Vt(s,Wt)&&Qt(s,Wt)),l&&(l[Pt][o]=fe(c)+"px"),le.call(n,mt,i,r),setTimeout(function(){Qt(c,qt)},0),re(c,function(){l&&Kt(l,$t),Qt(c,Wt),Kt(e,Wt),setTimeout(function(){Kt(e,qt),l&&(l[Pt][o]=fe(e)+"px")},0),le.call(r,ht,i,n),le.call(n,vt,i,r)}),re(e,function(){le.call(r,pt,i,n),l?setTimeout(function(){re(l,function(){l[Pt][o]="",Qt(l,$t),n[a]=r[a]=!1})},0):n[a]=r[a]=!1}))},b in t||ie(t,ct,h),this[o]&&(l=d()[kt]),t[b]=this};ue(b,Ce,a);var Le=function(t,e){t=ee(t);var n=t[wt](k);placementData=t[wt](H),delayData=t[wt](B),containerData=t[wt](D),component="tooltip",classString="class",title="title",fade="fade",div="div",e=e||{},this[F]=e[F]&&e[F]!==fade?e[F]:n||fade,this[U]=e[U]?e[U]:placementData||_t,this[$]=parseInt(e[$]||delayData)||200,this[X]=ee(e[X])||ee(containerData)||i;var o=this,a=0,r=this[U],l=null,c=t[wt](title)||t[wt](L);if(c){var u=function(){o[X].removeChild(l),l=null,a=null},s=function(){c=t[wt](title)||t[wt](L),l=document.createElement(div),l[Et]("role",component);var e=document.createElement(div),n=document.createElement(div);e[Et](classString,component+"-arrow"),n[Et](classString,component+"-inner"),l.appendChild(e),l.appendChild(n),n.innerHTML=c,o[X].appendChild(l),l[Et](classString,component+" "+r+" "+o[F])},f=function(){pe(t,l,r,o[X]),de(l)||(r=me(r),pe(t,l,r,o[X]))},d=function(){!Vt(l,qt)&&Kt(l,qt)};this.show=function(){clearTimeout(a),a=setTimeout(function(){null===l&&(r=o[U],s(),f(),d(),le.call(t,ht,component),re(l,function(){le.call(t,pt,component)}))},20)},this.hide=function(){clearTimeout(a),a=setTimeout(function(){l&&null!==l&&Vt(l,qt)&&(le.call(t,mt,component),Qt(l,qt),re(l,function(){u(),le.call(t,vt,component)}))},o[$])},this.toggle=function(){l?o.hide():o.show()},y in t||(t[Et](L,c),t.removeAttribute(title),ie(t,Ut[0],this.show),ie(t,Ut[1],this.hide)),t[y]=this}};return ue(y,Le,a),{Affix:ve,Alert:ge,Button:be,Carousel:ye,Collapse:xe,Dropdown:Te,Modal:we,Popover:Ee,ScrollSpy:Ie,Tab:Ce,Tooltip:Le}})}).call(e,function(){return this}())}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbXktY29tLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAwM2M0YmE1YzIzNDlmZTYxZjYzZSIsIndlYnBhY2s6Ly8vLi9qcy9sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9ib290c3RyYXAubmF0aXZlL2Rpc3QvYm9vdHN0cmFwLW5hdGl2ZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfYm9vdHN0cmFwIiwiZG9jdW1lbnQiLCJib2R5IiwiYmxuUmVtb3ZlU3VtYml0IiwiZWxtSW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImJ0blN1bWJpdCIsInF1ZXJ5U2VsZWN0b3IiLCJidG5GaW5kUGVyc29uIiwiZm9yRWFjaCIsImN1cjIiLCJ2YWx1ZSIsInRyaW0iLCJsZW5ndGgiLCJuYW1lIiwic2V0QXR0cmlidXRlIiwiY3VyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImJsblN1bWJpdCIsImN1clBsYWNlZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsInJlbW92ZUF0dHJpYnV0ZSIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18iLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18iLCJnbG9iYWwiLCJyb290IiwiZmFjdG9yeSIsImFwcGx5IiwidW5kZWZpbmVkIiwidGhpcyIsImdsb2JhbE9iamVjdCIsIndpbmRvdyIsImRvYyIsImRvY3VtZW50RWxlbWVudCIsImlzSUUiLCJSZWdFeHAiLCJleGVjIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwicGFyc2VGbG9hdCIsIiQxIiwiZGF0YVRvZ2dsZSIsImRhdGFEaXNtaXNzIiwiZGF0YVNweSIsImRhdGFSaWRlIiwic3RyaW5nQWZmaXgiLCJzdHJpbmdBbGVydCIsInN0cmluZ0J1dHRvbiIsInN0cmluZ0Nhcm91c2VsIiwic3RyaW5nQ29sbGFwc2UiLCJzdHJpbmdEcm9wZG93biIsInN0cmluZ01vZGFsIiwic3RyaW5nUG9wb3ZlciIsInN0cmluZ1Njcm9sbFNweSIsInN0cmluZ1RhYiIsInN0cmluZ1Rvb2x0aXAiLCJkYXRhYmFja2Ryb3AiLCJkYXRhS2V5Ym9hcmQiLCJkYXRhVGFyZ2V0IiwiZGF0YUludGVydmFsIiwiZGF0YUhlaWdodCIsImRhdGFQYXVzZSIsImRhdGFPcmlnaW5hbFRpdGxlIiwiZGF0YU9yaWdpbmFsVGV4dCIsImRhdGFEaXNtaXNzaWJsZSIsImRhdGFUcmlnZ2VyIiwiZGF0YUFuaW1hdGlvbiIsImRhdGFDb250YWluZXIiLCJkYXRhUGxhY2VtZW50IiwiZGF0YURlbGF5IiwiZGF0YU9mZnNldFRvcCIsImRhdGFPZmZzZXRCb3R0b20iLCJiYWNrZHJvcCIsImtleWJvYXJkIiwiZGVsYXkiLCJkdXJhdGlvbiIsImNvbnRlbnQiLCJ0YXJnZXQiLCJpbnRlcnZhbCIsInBhdXNlIiwiYW5pbWF0aW9uIiwicGxhY2VtZW50IiwiY29udGFpbmVyIiwib2Zmc2V0VG9wIiwib2Zmc2V0Qm90dG9tIiwib2Zmc2V0TGVmdCIsInNjcm9sbFRvcCIsInNjcm9sbExlZnQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsIm9mZnNldFdpZHRoIiwib2Zmc2V0SGVpZ2h0IiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0Iiwic2Nyb2xsSGVpZ2h0IiwiaGVpZ2h0IiwiYXJpYUV4cGFuZGVkIiwiYXJpYUhpZGRlbiIsImNsaWNrRXZlbnQiLCJob3ZlckV2ZW50Iiwia2V5ZG93bkV2ZW50IiwicmVzaXplRXZlbnQiLCJzY3JvbGxFdmVudCIsInNob3dFdmVudCIsInNob3duRXZlbnQiLCJoaWRlRXZlbnQiLCJoaWRkZW5FdmVudCIsImNsb3NlRXZlbnQiLCJjbG9zZWRFdmVudCIsInNsaWRFdmVudCIsInNsaWRlRXZlbnQiLCJjaGFuZ2VFdmVudCIsImdldEF0dHJpYnV0ZSIsImhhc0F0dHJpYnV0ZSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiZ2V0RWxlbWVudHNCeUNMQVNTTkFNRSIsImluZGV4T2YiLCJwYXJlbnROb2RlIiwidG9Mb3dlckNhc2UiLCJUcmFuc2l0aW9uIiwiV2Via2l0Iiwic3R5bGUiLCJhY3RpdmUiLCJpbkNsYXNzIiwiY29sbGFwc2luZyIsImRpc2FibGVkIiwibG9hZGluZyIsImxlZnQiLCJyaWdodCIsInRvcCIsImJvdHRvbSIsIm1vdXNlSG92ZXIiLCJ0aXBQb3NpdGlvbnMiLCJzdXBwb3J0VHJhbnNpdGlvbnMiLCJ0cmFuc2l0aW9uRW5kRXZlbnQiLCJzZXRGb2N1cyIsImVsZW1lbnQiLCJmb2N1cyIsInNldEFjdGl2ZSIsImFkZENsYXNzIiwiY2xhc3NOQU1FIiwicmVtb3ZlQ2xhc3MiLCJoYXNDbGFzcyIsImNvbnRhaW5zIiwibm9kZUxpc3RUb0FycmF5Iiwibm9kZUxpc3QiLCJjaGlsZEl0ZW1zIiwiaSIsIm5sbCIsInB1c2giLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwic2VsZWN0aW9uTWV0aG9kIiwicmVwbGFjZSIsInF1ZXJ5RWxlbWVudCIsInNlbGVjdG9yIiwicGFyZW50IiwibG9va1VwIiwiZ2V0Q2xvc2VzdCIsImZpcnN0Q2hhciIsImNoYXJBdCIsInN1YnN0ciIsIm9uIiwiaGFuZGxlciIsIm9mZiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvbmUiLCJoYW5kbGVyV3JhcHBlciIsImVtdWxhdGVUcmFuc2l0aW9uRW5kIiwiYm9vdHN0cmFwQ3VzdG9tRXZlbnQiLCJldmVudE5hbWUiLCJjb21wb25lbnROYW1lIiwicmVsYXRlZCIsIk9yaWdpbmFsQ3VzdG9tRXZlbnQiLCJDdXN0b21FdmVudCIsInJlbGF0ZWRUYXJnZXQiLCJkaXNwYXRjaEV2ZW50IiwiQWxsRE9NRWxlbWVudHMiLCJpbml0aWFsaXplRGF0YUFQSSIsImNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwiZGF0YUF0dHJpYnV0ZSIsImNvbGxlY3Rpb24iLCJhdHRyVmFsdWUiLCJleHBlY3RlZEF0dHJWYWx1ZSIsImdldE91dGVySGVpZ2h0IiwiY2hpbGQiLCJjaGlsZFN0eWxlIiwiY3VycmVudFN0eWxlIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImJ0cCIsInRlc3QiLCJib3JkZXJUb3BXaWR0aCIsIk1hdGgiLCJyb3VuZCIsImJ0YiIsImJvcmRlckJvdHRvbVdpZHRoIiwibXRwIiwibWFyZ2luVG9wIiwibWJwIiwibWFyZ2luQm90dG9tIiwicGFyc2VJbnQiLCJnZXRNYXhIZWlnaHQiLCJwYXJlbnRIZWlnaHQiLCJrIiwibGwiLCJjaGlsZHJlbiIsImlzRWxlbWVudEluVmlld3BvcnQiLCJyZWN0IiwiZ2V0U2Nyb2xsIiwieSIsInBhZ2VZT2Zmc2V0IiwieCIsInBhZ2VYT2Zmc2V0Iiwic3R5bGVUaXAiLCJsaW5rIiwicG9zaXRpb24iLCJzY3JvbGwiLCJsaW5rRGltZW5zaW9ucyIsInciLCJoIiwiZWxlbWVudERpbWVuc2lvbnMiLCJjbGFzc05hbWUiLCJ1cGRhdGVQbGFjZW1lbnQiLCJBZmZpeCIsIm9wdGlvbnMiLCJ0YXJnZXREYXRhIiwib2Zmc2V0VG9wRGF0YSIsIm9mZnNldEJvdHRvbURhdGEiLCJhZmZpeCIsImFmZml4ZWQiLCJmbiIsInVwZGF0ZSIsImFmZml4VG9wIiwiYWZmaXhlZFRvcCIsImFmZml4Qm90dG9tIiwiYWZmaXhlZEJvdHRvbSIsInBpbk9mZnNldFRvcCIsInBpbk9mZnNldEJvdHRvbSIsIm1heFNjcm9sbCIsInNjcm9sbFkiLCJwaW5uZWRUb3AiLCJwaW5uZWRCb3R0b20iLCJzZWxmIiwicmVzaXplRGVsYXkiLCJhZmZpeGVkVG9Ub3AiLCJhZmZpeGVkVG9Cb3R0b20iLCJnZXRNYXhTY3JvbGwiLCJtYXgiLCJnZXRPZmZzZXRUb3AiLCJnZXRPZmZzZXRCb3R0b20iLCJjaGVja1Bvc2l0aW9uIiwicGluVG9wIiwidW5QaW5Ub3AiLCJwaW5Cb3R0b20iLCJ1blBpbkJvdHRvbSIsInVwZGF0ZVBpbiIsInNldFRpbWVvdXQiLCJBbGVydCIsImFsZXJ0IiwiY2xpY2tIYW5kbGVyIiwiZSIsImV2ZW50VGFyZ2V0IiwiY2xvc2UiLCJ0cmFuc2l0aW9uRW5kSGFuZGxlciIsInJlbW92ZUNoaWxkIiwiQnV0dG9uIiwib3B0aW9uIiwidG9nZ2xlZCIsImNoZWNrZWQiLCJyZXNldCIsIkxBQkVMIiwiSU5QVVQiLCJzZXRTdGF0ZSIsImlubmVySFRNTCIsInJlc2V0U3RhdGUiLCJ0b2dnbGUiLCJsYWJlbCIsInRhZ05hbWUiLCJsYWJlbHMiLCJpbnB1dCIsInR5cGUiLCJvdGhlckxhYmVsIiwib3RoZXJJbnB1dCIsIkNhcm91c2VsIiwiaW50ZXJ2YWxEYXRhIiwicGF1c2VEYXRhIiwia2V5Ym9hcmREYXRhIiwicGF1c2VkIiwiZGlyZWN0aW9uIiwiZGF0YVNsaWRlVG8iLCJpbmRleCIsInRpbWVyIiwiaXNTbGlkaW5nIiwic2xpZGVzIiwidG90YWwiLCJzbGlkZURpcmVjdGlvbiIsImNvbnRyb2xzIiwibGVmdEFycm93IiwicmlnaHRBcnJvdyIsImluZGljYXRvciIsImluZGljYXRvcnMiLCJwYXVzZUhhbmRsZXIiLCJjbGVhckludGVydmFsIiwicmVzdW1lSGFuZGxlciIsImN5Y2xlIiwiaW5kaWNhdG9ySGFuZGxlciIsImFjdGl2ZUluZGljYXRvciIsImdldEFjdGl2ZUluZGV4Iiwic2xpZGVUbyIsImNvbnRyb2xzSGFuZGxlciIsImN1cnJlbnRUYXJnZXQiLCJzcmNFbGVtZW50Iiwia2V5SGFuZGxlciIsIndoaWNoIiwic2V0QWN0aXZlUGFnZSIsInBhZ2VJbmRleCIsImljbCIsInNldEludGVydmFsIiwibmV4dCIsImFjdGl2ZUl0ZW0iLCJvcmllbnRhdGlvbiIsIkNvbGxhcHNlIiwiYWNjb3JkaW9uIiwiY29sbGFwc2UiLCJpc0FuaW1hdGluZyIsImFjY29yZGlvbkRhdGEiLCJjb2xsYXBzZWQiLCJvcGVuQWN0aW9uIiwiY29sbGFwc2VFbGVtZW50IiwiY2xvc2VBY3Rpb24iLCJnZXRUYXJnZXQiLCJocmVmIiwiaGlkZSIsInNob3ciLCJhY3RpdmVDb2xsYXBzZXMiLCJhbCIsIkRyb3Bkb3duIiwicGVyc2lzdCIsImlzT3BlbiIsIm9wZW4iLCJtZW51Iiwia2V5Q29kZSIsImhhc0RhdGEiLCJub2RlVHlwZSIsIk1vZGFsIiwiYnRuQ2hlY2siLCJjaGVja01vZGFsIiwibW9kYWwiLCJzdGF0aWNTdHJpbmciLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCIsIm1vZGFsQmFja2Ryb3BTdHJpbmciLCJib2R5SXNPdmVyZmxvd2luZyIsIm1vZGFsSXNPdmVyZmxvd2luZyIsInNjcm9sbGJhcldpZHRoIiwib3ZlcmxheSIsImdldFdpbmRvd1dpZHRoIiwiaHRtbFJlY3QiLCJhYnMiLCJzZXRTY3JvbGxiYXIiLCJib2R5U3R5bGUiLCJib2R5UGFkIiwicmVzZXRTY3JvbGxiYXIiLCJtZWFzdXJlU2Nyb2xsYmFyIiwic2Nyb2xsQmFyV2lkdGgiLCJzY3JvbGxEaXYiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJjaGVja1Njcm9sbGJhciIsImFkanVzdERpYWxvZyIsInJlc2V0QWRqdXN0bWVudHMiLCJjcmVhdGVPdmVybGF5IiwibmV3T3ZlcmxheSIsInJlbW92ZU92ZXJsYXkiLCJrZXlkb3duSGFuZGxlclRvZ2dsZSIsInJlc2l6ZUhhbmRsZXJUb2dnbGUiLCJkaXNtaXNzSGFuZGxlclRvZ2dsZSIsImRpc21pc3NIYW5kbGVyIiwiY2xpY2tUYXJnZXQiLCJtb2RhbFRyaWdnZXIiLCJrZXkiLCJjdXJyZW50T3BlbiIsImRpc3BsYXkiLCJzZXRDb250ZW50IiwiUG9wb3ZlciIsInRyaWdnZXJEYXRhIiwiYW5pbWF0aW9uRGF0YSIsInBsYWNlbWVudERhdGEiLCJkaXNtaXNzaWJsZURhdGEiLCJkZWxheURhdGEiLCJjb250YWluZXJEYXRhIiwidGVtcGxhdGUiLCJ0cmlnZ2VyIiwiY2xhc3NTdHJpbmciLCJkaXYiLCJmYWRlIiwiZGF0YVRpdGxlIiwiZGF0YUNvbnRlbnQiLCJkaXNtaXNzaWJsZSIsImNsb3NlQnRuIiwidGl0bGVTdHJpbmciLCJjb250ZW50U3RyaW5nIiwicG9wb3ZlciIsInBsYWNlbWVudFNldHRpbmciLCJkaXNtaXNzaWJsZUhhbmRsZXIiLCJyZW1vdmVQb3BvdmVyIiwiY3JlYXRlUG9wb3ZlciIsInBvcG92ZXJUaXRsZSIsInBvcG92ZXJBcnJvdyIsInBvcG92ZXJDb250ZW50IiwicG9wb3ZlclRlbXBsYXRlIiwiZmlyc3RDaGlsZCIsInNob3dQb3BvdmVyIiwidXBkYXRlUG9wb3ZlciIsImNsZWFyVGltZW91dCIsIlNjcm9sbFNweSIsInNjcm9sbE9mZnNldCIsInNweVRhcmdldCIsImxpbmtzIiwiaXRlbXMiLCJ0YXJnZXRJdGVtcyIsInNjcm9sbFRhcmdldCIsImlzV2luZG93IiwiaWwiLCJ0YXJnZXRJdGVtIiwidXBkYXRlSXRlbSIsImRyb3Bkb3duIiwidGFyZ2V0UmVjdCIsImlzQWN0aXZlIiwidG9wRWRnZSIsImJvdHRvbUVkZ2UiLCJpbnNpZGUiLCJ1cGRhdGVJdGVtcyIsIml0bCIsInJlZnJlc2giLCJUYWIiLCJoZWlnaHREYXRhIiwidGFic0NvbnRlbnRDb250YWluZXIiLCJ0YWJzIiwiZ2V0QWN0aXZlVGFiIiwiYWN0aXZlVGFiIiwiYWN0aXZlVGFicyIsImdldEFjdGl2ZUNvbnRlbnQiLCJuZXh0Q29udGVudCIsImFjdGl2ZUNvbnRlbnQiLCJUb29sdGlwIiwidGl0bGUiLCJ0b29sdGlwIiwicmVtb3ZlVG9vbFRpcCIsImNyZWF0ZVRvb2xUaXAiLCJ0b29sdGlwQXJyb3ciLCJ0b29sdGlwSW5uZXIiLCJ1cGRhdGVUb29sdGlwIiwic2hvd1Rvb2x0aXAiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FD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LEVBQVUsV0FBYSxNQUFPOEMiLCJmaWxlIjoibXktY29tLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgX2Jvb3RzdHJhcCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX2Jvb3RzdHJhcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ib290c3RyYXApO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdGlmIChkb2N1bWVudC5ib2R5LmlkID09ICdmaW5kUGVyc29uQm9keScpIHtcblx0ICAgIChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGJsblJlbW92ZVN1bWJpdCA9IHRydWU7XG5cdCAgICAgICAgdmFyIGVsbUlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzZWFyY2hQZXJzb24gaW5wdXQnKTtcblx0ICAgICAgICB2YXIgYnRuU3VtYml0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmaW5kUGVyc29uXCIpO1xuXHQgICAgICAgIHZhciBidG5GaW5kUGVyc29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlYXJjaFBob25lJyk7XG5cdFxuXHQgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChjdXIyKSB7XG5cdCAgICAgICAgICAgIGlmIChjdXIyLnZhbHVlLnRyaW0oKS5sZW5ndGggPT0gMCAmJiAoY3VyMi5uYW1lID09ICdsYXN0LW5hbWUnIHx8IGN1cjIubmFtZSA9PSAnZmlyc3QtbmFtZScpKSB7XG5cdCAgICAgICAgICAgICAgICBibG5SZW1vdmVTdW1iaXQgPSBmYWxzZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBibG5SZW1vdmVTdW1iaXQgPT09IGZhbHNlID8gYnRuU3VtYml0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnZGlzYWJsZWQnKSA6IG51bGw7XG5cdFxuXHQgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChjdXIpIHtcblx0ICAgICAgICAgICAgY3VyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGJsblN1bWJpdCA9IHRydWU7XG5cdFxuXHQgICAgICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGN1clBsYWNlZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChjdXJQbGFjZWQudmFsdWUudHJpbSgpLmxlbmd0aCA9PSAwICYmIChjdXJQbGFjZWQubmFtZSA9PSAnbGFzdC1uYW1lJyB8fCBjdXJQbGFjZWQubmFtZSA9PSAnZmlyc3QtbmFtZScpKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbG1JbnB1dHNbMF0udmFsdWUudHJpbSgpLmxlbmd0aCA8IDggfHwgZWxtSW5wdXRzWzBdLm5hbWUgIT0gJ3Bob25lLW51bWJlcicpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsblN1bWJpdCA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyUGxhY2VkLmNsYXNzTGlzdC5hZGQoJ215RXJyb3InKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ0bkZpbmRQZXJzb24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxuU3VtYml0ID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1clBsYWNlZC5jbGFzc0xpc3QucmVtb3ZlKCdteUVycm9yJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBidG5GaW5kUGVyc29uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGN1clBsYWNlZC5jbGFzc0xpc3QucmVtb3ZlKCdteUVycm9yJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgYmxuU3VtYml0ID09PSB0cnVlID8gYnRuU3VtYml0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKSA6IGJ0blN1bWJpdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBidG5GaW5kUGVyc29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhY3Rpb24nKS52YWx1ZSA9IFwic2VhcmNoQnlQaG9uZVwiO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYnRuQ2xlYXInKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgICAgICBlbG1JbnB1dHMuZm9yRWFjaChmdW5jdGlvbiAoY3VyKSB7XG5cdCAgICAgICAgICAgICAgICBjdXIudmFsdWUgPSAnJztcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICB9KSgpO1xuXHR9IC8qXG5cdCAgZnVuY3Rpb24gY2hlY2tWYWx1ZXMgKGVsbU5hbWUpIHtcblx0ICAgICAgYWxlcnQoZWxtTmFtZSk7XG5cdCAgfVxuXHQgIFxuXHQgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzZWFyY2hQZXJzb24gaW5wdXQnKS5mb3JFYWNoKChjdXIpID0+IHtcblx0ICAgICAgY3VyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgY2hlY2tWYWx1ZXMoJyNzZWFyY2hQZXJzb24nKSk7XG5cdCAgfSk7Ki9cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvLyBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgdjIuMC40IHwgwqkgZG5wX3RoZW1lIHwgTUlULUxpY2Vuc2Vcblx0KGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG5cdCAgaWYgKHRydWUpIHtcblx0ICAgIC8vIEFNRCBzdXBwb3J0OlxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW10sIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9IChmYWN0b3J5KSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSAodHlwZW9mIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9PT0gJ2Z1bmN0aW9uJyA/IChfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXykpIDogX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0ICAgIC8vIENvbW1vbkpTLWxpa2U6XG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdylcblx0ICAgIHZhciBic24gPSBmYWN0b3J5KCk7XG5cdCAgICByb290LkFmZml4ID0gYnNuLkFmZml4O1xuXHQgICAgcm9vdC5BbGVydCA9IGJzbi5BbGVydDtcblx0ICAgIHJvb3QuQnV0dG9uID0gYnNuLkJ1dHRvbjtcblx0ICAgIHJvb3QuQ2Fyb3VzZWwgPSBic24uQ2Fyb3VzZWw7XG5cdCAgICByb290LkNvbGxhcHNlID0gYnNuLkNvbGxhcHNlO1xuXHQgICAgcm9vdC5Ecm9wZG93biA9IGJzbi5Ecm9wZG93bjtcblx0ICAgIHJvb3QuTW9kYWwgPSBic24uTW9kYWw7XG5cdCAgICByb290LlBvcG92ZXIgPSBic24uUG9wb3Zlcjtcblx0ICAgIHJvb3QuU2Nyb2xsU3B5ID0gYnNuLlNjcm9sbFNweTtcblx0ICAgIHJvb3QuVGFiID0gYnNuLlRhYjtcblx0ICAgIHJvb3QuVG9vbHRpcCA9IGJzbi5Ub29sdGlwO1xuXHQgIH1cblx0fSh0aGlzLCBmdW5jdGlvbiAoKSB7XG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgSW50ZXJuYWwgVXRpbGl0eSBGdW5jdGlvbnNcblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBnbG9iYWxzXG5cdCAgdmFyIGdsb2JhbE9iamVjdCA9IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdGhpc3x8d2luZG93LFxuXHQgICAgZG9jID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBib2R5ID0gZG9jdW1lbnQuYm9keSxcblx0ICBcblx0ICAgIC8vIElFIGJyb3dzZXIgZGV0ZWN0XG5cdCAgICBpc0lFID0gKG5ldyBSZWdFeHAoXCJNU0lFIChbMC05XXsxLH1bXFwuMC05XXswLH0pXCIpLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudCkgIT0gbnVsbCkgPyBwYXJzZUZsb2F0KCBSZWdFeHAuJDEgKSA6IGZhbHNlLCAgXG5cdCAgXG5cdCAgICAvLyBmdW5jdGlvbiB0b2dnbGUgYXR0cmlidXRlc1xuXHQgICAgZGF0YVRvZ2dsZSAgICA9ICdkYXRhLXRvZ2dsZScsXG5cdCAgICBkYXRhRGlzbWlzcyAgID0gJ2RhdGEtZGlzbWlzcycsXG5cdCAgICBkYXRhU3B5ICAgICAgID0gJ2RhdGEtc3B5Jyxcblx0ICAgIGRhdGFSaWRlICAgICAgPSAnZGF0YS1yaWRlJyxcblx0ICAgIFxuXHQgICAgLy8gY29tcG9uZW50c1xuXHQgICAgc3RyaW5nQWZmaXggICAgID0gJ0FmZml4Jyxcblx0ICAgIHN0cmluZ0FsZXJ0ICAgICA9ICdBbGVydCcsXG5cdCAgICBzdHJpbmdCdXR0b24gICAgPSAnQnV0dG9uJyxcblx0ICAgIHN0cmluZ0Nhcm91c2VsICA9ICdDYXJvdXNlbCcsXG5cdCAgICBzdHJpbmdDb2xsYXBzZSAgPSAnQ29sbGFwc2UnLFxuXHQgICAgc3RyaW5nRHJvcGRvd24gID0gJ0Ryb3Bkb3duJyxcblx0ICAgIHN0cmluZ01vZGFsICAgICA9ICdNb2RhbCcsXG5cdCAgICBzdHJpbmdQb3BvdmVyICAgPSAnUG9wb3ZlcicsXG5cdCAgICBzdHJpbmdTY3JvbGxTcHkgPSAnU2Nyb2xsU3B5Jyxcblx0ICAgIHN0cmluZ1RhYiAgICAgICA9ICdUYWInLFxuXHQgICAgc3RyaW5nVG9vbHRpcCAgID0gJ1Rvb2x0aXAnLFxuXHQgIFxuXHQgICAgLy8gb3B0aW9ucyBEQVRBIEFQSVxuXHQgICAgZGF0YWJhY2tkcm9wICAgICAgPSAnZGF0YS1iYWNrZHJvcCcsXG5cdCAgICBkYXRhS2V5Ym9hcmQgICAgICA9ICdkYXRhLWtleWJvYXJkJyxcblx0ICAgIGRhdGFUYXJnZXQgICAgICAgID0gJ2RhdGEtdGFyZ2V0Jyxcblx0ICAgIGRhdGFJbnRlcnZhbCAgICAgID0gJ2RhdGEtaW50ZXJ2YWwnLFxuXHQgICAgZGF0YUhlaWdodCAgICAgICAgPSAnZGF0YS1oZWlnaHQnLFxuXHQgICAgZGF0YVBhdXNlICAgICAgICAgPSAnZGF0YS1wYXVzZScsXG5cdCAgICBkYXRhT3JpZ2luYWxUaXRsZSA9ICdkYXRhLW9yaWdpbmFsLXRpdGxlJyxcblx0ICAgIGRhdGFPcmlnaW5hbFRleHQgID0gJ2RhdGEtb3JpZ2luYWwtdGV4dCcsXG5cdCAgICBkYXRhRGlzbWlzc2libGUgICA9ICdkYXRhLWRpc21pc3NpYmxlJyxcblx0ICAgIGRhdGFUcmlnZ2VyICAgICAgID0gJ2RhdGEtdHJpZ2dlcicsXG5cdCAgICBkYXRhQW5pbWF0aW9uICAgICA9ICdkYXRhLWFuaW1hdGlvbicsXG5cdCAgICBkYXRhQ29udGFpbmVyICAgICA9ICdkYXRhLWNvbnRhaW5lcicsXG5cdCAgICBkYXRhUGxhY2VtZW50ICAgICA9ICdkYXRhLXBsYWNlbWVudCcsXG5cdCAgICBkYXRhRGVsYXkgICAgICAgICA9ICdkYXRhLWRlbGF5Jyxcblx0ICAgIGRhdGFPZmZzZXRUb3AgICAgID0gJ2RhdGEtb2Zmc2V0LXRvcCcsXG5cdCAgICBkYXRhT2Zmc2V0Qm90dG9tICA9ICdkYXRhLW9mZnNldC1ib3R0b20nLFxuXHQgIFxuXHQgICAgLy8gb3B0aW9uIGtleXNcblx0ICAgIGJhY2tkcm9wID0gJ2JhY2tkcm9wJywga2V5Ym9hcmQgPSAna2V5Ym9hcmQnLCBkZWxheSA9ICdkZWxheScsXG5cdCAgICBkdXJhdGlvbiA9ICdkdXJhdGlvbicsIGNvbnRlbnQgPSAnY29udGVudCcsIHRhcmdldCA9ICd0YXJnZXQnLCBcblx0ICAgIGludGVydmFsID0gJ2ludGVydmFsJywgcGF1c2UgPSAncGF1c2UnLCBhbmltYXRpb24gPSAnYW5pbWF0aW9uJyxcblx0ICAgIHBsYWNlbWVudCA9ICdwbGFjZW1lbnQnLCBjb250YWluZXIgPSAnY29udGFpbmVyJywgXG5cdCAgXG5cdCAgICAvLyBib3ggbW9kZWxcblx0ICAgIG9mZnNldFRvcCAgICA9ICdvZmZzZXRUb3AnLCAgICAgIG9mZnNldEJvdHRvbSAgID0gJ29mZnNldEJvdHRvbScsXG5cdCAgICBvZmZzZXRMZWZ0ICAgPSAnb2Zmc2V0TGVmdCcsXG5cdCAgICBzY3JvbGxUb3AgICAgPSAnc2Nyb2xsVG9wJywgICAgICBzY3JvbGxMZWZ0ICAgICA9ICdzY3JvbGxMZWZ0Jyxcblx0ICAgIGNsaWVudFdpZHRoICA9ICdjbGllbnRXaWR0aCcsICAgIGNsaWVudEhlaWdodCAgID0gJ2NsaWVudEhlaWdodCcsXG5cdCAgICBvZmZzZXRXaWR0aCAgPSAnb2Zmc2V0V2lkdGgnLCAgICBvZmZzZXRIZWlnaHQgICA9ICdvZmZzZXRIZWlnaHQnLFxuXHQgICAgaW5uZXJXaWR0aCAgID0gJ2lubmVyV2lkdGgnLCAgICAgaW5uZXJIZWlnaHQgICAgPSAnaW5uZXJIZWlnaHQnLFxuXHQgICAgc2Nyb2xsSGVpZ2h0ID0gJ3Njcm9sbEhlaWdodCcsICAgaGVpZ2h0ICAgICAgICAgPSAnaGVpZ2h0Jyxcblx0ICBcblx0ICAgIC8vIGFyaWFcblx0ICAgIGFyaWFFeHBhbmRlZCA9ICdhcmlhLWV4cGFuZGVkJyxcblx0ICAgIGFyaWFIaWRkZW4gICA9ICdhcmlhLWhpZGRlbicsXG5cdCAgXG5cdCAgICAvLyBldmVudCBuYW1lc1xuXHQgICAgY2xpY2tFdmVudCAgICA9ICdjbGljaycsXG5cdCAgICBob3ZlckV2ZW50ICAgID0gJ2hvdmVyJyxcblx0ICAgIGtleWRvd25FdmVudCAgPSAna2V5ZG93bicsXG5cdCAgICByZXNpemVFdmVudCAgID0gJ3Jlc2l6ZScsXG5cdCAgICBzY3JvbGxFdmVudCAgID0gJ3Njcm9sbCcsXG5cdCAgICAvLyBvcmlnaW5hbEV2ZW50c1xuXHQgICAgc2hvd0V2ZW50ICAgICA9ICdzaG93Jyxcblx0ICAgIHNob3duRXZlbnQgICAgPSAnc2hvd24nLFxuXHQgICAgaGlkZUV2ZW50ICAgICA9ICdoaWRlJyxcblx0ICAgIGhpZGRlbkV2ZW50ICAgPSAnaGlkZGVuJyxcblx0ICAgIGNsb3NlRXZlbnQgICAgPSAnY2xvc2UnLFxuXHQgICAgY2xvc2VkRXZlbnQgICA9ICdjbG9zZWQnLFxuXHQgICAgc2xpZEV2ZW50ICAgICA9ICdzbGlkJyxcblx0ICAgIHNsaWRlRXZlbnQgICAgPSAnc2xpZGUnLFxuXHQgICAgY2hhbmdlRXZlbnQgICA9ICdjaGFuZ2UnLFxuXHQgIFxuXHQgICAgLy8gb3RoZXJcblx0ICAgIGdldEF0dHJpYnV0ZSAgICAgICAgID0gJ2dldEF0dHJpYnV0ZScsXG5cdCAgICBzZXRBdHRyaWJ1dGUgICAgICAgICA9ICdzZXRBdHRyaWJ1dGUnLFxuXHQgICAgaGFzQXR0cmlidXRlICAgICAgICAgPSAnaGFzQXR0cmlidXRlJyxcblx0ICAgIGdldEVsZW1lbnRzQnlUYWdOYW1lID0gJ2dldEVsZW1lbnRzQnlUYWdOYW1lJyxcblx0ICAgIGdldEJvdW5kaW5nQ2xpZW50UmVjdD0gJ2dldEJvdW5kaW5nQ2xpZW50UmVjdCcsXG5cdCAgICBxdWVyeVNlbGVjdG9yQWxsICAgICA9ICdxdWVyeVNlbGVjdG9yQWxsJyxcblx0ICAgIGdldEVsZW1lbnRzQnlDTEFTU05BTUUgPSAnZ2V0RWxlbWVudHNCeUNsYXNzTmFtZScsXG5cdCAgXG5cdCAgICBpbmRleE9mICAgICAgPSAnaW5kZXhPZicsXG5cdCAgICBwYXJlbnROb2RlICAgPSAncGFyZW50Tm9kZScsXG5cdCAgICBsZW5ndGggICAgICAgPSAnbGVuZ3RoJyxcblx0ICAgIHRvTG93ZXJDYXNlICA9ICd0b0xvd2VyQ2FzZScsXG5cdCAgICBUcmFuc2l0aW9uICAgPSAnVHJhbnNpdGlvbicsXG5cdCAgICBXZWJraXQgICAgICAgPSAnV2Via2l0Jyxcblx0ICAgIHN0eWxlICAgICAgICA9ICdzdHlsZScsXG5cdCAgICBcblx0ICAgIGFjdGl2ZSAgICAgPSAnYWN0aXZlJyxcblx0ICAgIGluQ2xhc3MgICAgPSAnaW4nLFxuXHQgICAgY29sbGFwc2luZyA9ICdjb2xsYXBzaW5nJyxcblx0ICAgIGRpc2FibGVkICAgPSAnZGlzYWJsZWQnLFxuXHQgICAgbG9hZGluZyAgICA9ICdsb2FkaW5nJyxcblx0ICAgIGxlZnQgICAgICAgPSAnbGVmdCcsXG5cdCAgICByaWdodCAgICAgID0gJ3JpZ2h0Jyxcblx0ICAgIHRvcCAgICAgICAgPSAndG9wJyxcblx0ICAgIGJvdHRvbSAgICAgPSAnYm90dG9tJyxcblx0ICBcblx0ICAgIC8vIHRvb2x0aXAgLyBwb3BvdmVyXG5cdCAgICBtb3VzZUhvdmVyID0gKCdvbm1vdXNlbGVhdmUnIGluIGRvY3VtZW50KSA/IFsgJ21vdXNlZW50ZXInLCAnbW91c2VsZWF2ZSddIDogWyAnbW91c2VvdmVyJywgJ21vdXNlb3V0JyBdLFxuXHQgICAgdGlwUG9zaXRpb25zID0gL1xcYih0b3B8Ym90dG9tfGxlZnR8dG9wKSsvLFxuXHQgIFxuXHQgICAgLy8gdHJhbnNpdGlvbkVuZCBzaW5jZSAyLjAuNFxuXHQgICAgc3VwcG9ydFRyYW5zaXRpb25zID0gV2Via2l0K1RyYW5zaXRpb24gaW4gZG9jW3N0eWxlXSB8fCBUcmFuc2l0aW9uW3RvTG93ZXJDYXNlXSgpIGluIGRvY1tzdHlsZV0sXG5cdCAgICB0cmFuc2l0aW9uRW5kRXZlbnQgPSBXZWJraXQrVHJhbnNpdGlvbiBpbiBkb2Nbc3R5bGVdID8gV2Via2l0W3RvTG93ZXJDYXNlXSgpK1RyYW5zaXRpb24rJ0VuZCcgOiBUcmFuc2l0aW9uW3RvTG93ZXJDYXNlXSgpKydlbmQnLFxuXHQgICAgXG5cdCAgXG5cdCAgICAvLyBzZXQgbmV3IGZvY3VzIGVsZW1lbnQgc2luY2UgMi4wLjNcblx0ICAgIHNldEZvY3VzID0gZnVuY3Rpb24oZWxlbWVudCl7XG5cdCAgICAgIGVsZW1lbnQuZm9jdXMgPyBlbGVtZW50LmZvY3VzKCkgOiBlbGVtZW50LnNldEFjdGl2ZSgpO1xuXHQgICAgfSxcblx0ICBcblx0ICAgIC8vIGNsYXNzIG1hbmlwdWxhdGlvbiwgc2luY2UgMi4wLjAgcmVxdWlyZXMgcG9seWZpbGwuanNcblx0ICAgIGFkZENsYXNzID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpIHtcblx0ICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTkFNRSk7XG5cdCAgICB9LFxuXHQgICAgcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LGNsYXNzTkFNRSkge1xuXHQgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOQU1FKTtcblx0ICAgIH0sXG5cdCAgICBoYXNDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKXsgLy8gc2luY2UgMi4wLjBcblx0ICAgICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTkFNRSk7XG5cdCAgICB9LFxuXHQgIFxuXHQgICAgLy8gc2VsZWN0aW9uIG1ldGhvZHNcblx0ICAgIG5vZGVMaXN0VG9BcnJheSA9IGZ1bmN0aW9uKG5vZGVMaXN0KXtcblx0ICAgICAgdmFyIGNoaWxkSXRlbXMgPSBbXTsgZm9yICh2YXIgaSA9IDAsIG5sbCA9IG5vZGVMaXN0W2xlbmd0aF07IGk8bmxsOyBpKyspIHsgY2hpbGRJdGVtcy5wdXNoKCBub2RlTGlzdFtpXSApIH1cblx0ICAgICAgcmV0dXJuIGNoaWxkSXRlbXM7XG5cdCAgICB9LFxuXHQgICAgZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKSB7IC8vIGdldEVsZW1lbnRzQnlDbGFzc05hbWUgSUU4K1xuXHQgICAgICB2YXIgc2VsZWN0aW9uTWV0aG9kID0gaXNJRSA9PT0gOCA/IHF1ZXJ5U2VsZWN0b3JBbGwgOiBnZXRFbGVtZW50c0J5Q0xBU1NOQU1FOyAgICAgIFxuXHQgICAgICByZXR1cm4gbm9kZUxpc3RUb0FycmF5KGVsZW1lbnRbc2VsZWN0aW9uTWV0aG9kXSggaXNJRSA9PT0gOCA/ICcuJyArIGNsYXNzTkFNRS5yZXBsYWNlKC9cXHMoPz1bYS16XSkvZywnLicpIDogY2xhc3NOQU1FICkpO1xuXHQgICAgfSxcblx0ICAgIHF1ZXJ5RWxlbWVudCA9IGZ1bmN0aW9uIChzZWxlY3RvciwgcGFyZW50KSB7XG5cdCAgICAgIHZhciBsb29rVXAgPSBwYXJlbnQgPyBwYXJlbnQgOiBkb2N1bWVudDtcblx0ICAgICAgcmV0dXJuIHR5cGVvZiBzZWxlY3RvciA9PT0gJ29iamVjdCcgPyBzZWxlY3RvciA6IGxvb2tVcC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcblx0ICAgIH0sXG5cdCAgICBnZXRDbG9zZXN0ID0gZnVuY3Rpb24gKGVsZW1lbnQsIHNlbGVjdG9yKSB7IC8vZWxlbWVudCBpcyB0aGUgZWxlbWVudCBhbmQgc2VsZWN0b3IgaXMgZm9yIHRoZSBjbG9zZXN0IHBhcmVudCBlbGVtZW50IHRvIGZpbmRcblx0ICAgIC8vIHNvdXJjZSBodHRwOi8vZ29tYWtldGhpbmdzLmNvbS9jbGltYmluZy11cC1hbmQtZG93bi10aGUtZG9tLXRyZWUtd2l0aC12YW5pbGxhLWphdmFzY3JpcHQvXG5cdCAgICAgIHZhciBmaXJzdENoYXIgPSBzZWxlY3Rvci5jaGFyQXQoMCk7XG5cdCAgICAgIGZvciAoIDsgZWxlbWVudCAmJiBlbGVtZW50ICE9PSBkb2N1bWVudDsgZWxlbWVudCA9IGVsZW1lbnRbcGFyZW50Tm9kZV0gKSB7Ly8gR2V0IGNsb3Nlc3QgbWF0Y2hcblx0ICAgICAgICBpZiAoIGZpcnN0Q2hhciA9PT0gJy4nIHx8IGZpcnN0Q2hhciAhPT0gJyMnKSB7Ly8gSWYgc2VsZWN0b3IgaXMgYSBjbGFzc1xuXHQgICAgICAgICAgaWYgKCBxdWVyeUVsZW1lbnQoc2VsZWN0b3IsZWxlbWVudFtwYXJlbnROb2RlXSkgIT09IG51bGwgKSB7IHJldHVybiBlbGVtZW50OyB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICggZmlyc3RDaGFyID09PSAnIycgKSB7IC8vIElmIHNlbGVjdG9yIGlzIGFuIElEXG5cdCAgICAgICAgICBpZiAoIGVsZW1lbnQuaWQgPT09IHNlbGVjdG9yLnN1YnN0cigxKSApIHsgcmV0dXJuIGVsZW1lbnQ7IH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfSxcblx0ICBcblx0ICAgIC8vIGV2ZW50IGF0dGFjaCBqUXVlcnkgc3R5bGUgLyB0cmlnZ2VyICBzaW5jZSAxLjIuMFxuXHQgICAgb24gPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcblx0ICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7XG5cdCAgICB9LFxuXHQgICAgb2ZmID0gZnVuY3Rpb24oZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcblx0ICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7XG5cdCAgICB9LFxuXHQgICAgb25lID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7IC8vIG9uZSBzaW5jZSAyLjAuNFxuXHQgICAgICBvbihlbGVtZW50LCBldmVudCwgZnVuY3Rpb24gaGFuZGxlcldyYXBwZXIoKXtcblx0ICAgICAgICBoYW5kbGVyKCk7XG5cdCAgICAgICAgb2ZmKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyV3JhcHBlcik7XG5cdCAgICAgIH0pO1xuXHQgICAgfSxcblx0ICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24oZWxlbWVudCxoYW5kbGVyKXsgLy8gZW11bGF0ZVRyYW5zaXRpb25FbmQgc2luY2UgMi4wLjRcblx0ICAgICAgaWYgKHN1cHBvcnRUcmFuc2l0aW9ucykgeyBvbmUoZWxlbWVudCx0cmFuc2l0aW9uRW5kRXZlbnQsIGhhbmRsZXIpOyB9XG5cdCAgICAgIGVsc2UgeyBoYW5kbGVyKCk7IH1cblx0ICAgIH0sICBcblx0ICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgY29tcG9uZW50TmFtZSwgcmVsYXRlZCkge1xuXHQgICAgICB2YXIgT3JpZ2luYWxDdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCggZXZlbnROYW1lICsgJy5icy4nICsgY29tcG9uZW50TmFtZSk7XG5cdCAgICAgIE9yaWdpbmFsQ3VzdG9tRXZlbnQucmVsYXRlZFRhcmdldCA9IHJlbGF0ZWQ7XG5cdCAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChPcmlnaW5hbEN1c3RvbUV2ZW50KTtcblx0ICAgIH0sXG5cdCAgXG5cdCAgICAvLyByZWZlcmVuY2UgYSBsaXZlIGNvbGxlY3Rpb24gb2YgdGhlIERPTVxuXHQgICAgQWxsRE9NRWxlbWVudHMgPSBkb2N1bWVudFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJyonKSxcblx0ICBcblx0ICAgIC8vIEluaXQgREFUQSBBUElcblx0ICAgIGluaXRpYWxpemVEYXRhQVBJID0gZnVuY3Rpb24oIGNvbXBvbmVudCwgY29uc3RydWN0b3IsIGRhdGFBdHRyaWJ1dGUsIGNvbGxlY3Rpb24gKXtcblx0ICAgICAgdmFyIGxvb2tVcCA9IGNvbGxlY3Rpb24gJiYgY29sbGVjdGlvbltsZW5ndGhdID8gY29sbGVjdGlvbiA6IEFsbERPTUVsZW1lbnRzO1xuXHQgICAgICBmb3IgKHZhciBpPTA7IGkgPCBsb29rVXBbbGVuZ3RoXTsgaSsrKSB7XG5cdCAgICAgICAgdmFyIGF0dHJWYWx1ZSA9IGxvb2tVcFtpXVtnZXRBdHRyaWJ1dGVdKGRhdGFBdHRyaWJ1dGUpLCBleHBlY3RlZEF0dHJWYWx1ZSA9IGNvbXBvbmVudC5yZXBsYWNlKC9zcHkvaSwnJylbdG9Mb3dlckNhc2VdKCk7XG5cdCAgICAgICAgaWYgKCBhdHRyVmFsdWUgJiYgY29tcG9uZW50ID09PSBzdHJpbmdCdXR0b24gJiYgKCBhdHRyVmFsdWVbaW5kZXhPZl0oZXhwZWN0ZWRBdHRyVmFsdWUpID4gLTEgKSAvLyBkYXRhLXRvZ2dsZT1cImJ1dHRvbnNcIlxuXHQgICAgICAgICAgICB8fCBhdHRyVmFsdWUgPT09IGV4cGVjdGVkQXR0clZhbHVlICkgeyAvLyBhbGwgb3RoZXIgY29tcG9uZW50c1xuXHQgICAgICAgICAgbmV3IGNvbnN0cnVjdG9yKGxvb2tVcFtpXSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9LCAgXG5cdCAgXG5cdCAgICAvLyB0YWIgLyBjb2xsYXBzZSBzdHVmZlxuXHQgICAgZ2V0T3V0ZXJIZWlnaHQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcblx0ICAgICAgdmFyIGNoaWxkU3R5bGUgPSBjaGlsZCAmJiAoY2hpbGQuY3VycmVudFN0eWxlIHx8IGdsb2JhbE9iamVjdC5nZXRDb21wdXRlZFN0eWxlKGNoaWxkKSksIFxuXHQgICAgICAgIGJ0cCA9IC9weC8udGVzdChjaGlsZFN0eWxlLmJvcmRlclRvcFdpZHRoKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5ib3JkZXJUb3BXaWR0aC5yZXBsYWNlKCdweCcsJycpKSA6IDAsXG5cdCAgICAgICAgYnRiID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUuYm9yZGVyQm90dG9tV2lkdGgpID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLmJvcmRlckJvdHRvbVdpZHRoLnJlcGxhY2UoJ3B4JywnJykpIDogMCxcblx0ICAgICAgICBtdHAgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5tYXJnaW5Ub3ApID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLm1hcmdpblRvcC5yZXBsYWNlKCdweCcsJycpKSA6IDAsXG5cdCAgICAgICAgbWJwID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUubWFyZ2luQm90dG9tKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5tYXJnaW5Cb3R0b20ucmVwbGFjZSgncHgnLCcnKSkgOiAwO1xuXHQgICAgICByZXR1cm4gY2hpbGRbY2xpZW50SGVpZ2h0XSArIHBhcnNlSW50KCBidHAgKSArIHBhcnNlSW50KCBidGIgKSArIHBhcnNlSW50KCBtdHAgKSArIHBhcnNlSW50KCBtYnAgKTtcblx0ICAgIH0sXG5cdCAgICBnZXRNYXhIZWlnaHQgPSBmdW5jdGlvbihwYXJlbnQpIHsgLy8gZ2V0IGNvbGxhcHNlIHRydWVIZWlnaHQgYW5kIGJvcmRlclxuXHQgICAgICB2YXIgcGFyZW50SGVpZ2h0ID0gMDtcblx0ICAgICAgZm9yICh2YXIgayA9IDAsIGxsID0gcGFyZW50LmNoaWxkcmVuW2xlbmd0aF07IGsgPCBsbDsgaysrKSB7XG5cdCAgICAgICAgcGFyZW50SGVpZ2h0ICs9IGdldE91dGVySGVpZ2h0KHBhcmVudC5jaGlsZHJlbltrXSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHBhcmVudEhlaWdodDtcblx0ICAgIH0sXG5cdCAgXG5cdCAgICAvLyB0b29sdGlwIC8gcG9wb3ZlciBzdHVmZlxuXHQgICAgaXNFbGVtZW50SW5WaWV3cG9ydCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHsgLy8gY2hlY2sgaWYgdGhpcy50b29sdGlwIGlzIGluIHZpZXdwb3J0XG5cdCAgICAgIHZhciByZWN0ID0gZWxlbWVudFtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCk7XG5cdCAgICAgIHJldHVybiAoIHJlY3RbdG9wXSA+PSAwICYmIHJlY3RbbGVmdF0gPj0gMCAmJlxuXHQgICAgICAgIHJlY3RbYm90dG9tXSA8PSAoZ2xvYmFsT2JqZWN0W2lubmVySGVpZ2h0XSB8fCBkb2NbY2xpZW50SGVpZ2h0XSkgJiZcblx0ICAgICAgICByZWN0W3JpZ2h0XSA8PSAoZ2xvYmFsT2JqZWN0W2lubmVyV2lkdGhdIHx8IGRvY1tjbGllbnRXaWR0aF0pIClcblx0ICAgIH0sXG5cdCAgICBnZXRTY3JvbGwgPSBmdW5jdGlvbigpIHsgLy8gYWxzbyBBZmZpeCBhbmQgU2Nyb2xsU3B5IHVzZXMgaXRcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICB5IDogZ2xvYmFsT2JqZWN0LnBhZ2VZT2Zmc2V0IHx8IGRvY1tzY3JvbGxUb3BdLFxuXHQgICAgICAgIHggOiBnbG9iYWxPYmplY3QucGFnZVhPZmZzZXQgfHwgZG9jW3Njcm9sbExlZnRdXG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdCAgICBzdHlsZVRpcCA9IGZ1bmN0aW9uKGxpbmssZWxlbWVudCxwb3NpdGlvbixjb250YWluZXIpIHsgLy8gYm90aCBwb3BvdmVycyBhbmQgdG9vbHRpcHNcblx0ICAgICAgdmFyIHJlY3QgPSBsaW5rW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKSwgXG5cdCAgICAgICAgICBzY3JvbGwgPSBjb250YWluZXIgPT09IGJvZHkgPyBnZXRTY3JvbGwoKSA6IHsgeDogY29udGFpbmVyW29mZnNldExlZnRdICsgY29udGFpbmVyW3Njcm9sbExlZnRdLCB5OiBjb250YWluZXJbb2Zmc2V0VG9wXSArIGNvbnRhaW5lcltzY3JvbGxUb3BdIH0sXG5cdCAgICAgICAgICBsaW5rRGltZW5zaW9ucyA9IHsgdzogcmVjdFtyaWdodF0gLSByZWN0W2xlZnRdLCBoOiByZWN0W2JvdHRvbV0gLSByZWN0W3RvcF0gfSxcblx0ICAgICAgICAgIGVsZW1lbnREaW1lbnNpb25zID0geyB3IDogZWxlbWVudFtvZmZzZXRXaWR0aF0sIGg6IGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSB9O1xuXHQgIFxuXHQgICAgICAvLyBhcHBseSBzdHlsaW5nIHRvIHRvb2x0aXAgb3IgcG9wb3ZlclxuXHQgICAgICBpZiAoIHBvc2l0aW9uID09PSB0b3AgKSB7IC8vIFRPUFxuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW3RvcF0gPSByZWN0W3RvcF0gKyBzY3JvbGwueSAtIGVsZW1lbnREaW1lbnNpb25zLmggKyAncHgnO1xuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54IC0gZWxlbWVudERpbWVuc2lvbnMudy8yICsgbGlua0RpbWVuc2lvbnMudy8yICsgJ3B4J1xuXHQgIFxuXHQgICAgICB9IGVsc2UgaWYgKCBwb3NpdGlvbiA9PT0gYm90dG9tICkgeyAvLyBCT1RUT01cblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgKyBsaW5rRGltZW5zaW9ucy5oICsgJ3B4Jztcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCAtIGVsZW1lbnREaW1lbnNpb25zLncvMiArIGxpbmtEaW1lbnNpb25zLncvMiArICdweCc7XG5cdCAgXG5cdCAgICAgIH0gZWxzZSBpZiAoIHBvc2l0aW9uID09PSBsZWZ0ICkgeyAvLyBMRUZUXG5cdCAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaC8yICsgbGlua0RpbWVuc2lvbnMuaC8yICsgJ3B4Jztcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCAtIGVsZW1lbnREaW1lbnNpb25zLncgKyAncHgnO1xuXHQgIFxuXHQgICAgICB9IGVsc2UgaWYgKCBwb3NpdGlvbiA9PT0gcmlnaHQgKSB7IC8vIFJJR0hUXG5cdCAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaC8yICsgbGlua0RpbWVuc2lvbnMuaC8yICsgJ3B4Jztcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCArIGxpbmtEaW1lbnNpb25zLncgKyAncHgnO1xuXHQgICAgICB9XG5cdCAgICAgIGVsZW1lbnQuY2xhc3NOYW1lW2luZGV4T2ZdKHBvc2l0aW9uKSA9PT0gLTEgJiYgKGVsZW1lbnQuY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZSh0aXBQb3NpdGlvbnMscG9zaXRpb24pKTtcblx0ICAgIH0sXG5cdCAgICB1cGRhdGVQbGFjZW1lbnQgPSBmdW5jdGlvbihwb3NpdGlvbikge1xuXHQgICAgICByZXR1cm4gcG9zaXRpb24gPT09IHRvcCA/IGJvdHRvbSA6IC8vIHRvcFxuXHQgICAgICAgICAgICAgcG9zaXRpb24gPT09IGJvdHRvbSA/IHRvcCA6IC8vIGJvdHRvbVxuXHQgICAgICAgICAgICAgcG9zaXRpb24gPT09IGxlZnQgPyByaWdodCA6IC8vIGxlZnRcblx0ICAgICAgICAgICAgIHBvc2l0aW9uID09PSByaWdodCA/IGxlZnQgOiBwb3NpdGlvbjsgLy8gcmlnaHRcblx0ICAgIH07XG5cdCAgXG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQWZmaXhcblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvL0FGRklYIERFRklOSVRJT05cblx0ICB2YXIgQWZmaXggPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvbnNcblx0ICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgIFxuXHQgICAgLy8gcmVhZCBEQVRBIEFQSVxuXHQgICAgdmFyIHRhcmdldERhdGEgICAgICAgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpLFxuXHQgICAgICAgIG9mZnNldFRvcERhdGEgICAgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPZmZzZXRUb3ApLFxuXHQgICAgICAgIG9mZnNldEJvdHRvbURhdGEgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPZmZzZXRCb3R0b20pLFxuXHQgICAgICAgIFxuXHQgICAgICAgIC8vIGNvbXBvbmVudCBzcGVjaWZpYyBzdHJpbmdzXG5cdCAgICAgICAgYWZmaXggPSAnYWZmaXgnLCBhZmZpeGVkID0gJ2FmZml4ZWQnLCBmbiA9ICdmdW5jdGlvbicsIHVwZGF0ZSA9ICd1cGRhdGUnLFxuXHQgICAgICAgIGFmZml4VG9wID0gJ2FmZml4LXRvcCcsIGFmZml4ZWRUb3AgPSAnYWZmaXhlZC10b3AnLFxuXHQgICAgICAgIGFmZml4Qm90dG9tID0gJ2FmZml4LWJvdHRvbScsIGFmZml4ZWRCb3R0b20gPSAnYWZmaXhlZC1ib3R0b20nO1xuXHQgIFxuXHQgICAgdGhpc1t0YXJnZXRdID0gb3B0aW9uc1t0YXJnZXRdID8gcXVlcnlFbGVtZW50KG9wdGlvbnNbdGFyZ2V0XSkgOiBxdWVyeUVsZW1lbnQodGFyZ2V0RGF0YSkgfHwgbnVsbDsgLy8gdGFyZ2V0IGlzIGFuIG9iamVjdFxuXHQgICAgdGhpc1tvZmZzZXRUb3BdID0gb3B0aW9uc1tvZmZzZXRUb3BdID8gb3B0aW9uc1tvZmZzZXRUb3BdIDogcGFyc2VJbnQob2Zmc2V0VG9wRGF0YSkgfHwgMDsgLy8gb2Zmc2V0IG9wdGlvbiBpcyBhbiBpbnRlZ2VyIG51bWJlciBvciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhhdCBudW1iZXJcblx0ICAgIHRoaXNbb2Zmc2V0Qm90dG9tXSA9IG9wdGlvbnNbb2Zmc2V0Qm90dG9tXSA/IG9wdGlvbnNbb2Zmc2V0Qm90dG9tXTogcGFyc2VJbnQob2Zmc2V0Qm90dG9tRGF0YSkgfHwgMDtcblx0ICBcblx0ICAgIGlmICggIXRoaXNbdGFyZ2V0XSAmJiAhKCB0aGlzW29mZnNldFRvcF0gfHwgdGhpc1tvZmZzZXRCb3R0b21dICkgKSB7IHJldHVybjsgfSAvLyBpbnZhbGlkYXRlXG5cdCAgXG5cdCAgICAvLyBpbnRlcm5hbCBiaW5kXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsXG5cdCAgXG5cdCAgICAgIC8vIGNvbnN0YW50c1xuXHQgICAgICByZXNpemVEZWxheSA9IChpc0lFICYmIGlzSUUgPCAxMCkgPyA1MDAgOiA1MCwgLy8gZm9yIGxlZ2FjeSBicm93c2VycyB3ZSB0cnkgdG8gbGltaXQgdGhlIGludGVydmFsIGZvciB1cGRhdGluZyB0aGUgQWZmaXhcblx0ICAgICAgcGluT2Zmc2V0VG9wLCBwaW5PZmZzZXRCb3R0b20sIG1heFNjcm9sbCwgc2Nyb2xsWSwgcGlubmVkVG9wLCBwaW5uZWRCb3R0b20sXG5cdCAgICAgIGFmZml4ZWRUb1RvcCA9IGZhbHNlLCBhZmZpeGVkVG9Cb3R0b20gPSBmYWxzZSxcblx0ICAgICAgXG5cdCAgICAgIC8vIHByaXZhdGUgbWV0aG9kcyBcblx0ICAgICAgZ2V0TWF4U2Nyb2xsID0gZnVuY3Rpb24oKXtcblx0ICAgICAgICByZXR1cm4gTWF0aC5tYXgoIGJvZHlbc2Nyb2xsSGVpZ2h0XSwgYm9keVtvZmZzZXRIZWlnaHRdLCBkb2NbY2xpZW50SGVpZ2h0XSwgZG9jW3Njcm9sbEhlaWdodF0sIGRvY1tvZmZzZXRIZWlnaHRdICk7XG5cdCAgICAgIH0sXG5cdCAgICAgIGdldE9mZnNldFRvcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIHNlbGZbdGFyZ2V0XSAhPT0gbnVsbCApIHtcblx0ICAgICAgICAgIHJldHVybiBzZWxmW3RhcmdldF1bZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpW3RvcF0gKyBzY3JvbGxZO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoIHNlbGZbb2Zmc2V0VG9wXSApIHtcblx0ICAgICAgICAgIHJldHVybiBwYXJzZUludCh0eXBlb2Ygc2VsZltvZmZzZXRUb3BdID09PSBmbiA/IHNlbGZbb2Zmc2V0VG9wXSgpIDogc2VsZltvZmZzZXRUb3BdIHx8IDApO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZ2V0T2Zmc2V0Qm90dG9tID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggc2VsZltvZmZzZXRCb3R0b21dICkge1xuXHQgICAgICAgICAgcmV0dXJuIG1heFNjcm9sbCAtIGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSAtIHBhcnNlSW50KCB0eXBlb2Ygc2VsZltvZmZzZXRCb3R0b21dID09PSBmbiA/IHNlbGZbb2Zmc2V0Qm90dG9tXSgpIDogc2VsZltvZmZzZXRCb3R0b21dIHx8IDAgKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGNoZWNrUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgbWF4U2Nyb2xsID0gZ2V0TWF4U2Nyb2xsKCk7XG5cdCAgICAgICAgc2Nyb2xsWSA9IHBhcnNlSW50KGdldFNjcm9sbCgpLnksMCk7XG5cdCAgICAgICAgcGluT2Zmc2V0VG9wID0gZ2V0T2Zmc2V0VG9wKCk7XG5cdCAgICAgICAgcGluT2Zmc2V0Qm90dG9tID0gZ2V0T2Zmc2V0Qm90dG9tKCk7IFxuXHQgICAgICAgIHBpbm5lZFRvcCA9ICggcGFyc2VJbnQocGluT2Zmc2V0VG9wKSAtIHNjcm9sbFkgPCAwKSAmJiAoc2Nyb2xsWSA+IHBhcnNlSW50KHBpbk9mZnNldFRvcCkgKTtcblx0ICAgICAgICBwaW5uZWRCb3R0b20gPSAoIHBhcnNlSW50KHBpbk9mZnNldEJvdHRvbSkgLSBzY3JvbGxZIDwgMCkgJiYgKHNjcm9sbFkgPiBwYXJzZUludChwaW5PZmZzZXRCb3R0b20pICk7XG5cdCAgICAgIH0sXG5cdCAgICAgIHBpblRvcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoICFhZmZpeGVkVG9Ub3AgJiYgIWhhc0NsYXNzKGVsZW1lbnQsYWZmaXgpICkgeyAvLyBvbiBsb2FkaW5nIGEgcGFnZSBoYWxmd2F5IHNjcm9sbGVkIHRoZXNlIGV2ZW50cyBkb24ndCB0cmlnZ2VyIGluIENocm9tZVxuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeCwgYWZmaXgpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeFRvcCwgYWZmaXgpO1xuXHQgICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCxhZmZpeCk7XG5cdCAgICAgICAgICBhZmZpeGVkVG9Ub3AgPSB0cnVlO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkLCBhZmZpeCk7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWRUb3AsIGFmZml4KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHVuUGluVG9wID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggYWZmaXhlZFRvVG9wICYmIGhhc0NsYXNzKGVsZW1lbnQsYWZmaXgpICkge1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxhZmZpeCk7XG5cdCAgICAgICAgICBhZmZpeGVkVG9Ub3AgPSBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHBpbkJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoICFhZmZpeGVkVG9Cb3R0b20gJiYgIWhhc0NsYXNzKGVsZW1lbnQsIGFmZml4Qm90dG9tKSApIHtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXgsIGFmZml4KTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhCb3R0b20sIGFmZml4KTtcblx0ICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pO1xuXHQgICAgICAgICAgYWZmaXhlZFRvQm90dG9tID0gdHJ1ZTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhlZCwgYWZmaXgpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkQm90dG9tLCBhZmZpeCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB1blBpbkJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIGFmZml4ZWRUb0JvdHRvbSAmJiBoYXNDbGFzcyhlbGVtZW50LGFmZml4Qm90dG9tKSApIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pO1xuXHQgICAgICAgICAgYWZmaXhlZFRvQm90dG9tID0gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB1cGRhdGVQaW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCBwaW5uZWRCb3R0b20gKSB7XG5cdCAgICAgICAgICBpZiAoIHBpbm5lZFRvcCApIHsgdW5QaW5Ub3AoKTsgfVxuXHQgICAgICAgICAgcGluQm90dG9tKCk7IFxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB1blBpbkJvdHRvbSgpO1xuXHQgICAgICAgICAgaWYgKCBwaW5uZWRUb3AgKSB7IHBpblRvcCgpOyB9IFxuXHQgICAgICAgICAgZWxzZSB7IHVuUGluVG9wKCk7IH1cblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzW3VwZGF0ZV0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGNoZWNrUG9zaXRpb24oKTtcblx0ICAgICAgdXBkYXRlUGluKCk7IFxuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdBZmZpeCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIG9uKCBnbG9iYWxPYmplY3QsIHNjcm9sbEV2ZW50LCB0aGlzW3VwZGF0ZV0gKTtcblx0ICAgICAgb24oIGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIGZ1bmN0aW9uKCkgeyBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IHNlbGZbdXBkYXRlXSgpOyB9LCByZXNpemVEZWxheSk7IH0pO1xuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdBZmZpeF0gPSB0aGlzO1xuXHQgIFxuXHQgICAgdGhpc1t1cGRhdGVdKCk7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBBRkZJWCBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PT09PT09XG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkoIHN0cmluZ0FmZml4LCBBZmZpeCwgZGF0YVNweSApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEFsZXJ0XG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gQUxFUlQgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT1cblx0ICB2YXIgQWxlcnQgPSBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0ICAgIFxuXHQgICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuXHQgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcblx0ICBcblx0ICAgIC8vIGJpbmQsIHRhcmdldCBhbGVydCwgZHVyYXRpb24gYW5kIHN0dWZmXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIGNvbXBvbmVudCA9ICdhbGVydCcsXG5cdCAgICAgIGFsZXJ0ID0gZ2V0Q2xvc2VzdChlbGVtZW50LCcuJytjb21wb25lbnQpLFxuXHQgICAgICAvLyBoYW5kbGVyc1xuXHQgICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKXtcblx0ICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlW3RhcmdldF07XG5cdCAgICAgICAgZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldFtoYXNBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSA/IGV2ZW50VGFyZ2V0IDogZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV07XG5cdCAgICAgICAgaWYgKGV2ZW50VGFyZ2V0ICYmIGV2ZW50VGFyZ2V0W2hhc0F0dHJpYnV0ZV0oZGF0YURpc21pc3MpKSB7IC8vIHdlIGRvdWJsZSBjaGVjayB0aGUgZGF0YSBhdHRyaWJ1dGUsIGl0J3MgaW1wb3J0YW50XG5cdCAgICAgICAgICBhbGVydCA9IGdldENsb3Nlc3QoZXZlbnRUYXJnZXQsJy4nK2NvbXBvbmVudCk7XG5cdCAgICAgICAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KCdbJytkYXRhRGlzbWlzcysnPVwiJytjb21wb25lbnQrJ1wiXScsYWxlcnQpO1xuXHQgICAgICAgICAgKGVsZW1lbnQgPT09IGV2ZW50VGFyZ2V0IHx8IGVsZW1lbnQgPT09IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdKSAmJiBhbGVydCAmJiBzZWxmLmNsb3NlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB0cmFuc2l0aW9uRW5kSGFuZGxlciA9IGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhbGVydCwgY2xvc2VkRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgb2ZmKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7IC8vIGRldGFjaCBpdCdzIGxpc3RlbmVyXG5cdCAgICAgICAgYWxlcnRbcGFyZW50Tm9kZV0ucmVtb3ZlQ2hpbGQoYWxlcnQpO1xuXHQgICAgICB9O1xuXHQgICAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzLmNsb3NlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmICggYWxlcnQgJiYgZWxlbWVudCAmJiBoYXNDbGFzcyhhbGVydCxpbkNsYXNzKSApIHtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFsZXJ0LCBjbG9zZUV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKGFsZXJ0LGluQ2xhc3MpO1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBpZiAoYWxlcnQpIHtcblx0ICAgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoYWxlcnQsdHJhbnNpdGlvbkVuZEhhbmRsZXIpO1xuXHQgICAgICAgICAgfSBcblx0ICAgICAgICB9LCBkdXJhdGlvbik7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nQWxlcnQgaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdBbGVydF0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gQUxFUlQgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJICggc3RyaW5nQWxlcnQsIEFsZXJ0LCBkYXRhRGlzbWlzcyApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEJ1dHRvblxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gQlVUVE9OIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIEJ1dHRvbiA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb24gKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvblxuXHQgICAgb3B0aW9uID0gb3B0aW9uIHx8IG51bGw7XG5cdCAgXG5cdCAgICAvLyBjb25zdGFudFxuXHQgICAgdmFyIHRvZ2dsZWQgPSBmYWxzZSwgLy8gdG9nZ2xlZCBtYWtlcyBzdXJlIHRvIHByZXZlbnQgdHJpZ2dlcmluZyB0d2ljZSB0aGUgY2hhbmdlLmJzLmJ1dHRvbiBldmVudHNcblx0ICBcblx0ICAgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ2J1dHRvbicsXG5cdCAgICAgICAgY2hlY2tlZCA9ICdjaGVja2VkJyxcblx0ICAgICAgICByZXNldCA9ICdyZXNldCcsXG5cdCAgICAgICAgTEFCRUwgPSAnTEFCRUwnLFxuXHQgICAgICAgIElOUFVUID0gJ0lOUFVUJyxcblx0ICBcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIHNldFN0YXRlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCAhISBvcHRpb24gJiYgb3B0aW9uICE9PSByZXNldCApIHtcblx0ICAgICAgICAgIGlmICggb3B0aW9uID09PSBsb2FkaW5nICkge1xuXHQgICAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LGRpc2FibGVkKTtcblx0ICAgICAgICAgICAgZWxlbWVudFtzZXRBdHRyaWJ1dGVdKGRpc2FibGVkLGRpc2FibGVkKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGVsZW1lbnRbc2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUZXh0LCBlbGVtZW50LmlubmVySFRNTC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJykpOyAvLyB0cmltIHRoZSB0ZXh0XG5cdCAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnZGF0YS0nK29wdGlvbisnLXRleHQnKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlc2V0U3RhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRleHQpKSB7XG5cdCAgICAgICAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsZGlzYWJsZWQpIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkaXNhYmxlZCkgPT09IGRpc2FibGVkICkge1xuXHQgICAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGRpc2FibGVkKTtcblx0ICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoZGlzYWJsZWQpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGV4dCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB0b2dnbGUgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIHBhcmVudCA9IGVbdGFyZ2V0XVtwYXJlbnROb2RlXSxcblx0ICAgICAgICAgIGxhYmVsID0gZVt0YXJnZXRdLnRhZ05hbWUgPT09IExBQkVMID8gZVt0YXJnZXRdIDogcGFyZW50LnRhZ05hbWUgPT09IExBQkVMID8gcGFyZW50IDogbnVsbDsgLy8gdGhlIC5idG4gbGFiZWxcblx0ICBcblx0ICAgICAgICBpZiAoICFsYWJlbCApIHJldHVybjsgLy9yZWFjdCBpZiBhIGxhYmVsIG9yIGl0cyBpbW1lZGlhdGUgY2hpbGQgaXMgY2xpY2tlZFxuXHQgIFxuXHQgICAgICAgIHZhciBldmVudFRhcmdldCA9IHRoaXMsIC8vIHRoZSBidXR0b24gZ3JvdXAsIHRoZSB0YXJnZXQgb2YgdGhlIGhhbmRsZXIgZnVuY3Rpb25cblx0ICAgICAgICAgIGxhYmVscyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZXZlbnRUYXJnZXQsJ2J0bicpLCAvLyBhbGwgdGhlIGJ1dHRvbiBncm91cCBidXR0b25zXG5cdCAgICAgICAgICBpbnB1dCA9IGxhYmVsW2dldEVsZW1lbnRzQnlUYWdOYW1lXShJTlBVVClbMF07XG5cdCAgXG5cdCAgICAgICAgaWYgKCAhaW5wdXQgKSByZXR1cm47IC8vcmV0dXJuIGlmIG5vIGlucHV0IGZvdW5kXG5cdCAgXG5cdCAgICAgICAgLy8gbWFuYWdlIHRoZSBkb20gbWFuaXB1bGF0aW9uXG5cdCAgICAgICAgaWYgKCBpbnB1dC50eXBlID09PSAnY2hlY2tib3gnICkgeyAvL2NoZWNrYm94ZXNcblx0ICAgICAgICAgIGlmICggIWlucHV0W2NoZWNrZWRdICkge1xuXHQgICAgICAgICAgICBhZGRDbGFzcyhsYWJlbCxhY3RpdmUpO1xuXHQgICAgICAgICAgICBpbnB1dFtnZXRBdHRyaWJ1dGVdKGNoZWNrZWQpO1xuXHQgICAgICAgICAgICBpbnB1dFtzZXRBdHRyaWJ1dGVdKGNoZWNrZWQsY2hlY2tlZCk7XG5cdCAgICAgICAgICAgIGlucHV0W2NoZWNrZWRdID0gdHJ1ZTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHJlbW92ZUNsYXNzKGxhYmVsLGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIGlucHV0W2dldEF0dHJpYnV0ZV0oY2hlY2tlZCk7XG5cdCAgICAgICAgICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZShjaGVja2VkKTtcblx0ICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSBmYWxzZTtcblx0ICAgICAgICAgIH1cblx0ICBcblx0ICAgICAgICAgIGlmICghdG9nZ2xlZCkgeyAvLyBwcmV2ZW50IHRyaWdnZXJpbmcgdGhlIGV2ZW50IHR3aWNlXG5cdCAgICAgICAgICAgIHRvZ2dsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGlucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBpbnB1dFxuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGJ0bi1ncm91cFxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICBcblx0ICAgICAgICBpZiAoIGlucHV0LnR5cGUgPT09ICdyYWRpbycgJiYgIXRvZ2dsZWQgKSB7IC8vIHJhZGlvIGJ1dHRvbnNcblx0ICAgICAgICAgIGlmICggIWlucHV0W2NoZWNrZWRdICkgeyAvLyBkb24ndCB0cmlnZ2VyIGlmIGFscmVhZHkgYWN0aXZlXG5cdCAgICAgICAgICAgIGFkZENsYXNzKGxhYmVsLGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIGlucHV0W3NldEF0dHJpYnV0ZV0oY2hlY2tlZCxjaGVja2VkKTtcblx0ICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSB0cnVlO1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGlucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBpbnB1dFxuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGJ0bi1ncm91cFxuXHQgIFxuXHQgICAgICAgICAgICB0b2dnbGVkID0gdHJ1ZTtcblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxsID0gbGFiZWxzW2xlbmd0aF07IGk8bGw7IGkrKykge1xuXHQgICAgICAgICAgICAgIHZhciBvdGhlckxhYmVsID0gbGFiZWxzW2ldLCBvdGhlcklucHV0ID0gb3RoZXJMYWJlbFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oSU5QVVQpWzBdO1xuXHQgICAgICAgICAgICAgIGlmICggb3RoZXJMYWJlbCAhPT0gbGFiZWwgJiYgaGFzQ2xhc3Mob3RoZXJMYWJlbCxhY3RpdmUpICkgIHtcblx0ICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKG90aGVyTGFiZWwsYWN0aXZlKTtcblx0ICAgICAgICAgICAgICAgIG90aGVySW5wdXQucmVtb3ZlQXR0cmlidXRlKGNoZWNrZWQpO1xuXHQgICAgICAgICAgICAgICAgb3RoZXJJbnB1dFtjaGVja2VkXSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChvdGhlcklucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy8gdHJpZ2dlciB0aGUgY2hhbmdlXG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgeyB0b2dnbGVkID0gZmFsc2U7IH0sIDUwICk7XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ2J0bicpICkgeyAvLyB3aGVuIEJ1dHRvbiB0ZXh0IGlzIHVzZWQgd2UgZXhlY3V0ZSBpdCBhcyBhbiBpbnN0YW5jZSBtZXRob2Rcblx0ICAgICAgaWYgKCBvcHRpb24gIT09IG51bGwgKSB7XG5cdCAgICAgICAgaWYgKCBvcHRpb24gIT09IHJlc2V0ICkgeyBzZXRTdGF0ZSgpOyB9IFxuXHQgICAgICAgIGVsc2UgeyByZXNldFN0YXRlKCk7IH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgaWYgKCBoYXNDbGFzcyhlbGVtZW50LCdidG4tZ3JvdXAnKSApIHtcblx0ICAgICAgaWYgKCAhKCBzdHJpbmdCdXR0b24gaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICAgIG9uKCBlbGVtZW50LCBjbGlja0V2ZW50LCB0b2dnbGUgKTtcblx0ICAgICAgfVxuXHQgICAgICBlbGVtZW50W3N0cmluZ0J1dHRvbl0gPSB0aGlzO1xuXHQgICAgfVxuXHQgIH07XG5cdCAgXG5cdCAgLy8gQlVUVE9OIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQnV0dG9uLCBCdXR0b24sIGRhdGFUb2dnbGUgKTtcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBDYXJvdXNlbFxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIENBUk9VU0VMIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIENhcm91c2VsID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KCBlbGVtZW50ICk7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgXG5cdCAgICAvLyBEQVRBIEFQSVxuXHQgICAgdmFyIGludGVydmFsRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhSW50ZXJ2YWwpID09PSAnZmFsc2UnID8gZmFsc2UgOiBwYXJzZUludChlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUludGVydmFsKSkgfHwgNTAwMCwgLy8gYm9vdHN0cmFwIGNhcm91c2VsIGRlZmF1bHQgaW50ZXJ2YWxcblx0ICAgICAgICBwYXVzZURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBhdXNlKSA9PT0gaG92ZXJFdmVudCB8fCBmYWxzZSxcblx0ICAgICAgICBrZXlib2FyZERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUtleWJvYXJkKSA9PT0gJ3RydWUnIHx8IGZhbHNlLFxuXHQgICAgICBcblx0ICAgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ2Nhcm91c2VsJyxcblx0ICAgICAgICBwYXVzZWQgPSAncGF1c2VkJyxcblx0ICAgICAgICBkaXJlY3Rpb24gPSAnZGlyZWN0aW9uJyxcblx0ICAgICAgICBkYXRhU2xpZGVUbyA9ICdkYXRhLXNsaWRlLXRvJzsgXG5cdCAgXG5cdCAgICB0aGlzW2tleWJvYXJkXSA9IG9wdGlvbnNba2V5Ym9hcmRdID09PSB0cnVlIHx8IGtleWJvYXJkRGF0YTtcblx0ICAgIHRoaXNbcGF1c2VdID0gKG9wdGlvbnNbcGF1c2VdID09PSBob3ZlckV2ZW50IHx8IHBhdXNlRGF0YSkgPyBob3ZlckV2ZW50IDogZmFsc2U7IC8vIGZhbHNlIC8gaG92ZXJcblx0ICBcblx0ICAgIGlmICggISggb3B0aW9uc1tpbnRlcnZhbF0gfHwgaW50ZXJ2YWxEYXRhICkgKSB7IC8vIGRldGVybWluZSBzbGlkZSBpbnRlcnZhbFxuXHQgICAgICB0aGlzW2ludGVydmFsXSA9IGZhbHNlO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhpc1tpbnRlcnZhbF0gPSBwYXJzZUludChvcHRpb25zW2ludGVydmFsXSkgfHwgaW50ZXJ2YWxEYXRhOyAvLyBkZWZhdWx0IHNsaWRlIGludGVydmFsXG5cdCAgICB9XG5cdCAgXG5cdCAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIGluZGV4ID0gZWxlbWVudC5pbmRleCA9IDAsIHRpbWVyID0gZWxlbWVudC50aW1lciA9IDAsIFxuXHQgICAgICBpc1NsaWRpbmcgPSBmYWxzZSwgLy8gaXNTbGlkaW5nIHByZXZlbnRzIGNsaWNrIGV2ZW50IGhhbmRsZXJzIHdoZW4gYW5pbWF0aW9uIGlzIHJ1bm5pbmdcblx0ICAgICAgc2xpZGVzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlbGVtZW50LCdpdGVtJyksIHRvdGFsID0gc2xpZGVzW2xlbmd0aF0sXG5cdCAgICAgIHNsaWRlRGlyZWN0aW9uID0gdGhpc1tkaXJlY3Rpb25dID0gbGVmdCxcblx0ICAgICAgY29udHJvbHMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW1lbnQsY29tcG9uZW50KyctY29udHJvbCcpLFxuXHQgICAgICBsZWZ0QXJyb3cgPSBjb250cm9sc1swXSwgcmlnaHRBcnJvdyA9IGNvbnRyb2xzWzFdLFxuXHQgICAgICBpbmRpY2F0b3IgPSBxdWVyeUVsZW1lbnQoICcuJytjb21wb25lbnQrJy1pbmRpY2F0b3JzJywgZWxlbWVudCApLFxuXHQgICAgICBpbmRpY2F0b3JzID0gaW5kaWNhdG9yW2dldEVsZW1lbnRzQnlUYWdOYW1lXSggXCJMSVwiICk7XG5cdCAgXG5cdCAgICAvLyBoYW5kbGVyc1xuXHQgICAgdmFyIHBhdXNlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICE9PWZhbHNlICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG5cdCAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LHBhdXNlZCk7XG5cdCAgICAgICAgICAhaXNTbGlkaW5nICYmIGNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICByZXN1bWVIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAhPT0gZmFsc2UgJiYgaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxwYXVzZWQpO1xuXHQgICAgICAgICAgIWlzU2xpZGluZyAmJiBjbGVhckludGVydmFsKCB0aW1lciApO1xuXHQgICAgICAgICAgIWlzU2xpZGluZyAmJiBzZWxmLmN5Y2xlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBpbmRpY2F0b3JIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICBpZiAoaXNTbGlkaW5nKSByZXR1cm47XG5cdCAgXG5cdCAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZVt0YXJnZXRdLCBhY3RpdmVJbmRpY2F0b3IgPSBzZWxmLmdldEFjdGl2ZUluZGV4KCk7IC8vIGV2ZW50IHRhcmdldCB8IHRoZSBjdXJyZW50IGFjdGl2ZSBpdGVtXG5cdCAgXG5cdCAgICAgICAgaWYgKCBldmVudFRhcmdldCAmJiAhaGFzQ2xhc3MoZXZlbnRUYXJnZXQsYWN0aXZlKSAmJiBldmVudFRhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFTbGlkZVRvKSApIHtcblx0ICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoIGV2ZW50VGFyZ2V0W2dldEF0dHJpYnV0ZV0oZGF0YVNsaWRlVG8pLCAxMCApO1xuXHQgIFxuXHQgICAgICAgICAgLy9kZXRlcm1pbmUgZGlyZWN0aW9uIGZpcnN0XG5cdCAgICAgICAgICBpZiAgKCAoYWN0aXZlSW5kaWNhdG9yIDwgaW5kZXggKSB8fCAoYWN0aXZlSW5kaWNhdG9yID09PSAwICYmIGluZGV4ID09PSB0b3RhbCAtMSApICkge1xuXHQgICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IGxlZnQ7IC8vIG5leHRcblx0ICAgICAgICAgIH0gZWxzZSBpZiAgKCAoYWN0aXZlSW5kaWNhdG9yID4gaW5kZXgpIHx8IChhY3RpdmVJbmRpY2F0b3IgPT09IHRvdGFsIC0gMSAmJiBpbmRleCA9PT0gMCApICkge1xuXHQgICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IHJpZ2h0OyAvLyBwcmV2XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9XG5cdCAgXG5cdCAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApOyAvL0RvIHRoZSBzbGlkZVxuXHQgICAgICB9LFxuXHQgICAgICBjb250cm9sc0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICBpZiAoaXNTbGlkaW5nKSByZXR1cm47XG5cdCAgXG5cdCAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZS5jdXJyZW50VGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcblx0ICBcblx0ICAgICAgICBpZiAoIGV2ZW50VGFyZ2V0ID09PSByaWdodEFycm93ICkge1xuXHQgICAgICAgICAgaW5kZXgrKztcblx0ICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDsgLy9zZXQgZGlyZWN0aW9uIGZpcnN0XG5cdCAgXG5cdCAgICAgICAgICBpZiggaW5kZXggPT09IHRvdGFsIC0gMSApIHtcblx0ICAgICAgICAgICAgaW5kZXggPSB0b3RhbCAtIDE7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKCBpbmRleCA9PT0gdG90YWwgKXtcblx0ICAgICAgICAgICAgaW5kZXggPSAwO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSBpZiAoIGV2ZW50VGFyZ2V0ID09PSBsZWZ0QXJyb3cgKSB7XG5cdCAgICAgICAgICBpbmRleC0tO1xuXHQgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSByaWdodDsgLy9zZXQgZGlyZWN0aW9uIGZpcnN0XG5cdCAgXG5cdCAgICAgICAgICBpZiggaW5kZXggPT09IDAgKSB7XG5cdCAgICAgICAgICAgIGluZGV4ID0gMDtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAoIGluZGV4IDwgMCApe1xuXHQgICAgICAgICAgICBpbmRleCA9IHRvdGFsIC0gMVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICBcblx0ICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7IC8vRG8gdGhlIHNsaWRlXG5cdCAgICAgIH0sXG5cdCAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmIChpc1NsaWRpbmcpIHJldHVybjtcblx0ICAgICAgICBzd2l0Y2ggKGUud2hpY2gpIHtcblx0ICAgICAgICAgIGNhc2UgMzk6XG5cdCAgICAgICAgICAgIGluZGV4Kys7XG5cdCAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDtcblx0ICAgICAgICAgICAgaWYoIGluZGV4ID09IHRvdGFsIC0gMSApIHsgaW5kZXggPSB0b3RhbCAtIDE7IH0gZWxzZVxuXHQgICAgICAgICAgICBpZiAoIGluZGV4ID09IHRvdGFsICl7IGluZGV4ID0gMCB9XG5cdCAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgY2FzZSAzNzpcblx0ICAgICAgICAgICAgaW5kZXgtLTtcblx0ICAgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSByaWdodDtcblx0ICAgICAgICAgICAgaWYgKCBpbmRleCA9PSAwICkgeyBpbmRleCA9IDA7IH0gZWxzZVxuXHQgICAgICAgICAgICBpZiAoIGluZGV4IDwgMCApIHsgaW5kZXggPSB0b3RhbCAtIDEgfVxuXHQgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgIGRlZmF1bHQ6IHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApOyAvL0RvIHRoZSBzbGlkZVxuXHQgICAgICB9LFxuXHQgICAgICAvLyBwcml2YXRlIG1ldGhvZHNcblx0ICAgICAgc2V0QWN0aXZlUGFnZSA9IGZ1bmN0aW9uKCBwYWdlSW5kZXggKSB7IC8vaW5kaWNhdG9yc1xuXHQgICAgICAgIGZvciAoIHZhciBpID0gMCwgaWNsID0gaW5kaWNhdG9yc1tsZW5ndGhdOyBpIDwgaWNsOyBpKysgKSB7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhpbmRpY2F0b3JzW2ldLGFjdGl2ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChpbmRpY2F0b3JzW3BhZ2VJbmRleF0pIGFkZENsYXNzKGluZGljYXRvcnNbcGFnZUluZGV4XSwgYWN0aXZlKTtcblx0ICAgICAgfTtcblx0ICBcblx0ICBcblx0ICAgIC8vIHB1YmxpYyBtZXRob2RzXG5cdCAgICB0aGlzLmN5Y2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHNsaWRlRGlyZWN0aW9uID0gdGhpc1tkaXJlY3Rpb25dID0gbGVmdDsgLy8gbWFrZSBzdXJlIHRvIGFsd2F5cyBjb21lIGJhY2sgdG8gZGVmYXVsdCBzbGlkZURpcmVjdGlvblxuXHQgICAgICB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGluZGV4Kys7XG5cdCAgXG5cdCAgICAgICAgaW5kZXggPSBpbmRleCA9PT0gdG90YWwgPyAwIDogaW5kZXg7XG5cdCAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApO1xuXHQgICAgICB9LCB0aGlzW2ludGVydmFsXSk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zbGlkZVRvID0gZnVuY3Rpb24oIG5leHQgKSB7XG5cdCAgICAgIHZhciBhY3RpdmVJdGVtID0gdGhpcy5nZXRBY3RpdmVJbmRleCgpLCAvLyB0aGUgY3VycmVudCBhY3RpdmVcblx0ICAgICAgICAgIG9yaWVudGF0aW9uID0gc2xpZGVEaXJlY3Rpb24gPT09IGxlZnQgPyAnbmV4dCcgOiAncHJldic7IC8vZGV0ZXJtaW5lIHR5cGVcblx0ICBcblx0ICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzbGlkZUV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZGVcblx0ICBcblx0ICAgICAgaXNTbGlkaW5nID0gdGhpcy5pc1NsaWRpbmcgPSB0cnVlO1xuXHQgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcblx0ICAgICAgc2V0QWN0aXZlUGFnZSggbmV4dCApO1xuXHQgIFxuXHQgICAgICBpZiAoIHN1cHBvcnRUcmFuc2l0aW9ucyAmJiBoYXNDbGFzcyhlbGVtZW50LCdzbGlkZScpICkge1xuXHQgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxvcmllbnRhdGlvbik7XG5cdCAgICAgICAgc2xpZGVzW25leHRdW29mZnNldFdpZHRoXTsgIFxuXHQgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxzbGlkZURpcmVjdGlvbik7XG5cdCAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLHNsaWRlRGlyZWN0aW9uKTtcblx0ICBcblx0ICAgICAgICBvbmUoc2xpZGVzW25leHRdLCB0cmFuc2l0aW9uRW5kRXZlbnQsIGZ1bmN0aW9uKCkgeyAvL3dlJ3JlIGdvbm5hIGZha2Ugd2FpdGluZyBmb3IgdGhlIGFuaW1hdGlvbiB0byBmaW5pc2gsIGNsZWFuZXIgYW5kIGJldHRlclxuXHQgICAgICAgICAgaXNTbGlkaW5nID0gc2VsZi5pc1NsaWRpbmcgPSBmYWxzZTtcblx0ICBcblx0ICAgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxhY3RpdmUpO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLGFjdGl2ZSk7XG5cdCAgXG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbbmV4dF0sb3JpZW50YXRpb24pO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW25leHRdLHNsaWRlRGlyZWN0aW9uKTtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1thY3RpdmVJdGVtXSxzbGlkZURpcmVjdGlvbik7XG5cdCAgXG5cdCAgICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG5cdCAgICAgICAgICAgIHNlbGYuY3ljbGUoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2xpZEV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZCBldmVudFxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIFxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxhY3RpdmUpO1xuXHQgICAgICAgIHNsaWRlc1tuZXh0XVtvZmZzZXRXaWR0aF07XG5cdCAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLGFjdGl2ZSk7XG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGlzU2xpZGluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAmJiAhaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuXHQgICAgICAgICAgICBzZWxmLmN5Y2xlKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNsaWRFdmVudCwgY29tcG9uZW50LCBzbGlkZXNbbmV4dF0pOyAvLyBoZXJlIHdlIGdvIHdpdGggdGhlIHNsaWQgZXZlbnRcblx0ICAgICAgICB9LCAxMDAgKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIHRoaXMuZ2V0QWN0aXZlSW5kZXggPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBzbGlkZXNbaW5kZXhPZl0oZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlbGVtZW50LCdpdGVtIGFjdGl2ZScpWzBdKSB8fCAwO1xuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdDYXJvdXNlbCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgXG5cdCAgICAgIGlmICggdGhpc1twYXVzZV0gJiYgdGhpc1tpbnRlcnZhbF0gKSB7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsIG1vdXNlSG92ZXJbMF0sIHBhdXNlSGFuZGxlciApO1xuXHQgICAgICAgIG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzFdLCByZXN1bWVIYW5kbGVyICk7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsICd0b3VjaHN0YXJ0JywgcGF1c2VIYW5kbGVyICk7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsICd0b3VjaGVuZCcsIHJlc3VtZUhhbmRsZXIgKTtcblx0ICAgICAgfVxuXHQgICAgXG5cdCAgICAgIHJpZ2h0QXJyb3cgJiYgb24oIHJpZ2h0QXJyb3csIGNsaWNrRXZlbnQsIGNvbnRyb2xzSGFuZGxlciApO1xuXHQgICAgICBsZWZ0QXJyb3cgJiYgb24oIGxlZnRBcnJvdywgY2xpY2tFdmVudCwgY29udHJvbHNIYW5kbGVyICk7XG5cdCAgICBcblx0ICAgICAgaW5kaWNhdG9yICYmIG9uKCBpbmRpY2F0b3IsIGNsaWNrRXZlbnQsIGluZGljYXRvckhhbmRsZXIsIGZhbHNlKTtcblx0ICAgICAgdGhpc1trZXlib2FyZF0gPT09IHRydWUgJiYgb24oIGdsb2JhbE9iamVjdCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyLCBmYWxzZSk7XG5cdCAgXG5cdCAgICB9XG5cdCAgICBpZiAodGhpcy5nZXRBY3RpdmVJbmRleCgpPDApIHtcblx0ICAgICAgc2xpZGVzW2xlbmd0aF0gJiYgYWRkQ2xhc3Moc2xpZGVzWzBdLGFjdGl2ZSk7XG5cdCAgICAgIGluZGljYXRvcnNbbGVuZ3RoXSAmJiBzZXRBY3RpdmVQYWdlKDApO1xuXHQgICAgfVxuXHQgIFxuXHQgICAgaWYgKCB0aGlzW2ludGVydmFsXSApeyB0aGlzLmN5Y2xlKCk7IH1cblx0ICAgIGVsZW1lbnRbc3RyaW5nQ2Fyb3VzZWxdID0gdGhpcztcblx0ICB9O1xuXHQgIFxuXHQgIC8vIENBUk9VU0VMIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQ2Fyb3VzZWwsIENhcm91c2VsLCBkYXRhUmlkZSApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IENvbGxhcHNlXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIENPTExBUFNFIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIENvbGxhcHNlID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvbnNcblx0ICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgIFxuXHQgIFxuXHQgICAgLy8gZXZlbnQgdGFyZ2V0cyBhbmQgY29uc3RhbnRzXG5cdCAgICB2YXIgYWNjb3JkaW9uID0gbnVsbCwgY29sbGFwc2UgPSBudWxsLCBzZWxmID0gdGhpcywgXG5cdCAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2UsIC8vIHdoZW4gdHJ1ZSBpdCB3aWxsIHByZXZlbnQgY2xpY2sgaGFuZGxlcnNcblx0ICAgICAgYWNjb3JkaW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnZGF0YS1wYXJlbnQnKSxcblx0ICBcblx0ICAgICAgLy8gY29tcG9uZW50IHN0cmluZ3Ncblx0ICAgICAgY29tcG9uZW50ID0gJ2NvbGxhcHNlJyxcblx0ICAgICAgY29sbGFwc2VkID0gJ2NvbGxhcHNlZCcsXG5cdCAgXG5cdCAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgICBvcGVuQWN0aW9uID0gZnVuY3Rpb24oY29sbGFwc2VFbGVtZW50KSB7XG5cdCAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIHNob3dFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7XG5cdCAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuXHQgICAgICAgIGFkZENsYXNzKGNvbGxhcHNlRWxlbWVudCxpbkNsYXNzKTtcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGNvbGxhcHNlRWxlbWVudCkgKyAncHgnO1xuXHQgICAgICAgIH0sIDApO1xuXHQgIFxuXHQgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKGNvbGxhcHNlRWxlbWVudCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG5cdCAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSAnJztcblx0ICAgICAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2U7XG5cdCAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsJ3RydWUnKTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9LFxuXHQgICAgICBjbG9zZUFjdGlvbiA9IGZ1bmN0aW9uKGNvbGxhcHNlRWxlbWVudCkge1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgaXNBbmltYXRpbmcgPSB0cnVlO1xuXHQgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9IGdldE1heEhlaWdodChjb2xsYXBzZUVsZW1lbnQpICsgJ3B4Jztcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuXHQgICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gJzBweCc7XG5cdCAgICAgICAgfSwgMCk7XG5cdCAgXG5cdCAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoY29sbGFwc2VFbGVtZW50LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxjb2xsYXBzaW5nKTtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxpbkNsYXNzKTtcblx0ICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9ICcnO1xuXHQgICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTtcblx0ICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzZXRBdHRyaWJ1dGVdKGFyaWFFeHBhbmRlZCwnZmFsc2UnKTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSxcblx0ICAgICAgZ2V0VGFyZ2V0ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGhyZWYgPSBlbGVtZW50LmhyZWYgJiYgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdocmVmJyksXG5cdCAgICAgICAgICBwYXJlbnQgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCksXG5cdCAgICAgICAgICBpZCA9IGhyZWYgfHwgKCBwYXJlbnQgJiYgLyMvLnRlc3QocGFyZW50KSApICYmIHBhcmVudDtcblx0ICAgICAgICByZXR1cm4gaWQgJiYgcXVlcnlFbGVtZW50KGlkKTtcblx0ICAgICAgfTtcblx0ICAgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgIGlmIChpc0FuaW1hdGluZykgcmV0dXJuO1xuXHQgICAgICBpZiAoIWhhc0NsYXNzKGNvbGxhcHNlLGluQ2xhc3MpKSB7IHNlbGYuc2hvdygpOyB9IFxuXHQgICAgICBlbHNlIHsgc2VsZi5oaWRlKCk7IH1cblx0ICAgIH07XG5cdCAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgY2xvc2VBY3Rpb24oY29sbGFwc2UpO1xuXHQgICAgICBhZGRDbGFzcyhlbGVtZW50LGNvbGxhcHNlZCk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIG9wZW5BY3Rpb24oY29sbGFwc2UpO1xuXHQgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGNvbGxhcHNlZCk7XG5cdCAgXG5cdCAgICAgIGlmICggYWNjb3JkaW9uICE9PSBudWxsICkge1xuXHQgICAgICAgIHZhciBhY3RpdmVDb2xsYXBzZXMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGFjY29yZGlvbixjb21wb25lbnQrJyAnK2luQ2xhc3MpO1xuXHQgICAgICAgIGZvciAodmFyIGk9MCwgYWw9YWN0aXZlQ29sbGFwc2VzW2xlbmd0aF07IGk8YWw7IGkrKykge1xuXHQgICAgICAgICAgaWYgKCBhY3RpdmVDb2xsYXBzZXNbaV0gIT09IGNvbGxhcHNlKSBjbG9zZUFjdGlvbihhY3RpdmVDb2xsYXBzZXNbaV0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdDb2xsYXBzZSBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIHRoaXMudG9nZ2xlKTtcblx0ICAgIH1cblx0ICAgIGNvbGxhcHNlID0gZ2V0VGFyZ2V0KCk7XG5cdCAgICBhY2NvcmRpb24gPSBxdWVyeUVsZW1lbnQob3B0aW9ucy5wYXJlbnQpIHx8IGFjY29yZGlvbkRhdGEgJiYgZ2V0Q2xvc2VzdChlbGVtZW50LCBhY2NvcmRpb25EYXRhKTtcblx0ICAgIGVsZW1lbnRbc3RyaW5nQ29sbGFwc2VdID0gdGhpcztcblx0ICB9O1xuXHQgIFxuXHQgIC8vIENPTExBUFNFIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdDb2xsYXBzZSwgQ29sbGFwc2UsIGRhdGFUb2dnbGUpO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IERyb3Bkb3duXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gRFJPUERPV04gREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PT1cblx0ICB2YXIgRHJvcGRvd24gPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9uICkge1xuXHQgICAgICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uXG5cdCAgICB0aGlzLnBlcnNpc3QgPSBvcHRpb24gPT09IHRydWUgfHwgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdkYXRhLXBlcnNpc3QnKSA9PT0gJ3RydWUnIHx8IGZhbHNlO1xuXHQgIFxuXHQgICAgLy8gY29uc3RhbnRzLCBldmVudCB0YXJnZXRzLCBzdHJpbmdzXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIGlzT3BlbiA9IGZhbHNlLFxuXHQgICAgICBwYXJlbnQgPSBlbGVtZW50W3BhcmVudE5vZGVdLFxuXHQgICAgICBjb21wb25lbnQgPSAnZHJvcGRvd24nLCBvcGVuID0gJ29wZW4nLFxuXHQgICAgICByZWxhdGVkVGFyZ2V0ID0gbnVsbCxcblx0ICAgICAgbWVudSA9IHF1ZXJ5RWxlbWVudCgnLmRyb3Bkb3duLW1lbnUnLCBwYXJlbnQpLFxuXHQgICAgICBjaGlsZHJlbiA9IG5vZGVMaXN0VG9BcnJheSggbWVudVtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJyonKSksXG5cdCAgXG5cdCAgICAgIC8vIGhhbmRsZXJzXG5cdCAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgaWYgKGlzT3BlbiAmJiAoZS53aGljaCA9PSAyNyB8fCBlLmtleUNvZGUgPT0gMjcpKSB7IHJlbGF0ZWRUYXJnZXQgPSBudWxsOyBoaWRlKCk7IH0gLy8gZS5rZXlDb2RlIGZvciBJRThcblx0ICAgICAgfSxcblx0ICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICAgIHZhciBldmVudFRhcmdldCA9IGVbdGFyZ2V0XSwgaGFzRGF0YTtcblx0ICAgICAgICBoYXNEYXRhID0gKCBldmVudFRhcmdldC5ub2RlVHlwZSAhPT0gMSAmJiAoZXZlbnRUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhVG9nZ2xlKSB8fCBldmVudFRhcmdldFtwYXJlbnROb2RlXVtnZXRBdHRyaWJ1dGVdKGRhdGFUb2dnbGUpKSApO1xuXHQgICAgICAgIGlmICggZXZlbnRUYXJnZXQgPT09IGVsZW1lbnQgfHwgZXZlbnRUYXJnZXQgPT09IHBhcmVudCB8fCBldmVudFRhcmdldFtwYXJlbnROb2RlXSA9PT0gZWxlbWVudCApIHtcblx0ICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy8gY29tbWVudCB0aGlzIGxpbmUgdG8gc3RvcCBwcmV2ZW50aW5nIG5hdmlnYXRpb24gd2hlbiBjbGljayB0YXJnZXQgaXMgYSBsaW5rIFxuXHQgICAgICAgICAgcmVsYXRlZFRhcmdldCA9IGVsZW1lbnQ7XG5cdCAgICAgICAgICBzZWxmLnRvZ2dsZSgpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoIGlzT3BlbiApIHtcblx0ICAgICAgICAgIGlmICggKGV2ZW50VGFyZ2V0ID09PSBtZW51IHx8IGNoaWxkcmVuICYmIGNoaWxkcmVuW2luZGV4T2ZdKGV2ZW50VGFyZ2V0KSA+IC0xKSAmJiAoIHNlbGYucGVyc2lzdCB8fCBoYXNEYXRhICkgKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgIH0gZWxzZSB7IHJlbGF0ZWRUYXJnZXQgPSBudWxsOyBoaWRlKCk7IH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgKC9cXCMkLy50ZXN0KGV2ZW50VGFyZ2V0LmhyZWYpIHx8IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdICYmIC9cXCMkLy50ZXN0KGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdLmhyZWYpKSAmJiBlLnByZXZlbnREZWZhdWx0KCk7IC8vIHNob3VsZCBiZSBoZXJlIHRvIHByZXZlbnQganVtcHNcblx0ICAgICAgfSxcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIHNob3cgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgc2hvd0V2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICAgIGFkZENsYXNzKHBhcmVudCxvcGVuKTtcblx0ICAgICAgICBtZW51W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLHRydWUpO1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICAgIG9uKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuXHQgICAgICAgIGlzT3BlbiA9IHRydWU7XG5cdCAgICAgIH0sXG5cdCAgICAgIGhpZGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgaGlkZUV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKHBhcmVudCxvcGVuKTtcblx0ICAgICAgICBtZW51W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLGZhbHNlKTtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG5cdCAgICAgICAgb2ZmKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuXHQgICAgICAgIGlzT3BlbiA9IGZhbHNlO1xuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmIChoYXNDbGFzcyhwYXJlbnQsb3BlbikgJiYgaXNPcGVuKSB7IGhpZGUoKTsgfSBcblx0ICAgICAgZWxzZSB7IHNob3coKTsgfVxuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdEcm9wZG93biBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgbWVudVtzZXRBdHRyaWJ1dGVdKCd0YWJpbmRleCcsICcwJyk7IC8vIEZpeCBvbmJsdXIgb24gQ2hyb21lIHwgU2FmYXJpXG5cdCAgICAgIG9uKGRvY3VtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdEcm9wZG93bl0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gRFJPUERPV04gREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdEcm9wZG93biwgRHJvcGRvd24sIGRhdGFUb2dnbGUgKTtcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBNb2RhbFxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgICAgXG5cdCAgLy8gTU9EQUwgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PVxuXHQgIHZhciBNb2RhbCA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHsgLy8gZWxlbWVudCBjYW4gYmUgdGhlIG1vZGFsL3RyaWdnZXJpbmcgYnV0dG9uXG5cdCAgXG5cdCAgICAvLyB0aGUgbW9kYWwgKGJvdGggSmF2YVNjcmlwdCAvIERBVEEgQVBJIGluaXQpIC8gdHJpZ2dlcmluZyBidXR0b24gZWxlbWVudCAoREFUQSBBUEkpXG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gZGV0ZXJtaW5lIG1vZGFsLCB0cmlnZ2VyaW5nIGVsZW1lbnQgXG5cdCAgICB2YXIgYnRuQ2hlY2sgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCl8fGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnaHJlZicpLFxuXHQgICAgICBjaGVja01vZGFsID0gcXVlcnlFbGVtZW50KCBidG5DaGVjayApLFxuXHQgICAgICBtb2RhbCA9IGhhc0NsYXNzKGVsZW1lbnQsJ21vZGFsJykgPyBlbGVtZW50IDogY2hlY2tNb2RhbCxcblx0ICBcblx0ICAgICAgLy8gc3RyaW5nc1xuXHQgICAgICBjb21wb25lbnQgPSAnbW9kYWwnLFxuXHQgICAgICBzdGF0aWNTdHJpbmcgPSAnc3RhdGljJyxcblx0ICAgICAgcGFkZGluZ0xlZnQgPSAncGFkZGluZ0xlZnQnLFxuXHQgICAgICBwYWRkaW5nUmlnaHQgPSAncGFkZGluZ1JpZ2h0Jyxcblx0ICAgICAgbW9kYWxCYWNrZHJvcFN0cmluZyA9ICdtb2RhbC1iYWNrZHJvcCc7XG5cdCAgXG5cdCAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ21vZGFsJykgKSB7IGVsZW1lbnQgPSBudWxsOyB9IC8vIG1vZGFsIGlzIG5vdyBpbmRlcGVuZGVudCBvZiBpdCdzIHRyaWdnZXJpbmcgZWxlbWVudFxuXHQgIFxuXHQgICAgaWYgKCAhbW9kYWwgKSB7IHJldHVybjsgfSAvLyBpbnZhbGlkYXRlXG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgXG5cdCAgICB0aGlzW2tleWJvYXJkXSA9IG9wdGlvbnNba2V5Ym9hcmRdID09PSBmYWxzZSB8fCBtb2RhbFtnZXRBdHRyaWJ1dGVdKGRhdGFLZXlib2FyZCkgPT09ICdmYWxzZScgPyBmYWxzZSA6IHRydWU7XG5cdCAgICB0aGlzW2JhY2tkcm9wXSA9IG9wdGlvbnNbYmFja2Ryb3BdID09PSBzdGF0aWNTdHJpbmcgfHwgbW9kYWxbZ2V0QXR0cmlidXRlXShkYXRhYmFja2Ryb3ApID09PSBzdGF0aWNTdHJpbmcgPyBzdGF0aWNTdHJpbmcgOiB0cnVlO1xuXHQgICAgdGhpc1tiYWNrZHJvcF0gPSBvcHRpb25zW2JhY2tkcm9wXSA9PT0gZmFsc2UgfHwgbW9kYWxbZ2V0QXR0cmlidXRlXShkYXRhYmFja2Ryb3ApID09PSAnZmFsc2UnID8gZmFsc2UgOiB0aGlzW2JhY2tkcm9wXTtcblx0ICAgIHRoaXNbY29udGVudF0gID0gb3B0aW9uc1tjb250ZW50XTsgLy8gSmF2YVNjcmlwdCBvbmx5XG5cdCAgXG5cdCAgICAvLyBiaW5kLCBjb25zdGFudHMsIGV2ZW50IHRhcmdldHMgYW5kIG90aGVyIHZhcnNcblx0ICAgIHZhciBzZWxmID0gdGhpcywgb3BlbiA9IHRoaXMub3BlbiA9IGZhbHNlLCByZWxhdGVkVGFyZ2V0ID0gbnVsbCxcblx0ICAgICAgYm9keUlzT3ZlcmZsb3dpbmcsIG1vZGFsSXNPdmVyZmxvd2luZywgc2Nyb2xsYmFyV2lkdGgsIG92ZXJsYXksXG5cdCAgXG5cdCAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgICBnZXRXaW5kb3dXaWR0aCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBodG1sUmVjdCA9IGRvY1tnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCk7XG5cdCAgICAgICAgcmV0dXJuIGdsb2JhbE9iamVjdFtpbm5lcldpZHRoXSB8fCAoaHRtbFJlY3RbcmlnaHRdIC0gTWF0aC5hYnMoaHRtbFJlY3RbbGVmdF0pKTtcblx0ICAgICAgfSxcblx0ICAgICAgc2V0U2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBib2R5U3R5bGUgPSBib2R5LmN1cnJlbnRTdHlsZSB8fCBnbG9iYWxPYmplY3QuZ2V0Q29tcHV0ZWRTdHlsZShib2R5KSwgYm9keVBhZCA9IHBhcnNlSW50KChib2R5U3R5bGVbcGFkZGluZ1JpZ2h0XSksIDEwKTtcblx0ICAgICAgICBpZiAoYm9keUlzT3ZlcmZsb3dpbmcpIHsgYm9keVtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9IChib2R5UGFkICsgc2Nyb2xsYmFyV2lkdGgpICsgJ3B4JzsgfVxuXHQgICAgICB9LFxuXHQgICAgICByZXNldFNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBib2R5W3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gJyc7XG5cdCAgICAgIH0sXG5cdCAgICAgIG1lYXN1cmVTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7IC8vIHRoeCB3YWxzaFxuXHQgICAgICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwgc2Nyb2xsQmFyV2lkdGg7XG5cdCAgICAgICAgc2Nyb2xsRGl2LmNsYXNzTmFtZSA9IGNvbXBvbmVudCsnLXNjcm9sbGJhci1tZWFzdXJlJzsgLy8gdGhpcyBpcyBoZXJlIHRvIHN0YXlcblx0ICAgICAgICBib2R5LmFwcGVuZENoaWxkKHNjcm9sbERpdik7XG5cdCAgICAgICAgc2Nyb2xsQmFyV2lkdGggPSBzY3JvbGxEaXZbb2Zmc2V0V2lkdGhdIC0gc2Nyb2xsRGl2W2NsaWVudFdpZHRoXTtcblx0ICAgICAgICBib2R5LnJlbW92ZUNoaWxkKHNjcm9sbERpdik7XG5cdCAgICAgICAgcmV0dXJuIHNjcm9sbEJhcldpZHRoO1xuXHQgICAgICB9LFxuXHQgICAgICBjaGVja1Njcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBib2R5SXNPdmVyZmxvd2luZyA9IGJvZHlbY2xpZW50V2lkdGhdIDwgZ2V0V2luZG93V2lkdGgoKTtcblx0ICAgICAgICBtb2RhbElzT3ZlcmZsb3dpbmcgPSBtb2RhbFtzY3JvbGxIZWlnaHRdID4gZG9jW2NsaWVudEhlaWdodF07XG5cdCAgICAgICAgc2Nyb2xsYmFyV2lkdGggPSBtZWFzdXJlU2Nyb2xsYmFyKCk7XG5cdCAgICAgIH0sXG5cdCAgICAgIGFkanVzdERpYWxvZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ0xlZnRdID0gIWJvZHlJc092ZXJmbG93aW5nICYmIG1vZGFsSXNPdmVyZmxvd2luZyA/IHNjcm9sbGJhcldpZHRoICsgJ3B4JyA6ICcnO1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gYm9keUlzT3ZlcmZsb3dpbmcgJiYgIW1vZGFsSXNPdmVyZmxvd2luZyA/IHNjcm9sbGJhcldpZHRoICsgJ3B4JyA6ICcnO1xuXHQgICAgICB9LFxuXHQgICAgICByZXNldEFkanVzdG1lbnRzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nTGVmdF0gPSAnJztcblx0ICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9ICcnO1xuXHQgICAgICB9LFxuXHQgICAgICBjcmVhdGVPdmVybGF5ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIG5ld092ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0ICAgICAgICBvdmVybGF5ID0gcXVlcnlFbGVtZW50KCcuJyttb2RhbEJhY2tkcm9wU3RyaW5nKTtcblx0ICBcblx0ICAgICAgICBpZiAoIG92ZXJsYXkgPT09IG51bGwgKSB7XG5cdCAgICAgICAgICBuZXdPdmVybGF5W3NldEF0dHJpYnV0ZV0oJ2NsYXNzJyxtb2RhbEJhY2tkcm9wU3RyaW5nKycgZmFkZScpO1xuXHQgICAgICAgICAgb3ZlcmxheSA9IG5ld092ZXJsYXk7XG5cdCAgICAgICAgICBib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgcmVtb3ZlT3ZlcmxheSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIG92ZXJsYXkgPSBxdWVyeUVsZW1lbnQoJy4nK21vZGFsQmFja2Ryb3BTdHJpbmcpOyBcblx0ICAgICAgICBpZiAoIG92ZXJsYXkgJiYgb3ZlcmxheSAhPT0gbnVsbCAmJiB0eXBlb2Ygb3ZlcmxheSA9PT0gJ29iamVjdCcgKSB7XG5cdCAgICAgICAgICBib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyBvdmVybGF5ID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGtleWRvd25IYW5kbGVyVG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSkge1xuXHQgICAgICAgICAgb24oZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG9mZihkb2N1bWVudCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlc2l6ZUhhbmRsZXJUb2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoIWhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7XG5cdCAgICAgICAgICBvbihnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLnVwZGF0ZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG9mZihnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLnVwZGF0ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBkaXNtaXNzSGFuZGxlclRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICghaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHtcblx0ICAgICAgICAgIG9uKG1vZGFsLCBjbGlja0V2ZW50LCBkaXNtaXNzSGFuZGxlcik7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG9mZihtb2RhbCwgY2xpY2tFdmVudCwgZGlzbWlzc0hhbmRsZXIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLy8gaGFuZGxlcnNcblx0ICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICAgIHZhciBjbGlja1RhcmdldCA9IGVbdGFyZ2V0XTsgXG5cdCAgICAgICAgY2xpY2tUYXJnZXQgPSBjbGlja1RhcmdldFtoYXNBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpIHx8IGNsaWNrVGFyZ2V0W2hhc0F0dHJpYnV0ZV0oJ2hyZWYnKSA/IGNsaWNrVGFyZ2V0IDogY2xpY2tUYXJnZXRbcGFyZW50Tm9kZV07XG5cdCAgICAgICAgaWYgKCAhb3BlbiAmJiBjbGlja1RhcmdldCA9PT0gZWxlbWVudCAmJiAhaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykgKSB7XG5cdCAgICAgICAgICBtb2RhbC5tb2RhbFRyaWdnZXIgPSBlbGVtZW50O1xuXHQgICAgICAgICAgcmVsYXRlZFRhcmdldCA9IGVsZW1lbnQ7XG5cdCAgICAgICAgICBzZWxmLnNob3coKTtcblx0ICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIGtleSA9IGUud2hpY2ggfHwgZS5rZXlDb2RlOyAvLyBrZXlDb2RlIGZvciBJRThcblx0ICAgICAgICBpZiAoc2VsZltrZXlib2FyZF0gJiYga2V5ID09IDI3ICYmIG9wZW4pIHtcblx0ICAgICAgICAgIHNlbGYuaGlkZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZGlzbWlzc0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIGNsaWNrVGFyZ2V0ID0gZVt0YXJnZXRdO1xuXHQgICAgICAgIGlmICggb3BlbiAmJiAoY2xpY2tUYXJnZXRbcGFyZW50Tm9kZV1bZ2V0QXR0cmlidXRlXShkYXRhRGlzbWlzcykgPT09IGNvbXBvbmVudCBcblx0ICAgICAgICAgICAgfHwgY2xpY2tUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhRGlzbWlzcykgPT09IGNvbXBvbmVudFxuXHQgICAgICAgICAgICB8fCAoY2xpY2tUYXJnZXQgPT09IG1vZGFsICYmIHNlbGZbYmFja2Ryb3BdICE9PSBzdGF0aWNTdHJpbmcpICkgKSB7XG5cdCAgICAgICAgICBzZWxmLmhpZGUoKTsgcmVsYXRlZFRhcmdldCA9IG51bGw7XG5cdCAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmIChvcGVuICYmIGhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7dGhpcy5oaWRlKCk7fSBlbHNlIHt0aGlzLnNob3coKTt9XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIHNob3dFdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcblx0ICBcblx0ICAgICAgLy8gd2UgZWxlZ2FudGx5IGhpZGUgYW55IG9wZW5lZCBtb2RhbFxuXHQgICAgICB2YXIgY3VycmVudE9wZW4gPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGRvY3VtZW50LGNvbXBvbmVudCsnIGluJylbMF07XG5cdCAgICAgIGN1cnJlbnRPcGVuICYmIGN1cnJlbnRPcGVuICE9PSBtb2RhbCAmJiBjdXJyZW50T3Blbi5tb2RhbFRyaWdnZXJbc3RyaW5nTW9kYWxdLmhpZGUoKTsgXG5cdCAgXG5cdCAgICAgIGlmICggdGhpc1tiYWNrZHJvcF0gKSB7XG5cdCAgICAgICAgY3JlYXRlT3ZlcmxheSgpO1xuXHQgICAgICB9XG5cdCAgXG5cdCAgICAgIGlmICggb3ZlcmxheSAmJiAhaGFzQ2xhc3Mob3ZlcmxheSxpbkNsYXNzKSkge1xuXHQgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgeyBhZGRDbGFzcyhvdmVybGF5LGluQ2xhc3MpOyB9LCAwKTtcblx0ICAgICAgfVxuXHQgIFxuXHQgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBtb2RhbFtzdHlsZV0uZGlzcGxheSA9ICdibG9jayc7XG5cdCAgXG5cdCAgICAgICAgY2hlY2tTY3JvbGxiYXIoKTtcblx0ICAgICAgICBzZXRTY3JvbGxiYXIoKTtcblx0ICAgICAgICBhZGp1c3REaWFsb2coKTtcblx0ICBcblx0ICAgICAgICByZXNpemVIYW5kbGVyVG9nZ2xlKCk7XG5cdCAgICAgICAgZGlzbWlzc0hhbmRsZXJUb2dnbGUoKTtcblx0ICAgICAgICBrZXlkb3duSGFuZGxlclRvZ2dsZSgpO1xuXHQgIFxuXHQgICAgICAgIGFkZENsYXNzKGJvZHksY29tcG9uZW50Kyctb3BlbicpO1xuXHQgICAgICAgIGFkZENsYXNzKG1vZGFsLGluQ2xhc3MpO1xuXHQgICAgICAgIG1vZGFsW3NldEF0dHJpYnV0ZV0oYXJpYUhpZGRlbiwgZmFsc2UpO1xuXHQgICAgICB9LCAwKTtcblx0ICBcblx0ICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQobW9kYWwsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIG9wZW4gPSBzZWxmLm9wZW4gPSB0cnVlO1xuXHQgICAgICAgIHNldEZvY3VzKG1vZGFsKTtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBzaG93bkV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICB9KTtcblx0ICAgIH07XG5cdCAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChtb2RhbCwgaGlkZUV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICBvdmVybGF5ID0gcXVlcnlFbGVtZW50KCcuJyttb2RhbEJhY2tkcm9wU3RyaW5nKTtcblx0ICBcblx0ICAgICAgaWYgKCBvdmVybGF5ICE9PSBudWxsICkge1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKG92ZXJsYXksaW5DbGFzcyk7XG5cdCAgICAgIH1cblx0ICAgICAgcmVtb3ZlQ2xhc3MobW9kYWwsaW5DbGFzcyk7XG5cdCAgICAgIG1vZGFsW3NldEF0dHJpYnV0ZV0oYXJpYUhpZGRlbiwgdHJ1ZSk7XG5cdCAgXG5cdCAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKG1vZGFsLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZW1vdmVDbGFzcyhib2R5LGNvbXBvbmVudCsnLW9wZW4nKTtcblx0ICAgICAgICByZXNpemVIYW5kbGVyVG9nZ2xlKCk7XG5cdCAgICAgICAgZGlzbWlzc0hhbmRsZXJUb2dnbGUoKTtcblx0ICAgICAgICBrZXlkb3duSGFuZGxlclRvZ2dsZSgpO1xuXHQgIFxuXHQgICAgICAgIHJlc2V0QWRqdXN0bWVudHMoKTtcblx0ICAgICAgICByZXNldFNjcm9sbGJhcigpO1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXS5kaXNwbGF5ID0gJyc7XG5cdCAgXG5cdCAgICAgICAgaWYgKCFnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGRvY3VtZW50LGNvbXBvbmVudCsnICcraW5DbGFzcylbMF0pIHsgcmVtb3ZlT3ZlcmxheSgpOyB9XG5cdCAgICAgICAgb3BlbiA9IHNlbGYub3BlbiA9IGZhbHNlO1xuXHQgICAgICAgIGVsZW1lbnQgJiYgKHNldEZvY3VzKGVsZW1lbnQpKTtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zZXRDb250ZW50ID0gZnVuY3Rpb24oIGNvbnRlbnQgKSB7XG5cdCAgICAgIHF1ZXJ5RWxlbWVudCgnLicrY29tcG9uZW50KyctY29udGVudCcsbW9kYWwpLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdCAgICB9O1xuXHQgICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKG9wZW4pIHtcblx0ICAgICAgICBjaGVja1Njcm9sbGJhcigpO1xuXHQgICAgICAgIHNldFNjcm9sbGJhcigpO1xuXHQgICAgICAgIGFkanVzdERpYWxvZygpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgb3ZlciBhbmQgb3ZlclxuXHQgICAgLy8gbW9kYWwgaXMgaW5kZXBlbmRlbnQgb2YgYSB0cmlnZ2VyaW5nIGVsZW1lbnQgXG5cdCAgICBpZiAoICEhZWxlbWVudCAmJiAhKHN0cmluZ01vZGFsIGluIGVsZW1lbnQpICkge1xuXHQgICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuXHQgICAgfVxuXHQgICAgaWYgKCAhIXRoaXNbY29udGVudF0gKSB7IHRoaXMuc2V0Q29udGVudCggdGhpc1tjb250ZW50XSApOyB9XG5cdCAgICAhIWVsZW1lbnQgJiYgKGVsZW1lbnRbc3RyaW5nTW9kYWxdID0gdGhpcyk7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBEQVRBIEFQSVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ01vZGFsLCBNb2RhbCwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgUG9wb3ZlclxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIFBPUE9WRVIgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PVxuXHQgIHZhciBQb3BvdmVyID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gREFUQSBBUElcblx0ICAgIHZhciB0cmlnZ2VyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVHJpZ2dlciksIC8vIGNsaWNrIC8gaG92ZXIgLyBmb2N1c1xuXHQgICAgICAgIGFuaW1hdGlvbkRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUFuaW1hdGlvbiksIC8vIHRydWUgLyBmYWxzZVxuXHQgICAgICAgIHBsYWNlbWVudERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBsYWNlbWVudCksXG5cdCAgICAgICAgZGlzbWlzc2libGVEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzaWJsZSksXG5cdCAgICAgICAgZGVsYXlEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEZWxheSksXG5cdCAgICAgICAgY29udGFpbmVyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGFpbmVyKSxcblx0ICBcblx0ICAgICAgICAvLyBpbnRlcm5hbCBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ3BvcG92ZXInLFxuXHQgICAgICAgIHRlbXBsYXRlID0gJ3RlbXBsYXRlJyxcblx0ICAgICAgICB0cmlnZ2VyID0gJ3RyaWdnZXInLFxuXHQgICAgICAgIGNsYXNzU3RyaW5nID0gJ2NsYXNzJyxcblx0ICAgICAgICBkaXYgPSAnZGl2Jyxcblx0ICAgICAgICBmYWRlID0gJ2ZhZGUnLFxuXHQgICAgICAgIHRpdGxlID0gJ3RpdGxlJyxcblx0ICAgICAgICBjb250ZW50ID0gJ2NvbnRlbnQnLFxuXHQgICAgICAgIGRhdGFUaXRsZSA9ICdkYXRhLXRpdGxlJyxcblx0ICAgICAgICBkYXRhQ29udGVudCA9ICdkYXRhLWNvbnRlbnQnLFxuXHQgICAgICAgIGRpc21pc3NpYmxlID0gJ2Rpc21pc3NpYmxlJyxcblx0ICAgICAgICBjbG9zZUJ0biA9ICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCI+w5c8L2J1dHRvbj4nO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvbnNcblx0ICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgICAgdGhpc1t0ZW1wbGF0ZV0gPSBvcHRpb25zW3RlbXBsYXRlXSA/IG9wdGlvbnNbdGVtcGxhdGVdIDogbnVsbDsgLy8gSmF2YVNjcmlwdCBvbmx5XG5cdCAgICB0aGlzW3RyaWdnZXJdID0gb3B0aW9uc1t0cmlnZ2VyXSA/IG9wdGlvbnNbdHJpZ2dlcl0gOiB0cmlnZ2VyRGF0YSB8fCBob3ZlckV2ZW50O1xuXHQgICAgdGhpc1thbmltYXRpb25dID0gb3B0aW9uc1thbmltYXRpb25dICYmIG9wdGlvbnNbYW5pbWF0aW9uXSAhPT0gZmFkZSA/IG9wdGlvbnNbYW5pbWF0aW9uXSA6IGFuaW1hdGlvbkRhdGEgfHwgZmFkZTtcblx0ICAgIHRoaXNbcGxhY2VtZW50XSA9IG9wdGlvbnNbcGxhY2VtZW50XSA/IG9wdGlvbnNbcGxhY2VtZW50XSA6IHBsYWNlbWVudERhdGEgfHwgdG9wO1xuXHQgICAgdGhpc1tkZWxheV0gPSBwYXJzZUludChvcHRpb25zW2RlbGF5XSB8fCBkZWxheURhdGEpIHx8IDIwMDtcblx0ICAgIHRoaXNbZGlzbWlzc2libGVdID0gb3B0aW9uc1tkaXNtaXNzaWJsZV0gfHwgZGlzbWlzc2libGVEYXRhID09PSAndHJ1ZScgPyB0cnVlIDogZmFsc2U7XG5cdCAgICB0aGlzW2NvbnRhaW5lcl0gPSBxdWVyeUVsZW1lbnQob3B0aW9uc1tjb250YWluZXJdKSB8fCBxdWVyeUVsZW1lbnQoY29udGFpbmVyRGF0YSkgfHwgYm9keTtcblx0ICAgIFxuXHQgICAgLy8gYmluZCwgY29udGVudFxuXHQgICAgdmFyIHNlbGYgPSB0aGlzLCBcblx0ICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRpdGxlKSB8fCBudWxsLFxuXHQgICAgICBjb250ZW50U3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250ZW50KSB8fCBudWxsO1xuXHQgIFxuXHQgICAgaWYgKCAhY29udGVudFN0cmluZyAmJiAhdGhpc1t0ZW1wbGF0ZV0gKSByZXR1cm47IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIGNvbnN0YW50cywgdmFyc1xuXHQgICAgdmFyIHBvcG92ZXIgPSBudWxsLCB0aW1lciA9IDAsIHBsYWNlbWVudFNldHRpbmcgPSB0aGlzW3BsYWNlbWVudF0sXG5cdCAgICAgIFxuXHQgICAgICAvLyBoYW5kbGVyc1xuXHQgICAgICBkaXNtaXNzaWJsZUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgaWYgKHBvcG92ZXIgIT09IG51bGwgJiYgZVt0YXJnZXRdID09PSBxdWVyeUVsZW1lbnQoJy5jbG9zZScscG9wb3ZlcikpIHtcblx0ICAgICAgICAgIHNlbGYuaGlkZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICBcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIHJlbW92ZVBvcG92ZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZWxmW2NvbnRhaW5lcl0ucmVtb3ZlQ2hpbGQocG9wb3Zlcik7XG5cdCAgICAgICAgdGltZXIgPSBudWxsOyBwb3BvdmVyID0gbnVsbDsgXG5cdCAgICAgIH0sXG5cdCAgICAgIGNyZWF0ZVBvcG92ZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aXRsZVN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGl0bGUpOyAvLyBjaGVjayBjb250ZW50IGFnYWluXG5cdCAgICAgICAgY29udGVudFN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGVudCk7XG5cdCAgXG5cdCAgICAgICAgcG9wb3ZlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcblx0ICBcblx0ICAgICAgICBpZiAoIGNvbnRlbnRTdHJpbmcgIT09IG51bGwgJiYgc2VsZlt0ZW1wbGF0ZV0gPT09IG51bGwgKSB7IC8vY3JlYXRlIHRoZSBwb3BvdmVyIGZyb20gZGF0YSBhdHRyaWJ1dGVzXG5cdCAgXG5cdCAgICAgICAgICBwb3BvdmVyW3NldEF0dHJpYnV0ZV0oJ3JvbGUnLCd0b29sdGlwJyk7XG5cdCAgXG5cdCAgICAgICAgICBpZiAodGl0bGVTdHJpbmcgIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgdmFyIHBvcG92ZXJUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG5cdCAgICAgICAgICAgIHBvcG92ZXJUaXRsZVtzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLGNvbXBvbmVudCsnLXRpdGxlJyk7XG5cdCAgXG5cdCAgICAgICAgICAgIHBvcG92ZXJUaXRsZS5pbm5lckhUTUwgPSBzZWxmW2Rpc21pc3NpYmxlXSA/IHRpdGxlU3RyaW5nICsgY2xvc2VCdG4gOiB0aXRsZVN0cmluZztcblx0ICAgICAgICAgICAgcG9wb3Zlci5hcHBlbmRDaGlsZChwb3BvdmVyVGl0bGUpO1xuXHQgICAgICAgICAgfVxuXHQgIFxuXHQgICAgICAgICAgdmFyIHBvcG92ZXJBcnJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KSwgcG9wb3ZlckNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG5cdCAgICAgICAgICBwb3BvdmVyQXJyb3dbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywnYXJyb3cnKTsgcG9wb3ZlckNvbnRlbnRbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZyxjb21wb25lbnQrJy1jb250ZW50Jyk7XG5cdCAgICAgICAgICBwb3BvdmVyLmFwcGVuZENoaWxkKHBvcG92ZXJBcnJvdyk7IHBvcG92ZXIuYXBwZW5kQ2hpbGQocG9wb3ZlckNvbnRlbnQpO1xuXHQgIFxuXHQgICAgICAgICAgLy9zZXQgcG9wb3ZlciBjb250ZW50XG5cdCAgICAgICAgICBwb3BvdmVyQ29udGVudC5pbm5lckhUTUwgPSBzZWxmW2Rpc21pc3NpYmxlXSAmJiB0aXRsZVN0cmluZyA9PT0gbnVsbCA/IGNvbnRlbnRTdHJpbmcgKyBjbG9zZUJ0biA6IGNvbnRlbnRTdHJpbmc7XG5cdCAgXG5cdCAgICAgICAgfSBlbHNlIHsgIC8vIG9yIGNyZWF0ZSB0aGUgcG9wb3ZlciBmcm9tIHRlbXBsYXRlXG5cdCAgICAgICAgICB2YXIgcG9wb3ZlclRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuXHQgICAgICAgICAgcG9wb3ZlclRlbXBsYXRlLmlubmVySFRNTCA9IHNlbGZbdGVtcGxhdGVdO1xuXHQgICAgICAgICAgcG9wb3Zlci5pbm5lckhUTUwgPSBwb3BvdmVyVGVtcGxhdGUuZmlyc3RDaGlsZC5pbm5lckhUTUw7XG5cdCAgICAgICAgfVxuXHQgIFxuXHQgICAgICAgIC8vYXBwZW5kIHRvIHRoZSBjb250YWluZXJcblx0ICAgICAgICBzZWxmW2NvbnRhaW5lcl0uYXBwZW5kQ2hpbGQocG9wb3Zlcik7XG5cdCAgICAgICAgcG9wb3ZlcltzdHlsZV0uZGlzcGxheSA9ICdibG9jayc7XG5cdCAgICAgICAgcG9wb3ZlcltzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCBjb21wb25lbnQrICcgJyArIHBsYWNlbWVudFNldHRpbmcgKyAnICcgKyBzZWxmW2FuaW1hdGlvbl0pO1xuXHQgICAgICB9LFxuXHQgICAgICBzaG93UG9wb3ZlciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAhaGFzQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSAmJiAoIGFkZENsYXNzKHBvcG92ZXIsaW5DbGFzcykgKTtcblx0ICAgICAgfSxcblx0ICAgICAgdXBkYXRlUG9wb3ZlciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHN0eWxlVGlwKGVsZW1lbnQscG9wb3ZlcixwbGFjZW1lbnRTZXR0aW5nLHNlbGZbY29udGFpbmVyXSk7XG5cdCAgICAgICAgaWYgKCFpc0VsZW1lbnRJblZpZXdwb3J0KHBvcG92ZXIpICkgeyBcblx0ICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSB1cGRhdGVQbGFjZW1lbnQocGxhY2VtZW50U2V0dGluZyk7IFxuXHQgICAgICAgICAgc3R5bGVUaXAoZWxlbWVudCxwb3BvdmVyLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTsgXG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHMgLyBoYW5kbGVyc1xuXHQgICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKHBvcG92ZXIgPT09IG51bGwpIHsgc2VsZi5zaG93KCk7IH0gXG5cdCAgICAgIGVsc2UgeyBzZWxmLmhpZGUoKTsgfVxuXHQgICAgfTtcblx0ICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmIChwb3BvdmVyID09PSBudWxsKSB7XG5cdCAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gc2VsZltwbGFjZW1lbnRdOyAvLyB3ZSByZXNldCBwbGFjZW1lbnQgaW4gYWxsIGNhc2VzXG5cdCAgICAgICAgICBjcmVhdGVQb3BvdmVyKCk7XG5cdCAgICAgICAgICB1cGRhdGVQb3BvdmVyKCk7XG5cdCAgICAgICAgICBzaG93UG9wb3ZlcigpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChwb3BvdmVyLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCAyMCApO1xuXHQgICAgfTtcblx0ICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmIChwb3BvdmVyICYmIHBvcG92ZXIgIT09IG51bGwgJiYgaGFzQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSkge1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhwb3BvdmVyLGluQ2xhc3MpO1xuXHQgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQocG9wb3ZlciwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHJlbW92ZVBvcG92ZXIoKTtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgc2VsZltkZWxheV0gKTtcblx0ICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nUG9wb3ZlciBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgaWYgKHNlbGZbdHJpZ2dlcl0gPT09IGhvdmVyRXZlbnQpIHtcblx0ICAgICAgICBvbiggZWxlbWVudCwgbW91c2VIb3ZlclswXSwgc2VsZi5zaG93ICk7XG5cdCAgICAgICAgaWYgKCFzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZWxlbWVudCwgbW91c2VIb3ZlclsxXSwgc2VsZi5oaWRlICk7IH1cblx0ICAgICAgfSBlbHNlIGlmICgvXihjbGlja3xmb2N1cykkLy50ZXN0KHNlbGZbdHJpZ2dlcl0pKSB7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsIHNlbGZbdHJpZ2dlcl0sIHNlbGYudG9nZ2xlICk7XG5cdCAgICAgICAgaWYgKCFzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZWxlbWVudCwgJ2JsdXInLCBzZWxmLmhpZGUgKTsgfVxuXHQgICAgICB9XG5cdCAgICAgIFxuXHQgICAgICBpZiAoc2VsZltkaXNtaXNzaWJsZV0pIHsgb24oIGRvY3VtZW50LCBjbGlja0V2ZW50LCBkaXNtaXNzaWJsZUhhbmRsZXIgKTsgfVxuXHQgICAgXG5cdCAgICAgIC8vIGRpc21pc3Mgb24gd2luZG93IHJlc2l6ZVxuXHQgICAgICBpZiAoICEoaXNJRSAmJiBpc0lFIDwgOSkgKSB7IG9uKCBnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLmhpZGUgKTsgfVxuXHQgIFxuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdQb3BvdmVyXSA9IHNlbGY7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBQT1BPVkVSIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1BvcG92ZXIsIFBvcG92ZXIsIGRhdGFUb2dnbGUpO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IFNjcm9sbFNweVxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBTQ1JPTExTUFkgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIFNjcm9sbFNweSA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnQsIHRoZSBlbGVtZW50IHdlIHNweSBvblxuXHQgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTsgXG5cdCAgXG5cdCAgICAvLyBEQVRBIEFQSVxuXHQgICAgdmFyIHRhcmdldERhdGEgPSBxdWVyeUVsZW1lbnQoZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpKTtcblx0ICBcblx0ICAgIC8vIHNldCBvcHRpb25zXG5cdCAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0ICAgIGlmICggIW9wdGlvbnNbdGFyZ2V0XSAmJiAhdGFyZ2V0RGF0YSApIHsgcmV0dXJuOyB9IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIGV2ZW50IHRhcmdldHMsIGNvbnN0YW50c1xuXHQgICAgdmFyIHNweVRhcmdldCA9IG9wdGlvbnNbdGFyZ2V0XSAmJiBxdWVyeUVsZW1lbnQob3B0aW9uc1t0YXJnZXRdKSB8fCB0YXJnZXREYXRhLFxuXHQgICAgICAgIGxpbmtzID0gc3B5VGFyZ2V0ICYmIHNweVRhcmdldFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJ0EnKSwgXG5cdCAgICAgICAgaXRlbXMgPSBbXSwgdGFyZ2V0SXRlbXMgPSBbXSwgc2Nyb2xsT2Zmc2V0LFxuXHQgICAgICAgIHNjcm9sbFRhcmdldCA9IGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSA8IGVsZW1lbnRbc2Nyb2xsSGVpZ2h0XSA/IGVsZW1lbnQgOiBnbG9iYWxPYmplY3QsIC8vIGRldGVybWluZSB3aGljaCBpcyB0aGUgcmVhbCBzY3JvbGxUYXJnZXRcblx0ICAgICAgICBpc1dpbmRvdyA9IHNjcm9sbFRhcmdldCA9PT0gZ2xvYmFsT2JqZWN0OyAgXG5cdCAgXG5cdCAgICAvLyBwb3B1bGF0ZSBpdGVtcyBhbmQgdGFyZ2V0c1xuXHQgICAgZm9yICh2YXIgaT0wLCBpbD1saW5rc1tsZW5ndGhdOyBpPGlsOyBpKyspIHtcblx0ICAgICAgdmFyIGhyZWYgPSBsaW5rc1tpXVtnZXRBdHRyaWJ1dGVdKCdocmVmJyksIFxuXHQgICAgICAgICAgdGFyZ2V0SXRlbSA9IGhyZWYgJiYgLyNbYS16MC05XSskL2kudGVzdChocmVmKSAmJiBxdWVyeUVsZW1lbnQoaHJlZik7XG5cdCAgICAgIGlmICggISF0YXJnZXRJdGVtICkge1xuXHQgICAgICAgIGl0ZW1zLnB1c2gobGlua3NbaV0pO1xuXHQgICAgICAgIHRhcmdldEl0ZW1zLnB1c2godGFyZ2V0SXRlbSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICBcblx0ICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgdmFyIHVwZGF0ZUl0ZW0gPSBmdW5jdGlvbihpbmRleCkge1xuXHQgICAgICAgIHZhciBwYXJlbnQgPSBpdGVtc1tpbmRleF1bcGFyZW50Tm9kZV0sIC8vIGl0ZW0ncyBwYXJlbnQgTEkgZWxlbWVudFxuXHQgICAgICAgICAgdGFyZ2V0SXRlbSA9IHRhcmdldEl0ZW1zW2luZGV4XSwgLy8gdGhlIG1lbnUgaXRlbSB0YXJnZXRzIHRoaXMgZWxlbWVudFxuXHQgICAgICAgICAgZHJvcGRvd24gPSBnZXRDbG9zZXN0KHBhcmVudCwnLmRyb3Bkb3duJyksXG5cdCAgICAgICAgICB0YXJnZXRSZWN0ID0gaXNXaW5kb3cgJiYgdGFyZ2V0SXRlbVtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCksXG5cdCAgXG5cdCAgICAgICAgICBpc0FjdGl2ZSA9IGhhc0NsYXNzKHBhcmVudCxhY3RpdmUpIHx8IGZhbHNlLFxuXHQgIFxuXHQgICAgICAgICAgdG9wRWRnZSA9IGlzV2luZG93ID8gdGFyZ2V0UmVjdFt0b3BdICsgc2Nyb2xsT2Zmc2V0IDogdGFyZ2V0SXRlbVtvZmZzZXRUb3BdIC0gKHRhcmdldEl0ZW1zW2luZGV4LTFdID8gMCA6IDEwKSxcblx0ICAgICAgICAgIGJvdHRvbUVkZ2UgPSBpc1dpbmRvdyA/IHRhcmdldFJlY3RbYm90dG9tXSArIHNjcm9sbE9mZnNldCA6IHRhcmdldEl0ZW1zW2luZGV4KzFdID8gdGFyZ2V0SXRlbXNbaW5kZXgrMV1bb2Zmc2V0VG9wXSA6IGVsZW1lbnRbc2Nyb2xsSGVpZ2h0XSxcblx0ICBcblx0ICAgICAgICAgIGluc2lkZSA9IHNjcm9sbE9mZnNldCA+PSB0b3BFZGdlICYmIGJvdHRvbUVkZ2UgPiBzY3JvbGxPZmZzZXQ7XG5cdCAgXG5cdCAgICAgICAgaWYgKCAhaXNBY3RpdmUgJiYgaW5zaWRlICkge1xuXHQgICAgICAgICAgaWYgKCBwYXJlbnQudGFnTmFtZSA9PT0gJ0xJJyAmJiAhaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgKSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKHBhcmVudCxhY3RpdmUpO1xuXHQgICAgICAgICAgICBpc0FjdGl2ZSA9IHRydWU7XG5cdCAgICAgICAgICAgIGlmIChkcm9wZG93biAmJiAhaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSApIHtcblx0ICAgICAgICAgICAgICBhZGRDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgJ2FjdGl2YXRlJywgJ3Njcm9sbHNweScsIGl0ZW1zW2luZGV4XSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIGlmICggIWluc2lkZSApIHtcblx0ICAgICAgICAgIGlmICggcGFyZW50LnRhZ05hbWUgPT09ICdMSScgJiYgaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgKSB7XG5cdCAgICAgICAgICAgIHJlbW92ZUNsYXNzKHBhcmVudCxhY3RpdmUpO1xuXHQgICAgICAgICAgICBpc0FjdGl2ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgICBpZiAoZHJvcGRvd24gJiYgaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSAmJiAhZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShwYXJlbnRbcGFyZW50Tm9kZV0sYWN0aXZlKS5sZW5ndGggKSB7XG5cdCAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoZHJvcGRvd24sYWN0aXZlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSBpZiAoICFpbnNpZGUgJiYgIWlzQWN0aXZlIHx8IGlzQWN0aXZlICYmIGluc2lkZSApIHtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHVwZGF0ZUl0ZW1zID0gZnVuY3Rpb24oKXtcblx0ICAgICAgICBzY3JvbGxPZmZzZXQgPSBpc1dpbmRvdyA/IGdldFNjcm9sbCgpLnkgOiBlbGVtZW50W3Njcm9sbFRvcF07XG5cdCAgICAgICAgZm9yICh2YXIgaW5kZXg9MCwgaXRsPWl0ZW1zW2xlbmd0aF07IGluZGV4PGl0bDsgaW5kZXgrKykge1xuXHQgICAgICAgICAgdXBkYXRlSXRlbShpbmRleClcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHVwZGF0ZUl0ZW1zKCk7XG5cdCAgICB9XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nU2Nyb2xsU3B5IGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICBvbiggc2Nyb2xsVGFyZ2V0LCBzY3JvbGxFdmVudCwgdGhpcy5yZWZyZXNoICk7XG5cdCAgICAgIGlmICggIShpc0lFICYmIGlzSUUgPCA5KSkgeyBcblx0ICAgICAgICBvbiggZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgdGhpcy5yZWZyZXNoICk7IFxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICB0aGlzLnJlZnJlc2goKTtcblx0ICAgIGVsZW1lbnRbc3RyaW5nU2Nyb2xsU3B5XSA9IHRoaXM7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBTQ1JPTExTUFkgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdTY3JvbGxTcHksIFNjcm9sbFNweSwgZGF0YVNweSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgVGFiXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIFRBQiBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT1cblx0ICB2YXIgVGFiID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gREFUQSBBUElcblx0ICAgIHZhciBoZWlnaHREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFIZWlnaHQpLFxuXHQgICAgICBcblx0ICAgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ3RhYicsIGhlaWdodCA9ICdoZWlnaHQnLCBpc0FuaW1hdGluZyA9ICdpc0FuaW1hdGluZyc7XG5cdCAgXG5cdCAgICAvLyBzZXQgZGVmYXVsdCBhbmltYXRpb24gc3RhdGVcblx0ICAgIGVsZW1lbnRbaXNBbmltYXRpbmddID0gZmFsc2U7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICB0aGlzW2hlaWdodF0gPSBzdXBwb3J0VHJhbnNpdGlvbnMgPyAob3B0aW9uc1toZWlnaHRdIHx8IGhlaWdodERhdGEgPT09ICd0cnVlJykgOiBmYWxzZTsgLy8gZmlsdGVyIGxlZ2FjeSBicm93c2Vyc1xuXHQgIFxuXHQgICAgLy8gYmluZCwgZXZlbnQgdGFyZ2V0c1xuXHQgICAgdmFyIHNlbGYgPSB0aGlzLCBuZXh0LFxuXHQgICAgICB0YWJzID0gZ2V0Q2xvc2VzdChlbGVtZW50LCcubmF2JyksXG5cdCAgICAgIHRhYnNDb250ZW50Q29udGFpbmVyLFxuXHQgICAgICBkcm9wZG93biA9IHF1ZXJ5RWxlbWVudCgnLmRyb3Bkb3duJyx0YWJzKTtcblx0ICBcblx0ICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgdmFyIGdldEFjdGl2ZVRhYiA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBhY3RpdmVUYWJzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0YWJzLGFjdGl2ZSksIGFjdGl2ZVRhYjtcblx0ICAgICAgICBpZiAoIGFjdGl2ZVRhYnNbbGVuZ3RoXSA9PT0gMSAmJiAhaGFzQ2xhc3MoYWN0aXZlVGFic1swXSwnZHJvcGRvd24nKSApIHtcblx0ICAgICAgICAgIGFjdGl2ZVRhYiA9IGFjdGl2ZVRhYnNbMF07XG5cdCAgICAgICAgfSBlbHNlIGlmICggYWN0aXZlVGFic1tsZW5ndGhdID4gMSApIHtcblx0ICAgICAgICAgIGFjdGl2ZVRhYiA9IGFjdGl2ZVRhYnNbYWN0aXZlVGFic1tsZW5ndGhdLTFdO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gYWN0aXZlVGFiW2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnQScpWzBdO1xuXHQgICAgICB9LFxuXHQgICAgICBnZXRBY3RpdmVDb250ZW50ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHF1ZXJ5RWxlbWVudChnZXRBY3RpdmVUYWIoKVtnZXRBdHRyaWJ1dGVdKCdocmVmJykpO1xuXHQgICAgICB9LFxuXHQgICAgICAvLyBoYW5kbGVyIFxuXHQgICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgICAgIG5leHQgPSBlW3RhcmdldF07XG5cdCAgICAgICAgc2VsZi5zaG93KCk7XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsgLy8gdGhlIHRhYiB3ZSBjbGlja2VkIGlzIG5vdyB0aGUgbmV4dCB0YWJcblx0ICAgICAgdmFyIG5leHRDb250ZW50ID0gcXVlcnlFbGVtZW50KG5leHRbZ2V0QXR0cmlidXRlXSgnaHJlZicpKSwgLy90aGlzIGlzIHRoZSBhY3R1YWwgb2JqZWN0LCB0aGUgbmV4dCB0YWIgY29udGVudCB0byBhY3RpdmF0ZVxuXHQgICAgICAgIGFjdGl2ZVRhYiA9IGdldEFjdGl2ZVRhYigpLCBhY3RpdmVDb250ZW50ID0gZ2V0QWN0aXZlQ29udGVudCgpO1xuXHQgICAgICBcblx0ICAgICAgaWYgKCAoIWFjdGl2ZVRhYltpc0FuaW1hdGluZ10gfHwgIW5leHRbaXNBbmltYXRpbmddKSAmJiAhaGFzQ2xhc3MobmV4dFtwYXJlbnROb2RlXSxhY3RpdmUpICkge1xuXHQgICAgICAgIGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IHRydWU7XG5cdCAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlVGFiW3BhcmVudE5vZGVdLGFjdGl2ZSk7XG5cdCAgICAgICAgYWRkQ2xhc3MobmV4dFtwYXJlbnROb2RlXSxhY3RpdmUpO1xuXHQgIFxuXHQgICAgICAgIGlmICggZHJvcGRvd24gKSB7XG5cdCAgICAgICAgICBpZiAoICFoYXNDbGFzcyhlbGVtZW50W3BhcmVudE5vZGVdW3BhcmVudE5vZGVdLCdkcm9wZG93bi1tZW51JykgKSB7XG5cdCAgICAgICAgICAgIGlmIChoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpKSByZW1vdmVDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaWYgKCFoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpKSBhZGRDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBcblx0ICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIHRhYnNDb250ZW50Q29udGFpbmVyW3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGFjdGl2ZUNvbnRlbnQpICsgJ3B4JzsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuXHQgIFxuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoYWN0aXZlVGFiLCBoaWRlRXZlbnQsIGNvbXBvbmVudCwgbmV4dCk7XG5cdCAgXG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGFjdGl2ZUNvbnRlbnQsaW5DbGFzcyk7XG5cdCAgICAgICAgfSwgMCk7XG5cdCAgXG5cdCAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoYWN0aXZlQ29udGVudCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIGFkZENsYXNzKHRhYnNDb250ZW50Q29udGFpbmVyLGNvbGxhcHNpbmcpO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlQ29udGVudCxhY3RpdmUpO1xuXHQgICAgICAgICAgYWRkQ2xhc3MobmV4dENvbnRlbnQsYWN0aXZlKTtcblx0ICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKG5leHRDb250ZW50LGluQ2xhc3MpO1xuXHQgICAgICAgICAgICBpZih0YWJzQ29udGVudENvbnRhaW5lcikgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQobmV4dENvbnRlbnQpICsgJ3B4JzsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuXHQgICAgICAgICAgfSwgMCk7XG5cdCAgXG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG5leHQsIHNob3dFdmVudCwgY29tcG9uZW50LCBhY3RpdmVUYWIpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhY3RpdmVUYWIsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQsIG5leHQpO1xuXHQgIFxuXHQgICAgICAgIH0pO1xuXHQgIFxuXHQgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKG5leHRDb250ZW50LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobmV4dCwgc2hvd25FdmVudCwgY29tcG9uZW50LCBhY3RpdmVUYWIpO1xuXHQgICAgICAgICAgaWYgKHRhYnNDb250ZW50Q29udGFpbmVyKSB7IC8vIGhlaWdodCBhbmltYXRpb25cblx0ICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHQgICAgICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHRhYnNDb250ZW50Q29udGFpbmVyLCBmdW5jdGlvbigpe1xuXHQgICAgICAgICAgICAgICAgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSAgJyc7XG5cdCAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyh0YWJzQ29udGVudENvbnRhaW5lcixjb2xsYXBzaW5nKTtcblx0ICAgICAgICAgICAgICAgIGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIH0pXG5cdCAgICAgICAgICAgIH0sMCk7XG5cdCAgICAgICAgICB9IGVsc2UgeyBhY3RpdmVUYWJbaXNBbmltYXRpbmddID0gbmV4dFtpc0FuaW1hdGluZ10gPSBmYWxzZTsgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ1RhYiBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgb24oZWxlbWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTtcblx0ICAgIH1cblx0ICAgIGlmICh0aGlzW2hlaWdodF0pIHsgdGFic0NvbnRlbnRDb250YWluZXIgPSBnZXRBY3RpdmVDb250ZW50KClbcGFyZW50Tm9kZV07IH1cblx0ICAgIGVsZW1lbnRbc3RyaW5nVGFiXSA9IHRoaXM7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBUQUIgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdUYWIsIFRhYiwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgVG9vbHRpcFxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gVE9PTFRJUCBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIFRvb2x0aXAgPSBmdW5jdGlvbiggZWxlbWVudCxvcHRpb25zICkge1xuXHQgIFxuXHQgICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuXHQgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcblx0ICBcblx0ICAgIC8vIERBVEEgQVBJXG5cdCAgICB2YXIgYW5pbWF0aW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQW5pbWF0aW9uKTtcblx0ICAgICAgICBwbGFjZW1lbnREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFQbGFjZW1lbnQpO1xuXHQgICAgICAgIGRlbGF5RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhRGVsYXkpLFxuXHQgICAgICAgIGNvbnRhaW5lckRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUNvbnRhaW5lciksXG5cdCAgICAgICAgXG5cdCAgICAgICAgLy8gc3RyaW5nc1xuXHQgICAgICAgIGNvbXBvbmVudCA9ICd0b29sdGlwJyxcblx0ICAgICAgICBjbGFzc1N0cmluZyA9ICdjbGFzcycsXG5cdCAgICAgICAgdGl0bGUgPSAndGl0bGUnLFxuXHQgICAgICAgIGZhZGUgPSAnZmFkZScsXG5cdCAgICAgICAgZGl2ID0gJ2Rpdic7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICB0aGlzW2FuaW1hdGlvbl0gPSBvcHRpb25zW2FuaW1hdGlvbl0gJiYgb3B0aW9uc1thbmltYXRpb25dICE9PSBmYWRlID8gb3B0aW9uc1thbmltYXRpb25dIDogYW5pbWF0aW9uRGF0YSB8fCBmYWRlO1xuXHQgICAgdGhpc1twbGFjZW1lbnRdID0gb3B0aW9uc1twbGFjZW1lbnRdID8gb3B0aW9uc1twbGFjZW1lbnRdIDogcGxhY2VtZW50RGF0YSB8fCB0b3A7XG5cdCAgICB0aGlzW2RlbGF5XSA9IHBhcnNlSW50KG9wdGlvbnNbZGVsYXldIHx8IGRlbGF5RGF0YSkgfHwgMjAwO1xuXHQgICAgdGhpc1tjb250YWluZXJdID0gcXVlcnlFbGVtZW50KG9wdGlvbnNbY29udGFpbmVyXSkgfHwgcXVlcnlFbGVtZW50KGNvbnRhaW5lckRhdGEpIHx8IGJvZHk7XG5cdCAgXG5cdCAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzLCB0aXRsZSBhbmQgY29uc3RhbnRzXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIHRpbWVyID0gMCwgcGxhY2VtZW50U2V0dGluZyA9IHRoaXNbcGxhY2VtZW50XSwgdG9vbHRpcCA9IG51bGwsXG5cdCAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKHRpdGxlKSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGl0bGUpO1xuXHQgIFxuXHQgICAgaWYgKCAhdGl0bGVTdHJpbmcgKSByZXR1cm47IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgdmFyIHJlbW92ZVRvb2xUaXAgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZWxmW2NvbnRhaW5lcl0ucmVtb3ZlQ2hpbGQodG9vbHRpcCk7XG5cdCAgICAgICAgdG9vbHRpcCA9IG51bGw7IHRpbWVyID0gbnVsbDtcblx0ICAgICAgfSxcblx0ICAgICAgY3JlYXRlVG9vbFRpcCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKHRpdGxlKSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGl0bGUpOyAvLyByZWFkIHRoZSB0aXRsZSBhZ2FpblxuXHQgICAgICAgIHRvb2x0aXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG5cdCAgICAgICAgdG9vbHRpcFtzZXRBdHRyaWJ1dGVdKCdyb2xlJyxjb21wb25lbnQpO1xuXHQgIFxuXHQgICAgICAgIHZhciB0b29sdGlwQXJyb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdiksIHRvb2x0aXBJbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcblx0ICAgICAgICB0b29sdGlwQXJyb3dbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywgY29tcG9uZW50KyctYXJyb3cnKTsgdG9vbHRpcElubmVyW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsY29tcG9uZW50KyctaW5uZXInKTtcblx0ICBcblx0ICAgICAgICB0b29sdGlwLmFwcGVuZENoaWxkKHRvb2x0aXBBcnJvdyk7IHRvb2x0aXAuYXBwZW5kQ2hpbGQodG9vbHRpcElubmVyKTtcblx0ICBcblx0ICAgICAgICB0b29sdGlwSW5uZXIuaW5uZXJIVE1MID0gdGl0bGVTdHJpbmc7XG5cdCAgXG5cdCAgICAgICAgc2VsZltjb250YWluZXJdLmFwcGVuZENoaWxkKHRvb2x0aXApO1xuXHQgICAgICAgIHRvb2x0aXBbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywgY29tcG9uZW50ICsgJyAnICsgcGxhY2VtZW50U2V0dGluZyArICcgJyArIHNlbGZbYW5pbWF0aW9uXSk7XG5cdCAgICAgIH0sXG5cdCAgICAgIHVwZGF0ZVRvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgc3R5bGVUaXAoZWxlbWVudCx0b29sdGlwLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTtcblx0ICAgICAgICBpZiAoIWlzRWxlbWVudEluVmlld3BvcnQodG9vbHRpcCkgKSB7IFxuXHQgICAgICAgICAgcGxhY2VtZW50U2V0dGluZyA9IHVwZGF0ZVBsYWNlbWVudChwbGFjZW1lbnRTZXR0aW5nKTsgXG5cdCAgICAgICAgICBzdHlsZVRpcChlbGVtZW50LHRvb2x0aXAscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pOyBcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHNob3dUb29sdGlwID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICFoYXNDbGFzcyh0b29sdGlwLGluQ2xhc3MpICYmICggYWRkQ2xhc3ModG9vbHRpcCxpbkNsYXNzKSApO1xuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICh0b29sdGlwID09PSBudWxsKSB7XG5cdCAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gc2VsZltwbGFjZW1lbnRdOyAvLyB3ZSByZXNldCBwbGFjZW1lbnQgaW4gYWxsIGNhc2VzXG5cdCAgICAgICAgICBjcmVhdGVUb29sVGlwKCk7XG5cdCAgICAgICAgICB1cGRhdGVUb29sdGlwKCk7XG5cdCAgICAgICAgICBzaG93VG9vbHRpcCgpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZCh0b29sdGlwLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCAyMCApO1xuXHQgICAgfTtcblx0ICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICh0b29sdGlwICYmIHRvb2x0aXAgIT09IG51bGwgJiYgaGFzQ2xhc3ModG9vbHRpcCxpbkNsYXNzKSkge1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyh0b29sdGlwLGluQ2xhc3MpO1xuXHQgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQodG9vbHRpcCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHJlbW92ZVRvb2xUaXAoKTtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgc2VsZltkZWxheV0pO1xuXHQgICAgfTtcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmICghdG9vbHRpcCkgeyBzZWxmLnNob3coKTsgfSBcblx0ICAgICAgZWxzZSB7IHNlbGYuaGlkZSgpOyB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ1Rvb2x0aXAgaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIGVsZW1lbnRbc2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUaXRsZSx0aXRsZVN0cmluZyk7XG5cdCAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHRpdGxlKTtcblx0ICAgICAgb24oZWxlbWVudCwgbW91c2VIb3ZlclswXSwgdGhpcy5zaG93KTtcblx0ICAgICAgb24oZWxlbWVudCwgbW91c2VIb3ZlclsxXSwgdGhpcy5oaWRlKTtcblx0ICAgIH1cblx0ICAgIGVsZW1lbnRbc3RyaW5nVG9vbHRpcF0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gVE9PTFRJUCBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PT09PT09XG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nVG9vbHRpcCwgVG9vbHRpcCwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgcmV0dXJuIHtcblx0ICAgIEFmZml4OiBBZmZpeCxcblx0ICAgIEFsZXJ0OiBBbGVydCxcblx0ICAgIEJ1dHRvbjogQnV0dG9uLFxuXHQgICAgQ2Fyb3VzZWw6IENhcm91c2VsLFxuXHQgICAgQ29sbGFwc2U6IENvbGxhcHNlLFxuXHQgICAgRHJvcGRvd246IERyb3Bkb3duLFxuXHQgICAgTW9kYWw6IE1vZGFsLFxuXHQgICAgUG9wb3ZlcjogUG9wb3Zlcixcblx0ICAgIFNjcm9sbFNweTogU2Nyb2xsU3B5LFxuXHQgICAgVGFiOiBUYWIsXG5cdCAgICBUb29sdGlwOiBUb29sdGlwXG5cdCAgfTtcblx0fSkpO1xuXHRcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKVxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbXktY29tLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgMDNjNGJhNWMyMzQ5ZmU2MWY2M2UiLCIvKlxuZnVuY3Rpb24gY2hlY2tWYWx1ZXMgKGVsbU5hbWUpIHtcbiAgICBhbGVydChlbG1OYW1lKTtcbn1cblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3NlYXJjaFBlcnNvbiBpbnB1dCcpLmZvckVhY2goKGN1cikgPT4ge1xuICAgIGN1ci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGNoZWNrVmFsdWVzKCcjc2VhcmNoUGVyc29uJykpO1xufSk7Ki9cbmltcG9ydCBic24gZnJvbSAnYm9vdHN0cmFwLm5hdGl2ZSc7XG5cbmlmKGRvY3VtZW50LmJvZHkuaWQgPT0gJ2ZpbmRQZXJzb25Cb2R5Jykge1xuICAgIGxldCBibG5SZW1vdmVTdW1iaXQgPSB0cnVlO1xuICAgIGNvbnN0IGVsbUlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzZWFyY2hQZXJzb24gaW5wdXQnKTtcbiAgICBjb25zdCBidG5TdW1iaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ZpbmRQZXJzb25cIik7XG4gICAgY29uc3QgYnRuRmluZFBlcnNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWFyY2hQaG9uZScpO1xuXG4gICAgZWxtSW5wdXRzLmZvckVhY2goKGN1cjIpID0+IHtcbiAgICAgICAgaWYoKGN1cjIudmFsdWUudHJpbSgpLmxlbmd0aCA9PSAwKSAmJiAoKGN1cjIubmFtZSA9PSAnbGFzdC1uYW1lJykgfHwgKGN1cjIubmFtZSA9PSAnZmlyc3QtbmFtZScpKSkge1xuICAgICAgICAgICAgYmxuUmVtb3ZlU3VtYml0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGJsblJlbW92ZVN1bWJpdCA9PT0gZmFsc2UgPyBidG5TdW1iaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsJ2Rpc2FibGVkJykgOiBudWxsO1xuXG4gICAgZWxtSW5wdXRzLmZvckVhY2goKGN1cikgPT4ge1xuICAgICAgICBjdXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgYmxuU3VtYml0ID0gdHJ1ZTtcblxuICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goKGN1clBsYWNlZCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmKChjdXJQbGFjZWQudmFsdWUudHJpbSgpLmxlbmd0aCA9PSAwKSAmJiAoKGN1clBsYWNlZC5uYW1lID09ICdsYXN0LW5hbWUnKSB8fCAoY3VyUGxhY2VkLm5hbWUgPT0gJ2ZpcnN0LW5hbWUnKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoKGVsbUlucHV0c1swXS52YWx1ZS50cmltKCkubGVuZ3RoIDwgOCkgfHwgKGVsbUlucHV0c1swXS5uYW1lICE9ICdwaG9uZS1udW1iZXInKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxuU3VtYml0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJQbGFjZWQuY2xhc3NMaXN0LmFkZCgnbXlFcnJvcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnRuRmluZFBlcnNvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsblN1bWJpdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJQbGFjZWQuY2xhc3NMaXN0LnJlbW92ZSgnbXlFcnJvcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnRuRmluZFBlcnNvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjdXJQbGFjZWQuY2xhc3NMaXN0LnJlbW92ZSgnbXlFcnJvcicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBibG5TdW1iaXQgPT09IHRydWUgPyBidG5TdW1iaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpIDogYnRuU3VtYml0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCdkaXNhYmxlZCcpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGJ0bkZpbmRQZXJzb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FjdGlvbicpLnZhbHVlID0gXCJzZWFyY2hCeVBob25lXCI7XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYnRuQ2xlYXInKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICBlbG1JbnB1dHMuZm9yRWFjaCgoY3VyKSA9PiB7XG4gICAgICAgICAgICBjdXIudmFsdWUgPSAnJztcbiAgICAgICAgfSk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9qcy9sYXlvdXQuanMiLCIvLyBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgdjIuMC40IHwgwqkgZG5wX3RoZW1lIHwgTUlULUxpY2Vuc2VcbihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgLy8gQU1EIHN1cHBvcnQ6XG4gICAgZGVmaW5lKFtdLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIC8vIENvbW1vbkpTLWxpa2U6XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG4gIH0gZWxzZSB7XG4gICAgLy8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdylcbiAgICB2YXIgYnNuID0gZmFjdG9yeSgpO1xuICAgIHJvb3QuQWZmaXggPSBic24uQWZmaXg7XG4gICAgcm9vdC5BbGVydCA9IGJzbi5BbGVydDtcbiAgICByb290LkJ1dHRvbiA9IGJzbi5CdXR0b247XG4gICAgcm9vdC5DYXJvdXNlbCA9IGJzbi5DYXJvdXNlbDtcbiAgICByb290LkNvbGxhcHNlID0gYnNuLkNvbGxhcHNlO1xuICAgIHJvb3QuRHJvcGRvd24gPSBic24uRHJvcGRvd247XG4gICAgcm9vdC5Nb2RhbCA9IGJzbi5Nb2RhbDtcbiAgICByb290LlBvcG92ZXIgPSBic24uUG9wb3ZlcjtcbiAgICByb290LlNjcm9sbFNweSA9IGJzbi5TY3JvbGxTcHk7XG4gICAgcm9vdC5UYWIgPSBic24uVGFiO1xuICAgIHJvb3QuVG9vbHRpcCA9IGJzbi5Ub29sdGlwO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uICgpIHtcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEludGVybmFsIFV0aWxpdHkgRnVuY3Rpb25zXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gZ2xvYmFsc1xuICB2YXIgZ2xvYmFsT2JqZWN0ID0gdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0aGlzfHx3aW5kb3csXG4gICAgZG9jID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBib2R5ID0gZG9jdW1lbnQuYm9keSxcbiAgXG4gICAgLy8gSUUgYnJvd3NlciBkZXRlY3RcbiAgICBpc0lFID0gKG5ldyBSZWdFeHAoXCJNU0lFIChbMC05XXsxLH1bXFwuMC05XXswLH0pXCIpLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudCkgIT0gbnVsbCkgPyBwYXJzZUZsb2F0KCBSZWdFeHAuJDEgKSA6IGZhbHNlLCAgXG4gIFxuICAgIC8vIGZ1bmN0aW9uIHRvZ2dsZSBhdHRyaWJ1dGVzXG4gICAgZGF0YVRvZ2dsZSAgICA9ICdkYXRhLXRvZ2dsZScsXG4gICAgZGF0YURpc21pc3MgICA9ICdkYXRhLWRpc21pc3MnLFxuICAgIGRhdGFTcHkgICAgICAgPSAnZGF0YS1zcHknLFxuICAgIGRhdGFSaWRlICAgICAgPSAnZGF0YS1yaWRlJyxcbiAgICBcbiAgICAvLyBjb21wb25lbnRzXG4gICAgc3RyaW5nQWZmaXggICAgID0gJ0FmZml4JyxcbiAgICBzdHJpbmdBbGVydCAgICAgPSAnQWxlcnQnLFxuICAgIHN0cmluZ0J1dHRvbiAgICA9ICdCdXR0b24nLFxuICAgIHN0cmluZ0Nhcm91c2VsICA9ICdDYXJvdXNlbCcsXG4gICAgc3RyaW5nQ29sbGFwc2UgID0gJ0NvbGxhcHNlJyxcbiAgICBzdHJpbmdEcm9wZG93biAgPSAnRHJvcGRvd24nLFxuICAgIHN0cmluZ01vZGFsICAgICA9ICdNb2RhbCcsXG4gICAgc3RyaW5nUG9wb3ZlciAgID0gJ1BvcG92ZXInLFxuICAgIHN0cmluZ1Njcm9sbFNweSA9ICdTY3JvbGxTcHknLFxuICAgIHN0cmluZ1RhYiAgICAgICA9ICdUYWInLFxuICAgIHN0cmluZ1Rvb2x0aXAgICA9ICdUb29sdGlwJyxcbiAgXG4gICAgLy8gb3B0aW9ucyBEQVRBIEFQSVxuICAgIGRhdGFiYWNrZHJvcCAgICAgID0gJ2RhdGEtYmFja2Ryb3AnLFxuICAgIGRhdGFLZXlib2FyZCAgICAgID0gJ2RhdGEta2V5Ym9hcmQnLFxuICAgIGRhdGFUYXJnZXQgICAgICAgID0gJ2RhdGEtdGFyZ2V0JyxcbiAgICBkYXRhSW50ZXJ2YWwgICAgICA9ICdkYXRhLWludGVydmFsJyxcbiAgICBkYXRhSGVpZ2h0ICAgICAgICA9ICdkYXRhLWhlaWdodCcsXG4gICAgZGF0YVBhdXNlICAgICAgICAgPSAnZGF0YS1wYXVzZScsXG4gICAgZGF0YU9yaWdpbmFsVGl0bGUgPSAnZGF0YS1vcmlnaW5hbC10aXRsZScsXG4gICAgZGF0YU9yaWdpbmFsVGV4dCAgPSAnZGF0YS1vcmlnaW5hbC10ZXh0JyxcbiAgICBkYXRhRGlzbWlzc2libGUgICA9ICdkYXRhLWRpc21pc3NpYmxlJyxcbiAgICBkYXRhVHJpZ2dlciAgICAgICA9ICdkYXRhLXRyaWdnZXInLFxuICAgIGRhdGFBbmltYXRpb24gICAgID0gJ2RhdGEtYW5pbWF0aW9uJyxcbiAgICBkYXRhQ29udGFpbmVyICAgICA9ICdkYXRhLWNvbnRhaW5lcicsXG4gICAgZGF0YVBsYWNlbWVudCAgICAgPSAnZGF0YS1wbGFjZW1lbnQnLFxuICAgIGRhdGFEZWxheSAgICAgICAgID0gJ2RhdGEtZGVsYXknLFxuICAgIGRhdGFPZmZzZXRUb3AgICAgID0gJ2RhdGEtb2Zmc2V0LXRvcCcsXG4gICAgZGF0YU9mZnNldEJvdHRvbSAgPSAnZGF0YS1vZmZzZXQtYm90dG9tJyxcbiAgXG4gICAgLy8gb3B0aW9uIGtleXNcbiAgICBiYWNrZHJvcCA9ICdiYWNrZHJvcCcsIGtleWJvYXJkID0gJ2tleWJvYXJkJywgZGVsYXkgPSAnZGVsYXknLFxuICAgIGR1cmF0aW9uID0gJ2R1cmF0aW9uJywgY29udGVudCA9ICdjb250ZW50JywgdGFyZ2V0ID0gJ3RhcmdldCcsIFxuICAgIGludGVydmFsID0gJ2ludGVydmFsJywgcGF1c2UgPSAncGF1c2UnLCBhbmltYXRpb24gPSAnYW5pbWF0aW9uJyxcbiAgICBwbGFjZW1lbnQgPSAncGxhY2VtZW50JywgY29udGFpbmVyID0gJ2NvbnRhaW5lcicsIFxuICBcbiAgICAvLyBib3ggbW9kZWxcbiAgICBvZmZzZXRUb3AgICAgPSAnb2Zmc2V0VG9wJywgICAgICBvZmZzZXRCb3R0b20gICA9ICdvZmZzZXRCb3R0b20nLFxuICAgIG9mZnNldExlZnQgICA9ICdvZmZzZXRMZWZ0JyxcbiAgICBzY3JvbGxUb3AgICAgPSAnc2Nyb2xsVG9wJywgICAgICBzY3JvbGxMZWZ0ICAgICA9ICdzY3JvbGxMZWZ0JyxcbiAgICBjbGllbnRXaWR0aCAgPSAnY2xpZW50V2lkdGgnLCAgICBjbGllbnRIZWlnaHQgICA9ICdjbGllbnRIZWlnaHQnLFxuICAgIG9mZnNldFdpZHRoICA9ICdvZmZzZXRXaWR0aCcsICAgIG9mZnNldEhlaWdodCAgID0gJ29mZnNldEhlaWdodCcsXG4gICAgaW5uZXJXaWR0aCAgID0gJ2lubmVyV2lkdGgnLCAgICAgaW5uZXJIZWlnaHQgICAgPSAnaW5uZXJIZWlnaHQnLFxuICAgIHNjcm9sbEhlaWdodCA9ICdzY3JvbGxIZWlnaHQnLCAgIGhlaWdodCAgICAgICAgID0gJ2hlaWdodCcsXG4gIFxuICAgIC8vIGFyaWFcbiAgICBhcmlhRXhwYW5kZWQgPSAnYXJpYS1leHBhbmRlZCcsXG4gICAgYXJpYUhpZGRlbiAgID0gJ2FyaWEtaGlkZGVuJyxcbiAgXG4gICAgLy8gZXZlbnQgbmFtZXNcbiAgICBjbGlja0V2ZW50ICAgID0gJ2NsaWNrJyxcbiAgICBob3ZlckV2ZW50ICAgID0gJ2hvdmVyJyxcbiAgICBrZXlkb3duRXZlbnQgID0gJ2tleWRvd24nLFxuICAgIHJlc2l6ZUV2ZW50ICAgPSAncmVzaXplJyxcbiAgICBzY3JvbGxFdmVudCAgID0gJ3Njcm9sbCcsXG4gICAgLy8gb3JpZ2luYWxFdmVudHNcbiAgICBzaG93RXZlbnQgICAgID0gJ3Nob3cnLFxuICAgIHNob3duRXZlbnQgICAgPSAnc2hvd24nLFxuICAgIGhpZGVFdmVudCAgICAgPSAnaGlkZScsXG4gICAgaGlkZGVuRXZlbnQgICA9ICdoaWRkZW4nLFxuICAgIGNsb3NlRXZlbnQgICAgPSAnY2xvc2UnLFxuICAgIGNsb3NlZEV2ZW50ICAgPSAnY2xvc2VkJyxcbiAgICBzbGlkRXZlbnQgICAgID0gJ3NsaWQnLFxuICAgIHNsaWRlRXZlbnQgICAgPSAnc2xpZGUnLFxuICAgIGNoYW5nZUV2ZW50ICAgPSAnY2hhbmdlJyxcbiAgXG4gICAgLy8gb3RoZXJcbiAgICBnZXRBdHRyaWJ1dGUgICAgICAgICA9ICdnZXRBdHRyaWJ1dGUnLFxuICAgIHNldEF0dHJpYnV0ZSAgICAgICAgID0gJ3NldEF0dHJpYnV0ZScsXG4gICAgaGFzQXR0cmlidXRlICAgICAgICAgPSAnaGFzQXR0cmlidXRlJyxcbiAgICBnZXRFbGVtZW50c0J5VGFnTmFtZSA9ICdnZXRFbGVtZW50c0J5VGFnTmFtZScsXG4gICAgZ2V0Qm91bmRpbmdDbGllbnRSZWN0PSAnZ2V0Qm91bmRpbmdDbGllbnRSZWN0JyxcbiAgICBxdWVyeVNlbGVjdG9yQWxsICAgICA9ICdxdWVyeVNlbGVjdG9yQWxsJyxcbiAgICBnZXRFbGVtZW50c0J5Q0xBU1NOQU1FID0gJ2dldEVsZW1lbnRzQnlDbGFzc05hbWUnLFxuICBcbiAgICBpbmRleE9mICAgICAgPSAnaW5kZXhPZicsXG4gICAgcGFyZW50Tm9kZSAgID0gJ3BhcmVudE5vZGUnLFxuICAgIGxlbmd0aCAgICAgICA9ICdsZW5ndGgnLFxuICAgIHRvTG93ZXJDYXNlICA9ICd0b0xvd2VyQ2FzZScsXG4gICAgVHJhbnNpdGlvbiAgID0gJ1RyYW5zaXRpb24nLFxuICAgIFdlYmtpdCAgICAgICA9ICdXZWJraXQnLFxuICAgIHN0eWxlICAgICAgICA9ICdzdHlsZScsXG4gICAgXG4gICAgYWN0aXZlICAgICA9ICdhY3RpdmUnLFxuICAgIGluQ2xhc3MgICAgPSAnaW4nLFxuICAgIGNvbGxhcHNpbmcgPSAnY29sbGFwc2luZycsXG4gICAgZGlzYWJsZWQgICA9ICdkaXNhYmxlZCcsXG4gICAgbG9hZGluZyAgICA9ICdsb2FkaW5nJyxcbiAgICBsZWZ0ICAgICAgID0gJ2xlZnQnLFxuICAgIHJpZ2h0ICAgICAgPSAncmlnaHQnLFxuICAgIHRvcCAgICAgICAgPSAndG9wJyxcbiAgICBib3R0b20gICAgID0gJ2JvdHRvbScsXG4gIFxuICAgIC8vIHRvb2x0aXAgLyBwb3BvdmVyXG4gICAgbW91c2VIb3ZlciA9ICgnb25tb3VzZWxlYXZlJyBpbiBkb2N1bWVudCkgPyBbICdtb3VzZWVudGVyJywgJ21vdXNlbGVhdmUnXSA6IFsgJ21vdXNlb3ZlcicsICdtb3VzZW91dCcgXSxcbiAgICB0aXBQb3NpdGlvbnMgPSAvXFxiKHRvcHxib3R0b218bGVmdHx0b3ApKy8sXG4gIFxuICAgIC8vIHRyYW5zaXRpb25FbmQgc2luY2UgMi4wLjRcbiAgICBzdXBwb3J0VHJhbnNpdGlvbnMgPSBXZWJraXQrVHJhbnNpdGlvbiBpbiBkb2Nbc3R5bGVdIHx8IFRyYW5zaXRpb25bdG9Mb3dlckNhc2VdKCkgaW4gZG9jW3N0eWxlXSxcbiAgICB0cmFuc2l0aW9uRW5kRXZlbnQgPSBXZWJraXQrVHJhbnNpdGlvbiBpbiBkb2Nbc3R5bGVdID8gV2Via2l0W3RvTG93ZXJDYXNlXSgpK1RyYW5zaXRpb24rJ0VuZCcgOiBUcmFuc2l0aW9uW3RvTG93ZXJDYXNlXSgpKydlbmQnLFxuICAgIFxuICBcbiAgICAvLyBzZXQgbmV3IGZvY3VzIGVsZW1lbnQgc2luY2UgMi4wLjNcbiAgICBzZXRGb2N1cyA9IGZ1bmN0aW9uKGVsZW1lbnQpe1xuICAgICAgZWxlbWVudC5mb2N1cyA/IGVsZW1lbnQuZm9jdXMoKSA6IGVsZW1lbnQuc2V0QWN0aXZlKCk7XG4gICAgfSxcbiAgXG4gICAgLy8gY2xhc3MgbWFuaXB1bGF0aW9uLCBzaW5jZSAyLjAuMCByZXF1aXJlcyBwb2x5ZmlsbC5qc1xuICAgIGFkZENsYXNzID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc05BTUUpO1xuICAgIH0sXG4gICAgcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LGNsYXNzTkFNRSkge1xuICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTkFNRSk7XG4gICAgfSxcbiAgICBoYXNDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKXsgLy8gc2luY2UgMi4wLjBcbiAgICAgIHJldHVybiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05BTUUpO1xuICAgIH0sXG4gIFxuICAgIC8vIHNlbGVjdGlvbiBtZXRob2RzXG4gICAgbm9kZUxpc3RUb0FycmF5ID0gZnVuY3Rpb24obm9kZUxpc3Qpe1xuICAgICAgdmFyIGNoaWxkSXRlbXMgPSBbXTsgZm9yICh2YXIgaSA9IDAsIG5sbCA9IG5vZGVMaXN0W2xlbmd0aF07IGk8bmxsOyBpKyspIHsgY2hpbGRJdGVtcy5wdXNoKCBub2RlTGlzdFtpXSApIH1cbiAgICAgIHJldHVybiBjaGlsZEl0ZW1zO1xuICAgIH0sXG4gICAgZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKSB7IC8vIGdldEVsZW1lbnRzQnlDbGFzc05hbWUgSUU4K1xuICAgICAgdmFyIHNlbGVjdGlvbk1ldGhvZCA9IGlzSUUgPT09IDggPyBxdWVyeVNlbGVjdG9yQWxsIDogZ2V0RWxlbWVudHNCeUNMQVNTTkFNRTsgICAgICBcbiAgICAgIHJldHVybiBub2RlTGlzdFRvQXJyYXkoZWxlbWVudFtzZWxlY3Rpb25NZXRob2RdKCBpc0lFID09PSA4ID8gJy4nICsgY2xhc3NOQU1FLnJlcGxhY2UoL1xccyg/PVthLXpdKS9nLCcuJykgOiBjbGFzc05BTUUgKSk7XG4gICAgfSxcbiAgICBxdWVyeUVsZW1lbnQgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIHBhcmVudCkge1xuICAgICAgdmFyIGxvb2tVcCA9IHBhcmVudCA/IHBhcmVudCA6IGRvY3VtZW50O1xuICAgICAgcmV0dXJuIHR5cGVvZiBzZWxlY3RvciA9PT0gJ29iamVjdCcgPyBzZWxlY3RvciA6IGxvb2tVcC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgICB9LFxuICAgIGdldENsb3Nlc3QgPSBmdW5jdGlvbiAoZWxlbWVudCwgc2VsZWN0b3IpIHsgLy9lbGVtZW50IGlzIHRoZSBlbGVtZW50IGFuZCBzZWxlY3RvciBpcyBmb3IgdGhlIGNsb3Nlc3QgcGFyZW50IGVsZW1lbnQgdG8gZmluZFxuICAgIC8vIHNvdXJjZSBodHRwOi8vZ29tYWtldGhpbmdzLmNvbS9jbGltYmluZy11cC1hbmQtZG93bi10aGUtZG9tLXRyZWUtd2l0aC12YW5pbGxhLWphdmFzY3JpcHQvXG4gICAgICB2YXIgZmlyc3RDaGFyID0gc2VsZWN0b3IuY2hhckF0KDApO1xuICAgICAgZm9yICggOyBlbGVtZW50ICYmIGVsZW1lbnQgIT09IGRvY3VtZW50OyBlbGVtZW50ID0gZWxlbWVudFtwYXJlbnROb2RlXSApIHsvLyBHZXQgY2xvc2VzdCBtYXRjaFxuICAgICAgICBpZiAoIGZpcnN0Q2hhciA9PT0gJy4nIHx8IGZpcnN0Q2hhciAhPT0gJyMnKSB7Ly8gSWYgc2VsZWN0b3IgaXMgYSBjbGFzc1xuICAgICAgICAgIGlmICggcXVlcnlFbGVtZW50KHNlbGVjdG9yLGVsZW1lbnRbcGFyZW50Tm9kZV0pICE9PSBudWxsICkgeyByZXR1cm4gZWxlbWVudDsgfVxuICAgICAgICB9XG4gICAgICAgIGlmICggZmlyc3RDaGFyID09PSAnIycgKSB7IC8vIElmIHNlbGVjdG9yIGlzIGFuIElEXG4gICAgICAgICAgaWYgKCBlbGVtZW50LmlkID09PSBzZWxlY3Rvci5zdWJzdHIoMSkgKSB7IHJldHVybiBlbGVtZW50OyB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuICBcbiAgICAvLyBldmVudCBhdHRhY2ggalF1ZXJ5IHN0eWxlIC8gdHJpZ2dlciAgc2luY2UgMS4yLjBcbiAgICBvbiA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudCwgaGFuZGxlcikge1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgfSxcbiAgICBvZmYgPSBmdW5jdGlvbihlbGVtZW50LCBldmVudCwgaGFuZGxlcikge1xuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7XG4gICAgfSxcbiAgICBvbmUgPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHsgLy8gb25lIHNpbmNlIDIuMC40XG4gICAgICBvbihlbGVtZW50LCBldmVudCwgZnVuY3Rpb24gaGFuZGxlcldyYXBwZXIoKXtcbiAgICAgICAgaGFuZGxlcigpO1xuICAgICAgICBvZmYoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXJXcmFwcGVyKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZW11bGF0ZVRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbihlbGVtZW50LGhhbmRsZXIpeyAvLyBlbXVsYXRlVHJhbnNpdGlvbkVuZCBzaW5jZSAyLjAuNFxuICAgICAgaWYgKHN1cHBvcnRUcmFuc2l0aW9ucykgeyBvbmUoZWxlbWVudCx0cmFuc2l0aW9uRW5kRXZlbnQsIGhhbmRsZXIpOyB9XG4gICAgICBlbHNlIHsgaGFuZGxlcigpOyB9XG4gICAgfSwgIFxuICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgY29tcG9uZW50TmFtZSwgcmVsYXRlZCkge1xuICAgICAgdmFyIE9yaWdpbmFsQ3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoIGV2ZW50TmFtZSArICcuYnMuJyArIGNvbXBvbmVudE5hbWUpO1xuICAgICAgT3JpZ2luYWxDdXN0b21FdmVudC5yZWxhdGVkVGFyZ2V0ID0gcmVsYXRlZDtcbiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChPcmlnaW5hbEN1c3RvbUV2ZW50KTtcbiAgICB9LFxuICBcbiAgICAvLyByZWZlcmVuY2UgYSBsaXZlIGNvbGxlY3Rpb24gb2YgdGhlIERPTVxuICAgIEFsbERPTUVsZW1lbnRzID0gZG9jdW1lbnRbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKCcqJyksXG4gIFxuICAgIC8vIEluaXQgREFUQSBBUElcbiAgICBpbml0aWFsaXplRGF0YUFQSSA9IGZ1bmN0aW9uKCBjb21wb25lbnQsIGNvbnN0cnVjdG9yLCBkYXRhQXR0cmlidXRlLCBjb2xsZWN0aW9uICl7XG4gICAgICB2YXIgbG9va1VwID0gY29sbGVjdGlvbiAmJiBjb2xsZWN0aW9uW2xlbmd0aF0gPyBjb2xsZWN0aW9uIDogQWxsRE9NRWxlbWVudHM7XG4gICAgICBmb3IgKHZhciBpPTA7IGkgPCBsb29rVXBbbGVuZ3RoXTsgaSsrKSB7XG4gICAgICAgIHZhciBhdHRyVmFsdWUgPSBsb29rVXBbaV1bZ2V0QXR0cmlidXRlXShkYXRhQXR0cmlidXRlKSwgZXhwZWN0ZWRBdHRyVmFsdWUgPSBjb21wb25lbnQucmVwbGFjZSgvc3B5L2ksJycpW3RvTG93ZXJDYXNlXSgpO1xuICAgICAgICBpZiAoIGF0dHJWYWx1ZSAmJiBjb21wb25lbnQgPT09IHN0cmluZ0J1dHRvbiAmJiAoIGF0dHJWYWx1ZVtpbmRleE9mXShleHBlY3RlZEF0dHJWYWx1ZSkgPiAtMSApIC8vIGRhdGEtdG9nZ2xlPVwiYnV0dG9uc1wiXG4gICAgICAgICAgICB8fCBhdHRyVmFsdWUgPT09IGV4cGVjdGVkQXR0clZhbHVlICkgeyAvLyBhbGwgb3RoZXIgY29tcG9uZW50c1xuICAgICAgICAgIG5ldyBjb25zdHJ1Y3Rvcihsb29rVXBbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgIFxuICBcbiAgICAvLyB0YWIgLyBjb2xsYXBzZSBzdHVmZlxuICAgIGdldE91dGVySGVpZ2h0ID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICB2YXIgY2hpbGRTdHlsZSA9IGNoaWxkICYmIChjaGlsZC5jdXJyZW50U3R5bGUgfHwgZ2xvYmFsT2JqZWN0LmdldENvbXB1dGVkU3R5bGUoY2hpbGQpKSwgXG4gICAgICAgIGJ0cCA9IC9weC8udGVzdChjaGlsZFN0eWxlLmJvcmRlclRvcFdpZHRoKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5ib3JkZXJUb3BXaWR0aC5yZXBsYWNlKCdweCcsJycpKSA6IDAsXG4gICAgICAgIGJ0YiA9IC9weC8udGVzdChjaGlsZFN0eWxlLmJvcmRlckJvdHRvbVdpZHRoKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5ib3JkZXJCb3R0b21XaWR0aC5yZXBsYWNlKCdweCcsJycpKSA6IDAsXG4gICAgICAgIG10cCA9IC9weC8udGVzdChjaGlsZFN0eWxlLm1hcmdpblRvcCkgPyBNYXRoLnJvdW5kKGNoaWxkU3R5bGUubWFyZ2luVG9wLnJlcGxhY2UoJ3B4JywnJykpIDogMCxcbiAgICAgICAgbWJwID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUubWFyZ2luQm90dG9tKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5tYXJnaW5Cb3R0b20ucmVwbGFjZSgncHgnLCcnKSkgOiAwO1xuICAgICAgcmV0dXJuIGNoaWxkW2NsaWVudEhlaWdodF0gKyBwYXJzZUludCggYnRwICkgKyBwYXJzZUludCggYnRiICkgKyBwYXJzZUludCggbXRwICkgKyBwYXJzZUludCggbWJwICk7XG4gICAgfSxcbiAgICBnZXRNYXhIZWlnaHQgPSBmdW5jdGlvbihwYXJlbnQpIHsgLy8gZ2V0IGNvbGxhcHNlIHRydWVIZWlnaHQgYW5kIGJvcmRlclxuICAgICAgdmFyIHBhcmVudEhlaWdodCA9IDA7XG4gICAgICBmb3IgKHZhciBrID0gMCwgbGwgPSBwYXJlbnQuY2hpbGRyZW5bbGVuZ3RoXTsgayA8IGxsOyBrKyspIHtcbiAgICAgICAgcGFyZW50SGVpZ2h0ICs9IGdldE91dGVySGVpZ2h0KHBhcmVudC5jaGlsZHJlbltrXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcGFyZW50SGVpZ2h0O1xuICAgIH0sXG4gIFxuICAgIC8vIHRvb2x0aXAgLyBwb3BvdmVyIHN0dWZmXG4gICAgaXNFbGVtZW50SW5WaWV3cG9ydCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHsgLy8gY2hlY2sgaWYgdGhpcy50b29sdGlwIGlzIGluIHZpZXdwb3J0XG4gICAgICB2YXIgcmVjdCA9IGVsZW1lbnRbZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpO1xuICAgICAgcmV0dXJuICggcmVjdFt0b3BdID49IDAgJiYgcmVjdFtsZWZ0XSA+PSAwICYmXG4gICAgICAgIHJlY3RbYm90dG9tXSA8PSAoZ2xvYmFsT2JqZWN0W2lubmVySGVpZ2h0XSB8fCBkb2NbY2xpZW50SGVpZ2h0XSkgJiZcbiAgICAgICAgcmVjdFtyaWdodF0gPD0gKGdsb2JhbE9iamVjdFtpbm5lcldpZHRoXSB8fCBkb2NbY2xpZW50V2lkdGhdKSApXG4gICAgfSxcbiAgICBnZXRTY3JvbGwgPSBmdW5jdGlvbigpIHsgLy8gYWxzbyBBZmZpeCBhbmQgU2Nyb2xsU3B5IHVzZXMgaXRcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHkgOiBnbG9iYWxPYmplY3QucGFnZVlPZmZzZXQgfHwgZG9jW3Njcm9sbFRvcF0sXG4gICAgICAgIHggOiBnbG9iYWxPYmplY3QucGFnZVhPZmZzZXQgfHwgZG9jW3Njcm9sbExlZnRdXG4gICAgICB9XG4gICAgfSxcbiAgICBzdHlsZVRpcCA9IGZ1bmN0aW9uKGxpbmssZWxlbWVudCxwb3NpdGlvbixjb250YWluZXIpIHsgLy8gYm90aCBwb3BvdmVycyBhbmQgdG9vbHRpcHNcbiAgICAgIHZhciByZWN0ID0gbGlua1tnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCksIFxuICAgICAgICAgIHNjcm9sbCA9IGNvbnRhaW5lciA9PT0gYm9keSA/IGdldFNjcm9sbCgpIDogeyB4OiBjb250YWluZXJbb2Zmc2V0TGVmdF0gKyBjb250YWluZXJbc2Nyb2xsTGVmdF0sIHk6IGNvbnRhaW5lcltvZmZzZXRUb3BdICsgY29udGFpbmVyW3Njcm9sbFRvcF0gfSxcbiAgICAgICAgICBsaW5rRGltZW5zaW9ucyA9IHsgdzogcmVjdFtyaWdodF0gLSByZWN0W2xlZnRdLCBoOiByZWN0W2JvdHRvbV0gLSByZWN0W3RvcF0gfSxcbiAgICAgICAgICBlbGVtZW50RGltZW5zaW9ucyA9IHsgdyA6IGVsZW1lbnRbb2Zmc2V0V2lkdGhdLCBoOiBlbGVtZW50W29mZnNldEhlaWdodF0gfTtcbiAgXG4gICAgICAvLyBhcHBseSBzdHlsaW5nIHRvIHRvb2x0aXAgb3IgcG9wb3ZlclxuICAgICAgaWYgKCBwb3NpdGlvbiA9PT0gdG9wICkgeyAvLyBUT1BcbiAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaCArICdweCc7XG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54IC0gZWxlbWVudERpbWVuc2lvbnMudy8yICsgbGlua0RpbWVuc2lvbnMudy8yICsgJ3B4J1xuICBcbiAgICAgIH0gZWxzZSBpZiAoIHBvc2l0aW9uID09PSBib3R0b20gKSB7IC8vIEJPVFRPTVxuICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgKyBsaW5rRGltZW5zaW9ucy5oICsgJ3B4JztcbiAgICAgICAgZWxlbWVudFtzdHlsZV1bbGVmdF0gPSByZWN0W2xlZnRdICsgc2Nyb2xsLnggLSBlbGVtZW50RGltZW5zaW9ucy53LzIgKyBsaW5rRGltZW5zaW9ucy53LzIgKyAncHgnO1xuICBcbiAgICAgIH0gZWxzZSBpZiAoIHBvc2l0aW9uID09PSBsZWZ0ICkgeyAvLyBMRUZUXG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW3RvcF0gPSByZWN0W3RvcF0gKyBzY3JvbGwueSAtIGVsZW1lbnREaW1lbnNpb25zLmgvMiArIGxpbmtEaW1lbnNpb25zLmgvMiArICdweCc7XG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54IC0gZWxlbWVudERpbWVuc2lvbnMudyArICdweCc7XG4gIFxuICAgICAgfSBlbHNlIGlmICggcG9zaXRpb24gPT09IHJpZ2h0ICkgeyAvLyBSSUdIVFxuICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgLSBlbGVtZW50RGltZW5zaW9ucy5oLzIgKyBsaW5rRGltZW5zaW9ucy5oLzIgKyAncHgnO1xuICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCArIGxpbmtEaW1lbnNpb25zLncgKyAncHgnO1xuICAgICAgfVxuICAgICAgZWxlbWVudC5jbGFzc05hbWVbaW5kZXhPZl0ocG9zaXRpb24pID09PSAtMSAmJiAoZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKHRpcFBvc2l0aW9ucyxwb3NpdGlvbikpO1xuICAgIH0sXG4gICAgdXBkYXRlUGxhY2VtZW50ID0gZnVuY3Rpb24ocG9zaXRpb24pIHtcbiAgICAgIHJldHVybiBwb3NpdGlvbiA9PT0gdG9wID8gYm90dG9tIDogLy8gdG9wXG4gICAgICAgICAgICAgcG9zaXRpb24gPT09IGJvdHRvbSA/IHRvcCA6IC8vIGJvdHRvbVxuICAgICAgICAgICAgIHBvc2l0aW9uID09PSBsZWZ0ID8gcmlnaHQgOiAvLyBsZWZ0XG4gICAgICAgICAgICAgcG9zaXRpb24gPT09IHJpZ2h0ID8gbGVmdCA6IHBvc2l0aW9uOyAvLyByaWdodFxuICAgIH07XG4gIFxuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEFmZml4XG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy9BRkZJWCBERUZJTklUSU9OXG4gIHZhciBBZmZpeCA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIFxuICAgIC8vIHJlYWQgREFUQSBBUElcbiAgICB2YXIgdGFyZ2V0RGF0YSAgICAgICAgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCksXG4gICAgICAgIG9mZnNldFRvcERhdGEgICAgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPZmZzZXRUb3ApLFxuICAgICAgICBvZmZzZXRCb3R0b21EYXRhICA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT2Zmc2V0Qm90dG9tKSxcbiAgICAgICAgXG4gICAgICAgIC8vIGNvbXBvbmVudCBzcGVjaWZpYyBzdHJpbmdzXG4gICAgICAgIGFmZml4ID0gJ2FmZml4JywgYWZmaXhlZCA9ICdhZmZpeGVkJywgZm4gPSAnZnVuY3Rpb24nLCB1cGRhdGUgPSAndXBkYXRlJyxcbiAgICAgICAgYWZmaXhUb3AgPSAnYWZmaXgtdG9wJywgYWZmaXhlZFRvcCA9ICdhZmZpeGVkLXRvcCcsXG4gICAgICAgIGFmZml4Qm90dG9tID0gJ2FmZml4LWJvdHRvbScsIGFmZml4ZWRCb3R0b20gPSAnYWZmaXhlZC1ib3R0b20nO1xuICBcbiAgICB0aGlzW3RhcmdldF0gPSBvcHRpb25zW3RhcmdldF0gPyBxdWVyeUVsZW1lbnQob3B0aW9uc1t0YXJnZXRdKSA6IHF1ZXJ5RWxlbWVudCh0YXJnZXREYXRhKSB8fCBudWxsOyAvLyB0YXJnZXQgaXMgYW4gb2JqZWN0XG4gICAgdGhpc1tvZmZzZXRUb3BdID0gb3B0aW9uc1tvZmZzZXRUb3BdID8gb3B0aW9uc1tvZmZzZXRUb3BdIDogcGFyc2VJbnQob2Zmc2V0VG9wRGF0YSkgfHwgMDsgLy8gb2Zmc2V0IG9wdGlvbiBpcyBhbiBpbnRlZ2VyIG51bWJlciBvciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhhdCBudW1iZXJcbiAgICB0aGlzW29mZnNldEJvdHRvbV0gPSBvcHRpb25zW29mZnNldEJvdHRvbV0gPyBvcHRpb25zW29mZnNldEJvdHRvbV06IHBhcnNlSW50KG9mZnNldEJvdHRvbURhdGEpIHx8IDA7XG4gIFxuICAgIGlmICggIXRoaXNbdGFyZ2V0XSAmJiAhKCB0aGlzW29mZnNldFRvcF0gfHwgdGhpc1tvZmZzZXRCb3R0b21dICkgKSB7IHJldHVybjsgfSAvLyBpbnZhbGlkYXRlXG4gIFxuICAgIC8vIGludGVybmFsIGJpbmRcbiAgICB2YXIgc2VsZiA9IHRoaXMsXG4gIFxuICAgICAgLy8gY29uc3RhbnRzXG4gICAgICByZXNpemVEZWxheSA9IChpc0lFICYmIGlzSUUgPCAxMCkgPyA1MDAgOiA1MCwgLy8gZm9yIGxlZ2FjeSBicm93c2VycyB3ZSB0cnkgdG8gbGltaXQgdGhlIGludGVydmFsIGZvciB1cGRhdGluZyB0aGUgQWZmaXhcbiAgICAgIHBpbk9mZnNldFRvcCwgcGluT2Zmc2V0Qm90dG9tLCBtYXhTY3JvbGwsIHNjcm9sbFksIHBpbm5lZFRvcCwgcGlubmVkQm90dG9tLFxuICAgICAgYWZmaXhlZFRvVG9wID0gZmFsc2UsIGFmZml4ZWRUb0JvdHRvbSA9IGZhbHNlLFxuICAgICAgXG4gICAgICAvLyBwcml2YXRlIG1ldGhvZHMgXG4gICAgICBnZXRNYXhTY3JvbGwgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoIGJvZHlbc2Nyb2xsSGVpZ2h0XSwgYm9keVtvZmZzZXRIZWlnaHRdLCBkb2NbY2xpZW50SGVpZ2h0XSwgZG9jW3Njcm9sbEhlaWdodF0sIGRvY1tvZmZzZXRIZWlnaHRdICk7XG4gICAgICB9LFxuICAgICAgZ2V0T2Zmc2V0VG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIHNlbGZbdGFyZ2V0XSAhPT0gbnVsbCApIHtcbiAgICAgICAgICByZXR1cm4gc2VsZlt0YXJnZXRdW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKVt0b3BdICsgc2Nyb2xsWTtcbiAgICAgICAgfSBlbHNlIGlmICggc2VsZltvZmZzZXRUb3BdICkge1xuICAgICAgICAgIHJldHVybiBwYXJzZUludCh0eXBlb2Ygc2VsZltvZmZzZXRUb3BdID09PSBmbiA/IHNlbGZbb2Zmc2V0VG9wXSgpIDogc2VsZltvZmZzZXRUb3BdIHx8IDApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZ2V0T2Zmc2V0Qm90dG9tID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIHNlbGZbb2Zmc2V0Qm90dG9tXSApIHtcbiAgICAgICAgICByZXR1cm4gbWF4U2Nyb2xsIC0gZWxlbWVudFtvZmZzZXRIZWlnaHRdIC0gcGFyc2VJbnQoIHR5cGVvZiBzZWxmW29mZnNldEJvdHRvbV0gPT09IGZuID8gc2VsZltvZmZzZXRCb3R0b21dKCkgOiBzZWxmW29mZnNldEJvdHRvbV0gfHwgMCApO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY2hlY2tQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbWF4U2Nyb2xsID0gZ2V0TWF4U2Nyb2xsKCk7XG4gICAgICAgIHNjcm9sbFkgPSBwYXJzZUludChnZXRTY3JvbGwoKS55LDApO1xuICAgICAgICBwaW5PZmZzZXRUb3AgPSBnZXRPZmZzZXRUb3AoKTtcbiAgICAgICAgcGluT2Zmc2V0Qm90dG9tID0gZ2V0T2Zmc2V0Qm90dG9tKCk7IFxuICAgICAgICBwaW5uZWRUb3AgPSAoIHBhcnNlSW50KHBpbk9mZnNldFRvcCkgLSBzY3JvbGxZIDwgMCkgJiYgKHNjcm9sbFkgPiBwYXJzZUludChwaW5PZmZzZXRUb3ApICk7XG4gICAgICAgIHBpbm5lZEJvdHRvbSA9ICggcGFyc2VJbnQocGluT2Zmc2V0Qm90dG9tKSAtIHNjcm9sbFkgPCAwKSAmJiAoc2Nyb2xsWSA+IHBhcnNlSW50KHBpbk9mZnNldEJvdHRvbSkgKTtcbiAgICAgIH0sXG4gICAgICBwaW5Ub3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggIWFmZml4ZWRUb1RvcCAmJiAhaGFzQ2xhc3MoZWxlbWVudCxhZmZpeCkgKSB7IC8vIG9uIGxvYWRpbmcgYSBwYWdlIGhhbGZ3YXkgc2Nyb2xsZWQgdGhlc2UgZXZlbnRzIGRvbid0IHRyaWdnZXIgaW4gQ2hyb21lXG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeCwgYWZmaXgpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhUb3AsIGFmZml4KTtcbiAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LGFmZml4KTtcbiAgICAgICAgICBhZmZpeGVkVG9Ub3AgPSB0cnVlO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhlZCwgYWZmaXgpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhlZFRvcCwgYWZmaXgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdW5QaW5Ub3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggYWZmaXhlZFRvVG9wICYmIGhhc0NsYXNzKGVsZW1lbnQsYWZmaXgpICkge1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsYWZmaXgpO1xuICAgICAgICAgIGFmZml4ZWRUb1RvcCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcGluQm90dG9tID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoICFhZmZpeGVkVG9Cb3R0b20gJiYgIWhhc0NsYXNzKGVsZW1lbnQsIGFmZml4Qm90dG9tKSApIHtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4LCBhZmZpeCk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeEJvdHRvbSwgYWZmaXgpO1xuICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pO1xuICAgICAgICAgIGFmZml4ZWRUb0JvdHRvbSA9IHRydWU7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkLCBhZmZpeCk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkQm90dG9tLCBhZmZpeCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1blBpbkJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCBhZmZpeGVkVG9Cb3R0b20gJiYgaGFzQ2xhc3MoZWxlbWVudCxhZmZpeEJvdHRvbSkgKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxhZmZpeEJvdHRvbSk7XG4gICAgICAgICAgYWZmaXhlZFRvQm90dG9tID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1cGRhdGVQaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggcGlubmVkQm90dG9tICkge1xuICAgICAgICAgIGlmICggcGlubmVkVG9wICkgeyB1blBpblRvcCgpOyB9XG4gICAgICAgICAgcGluQm90dG9tKCk7IFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVuUGluQm90dG9tKCk7XG4gICAgICAgICAgaWYgKCBwaW5uZWRUb3AgKSB7IHBpblRvcCgpOyB9IFxuICAgICAgICAgIGVsc2UgeyB1blBpblRvcCgpOyB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RcbiAgICB0aGlzW3VwZGF0ZV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja1Bvc2l0aW9uKCk7XG4gICAgICB1cGRhdGVQaW4oKTsgXG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdBZmZpeCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBvbiggZ2xvYmFsT2JqZWN0LCBzY3JvbGxFdmVudCwgdGhpc1t1cGRhdGVdICk7XG4gICAgICBvbiggZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgZnVuY3Rpb24oKSB7IHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgc2VsZlt1cGRhdGVdKCk7IH0sIHJlc2l6ZURlbGF5KTsgfSk7XG4gICAgfVxuICAgIGVsZW1lbnRbc3RyaW5nQWZmaXhdID0gdGhpcztcbiAgXG4gICAgdGhpc1t1cGRhdGVdKCk7XG4gIH07XG4gIFxuICAvLyBBRkZJWCBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQWZmaXgsIEFmZml4LCBkYXRhU3B5ICk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQWxlcnRcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBBTEVSVCBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT1cbiAgdmFyIEFsZXJ0ID0gZnVuY3Rpb24oIGVsZW1lbnQgKSB7XG4gICAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIGJpbmQsIHRhcmdldCBhbGVydCwgZHVyYXRpb24gYW5kIHN0dWZmXG4gICAgdmFyIHNlbGYgPSB0aGlzLCBjb21wb25lbnQgPSAnYWxlcnQnLFxuICAgICAgYWxlcnQgPSBnZXRDbG9zZXN0KGVsZW1lbnQsJy4nK2NvbXBvbmVudCksXG4gICAgICAvLyBoYW5kbGVyc1xuICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSl7XG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGVbdGFyZ2V0XTtcbiAgICAgICAgZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldFtoYXNBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSA/IGV2ZW50VGFyZ2V0IDogZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV07XG4gICAgICAgIGlmIChldmVudFRhcmdldCAmJiBldmVudFRhcmdldFtoYXNBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSkgeyAvLyB3ZSBkb3VibGUgY2hlY2sgdGhlIGRhdGEgYXR0cmlidXRlLCBpdCdzIGltcG9ydGFudFxuICAgICAgICAgIGFsZXJ0ID0gZ2V0Q2xvc2VzdChldmVudFRhcmdldCwnLicrY29tcG9uZW50KTtcbiAgICAgICAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KCdbJytkYXRhRGlzbWlzcysnPVwiJytjb21wb25lbnQrJ1wiXScsYWxlcnQpO1xuICAgICAgICAgIChlbGVtZW50ID09PSBldmVudFRhcmdldCB8fCBlbGVtZW50ID09PSBldmVudFRhcmdldFtwYXJlbnROb2RlXSkgJiYgYWxlcnQgJiYgc2VsZi5jbG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdHJhbnNpdGlvbkVuZEhhbmRsZXIgPSBmdW5jdGlvbigpe1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFsZXJ0LCBjbG9zZWRFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgb2ZmKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7IC8vIGRldGFjaCBpdCdzIGxpc3RlbmVyXG4gICAgICAgIGFsZXJ0W3BhcmVudE5vZGVdLnJlbW92ZUNoaWxkKGFsZXJ0KTtcbiAgICAgIH07XG4gICAgXG4gICAgLy8gcHVibGljIG1ldGhvZFxuICAgIHRoaXMuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmICggYWxlcnQgJiYgZWxlbWVudCAmJiBoYXNDbGFzcyhhbGVydCxpbkNsYXNzKSApIHtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhbGVydCwgY2xvc2VFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoYWxlcnQsaW5DbGFzcyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKGFsZXJ0KSB7XG4gICAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChhbGVydCx0cmFuc2l0aW9uRW5kSGFuZGxlcik7XG4gICAgICAgICAgfSBcbiAgICAgICAgfSwgZHVyYXRpb24pO1xuICAgICAgfVxuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nQWxlcnQgaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgb24oZWxlbWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTtcbiAgICB9XG4gICAgZWxlbWVudFtzdHJpbmdBbGVydF0gPSB0aGlzO1xuICB9O1xuICBcbiAgLy8gQUxFUlQgREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkgKCBzdHJpbmdBbGVydCwgQWxlcnQsIGRhdGFEaXNtaXNzICk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQnV0dG9uXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBCVVRUT04gREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09XG4gIHZhciBCdXR0b24gPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9uICkge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gc2V0IG9wdGlvblxuICAgIG9wdGlvbiA9IG9wdGlvbiB8fCBudWxsO1xuICBcbiAgICAvLyBjb25zdGFudFxuICAgIHZhciB0b2dnbGVkID0gZmFsc2UsIC8vIHRvZ2dsZWQgbWFrZXMgc3VyZSB0byBwcmV2ZW50IHRyaWdnZXJpbmcgdHdpY2UgdGhlIGNoYW5nZS5icy5idXR0b24gZXZlbnRzXG4gIFxuICAgICAgICAvLyBzdHJpbmdzXG4gICAgICAgIGNvbXBvbmVudCA9ICdidXR0b24nLFxuICAgICAgICBjaGVja2VkID0gJ2NoZWNrZWQnLFxuICAgICAgICByZXNldCA9ICdyZXNldCcsXG4gICAgICAgIExBQkVMID0gJ0xBQkVMJyxcbiAgICAgICAgSU5QVVQgPSAnSU5QVVQnLFxuICBcbiAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgICAgc2V0U3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCAhISBvcHRpb24gJiYgb3B0aW9uICE9PSByZXNldCApIHtcbiAgICAgICAgICBpZiAoIG9wdGlvbiA9PT0gbG9hZGluZyApIHtcbiAgICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQsZGlzYWJsZWQpO1xuICAgICAgICAgICAgZWxlbWVudFtzZXRBdHRyaWJ1dGVdKGRpc2FibGVkLGRpc2FibGVkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxlbWVudFtzZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRleHQsIGVsZW1lbnQuaW5uZXJIVE1MLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKSk7IC8vIHRyaW0gdGhlIHRleHRcbiAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnZGF0YS0nK29wdGlvbisnLXRleHQnKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlc2V0U3RhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUZXh0KSkge1xuICAgICAgICAgIGlmICggaGFzQ2xhc3MoZWxlbWVudCxkaXNhYmxlZCkgfHwgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRpc2FibGVkKSA9PT0gZGlzYWJsZWQgKSB7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGRpc2FibGVkKTtcbiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKGRpc2FibGVkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGV4dCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB0b2dnbGUgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSBlW3RhcmdldF1bcGFyZW50Tm9kZV0sXG4gICAgICAgICAgbGFiZWwgPSBlW3RhcmdldF0udGFnTmFtZSA9PT0gTEFCRUwgPyBlW3RhcmdldF0gOiBwYXJlbnQudGFnTmFtZSA9PT0gTEFCRUwgPyBwYXJlbnQgOiBudWxsOyAvLyB0aGUgLmJ0biBsYWJlbFxuICBcbiAgICAgICAgaWYgKCAhbGFiZWwgKSByZXR1cm47IC8vcmVhY3QgaWYgYSBsYWJlbCBvciBpdHMgaW1tZWRpYXRlIGNoaWxkIGlzIGNsaWNrZWRcbiAgXG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IHRoaXMsIC8vIHRoZSBidXR0b24gZ3JvdXAsIHRoZSB0YXJnZXQgb2YgdGhlIGhhbmRsZXIgZnVuY3Rpb25cbiAgICAgICAgICBsYWJlbHMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGV2ZW50VGFyZ2V0LCdidG4nKSwgLy8gYWxsIHRoZSBidXR0b24gZ3JvdXAgYnV0dG9uc1xuICAgICAgICAgIGlucHV0ID0gbGFiZWxbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKElOUFVUKVswXTtcbiAgXG4gICAgICAgIGlmICggIWlucHV0ICkgcmV0dXJuOyAvL3JldHVybiBpZiBubyBpbnB1dCBmb3VuZFxuICBcbiAgICAgICAgLy8gbWFuYWdlIHRoZSBkb20gbWFuaXB1bGF0aW9uXG4gICAgICAgIGlmICggaW5wdXQudHlwZSA9PT0gJ2NoZWNrYm94JyApIHsgLy9jaGVja2JveGVzXG4gICAgICAgICAgaWYgKCAhaW5wdXRbY2hlY2tlZF0gKSB7XG4gICAgICAgICAgICBhZGRDbGFzcyhsYWJlbCxhY3RpdmUpO1xuICAgICAgICAgICAgaW5wdXRbZ2V0QXR0cmlidXRlXShjaGVja2VkKTtcbiAgICAgICAgICAgIGlucHV0W3NldEF0dHJpYnV0ZV0oY2hlY2tlZCxjaGVja2VkKTtcbiAgICAgICAgICAgIGlucHV0W2NoZWNrZWRdID0gdHJ1ZTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVtb3ZlQ2xhc3MobGFiZWwsYWN0aXZlKTtcbiAgICAgICAgICAgIGlucHV0W2dldEF0dHJpYnV0ZV0oY2hlY2tlZCk7XG4gICAgICAgICAgICBpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoY2hlY2tlZCk7XG4gICAgICAgICAgICBpbnB1dFtjaGVja2VkXSA9IGZhbHNlO1xuICAgICAgICAgIH1cbiAgXG4gICAgICAgICAgaWYgKCF0b2dnbGVkKSB7IC8vIHByZXZlbnQgdHJpZ2dlcmluZyB0aGUgZXZlbnQgdHdpY2VcbiAgICAgICAgICAgIHRvZ2dsZWQgPSB0cnVlO1xuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChpbnB1dCwgY2hhbmdlRXZlbnQsIGNvbXBvbmVudCk7IC8vdHJpZ2dlciB0aGUgY2hhbmdlIGZvciB0aGUgaW5wdXRcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgY2hhbmdlRXZlbnQsIGNvbXBvbmVudCk7IC8vdHJpZ2dlciB0aGUgY2hhbmdlIGZvciB0aGUgYnRuLWdyb3VwXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gIFxuICAgICAgICBpZiAoIGlucHV0LnR5cGUgPT09ICdyYWRpbycgJiYgIXRvZ2dsZWQgKSB7IC8vIHJhZGlvIGJ1dHRvbnNcbiAgICAgICAgICBpZiAoICFpbnB1dFtjaGVja2VkXSApIHsgLy8gZG9uJ3QgdHJpZ2dlciBpZiBhbHJlYWR5IGFjdGl2ZVxuICAgICAgICAgICAgYWRkQ2xhc3MobGFiZWwsYWN0aXZlKTtcbiAgICAgICAgICAgIGlucHV0W3NldEF0dHJpYnV0ZV0oY2hlY2tlZCxjaGVja2VkKTtcbiAgICAgICAgICAgIGlucHV0W2NoZWNrZWRdID0gdHJ1ZTtcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoaW5wdXQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGlucHV0XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGJ0bi1ncm91cFxuICBcbiAgICAgICAgICAgIHRvZ2dsZWQgPSB0cnVlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxsID0gbGFiZWxzW2xlbmd0aF07IGk8bGw7IGkrKykge1xuICAgICAgICAgICAgICB2YXIgb3RoZXJMYWJlbCA9IGxhYmVsc1tpXSwgb3RoZXJJbnB1dCA9IG90aGVyTGFiZWxbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKElOUFVUKVswXTtcbiAgICAgICAgICAgICAgaWYgKCBvdGhlckxhYmVsICE9PSBsYWJlbCAmJiBoYXNDbGFzcyhvdGhlckxhYmVsLGFjdGl2ZSkgKSAge1xuICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKG90aGVyTGFiZWwsYWN0aXZlKTtcbiAgICAgICAgICAgICAgICBvdGhlcklucHV0LnJlbW92ZUF0dHJpYnV0ZShjaGVja2VkKTtcbiAgICAgICAgICAgICAgICBvdGhlcklucHV0W2NoZWNrZWRdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChvdGhlcklucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy8gdHJpZ2dlciB0aGUgY2hhbmdlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7IHRvZ2dsZWQgPSBmYWxzZTsgfSwgNTAgKTtcbiAgICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ2J0bicpICkgeyAvLyB3aGVuIEJ1dHRvbiB0ZXh0IGlzIHVzZWQgd2UgZXhlY3V0ZSBpdCBhcyBhbiBpbnN0YW5jZSBtZXRob2RcbiAgICAgIGlmICggb3B0aW9uICE9PSBudWxsICkge1xuICAgICAgICBpZiAoIG9wdGlvbiAhPT0gcmVzZXQgKSB7IHNldFN0YXRlKCk7IH0gXG4gICAgICAgIGVsc2UgeyByZXNldFN0YXRlKCk7IH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCBoYXNDbGFzcyhlbGVtZW50LCdidG4tZ3JvdXAnKSApIHtcbiAgICAgIGlmICggISggc3RyaW5nQnV0dG9uIGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgICAgb24oIGVsZW1lbnQsIGNsaWNrRXZlbnQsIHRvZ2dsZSApO1xuICAgICAgfVxuICAgICAgZWxlbWVudFtzdHJpbmdCdXR0b25dID0gdGhpcztcbiAgICB9XG4gIH07XG4gIFxuICAvLyBCVVRUT04gREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoIHN0cmluZ0J1dHRvbiwgQnV0dG9uLCBkYXRhVG9nZ2xlICk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQ2Fyb3VzZWxcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBDQVJPVVNFTCBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT1cbiAgdmFyIENhcm91c2VsID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KCBlbGVtZW50ICk7XG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIFxuICAgIC8vIERBVEEgQVBJXG4gICAgdmFyIGludGVydmFsRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhSW50ZXJ2YWwpID09PSAnZmFsc2UnID8gZmFsc2UgOiBwYXJzZUludChlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUludGVydmFsKSkgfHwgNTAwMCwgLy8gYm9vdHN0cmFwIGNhcm91c2VsIGRlZmF1bHQgaW50ZXJ2YWxcbiAgICAgICAgcGF1c2VEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFQYXVzZSkgPT09IGhvdmVyRXZlbnQgfHwgZmFsc2UsXG4gICAgICAgIGtleWJvYXJkRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhS2V5Ym9hcmQpID09PSAndHJ1ZScgfHwgZmFsc2UsXG4gICAgICBcbiAgICAgICAgLy8gc3RyaW5nc1xuICAgICAgICBjb21wb25lbnQgPSAnY2Fyb3VzZWwnLFxuICAgICAgICBwYXVzZWQgPSAncGF1c2VkJyxcbiAgICAgICAgZGlyZWN0aW9uID0gJ2RpcmVjdGlvbicsXG4gICAgICAgIGRhdGFTbGlkZVRvID0gJ2RhdGEtc2xpZGUtdG8nOyBcbiAgXG4gICAgdGhpc1trZXlib2FyZF0gPSBvcHRpb25zW2tleWJvYXJkXSA9PT0gdHJ1ZSB8fCBrZXlib2FyZERhdGE7XG4gICAgdGhpc1twYXVzZV0gPSAob3B0aW9uc1twYXVzZV0gPT09IGhvdmVyRXZlbnQgfHwgcGF1c2VEYXRhKSA/IGhvdmVyRXZlbnQgOiBmYWxzZTsgLy8gZmFsc2UgLyBob3ZlclxuICBcbiAgICBpZiAoICEoIG9wdGlvbnNbaW50ZXJ2YWxdIHx8IGludGVydmFsRGF0YSApICkgeyAvLyBkZXRlcm1pbmUgc2xpZGUgaW50ZXJ2YWxcbiAgICAgIHRoaXNbaW50ZXJ2YWxdID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXNbaW50ZXJ2YWxdID0gcGFyc2VJbnQob3B0aW9uc1tpbnRlcnZhbF0pIHx8IGludGVydmFsRGF0YTsgLy8gZGVmYXVsdCBzbGlkZSBpbnRlcnZhbFxuICAgIH1cbiAgXG4gICAgLy8gYmluZCwgZXZlbnQgdGFyZ2V0c1xuICAgIHZhciBzZWxmID0gdGhpcywgaW5kZXggPSBlbGVtZW50LmluZGV4ID0gMCwgdGltZXIgPSBlbGVtZW50LnRpbWVyID0gMCwgXG4gICAgICBpc1NsaWRpbmcgPSBmYWxzZSwgLy8gaXNTbGlkaW5nIHByZXZlbnRzIGNsaWNrIGV2ZW50IGhhbmRsZXJzIHdoZW4gYW5pbWF0aW9uIGlzIHJ1bm5pbmdcbiAgICAgIHNsaWRlcyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZWxlbWVudCwnaXRlbScpLCB0b3RhbCA9IHNsaWRlc1tsZW5ndGhdLFxuICAgICAgc2xpZGVEaXJlY3Rpb24gPSB0aGlzW2RpcmVjdGlvbl0gPSBsZWZ0LFxuICAgICAgY29udHJvbHMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW1lbnQsY29tcG9uZW50KyctY29udHJvbCcpLFxuICAgICAgbGVmdEFycm93ID0gY29udHJvbHNbMF0sIHJpZ2h0QXJyb3cgPSBjb250cm9sc1sxXSxcbiAgICAgIGluZGljYXRvciA9IHF1ZXJ5RWxlbWVudCggJy4nK2NvbXBvbmVudCsnLWluZGljYXRvcnMnLCBlbGVtZW50ICksXG4gICAgICBpbmRpY2F0b3JzID0gaW5kaWNhdG9yW2dldEVsZW1lbnRzQnlUYWdOYW1lXSggXCJMSVwiICk7XG4gIFxuICAgIC8vIGhhbmRsZXJzXG4gICAgdmFyIHBhdXNlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAhPT1mYWxzZSAmJiAhaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQscGF1c2VkKTtcbiAgICAgICAgICAhaXNTbGlkaW5nICYmIGNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZXN1bWVIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICggc2VsZltpbnRlcnZhbF0gIT09IGZhbHNlICYmIGhhc0NsYXNzKGVsZW1lbnQscGF1c2VkKSApIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LHBhdXNlZCk7XG4gICAgICAgICAgIWlzU2xpZGluZyAmJiBjbGVhckludGVydmFsKCB0aW1lciApO1xuICAgICAgICAgICFpc1NsaWRpbmcgJiYgc2VsZi5jeWNsZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaW5kaWNhdG9ySGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoaXNTbGlkaW5nKSByZXR1cm47XG4gIFxuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlW3RhcmdldF0sIGFjdGl2ZUluZGljYXRvciA9IHNlbGYuZ2V0QWN0aXZlSW5kZXgoKTsgLy8gZXZlbnQgdGFyZ2V0IHwgdGhlIGN1cnJlbnQgYWN0aXZlIGl0ZW1cbiAgXG4gICAgICAgIGlmICggZXZlbnRUYXJnZXQgJiYgIWhhc0NsYXNzKGV2ZW50VGFyZ2V0LGFjdGl2ZSkgJiYgZXZlbnRUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhU2xpZGVUbykgKSB7XG4gICAgICAgICAgaW5kZXggPSBwYXJzZUludCggZXZlbnRUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhU2xpZGVUbyksIDEwICk7XG4gIFxuICAgICAgICAgIC8vZGV0ZXJtaW5lIGRpcmVjdGlvbiBmaXJzdFxuICAgICAgICAgIGlmICAoIChhY3RpdmVJbmRpY2F0b3IgPCBpbmRleCApIHx8IChhY3RpdmVJbmRpY2F0b3IgPT09IDAgJiYgaW5kZXggPT09IHRvdGFsIC0xICkgKSB7XG4gICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IGxlZnQ7IC8vIG5leHRcbiAgICAgICAgICB9IGVsc2UgaWYgICggKGFjdGl2ZUluZGljYXRvciA+IGluZGV4KSB8fCAoYWN0aXZlSW5kaWNhdG9yID09PSB0b3RhbCAtIDEgJiYgaW5kZXggPT09IDAgKSApIHtcbiAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gcmlnaHQ7IC8vIHByZXZcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfVxuICBcbiAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApOyAvL0RvIHRoZSBzbGlkZVxuICAgICAgfSxcbiAgICAgIGNvbnRyb2xzSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKGlzU2xpZGluZykgcmV0dXJuO1xuICBcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZS5jdXJyZW50VGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgXG4gICAgICAgIGlmICggZXZlbnRUYXJnZXQgPT09IHJpZ2h0QXJyb3cgKSB7XG4gICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IGxlZnQ7IC8vc2V0IGRpcmVjdGlvbiBmaXJzdFxuICBcbiAgICAgICAgICBpZiggaW5kZXggPT09IHRvdGFsIC0gMSApIHtcbiAgICAgICAgICAgIGluZGV4ID0gdG90YWwgLSAxO1xuICAgICAgICAgIH0gZWxzZSBpZiAoIGluZGV4ID09PSB0b3RhbCApe1xuICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICggZXZlbnRUYXJnZXQgPT09IGxlZnRBcnJvdyApIHtcbiAgICAgICAgICBpbmRleC0tO1xuICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gcmlnaHQ7IC8vc2V0IGRpcmVjdGlvbiBmaXJzdFxuICBcbiAgICAgICAgICBpZiggaW5kZXggPT09IDAgKSB7XG4gICAgICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgICAgfSBlbHNlIGlmICggaW5kZXggPCAwICl7XG4gICAgICAgICAgICBpbmRleCA9IHRvdGFsIC0gMVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICBcbiAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApOyAvL0RvIHRoZSBzbGlkZVxuICAgICAgfSxcbiAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoaXNTbGlkaW5nKSByZXR1cm47XG4gICAgICAgIHN3aXRjaCAoZS53aGljaCkge1xuICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSBsZWZ0O1xuICAgICAgICAgICAgaWYoIGluZGV4ID09IHRvdGFsIC0gMSApIHsgaW5kZXggPSB0b3RhbCAtIDE7IH0gZWxzZVxuICAgICAgICAgICAgaWYgKCBpbmRleCA9PSB0b3RhbCApeyBpbmRleCA9IDAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAzNzpcbiAgICAgICAgICAgIGluZGV4LS07XG4gICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IHJpZ2h0O1xuICAgICAgICAgICAgaWYgKCBpbmRleCA9PSAwICkgeyBpbmRleCA9IDA7IH0gZWxzZVxuICAgICAgICAgICAgaWYgKCBpbmRleCA8IDAgKSB7IGluZGV4ID0gdG90YWwgLSAxIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGRlZmF1bHQ6IHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7IC8vRG8gdGhlIHNsaWRlXG4gICAgICB9LFxuICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgICBzZXRBY3RpdmVQYWdlID0gZnVuY3Rpb24oIHBhZ2VJbmRleCApIHsgLy9pbmRpY2F0b3JzXG4gICAgICAgIGZvciAoIHZhciBpID0gMCwgaWNsID0gaW5kaWNhdG9yc1tsZW5ndGhdOyBpIDwgaWNsOyBpKysgKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoaW5kaWNhdG9yc1tpXSxhY3RpdmUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbmRpY2F0b3JzW3BhZ2VJbmRleF0pIGFkZENsYXNzKGluZGljYXRvcnNbcGFnZUluZGV4XSwgYWN0aXZlKTtcbiAgICAgIH07XG4gIFxuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgIHRoaXMuY3ljbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIHNsaWRlRGlyZWN0aW9uID0gdGhpc1tkaXJlY3Rpb25dID0gbGVmdDsgLy8gbWFrZSBzdXJlIHRvIGFsd2F5cyBjb21lIGJhY2sgdG8gZGVmYXVsdCBzbGlkZURpcmVjdGlvblxuICAgICAgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICAgICAgaW5kZXgrKztcbiAgXG4gICAgICAgIGluZGV4ID0gaW5kZXggPT09IHRvdGFsID8gMCA6IGluZGV4O1xuICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7XG4gICAgICB9LCB0aGlzW2ludGVydmFsXSk7XG4gICAgfTtcbiAgICB0aGlzLnNsaWRlVG8gPSBmdW5jdGlvbiggbmV4dCApIHtcbiAgICAgIHZhciBhY3RpdmVJdGVtID0gdGhpcy5nZXRBY3RpdmVJbmRleCgpLCAvLyB0aGUgY3VycmVudCBhY3RpdmVcbiAgICAgICAgICBvcmllbnRhdGlvbiA9IHNsaWRlRGlyZWN0aW9uID09PSBsZWZ0ID8gJ25leHQnIDogJ3ByZXYnOyAvL2RldGVybWluZSB0eXBlXG4gIFxuICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzbGlkZUV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZGVcbiAgXG4gICAgICBpc1NsaWRpbmcgPSB0aGlzLmlzU2xpZGluZyA9IHRydWU7XG4gICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcbiAgICAgIHNldEFjdGl2ZVBhZ2UoIG5leHQgKTtcbiAgXG4gICAgICBpZiAoIHN1cHBvcnRUcmFuc2l0aW9ucyAmJiBoYXNDbGFzcyhlbGVtZW50LCdzbGlkZScpICkge1xuICAgICAgICBhZGRDbGFzcyhzbGlkZXNbbmV4dF0sb3JpZW50YXRpb24pO1xuICAgICAgICBzbGlkZXNbbmV4dF1bb2Zmc2V0V2lkdGhdOyAgXG4gICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxzbGlkZURpcmVjdGlvbik7XG4gICAgICAgIGFkZENsYXNzKHNsaWRlc1thY3RpdmVJdGVtXSxzbGlkZURpcmVjdGlvbik7XG4gIFxuICAgICAgICBvbmUoc2xpZGVzW25leHRdLCB0cmFuc2l0aW9uRW5kRXZlbnQsIGZ1bmN0aW9uKCkgeyAvL3dlJ3JlIGdvbm5hIGZha2Ugd2FpdGluZyBmb3IgdGhlIGFuaW1hdGlvbiB0byBmaW5pc2gsIGNsZWFuZXIgYW5kIGJldHRlclxuICAgICAgICAgIGlzU2xpZGluZyA9IHNlbGYuaXNTbGlkaW5nID0gZmFsc2U7XG4gIFxuICAgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxhY3RpdmUpO1xuICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1thY3RpdmVJdGVtXSxhY3RpdmUpO1xuICBcbiAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbbmV4dF0sb3JpZW50YXRpb24pO1xuICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1tuZXh0XSxzbGlkZURpcmVjdGlvbik7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLHNsaWRlRGlyZWN0aW9uKTtcbiAgXG4gICAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAmJiAhaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuICAgICAgICAgICAgc2VsZi5jeWNsZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNsaWRFdmVudCwgY29tcG9uZW50LCBzbGlkZXNbbmV4dF0pOyAvLyBoZXJlIHdlIGdvIHdpdGggdGhlIHNsaWQgZXZlbnRcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLGFjdGl2ZSk7XG4gICAgICAgIHNsaWRlc1tuZXh0XVtvZmZzZXRXaWR0aF07XG4gICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1thY3RpdmVJdGVtXSxhY3RpdmUpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlzU2xpZGluZyA9IGZhbHNlO1xuICAgICAgICAgIGlmICggc2VsZltpbnRlcnZhbF0gJiYgIWhhc0NsYXNzKGVsZW1lbnQscGF1c2VkKSApIHtcbiAgICAgICAgICAgIHNlbGYuY3ljbGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzbGlkRXZlbnQsIGNvbXBvbmVudCwgc2xpZGVzW25leHRdKTsgLy8gaGVyZSB3ZSBnbyB3aXRoIHRoZSBzbGlkIGV2ZW50XG4gICAgICAgIH0sIDEwMCApO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5nZXRBY3RpdmVJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBzbGlkZXNbaW5kZXhPZl0oZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlbGVtZW50LCdpdGVtIGFjdGl2ZScpWzBdKSB8fCAwO1xuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nQ2Fyb3VzZWwgaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICBcbiAgICAgIGlmICggdGhpc1twYXVzZV0gJiYgdGhpc1tpbnRlcnZhbF0gKSB7XG4gICAgICAgIG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzBdLCBwYXVzZUhhbmRsZXIgKTtcbiAgICAgICAgb24oIGVsZW1lbnQsIG1vdXNlSG92ZXJbMV0sIHJlc3VtZUhhbmRsZXIgKTtcbiAgICAgICAgb24oIGVsZW1lbnQsICd0b3VjaHN0YXJ0JywgcGF1c2VIYW5kbGVyICk7XG4gICAgICAgIG9uKCBlbGVtZW50LCAndG91Y2hlbmQnLCByZXN1bWVIYW5kbGVyICk7XG4gICAgICB9XG4gICAgXG4gICAgICByaWdodEFycm93ICYmIG9uKCByaWdodEFycm93LCBjbGlja0V2ZW50LCBjb250cm9sc0hhbmRsZXIgKTtcbiAgICAgIGxlZnRBcnJvdyAmJiBvbiggbGVmdEFycm93LCBjbGlja0V2ZW50LCBjb250cm9sc0hhbmRsZXIgKTtcbiAgICBcbiAgICAgIGluZGljYXRvciAmJiBvbiggaW5kaWNhdG9yLCBjbGlja0V2ZW50LCBpbmRpY2F0b3JIYW5kbGVyLCBmYWxzZSk7XG4gICAgICB0aGlzW2tleWJvYXJkXSA9PT0gdHJ1ZSAmJiBvbiggZ2xvYmFsT2JqZWN0LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIsIGZhbHNlKTtcbiAgXG4gICAgfVxuICAgIGlmICh0aGlzLmdldEFjdGl2ZUluZGV4KCk8MCkge1xuICAgICAgc2xpZGVzW2xlbmd0aF0gJiYgYWRkQ2xhc3Moc2xpZGVzWzBdLGFjdGl2ZSk7XG4gICAgICBpbmRpY2F0b3JzW2xlbmd0aF0gJiYgc2V0QWN0aXZlUGFnZSgwKTtcbiAgICB9XG4gIFxuICAgIGlmICggdGhpc1tpbnRlcnZhbF0gKXsgdGhpcy5jeWNsZSgpOyB9XG4gICAgZWxlbWVudFtzdHJpbmdDYXJvdXNlbF0gPSB0aGlzO1xuICB9O1xuICBcbiAgLy8gQ0FST1VTRUwgREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoIHN0cmluZ0Nhcm91c2VsLCBDYXJvdXNlbCwgZGF0YVJpZGUgKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBDb2xsYXBzZVxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBDT0xMQVBTRSBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT1cbiAgdmFyIENvbGxhcHNlID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBcbiAgXG4gICAgLy8gZXZlbnQgdGFyZ2V0cyBhbmQgY29uc3RhbnRzXG4gICAgdmFyIGFjY29yZGlvbiA9IG51bGwsIGNvbGxhcHNlID0gbnVsbCwgc2VsZiA9IHRoaXMsIFxuICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZSwgLy8gd2hlbiB0cnVlIGl0IHdpbGwgcHJldmVudCBjbGljayBoYW5kbGVyc1xuICAgICAgYWNjb3JkaW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnZGF0YS1wYXJlbnQnKSxcbiAgXG4gICAgICAvLyBjb21wb25lbnQgc3RyaW5nc1xuICAgICAgY29tcG9uZW50ID0gJ2NvbGxhcHNlJyxcbiAgICAgIGNvbGxhcHNlZCA9ICdjb2xsYXBzZWQnLFxuICBcbiAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgICAgb3BlbkFjdGlvbiA9IGZ1bmN0aW9uKGNvbGxhcHNlRWxlbWVudCkge1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGNvbGxhcHNlRWxlbWVudCwgc2hvd0V2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7XG4gICAgICAgIGFkZENsYXNzKGNvbGxhcHNlRWxlbWVudCxjb2xsYXBzaW5nKTtcbiAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGluQ2xhc3MpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9IGdldE1heEhlaWdodChjb2xsYXBzZUVsZW1lbnQpICsgJ3B4JztcbiAgICAgICAgfSwgMCk7XG4gIFxuICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChjb2xsYXBzZUVsZW1lbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxjb2xsYXBzaW5nKTtcbiAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSAnJztcbiAgICAgICAgICBpc0FuaW1hdGluZyA9IGZhbHNlO1xuICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzZXRBdHRyaWJ1dGVdKGFyaWFFeHBhbmRlZCwndHJ1ZScpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBjbG9zZUFjdGlvbiA9IGZ1bmN0aW9uKGNvbGxhcHNlRWxlbWVudCkge1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGNvbGxhcHNlRWxlbWVudCwgaGlkZUV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7XG4gICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9IGdldE1heEhlaWdodChjb2xsYXBzZUVsZW1lbnQpICsgJ3B4JztcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBhZGRDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG4gICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gJzBweCc7XG4gICAgICAgIH0sIDApO1xuICBcbiAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoY29sbGFwc2VFbGVtZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoY29sbGFwc2VFbGVtZW50LGluQ2xhc3MpO1xuICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9ICcnO1xuICAgICAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgY29sbGFwc2VFbGVtZW50W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLCdmYWxzZScpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgZ2V0VGFyZ2V0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBocmVmID0gZWxlbWVudC5ocmVmICYmIGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnaHJlZicpLFxuICAgICAgICAgIHBhcmVudCA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGFyZ2V0KSxcbiAgICAgICAgICBpZCA9IGhyZWYgfHwgKCBwYXJlbnQgJiYgLyMvLnRlc3QocGFyZW50KSApICYmIHBhcmVudDtcbiAgICAgICAgcmV0dXJuIGlkICYmIHF1ZXJ5RWxlbWVudChpZCk7XG4gICAgICB9O1xuICAgIFxuICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbihlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAoaXNBbmltYXRpbmcpIHJldHVybjtcbiAgICAgIGlmICghaGFzQ2xhc3MoY29sbGFwc2UsaW5DbGFzcykpIHsgc2VsZi5zaG93KCk7IH0gXG4gICAgICBlbHNlIHsgc2VsZi5oaWRlKCk7IH1cbiAgICB9O1xuICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgY2xvc2VBY3Rpb24oY29sbGFwc2UpO1xuICAgICAgYWRkQ2xhc3MoZWxlbWVudCxjb2xsYXBzZWQpO1xuICAgIH07XG4gICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICBvcGVuQWN0aW9uKGNvbGxhcHNlKTtcbiAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsY29sbGFwc2VkKTtcbiAgXG4gICAgICBpZiAoIGFjY29yZGlvbiAhPT0gbnVsbCApIHtcbiAgICAgICAgdmFyIGFjdGl2ZUNvbGxhcHNlcyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoYWNjb3JkaW9uLGNvbXBvbmVudCsnICcraW5DbGFzcyk7XG4gICAgICAgIGZvciAodmFyIGk9MCwgYWw9YWN0aXZlQ29sbGFwc2VzW2xlbmd0aF07IGk8YWw7IGkrKykge1xuICAgICAgICAgIGlmICggYWN0aXZlQ29sbGFwc2VzW2ldICE9PSBjb2xsYXBzZSkgY2xvc2VBY3Rpb24oYWN0aXZlQ29sbGFwc2VzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nQ29sbGFwc2UgaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgb24oZWxlbWVudCwgY2xpY2tFdmVudCwgdGhpcy50b2dnbGUpO1xuICAgIH1cbiAgICBjb2xsYXBzZSA9IGdldFRhcmdldCgpO1xuICAgIGFjY29yZGlvbiA9IHF1ZXJ5RWxlbWVudChvcHRpb25zLnBhcmVudCkgfHwgYWNjb3JkaW9uRGF0YSAmJiBnZXRDbG9zZXN0KGVsZW1lbnQsIGFjY29yZGlvbkRhdGEpO1xuICAgIGVsZW1lbnRbc3RyaW5nQ29sbGFwc2VdID0gdGhpcztcbiAgfTtcbiAgXG4gIC8vIENPTExBUFNFIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ0NvbGxhcHNlLCBDb2xsYXBzZSwgZGF0YVRvZ2dsZSk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgRHJvcGRvd25cbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBEUk9QRE9XTiBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT1cbiAgdmFyIERyb3Bkb3duID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbiApIHtcbiAgICAgIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uXG4gICAgdGhpcy5wZXJzaXN0ID0gb3B0aW9uID09PSB0cnVlIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnZGF0YS1wZXJzaXN0JykgPT09ICd0cnVlJyB8fCBmYWxzZTtcbiAgXG4gICAgLy8gY29uc3RhbnRzLCBldmVudCB0YXJnZXRzLCBzdHJpbmdzXG4gICAgdmFyIHNlbGYgPSB0aGlzLCBpc09wZW4gPSBmYWxzZSxcbiAgICAgIHBhcmVudCA9IGVsZW1lbnRbcGFyZW50Tm9kZV0sXG4gICAgICBjb21wb25lbnQgPSAnZHJvcGRvd24nLCBvcGVuID0gJ29wZW4nLFxuICAgICAgcmVsYXRlZFRhcmdldCA9IG51bGwsXG4gICAgICBtZW51ID0gcXVlcnlFbGVtZW50KCcuZHJvcGRvd24tbWVudScsIHBhcmVudCksXG4gICAgICBjaGlsZHJlbiA9IG5vZGVMaXN0VG9BcnJheSggbWVudVtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJyonKSksXG4gIFxuICAgICAgLy8gaGFuZGxlcnNcbiAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChpc09wZW4gJiYgKGUud2hpY2ggPT0gMjcgfHwgZS5rZXlDb2RlID09IDI3KSkgeyByZWxhdGVkVGFyZ2V0ID0gbnVsbDsgaGlkZSgpOyB9IC8vIGUua2V5Q29kZSBmb3IgSUU4XG4gICAgICB9LFxuICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlW3RhcmdldF0sIGhhc0RhdGE7XG4gICAgICAgIGhhc0RhdGEgPSAoIGV2ZW50VGFyZ2V0Lm5vZGVUeXBlICE9PSAxICYmIChldmVudFRhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFUb2dnbGUpIHx8IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdW2dldEF0dHJpYnV0ZV0oZGF0YVRvZ2dsZSkpICk7XG4gICAgICAgIGlmICggZXZlbnRUYXJnZXQgPT09IGVsZW1lbnQgfHwgZXZlbnRUYXJnZXQgPT09IHBhcmVudCB8fCBldmVudFRhcmdldFtwYXJlbnROb2RlXSA9PT0gZWxlbWVudCApIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIGNvbW1lbnQgdGhpcyBsaW5lIHRvIHN0b3AgcHJldmVudGluZyBuYXZpZ2F0aW9uIHdoZW4gY2xpY2sgdGFyZ2V0IGlzIGEgbGluayBcbiAgICAgICAgICByZWxhdGVkVGFyZ2V0ID0gZWxlbWVudDtcbiAgICAgICAgICBzZWxmLnRvZ2dsZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKCBpc09wZW4gKSB7XG4gICAgICAgICAgaWYgKCAoZXZlbnRUYXJnZXQgPT09IG1lbnUgfHwgY2hpbGRyZW4gJiYgY2hpbGRyZW5baW5kZXhPZl0oZXZlbnRUYXJnZXQpID4gLTEpICYmICggc2VsZi5wZXJzaXN0IHx8IGhhc0RhdGEgKSApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2UgeyByZWxhdGVkVGFyZ2V0ID0gbnVsbDsgaGlkZSgpOyB9XG4gICAgICAgIH1cbiAgICAgICAgKC9cXCMkLy50ZXN0KGV2ZW50VGFyZ2V0LmhyZWYpIHx8IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdICYmIC9cXCMkLy50ZXN0KGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdLmhyZWYpKSAmJiBlLnByZXZlbnREZWZhdWx0KCk7IC8vIHNob3VsZCBiZSBoZXJlIHRvIHByZXZlbnQganVtcHNcbiAgICAgIH0sXG4gICAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICAgIHNob3cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChwYXJlbnQsIHNob3dFdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcbiAgICAgICAgYWRkQ2xhc3MocGFyZW50LG9wZW4pO1xuICAgICAgICBtZW51W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLHRydWUpO1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgc2hvd25FdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcbiAgICAgICAgb24oZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG4gICAgICAgIGlzT3BlbiA9IHRydWU7XG4gICAgICB9LFxuICAgICAgaGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgaGlkZUV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuICAgICAgICByZW1vdmVDbGFzcyhwYXJlbnQsb3Blbik7XG4gICAgICAgIG1lbnVbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsZmFsc2UpO1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG4gICAgICAgIG9mZihkb2N1bWVudCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyKTtcbiAgICAgICAgaXNPcGVuID0gZmFsc2U7XG4gICAgICB9O1xuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoaGFzQ2xhc3MocGFyZW50LG9wZW4pICYmIGlzT3BlbikgeyBoaWRlKCk7IH0gXG4gICAgICBlbHNlIHsgc2hvdygpOyB9XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdEcm9wZG93biBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIG1lbnVbc2V0QXR0cmlidXRlXSgndGFiaW5kZXgnLCAnMCcpOyAvLyBGaXggb25ibHVyIG9uIENocm9tZSB8IFNhZmFyaVxuICAgICAgb24oZG9jdW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7XG4gICAgfVxuICAgIGVsZW1lbnRbc3RyaW5nRHJvcGRvd25dID0gdGhpcztcbiAgfTtcbiAgXG4gIC8vIERST1BET1dOIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdEcm9wZG93biwgRHJvcGRvd24sIGRhdGFUb2dnbGUgKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBNb2RhbFxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgICBcbiAgLy8gTU9EQUwgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT1cbiAgdmFyIE1vZGFsID0gZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucykgeyAvLyBlbGVtZW50IGNhbiBiZSB0aGUgbW9kYWwvdHJpZ2dlcmluZyBidXR0b25cbiAgXG4gICAgLy8gdGhlIG1vZGFsIChib3RoIEphdmFTY3JpcHQgLyBEQVRBIEFQSSBpbml0KSAvIHRyaWdnZXJpbmcgYnV0dG9uIGVsZW1lbnQgKERBVEEgQVBJKVxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIGRldGVybWluZSBtb2RhbCwgdHJpZ2dlcmluZyBlbGVtZW50IFxuICAgIHZhciBidG5DaGVjayA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGFyZ2V0KXx8ZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdocmVmJyksXG4gICAgICBjaGVja01vZGFsID0gcXVlcnlFbGVtZW50KCBidG5DaGVjayApLFxuICAgICAgbW9kYWwgPSBoYXNDbGFzcyhlbGVtZW50LCdtb2RhbCcpID8gZWxlbWVudCA6IGNoZWNrTW9kYWwsXG4gIFxuICAgICAgLy8gc3RyaW5nc1xuICAgICAgY29tcG9uZW50ID0gJ21vZGFsJyxcbiAgICAgIHN0YXRpY1N0cmluZyA9ICdzdGF0aWMnLFxuICAgICAgcGFkZGluZ0xlZnQgPSAncGFkZGluZ0xlZnQnLFxuICAgICAgcGFkZGluZ1JpZ2h0ID0gJ3BhZGRpbmdSaWdodCcsXG4gICAgICBtb2RhbEJhY2tkcm9wU3RyaW5nID0gJ21vZGFsLWJhY2tkcm9wJztcbiAgXG4gICAgaWYgKCBoYXNDbGFzcyhlbGVtZW50LCdtb2RhbCcpICkgeyBlbGVtZW50ID0gbnVsbDsgfSAvLyBtb2RhbCBpcyBub3cgaW5kZXBlbmRlbnQgb2YgaXQncyB0cmlnZ2VyaW5nIGVsZW1lbnRcbiAgXG4gICAgaWYgKCAhbW9kYWwgKSB7IHJldHVybjsgfSAvLyBpbnZhbGlkYXRlXG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIFxuICAgIHRoaXNba2V5Ym9hcmRdID0gb3B0aW9uc1trZXlib2FyZF0gPT09IGZhbHNlIHx8IG1vZGFsW2dldEF0dHJpYnV0ZV0oZGF0YUtleWJvYXJkKSA9PT0gJ2ZhbHNlJyA/IGZhbHNlIDogdHJ1ZTtcbiAgICB0aGlzW2JhY2tkcm9wXSA9IG9wdGlvbnNbYmFja2Ryb3BdID09PSBzdGF0aWNTdHJpbmcgfHwgbW9kYWxbZ2V0QXR0cmlidXRlXShkYXRhYmFja2Ryb3ApID09PSBzdGF0aWNTdHJpbmcgPyBzdGF0aWNTdHJpbmcgOiB0cnVlO1xuICAgIHRoaXNbYmFja2Ryb3BdID0gb3B0aW9uc1tiYWNrZHJvcF0gPT09IGZhbHNlIHx8IG1vZGFsW2dldEF0dHJpYnV0ZV0oZGF0YWJhY2tkcm9wKSA9PT0gJ2ZhbHNlJyA/IGZhbHNlIDogdGhpc1tiYWNrZHJvcF07XG4gICAgdGhpc1tjb250ZW50XSAgPSBvcHRpb25zW2NvbnRlbnRdOyAvLyBKYXZhU2NyaXB0IG9ubHlcbiAgXG4gICAgLy8gYmluZCwgY29uc3RhbnRzLCBldmVudCB0YXJnZXRzIGFuZCBvdGhlciB2YXJzXG4gICAgdmFyIHNlbGYgPSB0aGlzLCBvcGVuID0gdGhpcy5vcGVuID0gZmFsc2UsIHJlbGF0ZWRUYXJnZXQgPSBudWxsLFxuICAgICAgYm9keUlzT3ZlcmZsb3dpbmcsIG1vZGFsSXNPdmVyZmxvd2luZywgc2Nyb2xsYmFyV2lkdGgsIG92ZXJsYXksXG4gIFxuICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgICBnZXRXaW5kb3dXaWR0aCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaHRtbFJlY3QgPSBkb2NbZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpO1xuICAgICAgICByZXR1cm4gZ2xvYmFsT2JqZWN0W2lubmVyV2lkdGhdIHx8IChodG1sUmVjdFtyaWdodF0gLSBNYXRoLmFicyhodG1sUmVjdFtsZWZ0XSkpO1xuICAgICAgfSxcbiAgICAgIHNldFNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJvZHlTdHlsZSA9IGJvZHkuY3VycmVudFN0eWxlIHx8IGdsb2JhbE9iamVjdC5nZXRDb21wdXRlZFN0eWxlKGJvZHkpLCBib2R5UGFkID0gcGFyc2VJbnQoKGJvZHlTdHlsZVtwYWRkaW5nUmlnaHRdKSwgMTApO1xuICAgICAgICBpZiAoYm9keUlzT3ZlcmZsb3dpbmcpIHsgYm9keVtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9IChib2R5UGFkICsgc2Nyb2xsYmFyV2lkdGgpICsgJ3B4JzsgfVxuICAgICAgfSxcbiAgICAgIHJlc2V0U2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBib2R5W3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gJyc7XG4gICAgICB9LFxuICAgICAgbWVhc3VyZVNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHsgLy8gdGh4IHdhbHNoXG4gICAgICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwgc2Nyb2xsQmFyV2lkdGg7XG4gICAgICAgIHNjcm9sbERpdi5jbGFzc05hbWUgPSBjb21wb25lbnQrJy1zY3JvbGxiYXItbWVhc3VyZSc7IC8vIHRoaXMgaXMgaGVyZSB0byBzdGF5XG4gICAgICAgIGJvZHkuYXBwZW5kQ2hpbGQoc2Nyb2xsRGl2KTtcbiAgICAgICAgc2Nyb2xsQmFyV2lkdGggPSBzY3JvbGxEaXZbb2Zmc2V0V2lkdGhdIC0gc2Nyb2xsRGl2W2NsaWVudFdpZHRoXTtcbiAgICAgICAgYm9keS5yZW1vdmVDaGlsZChzY3JvbGxEaXYpO1xuICAgICAgICByZXR1cm4gc2Nyb2xsQmFyV2lkdGg7XG4gICAgICB9LFxuICAgICAgY2hlY2tTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGJvZHlJc092ZXJmbG93aW5nID0gYm9keVtjbGllbnRXaWR0aF0gPCBnZXRXaW5kb3dXaWR0aCgpO1xuICAgICAgICBtb2RhbElzT3ZlcmZsb3dpbmcgPSBtb2RhbFtzY3JvbGxIZWlnaHRdID4gZG9jW2NsaWVudEhlaWdodF07XG4gICAgICAgIHNjcm9sbGJhcldpZHRoID0gbWVhc3VyZVNjcm9sbGJhcigpO1xuICAgICAgfSxcbiAgICAgIGFkanVzdERpYWxvZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbW9kYWxbc3R5bGVdW3BhZGRpbmdMZWZ0XSA9ICFib2R5SXNPdmVyZmxvd2luZyAmJiBtb2RhbElzT3ZlcmZsb3dpbmcgPyBzY3JvbGxiYXJXaWR0aCArICdweCcgOiAnJztcbiAgICAgICAgbW9kYWxbc3R5bGVdW3BhZGRpbmdSaWdodF0gPSBib2R5SXNPdmVyZmxvd2luZyAmJiAhbW9kYWxJc092ZXJmbG93aW5nID8gc2Nyb2xsYmFyV2lkdGggKyAncHgnIDogJyc7XG4gICAgICB9LFxuICAgICAgcmVzZXRBZGp1c3RtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbW9kYWxbc3R5bGVdW3BhZGRpbmdMZWZ0XSA9ICcnO1xuICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9ICcnO1xuICAgICAgfSxcbiAgICAgIGNyZWF0ZU92ZXJsYXkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIG5ld092ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgb3ZlcmxheSA9IHF1ZXJ5RWxlbWVudCgnLicrbW9kYWxCYWNrZHJvcFN0cmluZyk7XG4gIFxuICAgICAgICBpZiAoIG92ZXJsYXkgPT09IG51bGwgKSB7XG4gICAgICAgICAgbmV3T3ZlcmxheVtzZXRBdHRyaWJ1dGVdKCdjbGFzcycsbW9kYWxCYWNrZHJvcFN0cmluZysnIGZhZGUnKTtcbiAgICAgICAgICBvdmVybGF5ID0gbmV3T3ZlcmxheTtcbiAgICAgICAgICBib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVtb3ZlT3ZlcmxheSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBvdmVybGF5ID0gcXVlcnlFbGVtZW50KCcuJyttb2RhbEJhY2tkcm9wU3RyaW5nKTsgXG4gICAgICAgIGlmICggb3ZlcmxheSAmJiBvdmVybGF5ICE9PSBudWxsICYmIHR5cGVvZiBvdmVybGF5ID09PSAnb2JqZWN0JyApIHtcbiAgICAgICAgICBib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyBvdmVybGF5ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGtleWRvd25IYW5kbGVyVG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHtcbiAgICAgICAgICBvbihkb2N1bWVudCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvZmYoZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZXNpemVIYW5kbGVyVG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHtcbiAgICAgICAgICBvbihnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLnVwZGF0ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2ZmKGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIHNlbGYudXBkYXRlKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRpc21pc3NIYW5kbGVyVG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHtcbiAgICAgICAgICBvbihtb2RhbCwgY2xpY2tFdmVudCwgZGlzbWlzc0hhbmRsZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9mZihtb2RhbCwgY2xpY2tFdmVudCwgZGlzbWlzc0hhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy8gaGFuZGxlcnNcbiAgICAgIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGNsaWNrVGFyZ2V0ID0gZVt0YXJnZXRdOyBcbiAgICAgICAgY2xpY2tUYXJnZXQgPSBjbGlja1RhcmdldFtoYXNBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpIHx8IGNsaWNrVGFyZ2V0W2hhc0F0dHJpYnV0ZV0oJ2hyZWYnKSA/IGNsaWNrVGFyZ2V0IDogY2xpY2tUYXJnZXRbcGFyZW50Tm9kZV07XG4gICAgICAgIGlmICggIW9wZW4gJiYgY2xpY2tUYXJnZXQgPT09IGVsZW1lbnQgJiYgIWhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpICkge1xuICAgICAgICAgIG1vZGFsLm1vZGFsVHJpZ2dlciA9IGVsZW1lbnQ7XG4gICAgICAgICAgcmVsYXRlZFRhcmdldCA9IGVsZW1lbnQ7XG4gICAgICAgICAgc2VsZi5zaG93KCk7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAga2V5SGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGtleSA9IGUud2hpY2ggfHwgZS5rZXlDb2RlOyAvLyBrZXlDb2RlIGZvciBJRThcbiAgICAgICAgaWYgKHNlbGZba2V5Ym9hcmRdICYmIGtleSA9PSAyNyAmJiBvcGVuKSB7XG4gICAgICAgICAgc2VsZi5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkaXNtaXNzSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIGNsaWNrVGFyZ2V0ID0gZVt0YXJnZXRdO1xuICAgICAgICBpZiAoIG9wZW4gJiYgKGNsaWNrVGFyZ2V0W3BhcmVudE5vZGVdW2dldEF0dHJpYnV0ZV0oZGF0YURpc21pc3MpID09PSBjb21wb25lbnQgXG4gICAgICAgICAgICB8fCBjbGlja1RhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSA9PT0gY29tcG9uZW50XG4gICAgICAgICAgICB8fCAoY2xpY2tUYXJnZXQgPT09IG1vZGFsICYmIHNlbGZbYmFja2Ryb3BdICE9PSBzdGF0aWNTdHJpbmcpICkgKSB7XG4gICAgICAgICAgc2VsZi5oaWRlKCk7IHJlbGF0ZWRUYXJnZXQgPSBudWxsO1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICB0aGlzLnRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKG9wZW4gJiYgaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHt0aGlzLmhpZGUoKTt9IGVsc2Uge3RoaXMuc2hvdygpO31cbiAgICB9O1xuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChtb2RhbCwgc2hvd0V2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuICBcbiAgICAgIC8vIHdlIGVsZWdhbnRseSBoaWRlIGFueSBvcGVuZWQgbW9kYWxcbiAgICAgIHZhciBjdXJyZW50T3BlbiA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZG9jdW1lbnQsY29tcG9uZW50KycgaW4nKVswXTtcbiAgICAgIGN1cnJlbnRPcGVuICYmIGN1cnJlbnRPcGVuICE9PSBtb2RhbCAmJiBjdXJyZW50T3Blbi5tb2RhbFRyaWdnZXJbc3RyaW5nTW9kYWxdLmhpZGUoKTsgXG4gIFxuICAgICAgaWYgKCB0aGlzW2JhY2tkcm9wXSApIHtcbiAgICAgICAgY3JlYXRlT3ZlcmxheSgpO1xuICAgICAgfVxuICBcbiAgICAgIGlmICggb3ZlcmxheSAmJiAhaGFzQ2xhc3Mob3ZlcmxheSxpbkNsYXNzKSkge1xuICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsgYWRkQ2xhc3Mob3ZlcmxheSxpbkNsYXNzKTsgfSwgMCk7XG4gICAgICB9XG4gIFxuICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgIG1vZGFsW3N0eWxlXS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgXG4gICAgICAgIGNoZWNrU2Nyb2xsYmFyKCk7XG4gICAgICAgIHNldFNjcm9sbGJhcigpO1xuICAgICAgICBhZGp1c3REaWFsb2coKTtcbiAgXG4gICAgICAgIHJlc2l6ZUhhbmRsZXJUb2dnbGUoKTtcbiAgICAgICAgZGlzbWlzc0hhbmRsZXJUb2dnbGUoKTtcbiAgICAgICAga2V5ZG93bkhhbmRsZXJUb2dnbGUoKTtcbiAgXG4gICAgICAgIGFkZENsYXNzKGJvZHksY29tcG9uZW50Kyctb3BlbicpO1xuICAgICAgICBhZGRDbGFzcyhtb2RhbCxpbkNsYXNzKTtcbiAgICAgICAgbW9kYWxbc2V0QXR0cmlidXRlXShhcmlhSGlkZGVuLCBmYWxzZSk7XG4gICAgICB9LCAwKTtcbiAgXG4gICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChtb2RhbCwgZnVuY3Rpb24oKSB7XG4gICAgICAgIG9wZW4gPSBzZWxmLm9wZW4gPSB0cnVlO1xuICAgICAgICBzZXRGb2N1cyhtb2RhbCk7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIHNob3duRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChtb2RhbCwgaGlkZUV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgb3ZlcmxheSA9IHF1ZXJ5RWxlbWVudCgnLicrbW9kYWxCYWNrZHJvcFN0cmluZyk7XG4gIFxuICAgICAgaWYgKCBvdmVybGF5ICE9PSBudWxsICkge1xuICAgICAgICByZW1vdmVDbGFzcyhvdmVybGF5LGluQ2xhc3MpO1xuICAgICAgfVxuICAgICAgcmVtb3ZlQ2xhc3MobW9kYWwsaW5DbGFzcyk7XG4gICAgICBtb2RhbFtzZXRBdHRyaWJ1dGVdKGFyaWFIaWRkZW4sIHRydWUpO1xuICBcbiAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKG1vZGFsLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoYm9keSxjb21wb25lbnQrJy1vcGVuJyk7XG4gICAgICAgIHJlc2l6ZUhhbmRsZXJUb2dnbGUoKTtcbiAgICAgICAgZGlzbWlzc0hhbmRsZXJUb2dnbGUoKTtcbiAgICAgICAga2V5ZG93bkhhbmRsZXJUb2dnbGUoKTtcbiAgXG4gICAgICAgIHJlc2V0QWRqdXN0bWVudHMoKTtcbiAgICAgICAgcmVzZXRTY3JvbGxiYXIoKTtcbiAgICAgICAgbW9kYWxbc3R5bGVdLmRpc3BsYXkgPSAnJztcbiAgXG4gICAgICAgIGlmICghZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShkb2N1bWVudCxjb21wb25lbnQrJyAnK2luQ2xhc3MpWzBdKSB7IHJlbW92ZU92ZXJsYXkoKTsgfVxuICAgICAgICBvcGVuID0gc2VsZi5vcGVuID0gZmFsc2U7XG4gICAgICAgIGVsZW1lbnQgJiYgKHNldEZvY3VzKGVsZW1lbnQpKTtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChtb2RhbCwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHRoaXMuc2V0Q29udGVudCA9IGZ1bmN0aW9uKCBjb250ZW50ICkge1xuICAgICAgcXVlcnlFbGVtZW50KCcuJytjb21wb25lbnQrJy1jb250ZW50Jyxtb2RhbCkuaW5uZXJIVE1MID0gY29udGVudDtcbiAgICB9O1xuICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAob3Blbikge1xuICAgICAgICBjaGVja1Njcm9sbGJhcigpO1xuICAgICAgICBzZXRTY3JvbGxiYXIoKTtcbiAgICAgICAgYWRqdXN0RGlhbG9nKCk7XG4gICAgICB9XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIG92ZXIgYW5kIG92ZXJcbiAgICAvLyBtb2RhbCBpcyBpbmRlcGVuZGVudCBvZiBhIHRyaWdnZXJpbmcgZWxlbWVudCBcbiAgICBpZiAoICEhZWxlbWVudCAmJiAhKHN0cmluZ01vZGFsIGluIGVsZW1lbnQpICkge1xuICAgICAgb24oZWxlbWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTtcbiAgICB9XG4gICAgaWYgKCAhIXRoaXNbY29udGVudF0gKSB7IHRoaXMuc2V0Q29udGVudCggdGhpc1tjb250ZW50XSApOyB9XG4gICAgISFlbGVtZW50ICYmIChlbGVtZW50W3N0cmluZ01vZGFsXSA9IHRoaXMpO1xuICB9O1xuICBcbiAgLy8gREFUQSBBUElcbiAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nTW9kYWwsIE1vZGFsLCBkYXRhVG9nZ2xlKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBQb3BvdmVyXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gUE9QT1ZFUiBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PVxuICB2YXIgUG9wb3ZlciA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb25zICkge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gREFUQSBBUElcbiAgICB2YXIgdHJpZ2dlckRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRyaWdnZXIpLCAvLyBjbGljayAvIGhvdmVyIC8gZm9jdXNcbiAgICAgICAgYW5pbWF0aW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQW5pbWF0aW9uKSwgLy8gdHJ1ZSAvIGZhbHNlXG4gICAgICAgIHBsYWNlbWVudERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBsYWNlbWVudCksXG4gICAgICAgIGRpc21pc3NpYmxlRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhRGlzbWlzc2libGUpLFxuICAgICAgICBkZWxheURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YURlbGF5KSxcbiAgICAgICAgY29udGFpbmVyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGFpbmVyKSxcbiAgXG4gICAgICAgIC8vIGludGVybmFsIHN0cmluZ3NcbiAgICAgICAgY29tcG9uZW50ID0gJ3BvcG92ZXInLFxuICAgICAgICB0ZW1wbGF0ZSA9ICd0ZW1wbGF0ZScsXG4gICAgICAgIHRyaWdnZXIgPSAndHJpZ2dlcicsXG4gICAgICAgIGNsYXNzU3RyaW5nID0gJ2NsYXNzJyxcbiAgICAgICAgZGl2ID0gJ2RpdicsXG4gICAgICAgIGZhZGUgPSAnZmFkZScsXG4gICAgICAgIHRpdGxlID0gJ3RpdGxlJyxcbiAgICAgICAgY29udGVudCA9ICdjb250ZW50JyxcbiAgICAgICAgZGF0YVRpdGxlID0gJ2RhdGEtdGl0bGUnLFxuICAgICAgICBkYXRhQ29udGVudCA9ICdkYXRhLWNvbnRlbnQnLFxuICAgICAgICBkaXNtaXNzaWJsZSA9ICdkaXNtaXNzaWJsZScsXG4gICAgICAgIGNsb3NlQnRuID0gJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIj7DlzwvYnV0dG9uPic7XG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdGhpc1t0ZW1wbGF0ZV0gPSBvcHRpb25zW3RlbXBsYXRlXSA/IG9wdGlvbnNbdGVtcGxhdGVdIDogbnVsbDsgLy8gSmF2YVNjcmlwdCBvbmx5XG4gICAgdGhpc1t0cmlnZ2VyXSA9IG9wdGlvbnNbdHJpZ2dlcl0gPyBvcHRpb25zW3RyaWdnZXJdIDogdHJpZ2dlckRhdGEgfHwgaG92ZXJFdmVudDtcbiAgICB0aGlzW2FuaW1hdGlvbl0gPSBvcHRpb25zW2FuaW1hdGlvbl0gJiYgb3B0aW9uc1thbmltYXRpb25dICE9PSBmYWRlID8gb3B0aW9uc1thbmltYXRpb25dIDogYW5pbWF0aW9uRGF0YSB8fCBmYWRlO1xuICAgIHRoaXNbcGxhY2VtZW50XSA9IG9wdGlvbnNbcGxhY2VtZW50XSA/IG9wdGlvbnNbcGxhY2VtZW50XSA6IHBsYWNlbWVudERhdGEgfHwgdG9wO1xuICAgIHRoaXNbZGVsYXldID0gcGFyc2VJbnQob3B0aW9uc1tkZWxheV0gfHwgZGVsYXlEYXRhKSB8fCAyMDA7XG4gICAgdGhpc1tkaXNtaXNzaWJsZV0gPSBvcHRpb25zW2Rpc21pc3NpYmxlXSB8fCBkaXNtaXNzaWJsZURhdGEgPT09ICd0cnVlJyA/IHRydWUgOiBmYWxzZTtcbiAgICB0aGlzW2NvbnRhaW5lcl0gPSBxdWVyeUVsZW1lbnQob3B0aW9uc1tjb250YWluZXJdKSB8fCBxdWVyeUVsZW1lbnQoY29udGFpbmVyRGF0YSkgfHwgYm9keTtcbiAgICBcbiAgICAvLyBiaW5kLCBjb250ZW50XG4gICAgdmFyIHNlbGYgPSB0aGlzLCBcbiAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUaXRsZSkgfHwgbnVsbCxcbiAgICAgIGNvbnRlbnRTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUNvbnRlbnQpIHx8IG51bGw7XG4gIFxuICAgIGlmICggIWNvbnRlbnRTdHJpbmcgJiYgIXRoaXNbdGVtcGxhdGVdICkgcmV0dXJuOyAvLyBpbnZhbGlkYXRlXG4gIFxuICAgIC8vIGNvbnN0YW50cywgdmFyc1xuICAgIHZhciBwb3BvdmVyID0gbnVsbCwgdGltZXIgPSAwLCBwbGFjZW1lbnRTZXR0aW5nID0gdGhpc1twbGFjZW1lbnRdLFxuICAgICAgXG4gICAgICAvLyBoYW5kbGVyc1xuICAgICAgZGlzbWlzc2libGVIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAocG9wb3ZlciAhPT0gbnVsbCAmJiBlW3RhcmdldF0gPT09IHF1ZXJ5RWxlbWVudCgnLmNsb3NlJyxwb3BvdmVyKSkge1xuICAgICAgICAgIHNlbGYuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICBcbiAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgICAgcmVtb3ZlUG9wb3ZlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzZWxmW2NvbnRhaW5lcl0ucmVtb3ZlQ2hpbGQocG9wb3Zlcik7XG4gICAgICAgIHRpbWVyID0gbnVsbDsgcG9wb3ZlciA9IG51bGw7IFxuICAgICAgfSxcbiAgICAgIGNyZWF0ZVBvcG92ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRpdGxlKTsgLy8gY2hlY2sgY29udGVudCBhZ2FpblxuICAgICAgICBjb250ZW50U3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250ZW50KTtcbiAgXG4gICAgICAgIHBvcG92ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG4gIFxuICAgICAgICBpZiAoIGNvbnRlbnRTdHJpbmcgIT09IG51bGwgJiYgc2VsZlt0ZW1wbGF0ZV0gPT09IG51bGwgKSB7IC8vY3JlYXRlIHRoZSBwb3BvdmVyIGZyb20gZGF0YSBhdHRyaWJ1dGVzXG4gIFxuICAgICAgICAgIHBvcG92ZXJbc2V0QXR0cmlidXRlXSgncm9sZScsJ3Rvb2x0aXAnKTtcbiAgXG4gICAgICAgICAgaWYgKHRpdGxlU3RyaW5nICE9PSBudWxsKSB7XG4gICAgICAgICAgICB2YXIgcG9wb3ZlclRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcbiAgICAgICAgICAgIHBvcG92ZXJUaXRsZVtzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLGNvbXBvbmVudCsnLXRpdGxlJyk7XG4gIFxuICAgICAgICAgICAgcG9wb3ZlclRpdGxlLmlubmVySFRNTCA9IHNlbGZbZGlzbWlzc2libGVdID8gdGl0bGVTdHJpbmcgKyBjbG9zZUJ0biA6IHRpdGxlU3RyaW5nO1xuICAgICAgICAgICAgcG9wb3Zlci5hcHBlbmRDaGlsZChwb3BvdmVyVGl0bGUpO1xuICAgICAgICAgIH1cbiAgXG4gICAgICAgICAgdmFyIHBvcG92ZXJBcnJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KSwgcG9wb3ZlckNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG4gICAgICAgICAgcG9wb3ZlckFycm93W3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsJ2Fycm93Jyk7IHBvcG92ZXJDb250ZW50W3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsY29tcG9uZW50KyctY29udGVudCcpO1xuICAgICAgICAgIHBvcG92ZXIuYXBwZW5kQ2hpbGQocG9wb3ZlckFycm93KTsgcG9wb3Zlci5hcHBlbmRDaGlsZChwb3BvdmVyQ29udGVudCk7XG4gIFxuICAgICAgICAgIC8vc2V0IHBvcG92ZXIgY29udGVudFxuICAgICAgICAgIHBvcG92ZXJDb250ZW50LmlubmVySFRNTCA9IHNlbGZbZGlzbWlzc2libGVdICYmIHRpdGxlU3RyaW5nID09PSBudWxsID8gY29udGVudFN0cmluZyArIGNsb3NlQnRuIDogY29udGVudFN0cmluZztcbiAgXG4gICAgICAgIH0gZWxzZSB7ICAvLyBvciBjcmVhdGUgdGhlIHBvcG92ZXIgZnJvbSB0ZW1wbGF0ZVxuICAgICAgICAgIHZhciBwb3BvdmVyVGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG4gICAgICAgICAgcG9wb3ZlclRlbXBsYXRlLmlubmVySFRNTCA9IHNlbGZbdGVtcGxhdGVdO1xuICAgICAgICAgIHBvcG92ZXIuaW5uZXJIVE1MID0gcG9wb3ZlclRlbXBsYXRlLmZpcnN0Q2hpbGQuaW5uZXJIVE1MO1xuICAgICAgICB9XG4gIFxuICAgICAgICAvL2FwcGVuZCB0byB0aGUgY29udGFpbmVyXG4gICAgICAgIHNlbGZbY29udGFpbmVyXS5hcHBlbmRDaGlsZChwb3BvdmVyKTtcbiAgICAgICAgcG9wb3ZlcltzdHlsZV0uZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgIHBvcG92ZXJbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywgY29tcG9uZW50KyAnICcgKyBwbGFjZW1lbnRTZXR0aW5nICsgJyAnICsgc2VsZlthbmltYXRpb25dKTtcbiAgICAgIH0sXG4gICAgICBzaG93UG9wb3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgIWhhc0NsYXNzKHBvcG92ZXIsaW5DbGFzcykgJiYgKCBhZGRDbGFzcyhwb3BvdmVyLGluQ2xhc3MpICk7XG4gICAgICB9LFxuICAgICAgdXBkYXRlUG9wb3ZlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzdHlsZVRpcChlbGVtZW50LHBvcG92ZXIscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pO1xuICAgICAgICBpZiAoIWlzRWxlbWVudEluVmlld3BvcnQocG9wb3ZlcikgKSB7IFxuICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSB1cGRhdGVQbGFjZW1lbnQocGxhY2VtZW50U2V0dGluZyk7IFxuICAgICAgICAgIHN0eWxlVGlwKGVsZW1lbnQscG9wb3ZlcixwbGFjZW1lbnRTZXR0aW5nLHNlbGZbY29udGFpbmVyXSk7IFxuICAgICAgICB9XG4gICAgICB9O1xuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kcyAvIGhhbmRsZXJzXG4gICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChwb3BvdmVyID09PSBudWxsKSB7IHNlbGYuc2hvdygpOyB9IFxuICAgICAgZWxzZSB7IHNlbGYuaGlkZSgpOyB9XG4gICAgfTtcbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAocG9wb3ZlciA9PT0gbnVsbCkge1xuICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSBzZWxmW3BsYWNlbWVudF07IC8vIHdlIHJlc2V0IHBsYWNlbWVudCBpbiBhbGwgY2FzZXNcbiAgICAgICAgICBjcmVhdGVQb3BvdmVyKCk7XG4gICAgICAgICAgdXBkYXRlUG9wb3ZlcigpO1xuICAgICAgICAgIHNob3dQb3BvdmVyKCk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQocG9wb3ZlciwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sIDIwICk7XG4gICAgfTtcbiAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAocG9wb3ZlciAmJiBwb3BvdmVyICE9PSBudWxsICYmIGhhc0NsYXNzKHBvcG92ZXIsaW5DbGFzcykpIHtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGVFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICByZW1vdmVDbGFzcyhwb3BvdmVyLGluQ2xhc3MpO1xuICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHBvcG92ZXIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmVtb3ZlUG9wb3ZlcigpO1xuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgc2VsZltkZWxheV0gKTtcbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ1BvcG92ZXIgaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBpZiAoc2VsZlt0cmlnZ2VyXSA9PT0gaG92ZXJFdmVudCkge1xuICAgICAgICBvbiggZWxlbWVudCwgbW91c2VIb3ZlclswXSwgc2VsZi5zaG93ICk7XG4gICAgICAgIGlmICghc2VsZltkaXNtaXNzaWJsZV0pIHsgb24oIGVsZW1lbnQsIG1vdXNlSG92ZXJbMV0sIHNlbGYuaGlkZSApOyB9XG4gICAgICB9IGVsc2UgaWYgKC9eKGNsaWNrfGZvY3VzKSQvLnRlc3Qoc2VsZlt0cmlnZ2VyXSkpIHtcbiAgICAgICAgb24oIGVsZW1lbnQsIHNlbGZbdHJpZ2dlcl0sIHNlbGYudG9nZ2xlICk7XG4gICAgICAgIGlmICghc2VsZltkaXNtaXNzaWJsZV0pIHsgb24oIGVsZW1lbnQsICdibHVyJywgc2VsZi5oaWRlICk7IH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHNlbGZbZGlzbWlzc2libGVdKSB7IG9uKCBkb2N1bWVudCwgY2xpY2tFdmVudCwgZGlzbWlzc2libGVIYW5kbGVyICk7IH1cbiAgICBcbiAgICAgIC8vIGRpc21pc3Mgb24gd2luZG93IHJlc2l6ZVxuICAgICAgaWYgKCAhKGlzSUUgJiYgaXNJRSA8IDkpICkgeyBvbiggZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgc2VsZi5oaWRlICk7IH1cbiAgXG4gICAgfVxuICAgIGVsZW1lbnRbc3RyaW5nUG9wb3Zlcl0gPSBzZWxmO1xuICB9O1xuICBcbiAgLy8gUE9QT1ZFUiBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1BvcG92ZXIsIFBvcG92ZXIsIGRhdGFUb2dnbGUpO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IFNjcm9sbFNweVxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBTQ1JPTExTUFkgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PVxuICB2YXIgU2Nyb2xsU3B5ID0gZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucykge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50LCB0aGUgZWxlbWVudCB3ZSBzcHkgb25cbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpOyBcbiAgXG4gICAgLy8gREFUQSBBUElcbiAgICB2YXIgdGFyZ2V0RGF0YSA9IHF1ZXJ5RWxlbWVudChlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCkpO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIGlmICggIW9wdGlvbnNbdGFyZ2V0XSAmJiAhdGFyZ2V0RGF0YSApIHsgcmV0dXJuOyB9IC8vIGludmFsaWRhdGVcbiAgXG4gICAgLy8gZXZlbnQgdGFyZ2V0cywgY29uc3RhbnRzXG4gICAgdmFyIHNweVRhcmdldCA9IG9wdGlvbnNbdGFyZ2V0XSAmJiBxdWVyeUVsZW1lbnQob3B0aW9uc1t0YXJnZXRdKSB8fCB0YXJnZXREYXRhLFxuICAgICAgICBsaW5rcyA9IHNweVRhcmdldCAmJiBzcHlUYXJnZXRbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKCdBJyksIFxuICAgICAgICBpdGVtcyA9IFtdLCB0YXJnZXRJdGVtcyA9IFtdLCBzY3JvbGxPZmZzZXQsXG4gICAgICAgIHNjcm9sbFRhcmdldCA9IGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSA8IGVsZW1lbnRbc2Nyb2xsSGVpZ2h0XSA/IGVsZW1lbnQgOiBnbG9iYWxPYmplY3QsIC8vIGRldGVybWluZSB3aGljaCBpcyB0aGUgcmVhbCBzY3JvbGxUYXJnZXRcbiAgICAgICAgaXNXaW5kb3cgPSBzY3JvbGxUYXJnZXQgPT09IGdsb2JhbE9iamVjdDsgIFxuICBcbiAgICAvLyBwb3B1bGF0ZSBpdGVtcyBhbmQgdGFyZ2V0c1xuICAgIGZvciAodmFyIGk9MCwgaWw9bGlua3NbbGVuZ3RoXTsgaTxpbDsgaSsrKSB7XG4gICAgICB2YXIgaHJlZiA9IGxpbmtzW2ldW2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSwgXG4gICAgICAgICAgdGFyZ2V0SXRlbSA9IGhyZWYgJiYgLyNbYS16MC05XSskL2kudGVzdChocmVmKSAmJiBxdWVyeUVsZW1lbnQoaHJlZik7XG4gICAgICBpZiAoICEhdGFyZ2V0SXRlbSApIHtcbiAgICAgICAgaXRlbXMucHVzaChsaW5rc1tpXSk7XG4gICAgICAgIHRhcmdldEl0ZW1zLnB1c2godGFyZ2V0SXRlbSk7XG4gICAgICB9XG4gICAgfVxuICBcbiAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICB2YXIgdXBkYXRlSXRlbSA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSBpdGVtc1tpbmRleF1bcGFyZW50Tm9kZV0sIC8vIGl0ZW0ncyBwYXJlbnQgTEkgZWxlbWVudFxuICAgICAgICAgIHRhcmdldEl0ZW0gPSB0YXJnZXRJdGVtc1tpbmRleF0sIC8vIHRoZSBtZW51IGl0ZW0gdGFyZ2V0cyB0aGlzIGVsZW1lbnRcbiAgICAgICAgICBkcm9wZG93biA9IGdldENsb3Nlc3QocGFyZW50LCcuZHJvcGRvd24nKSxcbiAgICAgICAgICB0YXJnZXRSZWN0ID0gaXNXaW5kb3cgJiYgdGFyZ2V0SXRlbVtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCksXG4gIFxuICAgICAgICAgIGlzQWN0aXZlID0gaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgfHwgZmFsc2UsXG4gIFxuICAgICAgICAgIHRvcEVkZ2UgPSBpc1dpbmRvdyA/IHRhcmdldFJlY3RbdG9wXSArIHNjcm9sbE9mZnNldCA6IHRhcmdldEl0ZW1bb2Zmc2V0VG9wXSAtICh0YXJnZXRJdGVtc1tpbmRleC0xXSA/IDAgOiAxMCksXG4gICAgICAgICAgYm90dG9tRWRnZSA9IGlzV2luZG93ID8gdGFyZ2V0UmVjdFtib3R0b21dICsgc2Nyb2xsT2Zmc2V0IDogdGFyZ2V0SXRlbXNbaW5kZXgrMV0gPyB0YXJnZXRJdGVtc1tpbmRleCsxXVtvZmZzZXRUb3BdIDogZWxlbWVudFtzY3JvbGxIZWlnaHRdLFxuICBcbiAgICAgICAgICBpbnNpZGUgPSBzY3JvbGxPZmZzZXQgPj0gdG9wRWRnZSAmJiBib3R0b21FZGdlID4gc2Nyb2xsT2Zmc2V0O1xuICBcbiAgICAgICAgaWYgKCAhaXNBY3RpdmUgJiYgaW5zaWRlICkge1xuICAgICAgICAgIGlmICggcGFyZW50LnRhZ05hbWUgPT09ICdMSScgJiYgIWhhc0NsYXNzKHBhcmVudCxhY3RpdmUpICkge1xuICAgICAgICAgICAgYWRkQ2xhc3MocGFyZW50LGFjdGl2ZSk7XG4gICAgICAgICAgICBpc0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICBpZiAoZHJvcGRvd24gJiYgIWhhc0NsYXNzKGRyb3Bkb3duLGFjdGl2ZSkgKSB7XG4gICAgICAgICAgICAgIGFkZENsYXNzKGRyb3Bkb3duLGFjdGl2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsICdhY3RpdmF0ZScsICdzY3JvbGxzcHknLCBpdGVtc1tpbmRleF0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICggIWluc2lkZSApIHtcbiAgICAgICAgICBpZiAoIHBhcmVudC50YWdOYW1lID09PSAnTEknICYmIGhhc0NsYXNzKHBhcmVudCxhY3RpdmUpICkge1xuICAgICAgICAgICAgcmVtb3ZlQ2xhc3MocGFyZW50LGFjdGl2ZSk7XG4gICAgICAgICAgICBpc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKGRyb3Bkb3duICYmIGhhc0NsYXNzKGRyb3Bkb3duLGFjdGl2ZSkgJiYgIWdldEVsZW1lbnRzQnlDbGFzc05hbWUocGFyZW50W3BhcmVudE5vZGVdLGFjdGl2ZSkubGVuZ3RoICkge1xuICAgICAgICAgICAgICByZW1vdmVDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICggIWluc2lkZSAmJiAhaXNBY3RpdmUgfHwgaXNBY3RpdmUgJiYgaW5zaWRlICkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVwZGF0ZUl0ZW1zID0gZnVuY3Rpb24oKXtcbiAgICAgICAgc2Nyb2xsT2Zmc2V0ID0gaXNXaW5kb3cgPyBnZXRTY3JvbGwoKS55IDogZWxlbWVudFtzY3JvbGxUb3BdO1xuICAgICAgICBmb3IgKHZhciBpbmRleD0wLCBpdGw9aXRlbXNbbGVuZ3RoXTsgaW5kZXg8aXRsOyBpbmRleCsrKSB7XG4gICAgICAgICAgdXBkYXRlSXRlbShpbmRleClcbiAgICAgICAgfVxuICAgICAgfTtcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZFxuICAgIHRoaXMucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHVwZGF0ZUl0ZW1zKCk7XG4gICAgfVxuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ1Njcm9sbFNweSBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIG9uKCBzY3JvbGxUYXJnZXQsIHNjcm9sbEV2ZW50LCB0aGlzLnJlZnJlc2ggKTtcbiAgICAgIGlmICggIShpc0lFICYmIGlzSUUgPCA5KSkgeyBcbiAgICAgICAgb24oIGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIHRoaXMucmVmcmVzaCApOyBcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgZWxlbWVudFtzdHJpbmdTY3JvbGxTcHldID0gdGhpcztcbiAgfTtcbiAgXG4gIC8vIFNDUk9MTFNQWSBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nU2Nyb2xsU3B5LCBTY3JvbGxTcHksIGRhdGFTcHkpO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IFRhYlxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBUQUIgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PVxuICB2YXIgVGFiID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBEQVRBIEFQSVxuICAgIHZhciBoZWlnaHREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFIZWlnaHQpLFxuICAgICAgXG4gICAgICAgIC8vIHN0cmluZ3NcbiAgICAgICAgY29tcG9uZW50ID0gJ3RhYicsIGhlaWdodCA9ICdoZWlnaHQnLCBpc0FuaW1hdGluZyA9ICdpc0FuaW1hdGluZyc7XG4gIFxuICAgIC8vIHNldCBkZWZhdWx0IGFuaW1hdGlvbiBzdGF0ZVxuICAgIGVsZW1lbnRbaXNBbmltYXRpbmddID0gZmFsc2U7XG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdGhpc1toZWlnaHRdID0gc3VwcG9ydFRyYW5zaXRpb25zID8gKG9wdGlvbnNbaGVpZ2h0XSB8fCBoZWlnaHREYXRhID09PSAndHJ1ZScpIDogZmFsc2U7IC8vIGZpbHRlciBsZWdhY3kgYnJvd3NlcnNcbiAgXG4gICAgLy8gYmluZCwgZXZlbnQgdGFyZ2V0c1xuICAgIHZhciBzZWxmID0gdGhpcywgbmV4dCxcbiAgICAgIHRhYnMgPSBnZXRDbG9zZXN0KGVsZW1lbnQsJy5uYXYnKSxcbiAgICAgIHRhYnNDb250ZW50Q29udGFpbmVyLFxuICAgICAgZHJvcGRvd24gPSBxdWVyeUVsZW1lbnQoJy5kcm9wZG93bicsdGFicyk7XG4gIFxuICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgIHZhciBnZXRBY3RpdmVUYWIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFjdGl2ZVRhYnMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRhYnMsYWN0aXZlKSwgYWN0aXZlVGFiO1xuICAgICAgICBpZiAoIGFjdGl2ZVRhYnNbbGVuZ3RoXSA9PT0gMSAmJiAhaGFzQ2xhc3MoYWN0aXZlVGFic1swXSwnZHJvcGRvd24nKSApIHtcbiAgICAgICAgICBhY3RpdmVUYWIgPSBhY3RpdmVUYWJzWzBdO1xuICAgICAgICB9IGVsc2UgaWYgKCBhY3RpdmVUYWJzW2xlbmd0aF0gPiAxICkge1xuICAgICAgICAgIGFjdGl2ZVRhYiA9IGFjdGl2ZVRhYnNbYWN0aXZlVGFic1tsZW5ndGhdLTFdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY3RpdmVUYWJbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKCdBJylbMF07XG4gICAgICB9LFxuICAgICAgZ2V0QWN0aXZlQ29udGVudCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcXVlcnlFbGVtZW50KGdldEFjdGl2ZVRhYigpW2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSk7XG4gICAgICB9LFxuICAgICAgLy8gaGFuZGxlciBcbiAgICAgIGNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBuZXh0ID0gZVt0YXJnZXRdO1xuICAgICAgICBzZWxmLnNob3coKTtcbiAgICAgIH07XG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RcbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsgLy8gdGhlIHRhYiB3ZSBjbGlja2VkIGlzIG5vdyB0aGUgbmV4dCB0YWJcbiAgICAgIHZhciBuZXh0Q29udGVudCA9IHF1ZXJ5RWxlbWVudChuZXh0W2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSksIC8vdGhpcyBpcyB0aGUgYWN0dWFsIG9iamVjdCwgdGhlIG5leHQgdGFiIGNvbnRlbnQgdG8gYWN0aXZhdGVcbiAgICAgICAgYWN0aXZlVGFiID0gZ2V0QWN0aXZlVGFiKCksIGFjdGl2ZUNvbnRlbnQgPSBnZXRBY3RpdmVDb250ZW50KCk7XG4gICAgICBcbiAgICAgIGlmICggKCFhY3RpdmVUYWJbaXNBbmltYXRpbmddIHx8ICFuZXh0W2lzQW5pbWF0aW5nXSkgJiYgIWhhc0NsYXNzKG5leHRbcGFyZW50Tm9kZV0sYWN0aXZlKSApIHtcbiAgICAgICAgYWN0aXZlVGFiW2lzQW5pbWF0aW5nXSA9IG5leHRbaXNBbmltYXRpbmddID0gdHJ1ZTtcbiAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlVGFiW3BhcmVudE5vZGVdLGFjdGl2ZSk7XG4gICAgICAgIGFkZENsYXNzKG5leHRbcGFyZW50Tm9kZV0sYWN0aXZlKTtcbiAgXG4gICAgICAgIGlmICggZHJvcGRvd24gKSB7XG4gICAgICAgICAgaWYgKCAhaGFzQ2xhc3MoZWxlbWVudFtwYXJlbnROb2RlXVtwYXJlbnROb2RlXSwnZHJvcGRvd24tbWVudScpICkge1xuICAgICAgICAgICAgaWYgKGhhc0NsYXNzKGRyb3Bkb3duLGFjdGl2ZSkpIHJlbW92ZUNsYXNzKGRyb3Bkb3duLGFjdGl2ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICghaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSkgYWRkQ2xhc3MoZHJvcGRvd24sYWN0aXZlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICh0YWJzQ29udGVudENvbnRhaW5lcikgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQoYWN0aXZlQ29udGVudCkgKyAncHgnOyAvLyBoZWlnaHQgYW5pbWF0aW9uXG4gIFxuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFjdGl2ZVRhYiwgaGlkZUV2ZW50LCBjb21wb25lbnQsIG5leHQpO1xuICBcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyhhY3RpdmVDb250ZW50LGluQ2xhc3MpO1xuICAgICAgICB9LCAwKTtcbiAgXG4gICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKGFjdGl2ZUNvbnRlbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGlmICh0YWJzQ29udGVudENvbnRhaW5lcikgYWRkQ2xhc3ModGFic0NvbnRlbnRDb250YWluZXIsY29sbGFwc2luZyk7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlQ29udGVudCxhY3RpdmUpO1xuICAgICAgICAgIGFkZENsYXNzKG5leHRDb250ZW50LGFjdGl2ZSk7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFkZENsYXNzKG5leHRDb250ZW50LGluQ2xhc3MpO1xuICAgICAgICAgICAgaWYodGFic0NvbnRlbnRDb250YWluZXIpIHRhYnNDb250ZW50Q29udGFpbmVyW3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KG5leHRDb250ZW50KSArICdweCc7IC8vIGhlaWdodCBhbmltYXRpb25cbiAgICAgICAgICB9LCAwKTtcbiAgXG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChuZXh0LCBzaG93RXZlbnQsIGNvbXBvbmVudCwgYWN0aXZlVGFiKTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFjdGl2ZVRhYiwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCwgbmV4dCk7XG4gIFxuICAgICAgICB9KTtcbiAgXG4gICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKG5leHRDb250ZW50LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG5leHQsIHNob3duRXZlbnQsIGNvbXBvbmVudCwgYWN0aXZlVGFiKTtcbiAgICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIHsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZCh0YWJzQ29udGVudENvbnRhaW5lciwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB0YWJzQ29udGVudENvbnRhaW5lcltzdHlsZV1baGVpZ2h0XSA9ICAnJztcbiAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyh0YWJzQ29udGVudENvbnRhaW5lcixjb2xsYXBzaW5nKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVUYWJbaXNBbmltYXRpbmddID0gbmV4dFtpc0FuaW1hdGluZ10gPSBmYWxzZTtcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sMCk7XG4gICAgICAgICAgfSBlbHNlIHsgYWN0aXZlVGFiW2lzQW5pbWF0aW5nXSA9IG5leHRbaXNBbmltYXRpbmddID0gZmFsc2U7IH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdUYWIgaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuICAgIH1cbiAgICBpZiAodGhpc1toZWlnaHRdKSB7IHRhYnNDb250ZW50Q29udGFpbmVyID0gZ2V0QWN0aXZlQ29udGVudCgpW3BhcmVudE5vZGVdOyB9XG4gICAgZWxlbWVudFtzdHJpbmdUYWJdID0gdGhpcztcbiAgfTtcbiAgXG4gIC8vIFRBQiBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nVGFiLCBUYWIsIGRhdGFUb2dnbGUpO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IFRvb2x0aXBcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIFRPT0xUSVAgREVGSU5JVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT1cbiAgdmFyIFRvb2x0aXAgPSBmdW5jdGlvbiggZWxlbWVudCxvcHRpb25zICkge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gREFUQSBBUElcbiAgICB2YXIgYW5pbWF0aW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQW5pbWF0aW9uKTtcbiAgICAgICAgcGxhY2VtZW50RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhUGxhY2VtZW50KTtcbiAgICAgICAgZGVsYXlEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEZWxheSksXG4gICAgICAgIGNvbnRhaW5lckRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUNvbnRhaW5lciksXG4gICAgICAgIFxuICAgICAgICAvLyBzdHJpbmdzXG4gICAgICAgIGNvbXBvbmVudCA9ICd0b29sdGlwJyxcbiAgICAgICAgY2xhc3NTdHJpbmcgPSAnY2xhc3MnLFxuICAgICAgICB0aXRsZSA9ICd0aXRsZScsXG4gICAgICAgIGZhZGUgPSAnZmFkZScsXG4gICAgICAgIGRpdiA9ICdkaXYnO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIHRoaXNbYW5pbWF0aW9uXSA9IG9wdGlvbnNbYW5pbWF0aW9uXSAmJiBvcHRpb25zW2FuaW1hdGlvbl0gIT09IGZhZGUgPyBvcHRpb25zW2FuaW1hdGlvbl0gOiBhbmltYXRpb25EYXRhIHx8IGZhZGU7XG4gICAgdGhpc1twbGFjZW1lbnRdID0gb3B0aW9uc1twbGFjZW1lbnRdID8gb3B0aW9uc1twbGFjZW1lbnRdIDogcGxhY2VtZW50RGF0YSB8fCB0b3A7XG4gICAgdGhpc1tkZWxheV0gPSBwYXJzZUludChvcHRpb25zW2RlbGF5XSB8fCBkZWxheURhdGEpIHx8IDIwMDtcbiAgICB0aGlzW2NvbnRhaW5lcl0gPSBxdWVyeUVsZW1lbnQob3B0aW9uc1tjb250YWluZXJdKSB8fCBxdWVyeUVsZW1lbnQoY29udGFpbmVyRGF0YSkgfHwgYm9keTtcbiAgXG4gICAgLy8gYmluZCwgZXZlbnQgdGFyZ2V0cywgdGl0bGUgYW5kIGNvbnN0YW50c1xuICAgIHZhciBzZWxmID0gdGhpcywgdGltZXIgPSAwLCBwbGFjZW1lbnRTZXR0aW5nID0gdGhpc1twbGFjZW1lbnRdLCB0b29sdGlwID0gbnVsbCxcbiAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKHRpdGxlKSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGl0bGUpO1xuICBcbiAgICBpZiAoICF0aXRsZVN0cmluZyApIHJldHVybjsgLy8gaW52YWxpZGF0ZVxuICBcbiAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICB2YXIgcmVtb3ZlVG9vbFRpcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBzZWxmW2NvbnRhaW5lcl0ucmVtb3ZlQ2hpbGQodG9vbHRpcCk7XG4gICAgICAgIHRvb2x0aXAgPSBudWxsOyB0aW1lciA9IG51bGw7XG4gICAgICB9LFxuICAgICAgY3JlYXRlVG9vbFRpcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aXRsZVN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSh0aXRsZSkgfHwgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRpdGxlKTsgLy8gcmVhZCB0aGUgdGl0bGUgYWdhaW5cbiAgICAgICAgdG9vbHRpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcbiAgICAgICAgdG9vbHRpcFtzZXRBdHRyaWJ1dGVdKCdyb2xlJyxjb21wb25lbnQpO1xuICBcbiAgICAgICAgdmFyIHRvb2x0aXBBcnJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KSwgdG9vbHRpcElubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuICAgICAgICB0b29sdGlwQXJyb3dbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywgY29tcG9uZW50KyctYXJyb3cnKTsgdG9vbHRpcElubmVyW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsY29tcG9uZW50KyctaW5uZXInKTtcbiAgXG4gICAgICAgIHRvb2x0aXAuYXBwZW5kQ2hpbGQodG9vbHRpcEFycm93KTsgdG9vbHRpcC5hcHBlbmRDaGlsZCh0b29sdGlwSW5uZXIpO1xuICBcbiAgICAgICAgdG9vbHRpcElubmVyLmlubmVySFRNTCA9IHRpdGxlU3RyaW5nO1xuICBcbiAgICAgICAgc2VsZltjb250YWluZXJdLmFwcGVuZENoaWxkKHRvb2x0aXApO1xuICAgICAgICB0b29sdGlwW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsIGNvbXBvbmVudCArICcgJyArIHBsYWNlbWVudFNldHRpbmcgKyAnICcgKyBzZWxmW2FuaW1hdGlvbl0pO1xuICAgICAgfSxcbiAgICAgIHVwZGF0ZVRvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN0eWxlVGlwKGVsZW1lbnQsdG9vbHRpcCxwbGFjZW1lbnRTZXR0aW5nLHNlbGZbY29udGFpbmVyXSk7XG4gICAgICAgIGlmICghaXNFbGVtZW50SW5WaWV3cG9ydCh0b29sdGlwKSApIHsgXG4gICAgICAgICAgcGxhY2VtZW50U2V0dGluZyA9IHVwZGF0ZVBsYWNlbWVudChwbGFjZW1lbnRTZXR0aW5nKTsgXG4gICAgICAgICAgc3R5bGVUaXAoZWxlbWVudCx0b29sdGlwLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTsgXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzaG93VG9vbHRpcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgIWhhc0NsYXNzKHRvb2x0aXAsaW5DbGFzcykgJiYgKCBhZGRDbGFzcyh0b29sdGlwLGluQ2xhc3MpICk7XG4gICAgICB9O1xuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0b29sdGlwID09PSBudWxsKSB7XG4gICAgICAgICAgcGxhY2VtZW50U2V0dGluZyA9IHNlbGZbcGxhY2VtZW50XTsgLy8gd2UgcmVzZXQgcGxhY2VtZW50IGluIGFsbCBjYXNlc1xuICAgICAgICAgIGNyZWF0ZVRvb2xUaXAoKTtcbiAgICAgICAgICB1cGRhdGVUb29sdGlwKCk7XG4gICAgICAgICAgc2hvd1Rvb2x0aXAoKTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3dFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZCh0b29sdGlwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2hvd25FdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgMjAgKTtcbiAgICB9O1xuICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0b29sdGlwICYmIHRvb2x0aXAgIT09IG51bGwgJiYgaGFzQ2xhc3ModG9vbHRpcCxpbkNsYXNzKSkge1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgaGlkZUV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIHJlbW92ZUNsYXNzKHRvb2x0aXAsaW5DbGFzcyk7XG4gICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQodG9vbHRpcCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZW1vdmVUb29sVGlwKCk7XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBzZWxmW2RlbGF5XSk7XG4gICAgfTtcbiAgICB0aGlzLnRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCF0b29sdGlwKSB7IHNlbGYuc2hvdygpOyB9IFxuICAgICAgZWxzZSB7IHNlbGYuaGlkZSgpOyB9XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdUb29sdGlwIGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgZWxlbWVudFtzZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRpdGxlLHRpdGxlU3RyaW5nKTtcbiAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHRpdGxlKTtcbiAgICAgIG9uKGVsZW1lbnQsIG1vdXNlSG92ZXJbMF0sIHRoaXMuc2hvdyk7XG4gICAgICBvbihlbGVtZW50LCBtb3VzZUhvdmVyWzFdLCB0aGlzLmhpZGUpO1xuICAgIH1cbiAgICBlbGVtZW50W3N0cmluZ1Rvb2x0aXBdID0gdGhpcztcbiAgfTtcbiAgXG4gIC8vIFRPT0xUSVAgREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nVG9vbHRpcCwgVG9vbHRpcCwgZGF0YVRvZ2dsZSk7XG4gIFxuICBcbiAgcmV0dXJuIHtcbiAgICBBZmZpeDogQWZmaXgsXG4gICAgQWxlcnQ6IEFsZXJ0LFxuICAgIEJ1dHRvbjogQnV0dG9uLFxuICAgIENhcm91c2VsOiBDYXJvdXNlbCxcbiAgICBDb2xsYXBzZTogQ29sbGFwc2UsXG4gICAgRHJvcGRvd246IERyb3Bkb3duLFxuICAgIE1vZGFsOiBNb2RhbCxcbiAgICBQb3BvdmVyOiBQb3BvdmVyLFxuICAgIFNjcm9sbFNweTogU2Nyb2xsU3B5LFxuICAgIFRhYjogVGFiLFxuICAgIFRvb2x0aXA6IFRvb2x0aXBcbiAgfTtcbn0pKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vfi9ib290c3RyYXAubmF0aXZlL2Rpc3QvYm9vdHN0cmFwLW5hdGl2ZS5qc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9