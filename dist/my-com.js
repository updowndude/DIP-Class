!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var o=n(1);i(o);"findPersonBody"==document.body.id&&!function(){var t=!0,e=document.querySelectorAll("#searchPerson input"),n=document.querySelector("#findPerson"),i=document.querySelector("#searchPhone");e.forEach(function(e){0!=e.value.trim().length||"LName"!=e.name&&"FName"!=e.name||(t=!1)}),t===!1?n.setAttribute("disabled","disabled"):null,e.forEach(function(t){t.addEventListener("input",function(){var t=!0,o=0;e.forEach(function(n){0==n.value.trim().length||"LName"!=n.name&&"FName"!=n.name?null:o++,1==/^[1-9]{1}\d{3}-\d{2}-\d{2}$/.test(n.value.trim())&&"DOB"==n.name?o++:null,3===o?(t=!0,i.removeAttribute("disabled"),e.forEach(function(t,e,n){e<=2&&t.classList.remove("myError")})):(t=!1,e.forEach(function(t,e,n){e<=2&&t.classList.add("myError")}),i.setAttribute("disabled","disabled"))}),t===!0?n.removeAttribute("disabled"):n.setAttribute("disabled","disabled")})}),i.addEventListener("click",function(t){document.querySelector("#action").value="searchByPhone"}),document.querySelector("#btnClear").addEventListener("click",function(t){e.forEach(function(t){t.value=""}),t.preventDefault()})}()},function(t,e,n){var i,o,a;(function(n){!function(n,r){o=[],i=r,a="function"==typeof i?i.apply(e,o):i,!(void 0!==a&&(t.exports=a))}(this,function(){var t="undefined"!=typeof n?n:this||window,e=document.documentElement,i=document.body,o=null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)&&parseFloat(RegExp.$1),a="data-toggle",r="data-dismiss",l="data-spy",c="data-ride",u="Affix",s="Alert",f="Button",d="Carousel",h="Collapse",p="Dropdown",m="Modal",v="Popover",g="ScrollSpy",b="Tab",y="Tooltip",x="data-backdrop",T="data-keyboard",w="data-target",E="data-interval",I="data-height",L="data-pause",C="data-original-title",A="data-original-text",S="data-dismissible",M="data-trigger",k="data-animation",D="data-container",N="data-placement",B="data-delay",H="data-offset-top",P="data-offset-bottom",W="backdrop",q="keyboard",$="delay",O="duration",R="content",z="target",F="interval",j="pause",_="animation",U="placement",X="container",Y="offsetTop",G="offsetBottom",J="offsetLeft",K="scrollTop",Q="scrollLeft",V="clientWidth",Z="clientHeight",tt="offsetWidth",et="offsetHeight",nt="innerWidth",it="innerHeight",ot="scrollHeight",at="height",rt="aria-expanded",lt="aria-hidden",ct="click",ut="hover",st="keydown",ft="resize",dt="scroll",ht="show",pt="shown",mt="hide",vt="hidden",gt="close",bt="closed",yt="slid",xt="slide",Tt="change",wt="getAttribute",Et="setAttribute",It="hasAttribute",Lt="getElementsByTagName",Ct="getBoundingClientRect",At="querySelectorAll",St="getElementsByClassName",Mt="indexOf",kt="parentNode",Dt="length",Nt="toLowerCase",Bt="Transition",Ht="Webkit",Pt="style",Wt="active",qt="in",$t="collapsing",Ot="disabled",Rt="loading",zt="left",Ft="right",jt="top",_t="bottom",Ut="onmouseleave"in document?["mouseenter","mouseleave"]:["mouseover","mouseout"],Xt=/\b(top|bottom|left|top)+/,Yt=Ht+Bt in e[Pt]||Bt[Nt]()in e[Pt],Gt=Ht+Bt in e[Pt]?Ht[Nt]()+Bt+"End":Bt[Nt]()+"end",Jt=function(t){t.focus?t.focus():t.setActive()},Kt=function(t,e){t.classList.add(e)},Qt=function(t,e){t.classList.remove(e)},Vt=function(t,e){return t.classList.contains(e)},Zt=function(t){for(var e=[],n=0,i=t[Dt];n<i;n++)e.push(t[n]);return e},te=function(t,e){var n=8===o?At:St;return Zt(t[n](8===o?"."+e.replace(/\s(?=[a-z])/g,"."):e))},ee=function(t,e){var n=e?e:document;return"object"==typeof t?t:n.querySelector(t)},ne=function(t,e){for(var n=e.charAt(0);t&&t!==document;t=t[kt]){if(("."===n||"#"!==n)&&null!==ee(e,t[kt]))return t;if("#"===n&&t.id===e.substr(1))return t}return!1},ie=function(t,e,n){t.addEventListener(e,n,!1)},oe=function(t,e,n){t.removeEventListener(e,n,!1)},ae=function(t,e,n){ie(t,e,function i(){n(),oe(t,e,i)})},re=function(t,e){Yt?ae(t,Gt,e):e()},le=function(t,e,n){var i=new CustomEvent(t+".bs."+e);i.relatedTarget=n,this.dispatchEvent(i)},ce=document[Lt]("*"),ue=function(t,e,n,i){for(var o=i&&i[Dt]?i:ce,a=0;a<o[Dt];a++){var r=o[a][wt](n),l=t.replace(/spy/i,"")[Nt]();(r&&t===f&&r[Mt](l)>-1||r===l)&&new e(o[a])}},se=function(e){var n=e&&(e.currentStyle||t.getComputedStyle(e)),i=/px/.test(n.borderTopWidth)?Math.round(n.borderTopWidth.replace("px","")):0,o=/px/.test(n.borderBottomWidth)?Math.round(n.borderBottomWidth.replace("px","")):0,a=/px/.test(n.marginTop)?Math.round(n.marginTop.replace("px","")):0,r=/px/.test(n.marginBottom)?Math.round(n.marginBottom.replace("px","")):0;return e[Z]+parseInt(i)+parseInt(o)+parseInt(a)+parseInt(r)},fe=function(t){for(var e=0,n=0,i=t.children[Dt];n<i;n++)e+=se(t.children[n]);return e},de=function(n){var i=n[Ct]();return i[jt]>=0&&i[zt]>=0&&i[_t]<=(t[it]||e[Z])&&i[Ft]<=(t[nt]||e[V])},he=function(){return{y:t.pageYOffset||e[K],x:t.pageXOffset||e[Q]}},pe=function(t,e,n,o){var a=t[Ct](),r=o===i?he():{x:o[J]+o[Q],y:o[Y]+o[K]},l={w:a[Ft]-a[zt],h:a[_t]-a[jt]},c={w:e[tt],h:e[et]};n===jt?(e[Pt][jt]=a[jt]+r.y-c.h+"px",e[Pt][zt]=a[zt]+r.x-c.w/2+l.w/2+"px"):n===_t?(e[Pt][jt]=a[jt]+r.y+l.h+"px",e[Pt][zt]=a[zt]+r.x-c.w/2+l.w/2+"px"):n===zt?(e[Pt][jt]=a[jt]+r.y-c.h/2+l.h/2+"px",e[Pt][zt]=a[zt]+r.x-c.w+"px"):n===Ft&&(e[Pt][jt]=a[jt]+r.y-c.h/2+l.h/2+"px",e[Pt][zt]=a[zt]+r.x+l.w+"px"),e.className[Mt](n)===-1&&(e.className=e.className.replace(Xt,n))},me=function(t){return t===jt?_t:t===_t?jt:t===zt?Ft:t===Ft?zt:t},ve=function(n,a){n=ee(n),a=a||{};var r=n[wt](w),l=n[wt](H),c=n[wt](P),s="affix",f="affixed",d="function",h="update",p="affix-top",m="affixed-top",v="affix-bottom",g="affixed-bottom";if(this[z]=a[z]?ee(a[z]):ee(r)||null,this[Y]=a[Y]?a[Y]:parseInt(l)||0,this[G]=a[G]?a[G]:parseInt(c)||0,this[z]||this[Y]||this[G]){var b,y,x,T,E,I,L=this,C=o&&o<10?500:50,A=!1,S=!1,M=function(){return Math.max(i[ot],i[et],e[Z],e[ot],e[et])},k=function(){return null!==L[z]?L[z][Ct]()[jt]+T:L[Y]?parseInt(typeof L[Y]===d?L[Y]():L[Y]||0):void 0},D=function(){if(L[G])return x-n[et]-parseInt(typeof L[G]===d?L[G]():L[G]||0)},N=function(){x=M(),T=parseInt(he().y,0),b=k(),y=D(),E=parseInt(b)-T<0&&T>parseInt(b),I=parseInt(y)-T<0&&T>parseInt(y)},B=function(){A||Vt(n,s)||(le.call(n,s,s),le.call(n,p,s),Kt(n,s),A=!0,le.call(n,f,s),le.call(n,m,s))},W=function(){A&&Vt(n,s)&&(Qt(n,s),A=!1)},q=function(){S||Vt(n,v)||(le.call(n,s,s),le.call(n,v,s),Kt(n,v),S=!0,le.call(n,f,s),le.call(n,g,s))},$=function(){S&&Vt(n,v)&&(Qt(n,v),S=!1)},O=function(){I?(E&&W(),q()):($(),E?B():W())};this[h]=function(){N(),O()},u in n||(ie(t,dt,this[h]),ie(t,ft,function(){setTimeout(function(){L[h]()},C)})),n[u]=this,this[h]()}};ue(u,ve,l);var ge=function(t){t=ee(t);var e=this,n="alert",i=ne(t,"."+n),o=function(o){var a=o[z];a=a[It](r)?a:a[kt],a&&a[It](r)&&(i=ne(a,"."+n),t=ee("["+r+'="'+n+'"]',i),(t===a||t===a[kt])&&i&&e.close())},a=function(){le.call(i,bt,n),oe(t,ct,o),i[kt].removeChild(i)};this.close=function(){i&&t&&Vt(i,qt)&&(le.call(i,gt,n),Qt(i,qt),setTimeout(function(){i&&re(i,a)},O))},s in t||ie(t,ct,o),t[s]=this};ue(s,ge,r);var be=function(t,e){t=ee(t),e=e||null;var n=!1,i="button",o="checked",a="reset",r="LABEL",l="INPUT",c=function(){e&&e!==a&&(e===Rt&&(Kt(t,Ot),t[Et](Ot,Ot)),t[Et](A,t.innerHTML.replace(/^\s+|\s+$/g,"")),t.innerHTML=t[wt]("data-"+e+"-text"))},u=function(){t[wt](A)&&((Vt(t,Ot)||t[wt](Ot)===Ot)&&(Qt(t,Ot),t.removeAttribute(Ot)),t.innerHTML=t[wt](A))},s=function(e){var a=e[z][kt],c=e[z].tagName===r?e[z]:a.tagName===r?a:null;if(c){var u=this,s=te(u,"btn"),f=c[Lt](l)[0];if(f){if("checkbox"===f.type&&(f[o]?(Qt(c,Wt),f[wt](o),f.removeAttribute(o),f[o]=!1):(Kt(c,Wt),f[wt](o),f[Et](o,o),f[o]=!0),n||(n=!0,le.call(f,Tt,i),le.call(t,Tt,i))),"radio"===f.type&&!n&&!f[o]){Kt(c,Wt),f[Et](o,o),f[o]=!0,le.call(f,Tt,i),le.call(t,Tt,i),n=!0;for(var d=0,h=s[Dt];d<h;d++){var p=s[d],m=p[Lt](l)[0];p!==c&&Vt(p,Wt)&&(Qt(p,Wt),m.removeAttribute(o),m[o]=!1,le.call(m,Tt,i))}}setTimeout(function(){n=!1},50)}}};Vt(t,"btn")&&null!==e&&(e!==a?c():u()),Vt(t,"btn-group")&&(f in t||ie(t,ct,s),t[f]=this)};ue(f,be,a);var ye=function(e,n){e=ee(e),n=n||{};var i="false"!==e[wt](E)&&(parseInt(e[wt](E))||5e3),o=e[wt](L)===ut||!1,a="true"===e[wt](T)||!1,r="carousel",l="paused",c="direction",u="data-slide-to";this[q]=n[q]===!0||a,this[j]=!(n[j]!==ut&&!o)&&ut,n[F]||i?this[F]=parseInt(n[F])||i:this[F]=!1;var s=this,f=e.index=0,h=e.timer=0,p=!1,m=te(e,"item"),v=m[Dt],g=this[c]=zt,b=te(e,r+"-control"),y=b[0],x=b[1],w=ee("."+r+"-indicators",e),I=w[Lt]("LI"),C=function(){s[F]===!1||Vt(e,l)||(Kt(e,l),!p&&clearInterval(h))},A=function(){s[F]!==!1&&Vt(e,l)&&(Qt(e,l),!p&&clearInterval(h),!p&&s.cycle())},S=function(t){if(t.preventDefault(),!p){var e=t[z],n=s.getActiveIndex();if(!e||Vt(e,Wt)||!e[wt](u))return!1;f=parseInt(e[wt](u),10),n<f||0===n&&f===v-1?g=s[c]=zt:(n>f||n===v-1&&0===f)&&(g=s[c]=Ft),s.slideTo(f)}},M=function(t){if(t.preventDefault(),!p){var e=t.currentTarget||t.srcElement;e===x?(f++,g=s[c]=zt,f===v-1?f=v-1:f===v&&(f=0)):e===y&&(f--,g=s[c]=Ft,0===f?f=0:f<0&&(f=v-1)),s.slideTo(f)}},k=function(t){if(!p){switch(t.which){case 39:f++,g=s[c]=zt,f==v-1?f=v-1:f==v&&(f=0);break;case 37:f--,g=s[c]=Ft,0==f?f=0:f<0&&(f=v-1);break;default:return}s.slideTo(f)}},D=function(t){for(var e=0,n=I[Dt];e<n;e++)Qt(I[e],Wt);I[t]&&Kt(I[t],Wt)};this.cycle=function(){g=this[c]=zt,h=setInterval(function(){f++,f=f===v?0:f,s.slideTo(f)},this[F])},this.slideTo=function(t){var n=this.getActiveIndex(),i=g===zt?"next":"prev";le.call(e,xt,r,m[t]),p=this.isSliding=!0,clearInterval(h),D(t),Yt&&Vt(e,"slide")?(Kt(m[t],i),m[t][tt],Kt(m[t],g),Kt(m[n],g),ae(m[t],Gt,function(){p=s.isSliding=!1,Kt(m[t],Wt),Qt(m[n],Wt),Qt(m[t],i),Qt(m[t],g),Qt(m[n],g),s[F]&&!Vt(e,l)&&s.cycle(),le.call(e,yt,r,m[t])})):(Kt(m[t],Wt),m[t][tt],Qt(m[n],Wt),setTimeout(function(){p=!1,s[F]&&!Vt(e,l)&&s.cycle(),le.call(e,yt,r,m[t])},100))},this.getActiveIndex=function(){return m[Mt](te(e,"item active")[0])||0},d in e||(this[j]&&this[F]&&(ie(e,Ut[0],C),ie(e,Ut[1],A),ie(e,"touchstart",C),ie(e,"touchend",A)),x&&ie(x,ct,M),y&&ie(y,ct,M),w&&ie(w,ct,S,!1),this[q]===!0&&ie(t,st,k,!1)),this.getActiveIndex()<0&&(m[Dt]&&Kt(m[0],Wt),I[Dt]&&D(0)),this[F]&&this.cycle(),e[d]=this};ue(d,ye,c);var xe=function(t,e){t=ee(t),e=e||{};var n=null,i=null,o=this,a=!1,r=t[wt]("data-parent"),l="collapse",c="collapsed",u=function(t){le.call(t,ht,l),a=!0,Kt(t,$t),Kt(t,qt),setTimeout(function(){t[Pt][at]=fe(t)+"px"},0),re(t,function(){Qt(t,$t),t[Pt][at]="",a=!1,t[Et](rt,"true"),le.call(t,pt,l)})},s=function(t){le.call(t,mt,l),a=!0,t[Pt][at]=fe(t)+"px",setTimeout(function(){Kt(t,$t),t[Pt][at]="0px"},0),re(t,function(){Qt(t,$t),Qt(t,qt),t[Pt][at]="",a=!1,t[Et](rt,"false"),le.call(t,vt,l)})},f=function(){var e=t.href&&t[wt]("href"),n=t[wt](w),i=e||n&&/#/.test(n)&&n;return i&&ee(i)};this.toggle=function(t){t.preventDefault(),a||(Vt(i,qt)?o.hide():o.show())},this.hide=function(){s(i),Kt(t,c)},this.show=function(){if(u(i),Qt(t,c),null!==n)for(var e=te(n,l+" "+qt),o=0,a=e[Dt];o<a;o++)e[o]!==i&&s(e[o])},h in t||ie(t,ct,this.toggle),i=f(),n=ee(e.parent)||r&&ne(t,r),t[h]=this};ue(h,xe,a);var Te=function(t,e){t=ee(t),this.persist=e===!0||"true"===t[wt]("data-persist")||!1;var n=this,i=!1,o=t[kt],r="dropdown",l="open",c=null,u=ee(".dropdown-menu",o),s=Zt(u[Lt]("*")),f=function(t){!i||27!=t.which&&27!=t.keyCode||(c=null,m())},d=function(e){var r,l=e[z];if(r=1!==l.nodeType&&(l[wt](a)||l[kt][wt](a)),l===t||l===o||l[kt]===t)e.preventDefault(),c=t,n.toggle();else if(i){if((l===u||s&&s[Mt](l)>-1)&&(n.persist||r))return;c=null,m()}(/\#$/.test(l.href)||l[kt]&&/\#$/.test(l[kt].href))&&e.preventDefault()},h=function(){le.call(o,ht,r,c),Kt(o,l),u[Et](rt,!0),le.call(o,pt,r,c),ie(document,st,f),i=!0},m=function(){le.call(o,mt,r,c),Qt(o,l),u[Et](rt,!1),le.call(o,vt,r,c),oe(document,st,f),i=!1};this.toggle=function(){Vt(o,l)&&i?m():h()},p in t||(u[Et]("tabindex","0"),ie(document,ct,d)),t[p]=this};ue(p,Te,a);var we=function(n,o){n=ee(n);var a=n[wt](w)||n[wt]("href"),l=ee(a),c=Vt(n,"modal")?n:l,u="modal",s="static",f="paddingLeft",d="paddingRight",h="modal-backdrop";if(Vt(n,"modal")&&(n=null),c){o=o||{},this[q]=o[q]!==!1&&"false"!==c[wt](T),this[W]=o[W]!==s&&c[wt](x)!==s||s,this[W]=o[W]!==!1&&"false"!==c[wt](x)&&this[W],this[R]=o[R];var p,v,g,b,y=this,E=this.open=!1,I=null,L=function(){var n=e[Ct]();return t[nt]||n[Ft]-Math.abs(n[zt])},C=function(){var e=i.currentStyle||t.getComputedStyle(i),n=parseInt(e[d],10);p&&(i[Pt][d]=n+g+"px")},A=function(){i[Pt][d]=""},S=function(){var t,e=document.createElement("div");return e.className=u+"-scrollbar-measure",i.appendChild(e),t=e[tt]-e[V],i.removeChild(e),t},M=function(){p=i[V]<L(),v=c[ot]>e[Z],g=S()},k=function(){c[Pt][f]=!p&&v?g+"px":"",c[Pt][d]=p&&!v?g+"px":""},D=function(){c[Pt][f]="",c[Pt][d]=""},N=function(){var t=document.createElement("div");b=ee("."+h),null===b&&(t[Et]("class",h+" fade"),b=t,i.appendChild(b))},B=function(){b=ee("."+h),b&&null!==b&&"object"==typeof b&&(i.removeChild(b),b=null)},H=function(){Vt(c,qt)?oe(document,st,F):ie(document,st,F)},P=function(){Vt(c,qt)?oe(t,ft,y.update):ie(t,ft,y.update)},$=function(){Vt(c,qt)?oe(c,ct,j):ie(c,ct,j)},O=function(t){var e=t[z];e=e[It](w)||e[It]("href")?e:e[kt],E||e!==n||Vt(c,qt)||(c.modalTrigger=n,I=n,y.show(),t.preventDefault())},F=function(t){var e=t.which||t.keyCode;y[q]&&27==e&&E&&y.hide()},j=function(t){var e=t[z];E&&(e[kt][wt](r)===u||e[wt](r)===u||e===c&&y[W]!==s)&&(y.hide(),I=null,t.preventDefault())};this.toggle=function(){E&&Vt(c,qt)?this.hide():this.show()},this.show=function(){le.call(c,ht,u,I);var t=te(document,u+" in")[0];t&&t!==c&&t.modalTrigger[m].hide(),this[W]&&N(),b&&!Vt(b,qt)&&setTimeout(function(){Kt(b,qt)},0),setTimeout(function(){c[Pt].display="block",M(),C(),k(),P(),$(),H(),Kt(i,u+"-open"),Kt(c,qt),c[Et](lt,!1)},0),re(c,function(){E=y.open=!0,Jt(c),le.call(c,pt,u,I)})},this.hide=function(){le.call(c,mt,u),b=ee("."+h),null!==b&&Qt(b,qt),Qt(c,qt),c[Et](lt,!0),re(c,function(){Qt(i,u+"-open"),P(),$(),H(),D(),A(),c[Pt].display="",te(document,u+" "+qt)[0]||B(),E=y.open=!1,n&&Jt(n),le.call(c,vt,u)})},this.setContent=function(t){ee("."+u+"-content",c).innerHTML=t},this.update=function(){E&&(M(),C(),k())},!n||m in n||ie(n,ct,O),this[R]&&this.setContent(this[R]),!!n&&(n[m]=this)}};ue(m,we,a);var Ee=function(e,n){e=ee(e);var a=e[wt](M),r=e[wt](k),l=e[wt](N),c=e[wt](S),u=e[wt](B),s=e[wt](D),f="popover",d="template",h="trigger",p="class",m="div",g="fade",b="data-title",y="data-content",x="dismissible",T='<button type="button" class="close">×</button>';n=n||{},this[d]=n[d]?n[d]:null,this[h]=n[h]?n[h]:a||ut,this[_]=n[_]&&n[_]!==g?n[_]:r||g,this[U]=n[U]?n[U]:l||jt,this[$]=parseInt(n[$]||u)||200,this[x]=!(!n[x]&&"true"!==c),this[X]=ee(n[X])||ee(s)||i;var w=this,E=e[wt](b)||null,I=e[wt](y)||null;if(I||this[d]){var L=null,C=0,A=this[U],H=function(t){null!==L&&t[z]===ee(".close",L)&&w.hide()},P=function(){w[X].removeChild(L),C=null,L=null},W=function(){if(E=e[wt](b),I=e[wt](y),L=document.createElement(m),null!==I&&null===w[d]){if(L[Et]("role","tooltip"),null!==E){var t=document.createElement("h3");t[Et](p,f+"-title"),t.innerHTML=w[x]?E+T:E,L.appendChild(t)}var n=document.createElement(m),i=document.createElement(m);n[Et](p,"arrow"),i[Et](p,f+"-content"),L.appendChild(n),L.appendChild(i),i.innerHTML=w[x]&&null===E?I+T:I}else{var o=document.createElement(m);o.innerHTML=w[d],L.innerHTML=o.firstChild.innerHTML}w[X].appendChild(L),L[Pt].display="block",L[Et](p,f+" "+A+" "+w[_])},q=function(){!Vt(L,qt)&&Kt(L,qt)},O=function(){pe(e,L,A,w[X]),de(L)||(A=me(A),pe(e,L,A,w[X]))};this.toggle=function(){null===L?w.show():w.hide()},this.show=function(){clearTimeout(C),C=setTimeout(function(){null===L&&(A=w[U],W(),O(),q(),le.call(e,ht,f),re(L,function(){le.call(e,pt,f)}))},20)},this.hide=function(){clearTimeout(C),C=setTimeout(function(){L&&null!==L&&Vt(L,qt)&&(le.call(e,mt,f),Qt(L,qt),re(L,function(){P(),le.call(e,vt,f)}))},w[$])},v in e||(w[h]===ut?(ie(e,Ut[0],w.show),w[x]||ie(e,Ut[1],w.hide)):/^(click|focus)$/.test(w[h])&&(ie(e,w[h],w.toggle),w[x]||ie(e,"blur",w.hide)),w[x]&&ie(document,ct,H),o&&o<9||ie(t,ft,w.hide)),e[v]=w}};ue(v,Ee,a);var Ie=function(e,n){e=ee(e);var i=ee(e[wt](w));if(n=n||{},n[z]||i){for(var a,r=n[z]&&ee(n[z])||i,l=r&&r[Lt]("A"),c=[],u=[],s=e[et]<e[ot]?e:t,f=s===t,d=0,h=l[Dt];d<h;d++){var p=l[d][wt]("href"),m=p&&/#[a-z0-9]+$/i.test(p)&&ee(p);m&&(c.push(l[d]),u.push(m))}var v=function(t){var n=c[t][kt],i=u[t],o=ne(n,".dropdown"),r=f&&i[Ct](),l=Vt(n,Wt)||!1,s=f?r[jt]+a:i[Y]-(u[t-1]?0:10),d=f?r[_t]+a:u[t+1]?u[t+1][Y]:e[ot],h=a>=s&&d>a;if(!l&&h)"LI"!==n.tagName||Vt(n,Wt)||(Kt(n,Wt),l=!0,o&&!Vt(o,Wt)&&Kt(o,Wt),le.call(e,"activate","scrollspy",c[t]));else if(h){if(!h&&!l||l&&h)return}else"LI"===n.tagName&&Vt(n,Wt)&&(Qt(n,Wt),l=!1,o&&Vt(o,Wt)&&!te(n[kt],Wt).length&&Qt(o,Wt))},b=function(){a=f?he().y:e[K];for(var t=0,n=c[Dt];t<n;t++)v(t)};this.refresh=function(){b()},g in e||(ie(s,dt,this.refresh),o&&o<9||ie(t,ft,this.refresh)),this.refresh(),e[g]=this}};ue(g,Ie,l);var Le=function(t,e){t=ee(t);var n=t[wt](I),i="tab",o="height",a="isAnimating";t[a]=!1,e=e||{},this[o]=!!Yt&&(e[o]||"true"===n);var r,l,c=this,u=ne(t,".nav"),s=ee(".dropdown",u),f=function(){var t,e=te(u,Wt);return 1!==e[Dt]||Vt(e[0],"dropdown")?e[Dt]>1&&(t=e[e[Dt]-1]):t=e[0],t[Lt]("A")[0]},d=function(){return ee(f()[wt]("href"))},h=function(t){t.preventDefault(),r=t[z],c.show()};this.show=function(){var e=ee(r[wt]("href")),n=f(),c=d();n[a]&&r[a]||Vt(r[kt],Wt)||(n[a]=r[a]=!0,Qt(n[kt],Wt),Kt(r[kt],Wt),s&&(Vt(t[kt][kt],"dropdown-menu")?Vt(s,Wt)||Kt(s,Wt):Vt(s,Wt)&&Qt(s,Wt)),l&&(l[Pt][o]=fe(c)+"px"),le.call(n,mt,i,r),setTimeout(function(){Qt(c,qt)},0),re(c,function(){l&&Kt(l,$t),Qt(c,Wt),Kt(e,Wt),setTimeout(function(){Kt(e,qt),l&&(l[Pt][o]=fe(e)+"px")},0),le.call(r,ht,i,n),le.call(n,vt,i,r)}),re(e,function(){le.call(r,pt,i,n),l?setTimeout(function(){re(l,function(){l[Pt][o]="",Qt(l,$t),n[a]=r[a]=!1})},0):n[a]=r[a]=!1}))},b in t||ie(t,ct,h),this[o]&&(l=d()[kt]),t[b]=this};ue(b,Le,a);var Ce=function(t,e){t=ee(t);var n=t[wt](k);placementData=t[wt](N),delayData=t[wt](B),containerData=t[wt](D),component="tooltip",classString="class",title="title",fade="fade",div="div",e=e||{},this[_]=e[_]&&e[_]!==fade?e[_]:n||fade,this[U]=e[U]?e[U]:placementData||jt,this[$]=parseInt(e[$]||delayData)||200,this[X]=ee(e[X])||ee(containerData)||i;var o=this,a=0,r=this[U],l=null,c=t[wt](title)||t[wt](C);if(c){var u=function(){o[X].removeChild(l),l=null,a=null},s=function(){c=t[wt](title)||t[wt](C),l=document.createElement(div),l[Et]("role",component);var e=document.createElement(div),n=document.createElement(div);e[Et](classString,component+"-arrow"),n[Et](classString,component+"-inner"),l.appendChild(e),l.appendChild(n),n.innerHTML=c,o[X].appendChild(l),l[Et](classString,component+" "+r+" "+o[_])},f=function(){pe(t,l,r,o[X]),de(l)||(r=me(r),pe(t,l,r,o[X]))},d=function(){!Vt(l,qt)&&Kt(l,qt)};this.show=function(){clearTimeout(a),a=setTimeout(function(){null===l&&(r=o[U],s(),f(),d(),le.call(t,ht,component),re(l,function(){le.call(t,pt,component)}))},20)},this.hide=function(){clearTimeout(a),a=setTimeout(function(){l&&null!==l&&Vt(l,qt)&&(le.call(t,mt,component),Qt(l,qt),re(l,function(){u(),le.call(t,vt,component)}))},o[$])},this.toggle=function(){l?o.hide():o.show()},y in t||(t[Et](C,c),t.removeAttribute(title),ie(t,Ut[0],this.show),ie(t,Ut[1],this.hide)),t[y]=this}};return ue(y,Ce,a),{Affix:ve,Alert:ge,Button:be,Carousel:ye,Collapse:xe,Dropdown:Te,Modal:we,Popover:Ee,ScrollSpy:Ie,Tab:Le,Tooltip:Ce}})}).call(e,function(){return this}())}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vbXktY29tLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBmYWRiNDgxNzEzMWNjNjBlYzgxNSIsIndlYnBhY2s6Ly8vLi9qcy9sYXlvdXQuanMiLCJ3ZWJwYWNrOi8vLy4vfi9ib290c3RyYXAubmF0aXZlL2Rpc3QvYm9vdHN0cmFwLW5hdGl2ZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfYm9vdHN0cmFwIiwiZG9jdW1lbnQiLCJib2R5IiwiYmxuUmVtb3ZlU3VtYml0IiwiZWxtSW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImJ0blN1bWJpdCIsInF1ZXJ5U2VsZWN0b3IiLCJidG5GaW5kUGVyc29uIiwiZm9yRWFjaCIsImN1cjIiLCJ2YWx1ZSIsInRyaW0iLCJsZW5ndGgiLCJuYW1lIiwic2V0QXR0cmlidXRlIiwiY3VyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImJsblN1bWJpdCIsImludFJpZ2h0IiwiY3VyUGxhY2VkIiwidGVzdCIsInJlbW92ZUF0dHJpYnV0ZSIsImVsZW1lbnQiLCJpbmRleCIsImFycmF5IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIl9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyIsIl9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18iLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyIsImdsb2JhbCIsInJvb3QiLCJmYWN0b3J5IiwiYXBwbHkiLCJ1bmRlZmluZWQiLCJ0aGlzIiwiZ2xvYmFsT2JqZWN0Iiwid2luZG93IiwiZG9jIiwiZG9jdW1lbnRFbGVtZW50IiwiaXNJRSIsIlJlZ0V4cCIsImV4ZWMiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJwYXJzZUZsb2F0IiwiJDEiLCJkYXRhVG9nZ2xlIiwiZGF0YURpc21pc3MiLCJkYXRhU3B5IiwiZGF0YVJpZGUiLCJzdHJpbmdBZmZpeCIsInN0cmluZ0FsZXJ0Iiwic3RyaW5nQnV0dG9uIiwic3RyaW5nQ2Fyb3VzZWwiLCJzdHJpbmdDb2xsYXBzZSIsInN0cmluZ0Ryb3Bkb3duIiwic3RyaW5nTW9kYWwiLCJzdHJpbmdQb3BvdmVyIiwic3RyaW5nU2Nyb2xsU3B5Iiwic3RyaW5nVGFiIiwic3RyaW5nVG9vbHRpcCIsImRhdGFiYWNrZHJvcCIsImRhdGFLZXlib2FyZCIsImRhdGFUYXJnZXQiLCJkYXRhSW50ZXJ2YWwiLCJkYXRhSGVpZ2h0IiwiZGF0YVBhdXNlIiwiZGF0YU9yaWdpbmFsVGl0bGUiLCJkYXRhT3JpZ2luYWxUZXh0IiwiZGF0YURpc21pc3NpYmxlIiwiZGF0YVRyaWdnZXIiLCJkYXRhQW5pbWF0aW9uIiwiZGF0YUNvbnRhaW5lciIsImRhdGFQbGFjZW1lbnQiLCJkYXRhRGVsYXkiLCJkYXRhT2Zmc2V0VG9wIiwiZGF0YU9mZnNldEJvdHRvbSIsImJhY2tkcm9wIiwia2V5Ym9hcmQiLCJkZWxheSIsImR1cmF0aW9uIiwiY29udGVudCIsInRhcmdldCIsImludGVydmFsIiwicGF1c2UiLCJhbmltYXRpb24iLCJwbGFjZW1lbnQiLCJjb250YWluZXIiLCJvZmZzZXRUb3AiLCJvZmZzZXRCb3R0b20iLCJvZmZzZXRMZWZ0Iiwic2Nyb2xsVG9wIiwic2Nyb2xsTGVmdCIsImNsaWVudFdpZHRoIiwiY2xpZW50SGVpZ2h0Iiwib2Zmc2V0V2lkdGgiLCJvZmZzZXRIZWlnaHQiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJzY3JvbGxIZWlnaHQiLCJoZWlnaHQiLCJhcmlhRXhwYW5kZWQiLCJhcmlhSGlkZGVuIiwiY2xpY2tFdmVudCIsImhvdmVyRXZlbnQiLCJrZXlkb3duRXZlbnQiLCJyZXNpemVFdmVudCIsInNjcm9sbEV2ZW50Iiwic2hvd0V2ZW50Iiwic2hvd25FdmVudCIsImhpZGVFdmVudCIsImhpZGRlbkV2ZW50IiwiY2xvc2VFdmVudCIsImNsb3NlZEV2ZW50Iiwic2xpZEV2ZW50Iiwic2xpZGVFdmVudCIsImNoYW5nZUV2ZW50IiwiZ2V0QXR0cmlidXRlIiwiaGFzQXR0cmlidXRlIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJnZXRFbGVtZW50c0J5Q0xBU1NOQU1FIiwiaW5kZXhPZiIsInBhcmVudE5vZGUiLCJ0b0xvd2VyQ2FzZSIsIlRyYW5zaXRpb24iLCJXZWJraXQiLCJzdHlsZSIsImFjdGl2ZSIsImluQ2xhc3MiLCJjb2xsYXBzaW5nIiwiZGlzYWJsZWQiLCJsb2FkaW5nIiwibGVmdCIsInJpZ2h0IiwidG9wIiwiYm90dG9tIiwibW91c2VIb3ZlciIsInRpcFBvc2l0aW9ucyIsInN1cHBvcnRUcmFuc2l0aW9ucyIsInRyYW5zaXRpb25FbmRFdmVudCIsInNldEZvY3VzIiwiZm9jdXMiLCJzZXRBY3RpdmUiLCJhZGRDbGFzcyIsImNsYXNzTkFNRSIsInJlbW92ZUNsYXNzIiwiaGFzQ2xhc3MiLCJjb250YWlucyIsIm5vZGVMaXN0VG9BcnJheSIsIm5vZGVMaXN0IiwiY2hpbGRJdGVtcyIsImkiLCJubGwiLCJwdXNoIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInNlbGVjdGlvbk1ldGhvZCIsInJlcGxhY2UiLCJxdWVyeUVsZW1lbnQiLCJzZWxlY3RvciIsInBhcmVudCIsImxvb2tVcCIsImdldENsb3Nlc3QiLCJmaXJzdENoYXIiLCJjaGFyQXQiLCJzdWJzdHIiLCJvbiIsImhhbmRsZXIiLCJvZmYiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwib25lIiwiaGFuZGxlcldyYXBwZXIiLCJlbXVsYXRlVHJhbnNpdGlvbkVuZCIsImJvb3RzdHJhcEN1c3RvbUV2ZW50IiwiZXZlbnROYW1lIiwiY29tcG9uZW50TmFtZSIsInJlbGF0ZWQiLCJPcmlnaW5hbEN1c3RvbUV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJyZWxhdGVkVGFyZ2V0IiwiZGlzcGF0Y2hFdmVudCIsIkFsbERPTUVsZW1lbnRzIiwiaW5pdGlhbGl6ZURhdGFBUEkiLCJjb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsImRhdGFBdHRyaWJ1dGUiLCJjb2xsZWN0aW9uIiwiYXR0clZhbHVlIiwiZXhwZWN0ZWRBdHRyVmFsdWUiLCJnZXRPdXRlckhlaWdodCIsImNoaWxkIiwiY2hpbGRTdHlsZSIsImN1cnJlbnRTdHlsZSIsImdldENvbXB1dGVkU3R5bGUiLCJidHAiLCJib3JkZXJUb3BXaWR0aCIsIk1hdGgiLCJyb3VuZCIsImJ0YiIsImJvcmRlckJvdHRvbVdpZHRoIiwibXRwIiwibWFyZ2luVG9wIiwibWJwIiwibWFyZ2luQm90dG9tIiwicGFyc2VJbnQiLCJnZXRNYXhIZWlnaHQiLCJwYXJlbnRIZWlnaHQiLCJrIiwibGwiLCJjaGlsZHJlbiIsImlzRWxlbWVudEluVmlld3BvcnQiLCJyZWN0IiwiZ2V0U2Nyb2xsIiwieSIsInBhZ2VZT2Zmc2V0IiwieCIsInBhZ2VYT2Zmc2V0Iiwic3R5bGVUaXAiLCJsaW5rIiwicG9zaXRpb24iLCJzY3JvbGwiLCJsaW5rRGltZW5zaW9ucyIsInciLCJoIiwiZWxlbWVudERpbWVuc2lvbnMiLCJjbGFzc05hbWUiLCJ1cGRhdGVQbGFjZW1lbnQiLCJBZmZpeCIsIm9wdGlvbnMiLCJ0YXJnZXREYXRhIiwib2Zmc2V0VG9wRGF0YSIsIm9mZnNldEJvdHRvbURhdGEiLCJhZmZpeCIsImFmZml4ZWQiLCJmbiIsInVwZGF0ZSIsImFmZml4VG9wIiwiYWZmaXhlZFRvcCIsImFmZml4Qm90dG9tIiwiYWZmaXhlZEJvdHRvbSIsInBpbk9mZnNldFRvcCIsInBpbk9mZnNldEJvdHRvbSIsIm1heFNjcm9sbCIsInNjcm9sbFkiLCJwaW5uZWRUb3AiLCJwaW5uZWRCb3R0b20iLCJzZWxmIiwicmVzaXplRGVsYXkiLCJhZmZpeGVkVG9Ub3AiLCJhZmZpeGVkVG9Cb3R0b20iLCJnZXRNYXhTY3JvbGwiLCJtYXgiLCJnZXRPZmZzZXRUb3AiLCJnZXRPZmZzZXRCb3R0b20iLCJjaGVja1Bvc2l0aW9uIiwicGluVG9wIiwidW5QaW5Ub3AiLCJwaW5Cb3R0b20iLCJ1blBpbkJvdHRvbSIsInVwZGF0ZVBpbiIsInNldFRpbWVvdXQiLCJBbGVydCIsImFsZXJ0IiwiY2xpY2tIYW5kbGVyIiwiZSIsImV2ZW50VGFyZ2V0IiwiY2xvc2UiLCJ0cmFuc2l0aW9uRW5kSGFuZGxlciIsInJlbW92ZUNoaWxkIiwiQnV0dG9uIiwib3B0aW9uIiwidG9nZ2xlZCIsImNoZWNrZWQiLCJyZXNldCIsIkxBQkVMIiwiSU5QVVQiLCJzZXRTdGF0ZSIsImlubmVySFRNTCIsInJlc2V0U3RhdGUiLCJ0b2dnbGUiLCJsYWJlbCIsInRhZ05hbWUiLCJsYWJlbHMiLCJpbnB1dCIsInR5cGUiLCJvdGhlckxhYmVsIiwib3RoZXJJbnB1dCIsIkNhcm91c2VsIiwiaW50ZXJ2YWxEYXRhIiwicGF1c2VEYXRhIiwia2V5Ym9hcmREYXRhIiwicGF1c2VkIiwiZGlyZWN0aW9uIiwiZGF0YVNsaWRlVG8iLCJ0aW1lciIsImlzU2xpZGluZyIsInNsaWRlcyIsInRvdGFsIiwic2xpZGVEaXJlY3Rpb24iLCJjb250cm9scyIsImxlZnRBcnJvdyIsInJpZ2h0QXJyb3ciLCJpbmRpY2F0b3IiLCJpbmRpY2F0b3JzIiwicGF1c2VIYW5kbGVyIiwiY2xlYXJJbnRlcnZhbCIsInJlc3VtZUhhbmRsZXIiLCJjeWNsZSIsImluZGljYXRvckhhbmRsZXIiLCJhY3RpdmVJbmRpY2F0b3IiLCJnZXRBY3RpdmVJbmRleCIsInNsaWRlVG8iLCJjb250cm9sc0hhbmRsZXIiLCJjdXJyZW50VGFyZ2V0Iiwic3JjRWxlbWVudCIsImtleUhhbmRsZXIiLCJ3aGljaCIsInNldEFjdGl2ZVBhZ2UiLCJwYWdlSW5kZXgiLCJpY2wiLCJzZXRJbnRlcnZhbCIsIm5leHQiLCJhY3RpdmVJdGVtIiwib3JpZW50YXRpb24iLCJDb2xsYXBzZSIsImFjY29yZGlvbiIsImNvbGxhcHNlIiwiaXNBbmltYXRpbmciLCJhY2NvcmRpb25EYXRhIiwiY29sbGFwc2VkIiwib3BlbkFjdGlvbiIsImNvbGxhcHNlRWxlbWVudCIsImNsb3NlQWN0aW9uIiwiZ2V0VGFyZ2V0IiwiaHJlZiIsImhpZGUiLCJzaG93IiwiYWN0aXZlQ29sbGFwc2VzIiwiYWwiLCJEcm9wZG93biIsInBlcnNpc3QiLCJpc09wZW4iLCJvcGVuIiwibWVudSIsImtleUNvZGUiLCJoYXNEYXRhIiwibm9kZVR5cGUiLCJNb2RhbCIsImJ0bkNoZWNrIiwiY2hlY2tNb2RhbCIsIm1vZGFsIiwic3RhdGljU3RyaW5nIiwicGFkZGluZ0xlZnQiLCJwYWRkaW5nUmlnaHQiLCJtb2RhbEJhY2tkcm9wU3RyaW5nIiwiYm9keUlzT3ZlcmZsb3dpbmciLCJtb2RhbElzT3ZlcmZsb3dpbmciLCJzY3JvbGxiYXJXaWR0aCIsIm92ZXJsYXkiLCJnZXRXaW5kb3dXaWR0aCIsImh0bWxSZWN0IiwiYWJzIiwic2V0U2Nyb2xsYmFyIiwiYm9keVN0eWxlIiwiYm9keVBhZCIsInJlc2V0U2Nyb2xsYmFyIiwibWVhc3VyZVNjcm9sbGJhciIsInNjcm9sbEJhcldpZHRoIiwic2Nyb2xsRGl2IiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiY2hlY2tTY3JvbGxiYXIiLCJhZGp1c3REaWFsb2ciLCJyZXNldEFkanVzdG1lbnRzIiwiY3JlYXRlT3ZlcmxheSIsIm5ld092ZXJsYXkiLCJyZW1vdmVPdmVybGF5Iiwia2V5ZG93bkhhbmRsZXJUb2dnbGUiLCJyZXNpemVIYW5kbGVyVG9nZ2xlIiwiZGlzbWlzc0hhbmRsZXJUb2dnbGUiLCJkaXNtaXNzSGFuZGxlciIsImNsaWNrVGFyZ2V0IiwibW9kYWxUcmlnZ2VyIiwia2V5IiwiY3VycmVudE9wZW4iLCJkaXNwbGF5Iiwic2V0Q29udGVudCIsIlBvcG92ZXIiLCJ0cmlnZ2VyRGF0YSIsImFuaW1hdGlvbkRhdGEiLCJwbGFjZW1lbnREYXRhIiwiZGlzbWlzc2libGVEYXRhIiwiZGVsYXlEYXRhIiwiY29udGFpbmVyRGF0YSIsInRlbXBsYXRlIiwidHJpZ2dlciIsImNsYXNzU3RyaW5nIiwiZGl2IiwiZmFkZSIsImRhdGFUaXRsZSIsImRhdGFDb250ZW50IiwiZGlzbWlzc2libGUiLCJjbG9zZUJ0biIsInRpdGxlU3RyaW5nIiwiY29udGVudFN0cmluZyIsInBvcG92ZXIiLCJwbGFjZW1lbnRTZXR0aW5nIiwiZGlzbWlzc2libGVIYW5kbGVyIiwicmVtb3ZlUG9wb3ZlciIsImNyZWF0ZVBvcG92ZXIiLCJwb3BvdmVyVGl0bGUiLCJwb3BvdmVyQXJyb3ciLCJwb3BvdmVyQ29udGVudCIsInBvcG92ZXJUZW1wbGF0ZSIsImZpcnN0Q2hpbGQiLCJzaG93UG9wb3ZlciIsInVwZGF0ZVBvcG92ZXIiLCJjbGVhclRpbWVvdXQiLCJTY3JvbGxTcHkiLCJzY3JvbGxPZmZzZXQiLCJzcHlUYXJnZXQiLCJsaW5rcyIsIml0ZW1zIiwidGFyZ2V0SXRlbXMiLCJzY3JvbGxUYXJnZXQiLCJpc1dpbmRvdyIsImlsIiwidGFyZ2V0SXRlbSIsInVwZGF0ZUl0ZW0iLCJkcm9wZG93biIsInRhcmdldFJlY3QiLCJpc0FjdGl2ZSIsInRvcEVkZ2UiLCJib3R0b21FZGdlIiwiaW5zaWRlIiwidXBkYXRlSXRlbXMiLCJpdGwiLCJyZWZyZXNoIiwiVGFiIiwiaGVpZ2h0RGF0YSIsInRhYnNDb250ZW50Q29udGFpbmVyIiwidGFicyIsImdldEFjdGl2ZVRhYiIsImFjdGl2ZVRhYiIsImFjdGl2ZVRhYnMiLCJnZXRBY3RpdmVDb250ZW50IiwibmV4dENvbnRlbnQiLCJhY3RpdmVDb250ZW50IiwiVG9vbHRpcCIsInRpdGxlIiwidG9vbHRpcCIsInJlbW92ZVRvb2xUaXAiLCJjcmVhdGVUb29sVGlwIiwidG9vbHRpcEFycm93IiwidG9vbHRpcElubmVyIiwidXBkYXRlVG9vbHRpcCIsInNob3dUb29sdGlwIl0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxH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YixPQUNBM1IsR0FBQXBKLEVBQUF1SCxHQUFBLEdBQUF2RyxLQUFBOFMsTUFDQTFLLEdBQUFwSixFQUFBdUgsR0FBQSxHQUFBdkcsS0FBQTZTLE9BRUE3VCxFQUFBMEMsR0FBQTFCLE1BUUEsT0FIQW9KLElBQUExSCxFQUFBb1ksR0FBQWxaLElBSUFxTCxTQUNBa0MsU0FDQVEsVUFDQWtCLFlBQ0FxQyxZQUNBZSxZQUNBUSxTQUNBd0MsV0FDQStCLGFBQ0FvQixPQUNBVSxnQkhtSThCN2MsS0FBS0osRUFBVSxXQUFhLE1BQU9tRCIsImZpbGUiOiJteS1jb20uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBfYm9vdHN0cmFwID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfYm9vdHN0cmFwMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jvb3RzdHJhcCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0aWYgKGRvY3VtZW50LmJvZHkuaWQgPT0gJ2ZpbmRQZXJzb25Cb2R5Jykge1xuXHQgICAgKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgYmxuUmVtb3ZlU3VtYml0ID0gdHJ1ZTtcblx0ICAgICAgICB2YXIgZWxtSW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3NlYXJjaFBlcnNvbiBpbnB1dCcpO1xuXHQgICAgICAgIHZhciBidG5TdW1iaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ZpbmRQZXJzb25cIik7XG5cdCAgICAgICAgdmFyIGJ0bkZpbmRQZXJzb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VhcmNoUGhvbmUnKTtcblx0XG5cdCAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGN1cjIpIHtcblx0ICAgICAgICAgICAgaWYgKGN1cjIudmFsdWUudHJpbSgpLmxlbmd0aCA9PSAwICYmIChjdXIyLm5hbWUgPT0gJ0xOYW1lJyB8fCBjdXIyLm5hbWUgPT0gJ0ZOYW1lJykpIHtcblx0ICAgICAgICAgICAgICAgIGJsblJlbW92ZVN1bWJpdCA9IGZhbHNlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGJsblJlbW92ZVN1bWJpdCA9PT0gZmFsc2UgPyBidG5TdW1iaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpIDogbnVsbDtcblx0XG5cdCAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGN1cikge1xuXHQgICAgICAgICAgICBjdXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgYmxuU3VtYml0ID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgIHZhciBpbnRSaWdodCA9IDA7XG5cdFxuXHQgICAgICAgICAgICAgICAgZWxtSW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGN1clBsYWNlZCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGN1clBsYWNlZC52YWx1ZS50cmltKCkubGVuZ3RoICE9IDAgJiYgKGN1clBsYWNlZC5uYW1lID09ICdMTmFtZScgfHwgY3VyUGxhY2VkLm5hbWUgPT0gJ0ZOYW1lJykgPyBpbnRSaWdodCsrIDogbnVsbDtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgL15bMS05XXsxfVxcZHszfS1cXGR7Mn0tXFxkezJ9JC8udGVzdChjdXJQbGFjZWQudmFsdWUudHJpbSgpKSA9PSB0cnVlICYmIGN1clBsYWNlZC5uYW1lID09ICdET0InID8gaW50UmlnaHQrKyA6IG51bGw7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgIGlmIChpbnRSaWdodCA9PT0gMykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBibG5TdW1iaXQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBidG5GaW5kUGVyc29uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCwgYXJyYXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA8PSAyKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdteUVycm9yJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGJsblN1bWJpdCA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBlbG1JbnB1dHMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCwgaW5kZXgsIGFycmF5KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPD0gMikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbXlFcnJvcicpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgYnRuRmluZFBlcnNvbi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICAgICAgYmxuU3VtYml0ID09PSB0cnVlID8gYnRuU3VtYml0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKSA6IGJ0blN1bWJpdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBidG5GaW5kUGVyc29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdCAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhY3Rpb24nKS52YWx1ZSA9IFwic2VhcmNoQnlQaG9uZVwiO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYnRuQ2xlYXInKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgICAgICBlbG1JbnB1dHMuZm9yRWFjaChmdW5jdGlvbiAoY3VyKSB7XG5cdCAgICAgICAgICAgICAgICBjdXIudmFsdWUgPSAnJztcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICB9KSgpO1xuXHR9IC8qXG5cdCAgZnVuY3Rpb24gY2hlY2tWYWx1ZXMgKGVsbU5hbWUpIHtcblx0ICAgICAgYWxlcnQoZWxtTmFtZSk7XG5cdCAgfVxuXHQgIFxuXHQgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzZWFyY2hQZXJzb24gaW5wdXQnKS5mb3JFYWNoKChjdXIpID0+IHtcblx0ICAgICAgY3VyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgY2hlY2tWYWx1ZXMoJyNzZWFyY2hQZXJzb24nKSk7XG5cdCAgfSk7Ki9cblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihnbG9iYWwpIHsvLyBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgdjIuMC40IHwgwqkgZG5wX3RoZW1lIHwgTUlULUxpY2Vuc2Vcblx0KGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG5cdCAgaWYgKHRydWUpIHtcblx0ICAgIC8vIEFNRCBzdXBwb3J0OlxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW10sIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9IChmYWN0b3J5KSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSAodHlwZW9mIF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyA9PT0gJ2Z1bmN0aW9uJyA/IChfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXykpIDogX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0ICAgIC8vIENvbW1vbkpTLWxpa2U6XG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gQnJvd3NlciBnbG9iYWxzIChyb290IGlzIHdpbmRvdylcblx0ICAgIHZhciBic24gPSBmYWN0b3J5KCk7XG5cdCAgICByb290LkFmZml4ID0gYnNuLkFmZml4O1xuXHQgICAgcm9vdC5BbGVydCA9IGJzbi5BbGVydDtcblx0ICAgIHJvb3QuQnV0dG9uID0gYnNuLkJ1dHRvbjtcblx0ICAgIHJvb3QuQ2Fyb3VzZWwgPSBic24uQ2Fyb3VzZWw7XG5cdCAgICByb290LkNvbGxhcHNlID0gYnNuLkNvbGxhcHNlO1xuXHQgICAgcm9vdC5Ecm9wZG93biA9IGJzbi5Ecm9wZG93bjtcblx0ICAgIHJvb3QuTW9kYWwgPSBic24uTW9kYWw7XG5cdCAgICByb290LlBvcG92ZXIgPSBic24uUG9wb3Zlcjtcblx0ICAgIHJvb3QuU2Nyb2xsU3B5ID0gYnNuLlNjcm9sbFNweTtcblx0ICAgIHJvb3QuVGFiID0gYnNuLlRhYjtcblx0ICAgIHJvb3QuVG9vbHRpcCA9IGJzbi5Ub29sdGlwO1xuXHQgIH1cblx0fSh0aGlzLCBmdW5jdGlvbiAoKSB7XG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgSW50ZXJuYWwgVXRpbGl0eSBGdW5jdGlvbnNcblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBnbG9iYWxzXG5cdCAgdmFyIGdsb2JhbE9iamVjdCA9IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdGhpc3x8d2luZG93LFxuXHQgICAgZG9jID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBib2R5ID0gZG9jdW1lbnQuYm9keSxcblx0ICBcblx0ICAgIC8vIElFIGJyb3dzZXIgZGV0ZWN0XG5cdCAgICBpc0lFID0gKG5ldyBSZWdFeHAoXCJNU0lFIChbMC05XXsxLH1bXFwuMC05XXswLH0pXCIpLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudCkgIT0gbnVsbCkgPyBwYXJzZUZsb2F0KCBSZWdFeHAuJDEgKSA6IGZhbHNlLCAgXG5cdCAgXG5cdCAgICAvLyBmdW5jdGlvbiB0b2dnbGUgYXR0cmlidXRlc1xuXHQgICAgZGF0YVRvZ2dsZSAgICA9ICdkYXRhLXRvZ2dsZScsXG5cdCAgICBkYXRhRGlzbWlzcyAgID0gJ2RhdGEtZGlzbWlzcycsXG5cdCAgICBkYXRhU3B5ICAgICAgID0gJ2RhdGEtc3B5Jyxcblx0ICAgIGRhdGFSaWRlICAgICAgPSAnZGF0YS1yaWRlJyxcblx0ICAgIFxuXHQgICAgLy8gY29tcG9uZW50c1xuXHQgICAgc3RyaW5nQWZmaXggICAgID0gJ0FmZml4Jyxcblx0ICAgIHN0cmluZ0FsZXJ0ICAgICA9ICdBbGVydCcsXG5cdCAgICBzdHJpbmdCdXR0b24gICAgPSAnQnV0dG9uJyxcblx0ICAgIHN0cmluZ0Nhcm91c2VsICA9ICdDYXJvdXNlbCcsXG5cdCAgICBzdHJpbmdDb2xsYXBzZSAgPSAnQ29sbGFwc2UnLFxuXHQgICAgc3RyaW5nRHJvcGRvd24gID0gJ0Ryb3Bkb3duJyxcblx0ICAgIHN0cmluZ01vZGFsICAgICA9ICdNb2RhbCcsXG5cdCAgICBzdHJpbmdQb3BvdmVyICAgPSAnUG9wb3ZlcicsXG5cdCAgICBzdHJpbmdTY3JvbGxTcHkgPSAnU2Nyb2xsU3B5Jyxcblx0ICAgIHN0cmluZ1RhYiAgICAgICA9ICdUYWInLFxuXHQgICAgc3RyaW5nVG9vbHRpcCAgID0gJ1Rvb2x0aXAnLFxuXHQgIFxuXHQgICAgLy8gb3B0aW9ucyBEQVRBIEFQSVxuXHQgICAgZGF0YWJhY2tkcm9wICAgICAgPSAnZGF0YS1iYWNrZHJvcCcsXG5cdCAgICBkYXRhS2V5Ym9hcmQgICAgICA9ICdkYXRhLWtleWJvYXJkJyxcblx0ICAgIGRhdGFUYXJnZXQgICAgICAgID0gJ2RhdGEtdGFyZ2V0Jyxcblx0ICAgIGRhdGFJbnRlcnZhbCAgICAgID0gJ2RhdGEtaW50ZXJ2YWwnLFxuXHQgICAgZGF0YUhlaWdodCAgICAgICAgPSAnZGF0YS1oZWlnaHQnLFxuXHQgICAgZGF0YVBhdXNlICAgICAgICAgPSAnZGF0YS1wYXVzZScsXG5cdCAgICBkYXRhT3JpZ2luYWxUaXRsZSA9ICdkYXRhLW9yaWdpbmFsLXRpdGxlJyxcblx0ICAgIGRhdGFPcmlnaW5hbFRleHQgID0gJ2RhdGEtb3JpZ2luYWwtdGV4dCcsXG5cdCAgICBkYXRhRGlzbWlzc2libGUgICA9ICdkYXRhLWRpc21pc3NpYmxlJyxcblx0ICAgIGRhdGFUcmlnZ2VyICAgICAgID0gJ2RhdGEtdHJpZ2dlcicsXG5cdCAgICBkYXRhQW5pbWF0aW9uICAgICA9ICdkYXRhLWFuaW1hdGlvbicsXG5cdCAgICBkYXRhQ29udGFpbmVyICAgICA9ICdkYXRhLWNvbnRhaW5lcicsXG5cdCAgICBkYXRhUGxhY2VtZW50ICAgICA9ICdkYXRhLXBsYWNlbWVudCcsXG5cdCAgICBkYXRhRGVsYXkgICAgICAgICA9ICdkYXRhLWRlbGF5Jyxcblx0ICAgIGRhdGFPZmZzZXRUb3AgICAgID0gJ2RhdGEtb2Zmc2V0LXRvcCcsXG5cdCAgICBkYXRhT2Zmc2V0Qm90dG9tICA9ICdkYXRhLW9mZnNldC1ib3R0b20nLFxuXHQgIFxuXHQgICAgLy8gb3B0aW9uIGtleXNcblx0ICAgIGJhY2tkcm9wID0gJ2JhY2tkcm9wJywga2V5Ym9hcmQgPSAna2V5Ym9hcmQnLCBkZWxheSA9ICdkZWxheScsXG5cdCAgICBkdXJhdGlvbiA9ICdkdXJhdGlvbicsIGNvbnRlbnQgPSAnY29udGVudCcsIHRhcmdldCA9ICd0YXJnZXQnLCBcblx0ICAgIGludGVydmFsID0gJ2ludGVydmFsJywgcGF1c2UgPSAncGF1c2UnLCBhbmltYXRpb24gPSAnYW5pbWF0aW9uJyxcblx0ICAgIHBsYWNlbWVudCA9ICdwbGFjZW1lbnQnLCBjb250YWluZXIgPSAnY29udGFpbmVyJywgXG5cdCAgXG5cdCAgICAvLyBib3ggbW9kZWxcblx0ICAgIG9mZnNldFRvcCAgICA9ICdvZmZzZXRUb3AnLCAgICAgIG9mZnNldEJvdHRvbSAgID0gJ29mZnNldEJvdHRvbScsXG5cdCAgICBvZmZzZXRMZWZ0ICAgPSAnb2Zmc2V0TGVmdCcsXG5cdCAgICBzY3JvbGxUb3AgICAgPSAnc2Nyb2xsVG9wJywgICAgICBzY3JvbGxMZWZ0ICAgICA9ICdzY3JvbGxMZWZ0Jyxcblx0ICAgIGNsaWVudFdpZHRoICA9ICdjbGllbnRXaWR0aCcsICAgIGNsaWVudEhlaWdodCAgID0gJ2NsaWVudEhlaWdodCcsXG5cdCAgICBvZmZzZXRXaWR0aCAgPSAnb2Zmc2V0V2lkdGgnLCAgICBvZmZzZXRIZWlnaHQgICA9ICdvZmZzZXRIZWlnaHQnLFxuXHQgICAgaW5uZXJXaWR0aCAgID0gJ2lubmVyV2lkdGgnLCAgICAgaW5uZXJIZWlnaHQgICAgPSAnaW5uZXJIZWlnaHQnLFxuXHQgICAgc2Nyb2xsSGVpZ2h0ID0gJ3Njcm9sbEhlaWdodCcsICAgaGVpZ2h0ICAgICAgICAgPSAnaGVpZ2h0Jyxcblx0ICBcblx0ICAgIC8vIGFyaWFcblx0ICAgIGFyaWFFeHBhbmRlZCA9ICdhcmlhLWV4cGFuZGVkJyxcblx0ICAgIGFyaWFIaWRkZW4gICA9ICdhcmlhLWhpZGRlbicsXG5cdCAgXG5cdCAgICAvLyBldmVudCBuYW1lc1xuXHQgICAgY2xpY2tFdmVudCAgICA9ICdjbGljaycsXG5cdCAgICBob3ZlckV2ZW50ICAgID0gJ2hvdmVyJyxcblx0ICAgIGtleWRvd25FdmVudCAgPSAna2V5ZG93bicsXG5cdCAgICByZXNpemVFdmVudCAgID0gJ3Jlc2l6ZScsXG5cdCAgICBzY3JvbGxFdmVudCAgID0gJ3Njcm9sbCcsXG5cdCAgICAvLyBvcmlnaW5hbEV2ZW50c1xuXHQgICAgc2hvd0V2ZW50ICAgICA9ICdzaG93Jyxcblx0ICAgIHNob3duRXZlbnQgICAgPSAnc2hvd24nLFxuXHQgICAgaGlkZUV2ZW50ICAgICA9ICdoaWRlJyxcblx0ICAgIGhpZGRlbkV2ZW50ICAgPSAnaGlkZGVuJyxcblx0ICAgIGNsb3NlRXZlbnQgICAgPSAnY2xvc2UnLFxuXHQgICAgY2xvc2VkRXZlbnQgICA9ICdjbG9zZWQnLFxuXHQgICAgc2xpZEV2ZW50ICAgICA9ICdzbGlkJyxcblx0ICAgIHNsaWRlRXZlbnQgICAgPSAnc2xpZGUnLFxuXHQgICAgY2hhbmdlRXZlbnQgICA9ICdjaGFuZ2UnLFxuXHQgIFxuXHQgICAgLy8gb3RoZXJcblx0ICAgIGdldEF0dHJpYnV0ZSAgICAgICAgID0gJ2dldEF0dHJpYnV0ZScsXG5cdCAgICBzZXRBdHRyaWJ1dGUgICAgICAgICA9ICdzZXRBdHRyaWJ1dGUnLFxuXHQgICAgaGFzQXR0cmlidXRlICAgICAgICAgPSAnaGFzQXR0cmlidXRlJyxcblx0ICAgIGdldEVsZW1lbnRzQnlUYWdOYW1lID0gJ2dldEVsZW1lbnRzQnlUYWdOYW1lJyxcblx0ICAgIGdldEJvdW5kaW5nQ2xpZW50UmVjdD0gJ2dldEJvdW5kaW5nQ2xpZW50UmVjdCcsXG5cdCAgICBxdWVyeVNlbGVjdG9yQWxsICAgICA9ICdxdWVyeVNlbGVjdG9yQWxsJyxcblx0ICAgIGdldEVsZW1lbnRzQnlDTEFTU05BTUUgPSAnZ2V0RWxlbWVudHNCeUNsYXNzTmFtZScsXG5cdCAgXG5cdCAgICBpbmRleE9mICAgICAgPSAnaW5kZXhPZicsXG5cdCAgICBwYXJlbnROb2RlICAgPSAncGFyZW50Tm9kZScsXG5cdCAgICBsZW5ndGggICAgICAgPSAnbGVuZ3RoJyxcblx0ICAgIHRvTG93ZXJDYXNlICA9ICd0b0xvd2VyQ2FzZScsXG5cdCAgICBUcmFuc2l0aW9uICAgPSAnVHJhbnNpdGlvbicsXG5cdCAgICBXZWJraXQgICAgICAgPSAnV2Via2l0Jyxcblx0ICAgIHN0eWxlICAgICAgICA9ICdzdHlsZScsXG5cdCAgICBcblx0ICAgIGFjdGl2ZSAgICAgPSAnYWN0aXZlJyxcblx0ICAgIGluQ2xhc3MgICAgPSAnaW4nLFxuXHQgICAgY29sbGFwc2luZyA9ICdjb2xsYXBzaW5nJyxcblx0ICAgIGRpc2FibGVkICAgPSAnZGlzYWJsZWQnLFxuXHQgICAgbG9hZGluZyAgICA9ICdsb2FkaW5nJyxcblx0ICAgIGxlZnQgICAgICAgPSAnbGVmdCcsXG5cdCAgICByaWdodCAgICAgID0gJ3JpZ2h0Jyxcblx0ICAgIHRvcCAgICAgICAgPSAndG9wJyxcblx0ICAgIGJvdHRvbSAgICAgPSAnYm90dG9tJyxcblx0ICBcblx0ICAgIC8vIHRvb2x0aXAgLyBwb3BvdmVyXG5cdCAgICBtb3VzZUhvdmVyID0gKCdvbm1vdXNlbGVhdmUnIGluIGRvY3VtZW50KSA/IFsgJ21vdXNlZW50ZXInLCAnbW91c2VsZWF2ZSddIDogWyAnbW91c2VvdmVyJywgJ21vdXNlb3V0JyBdLFxuXHQgICAgdGlwUG9zaXRpb25zID0gL1xcYih0b3B8Ym90dG9tfGxlZnR8dG9wKSsvLFxuXHQgIFxuXHQgICAgLy8gdHJhbnNpdGlvbkVuZCBzaW5jZSAyLjAuNFxuXHQgICAgc3VwcG9ydFRyYW5zaXRpb25zID0gV2Via2l0K1RyYW5zaXRpb24gaW4gZG9jW3N0eWxlXSB8fCBUcmFuc2l0aW9uW3RvTG93ZXJDYXNlXSgpIGluIGRvY1tzdHlsZV0sXG5cdCAgICB0cmFuc2l0aW9uRW5kRXZlbnQgPSBXZWJraXQrVHJhbnNpdGlvbiBpbiBkb2Nbc3R5bGVdID8gV2Via2l0W3RvTG93ZXJDYXNlXSgpK1RyYW5zaXRpb24rJ0VuZCcgOiBUcmFuc2l0aW9uW3RvTG93ZXJDYXNlXSgpKydlbmQnLFxuXHQgICAgXG5cdCAgXG5cdCAgICAvLyBzZXQgbmV3IGZvY3VzIGVsZW1lbnQgc2luY2UgMi4wLjNcblx0ICAgIHNldEZvY3VzID0gZnVuY3Rpb24oZWxlbWVudCl7XG5cdCAgICAgIGVsZW1lbnQuZm9jdXMgPyBlbGVtZW50LmZvY3VzKCkgOiBlbGVtZW50LnNldEFjdGl2ZSgpO1xuXHQgICAgfSxcblx0ICBcblx0ICAgIC8vIGNsYXNzIG1hbmlwdWxhdGlvbiwgc2luY2UgMi4wLjAgcmVxdWlyZXMgcG9seWZpbGwuanNcblx0ICAgIGFkZENsYXNzID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpIHtcblx0ICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTkFNRSk7XG5cdCAgICB9LFxuXHQgICAgcmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LGNsYXNzTkFNRSkge1xuXHQgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOQU1FKTtcblx0ICAgIH0sXG5cdCAgICBoYXNDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKXsgLy8gc2luY2UgMi4wLjBcblx0ICAgICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTkFNRSk7XG5cdCAgICB9LFxuXHQgIFxuXHQgICAgLy8gc2VsZWN0aW9uIG1ldGhvZHNcblx0ICAgIG5vZGVMaXN0VG9BcnJheSA9IGZ1bmN0aW9uKG5vZGVMaXN0KXtcblx0ICAgICAgdmFyIGNoaWxkSXRlbXMgPSBbXTsgZm9yICh2YXIgaSA9IDAsIG5sbCA9IG5vZGVMaXN0W2xlbmd0aF07IGk8bmxsOyBpKyspIHsgY2hpbGRJdGVtcy5wdXNoKCBub2RlTGlzdFtpXSApIH1cblx0ICAgICAgcmV0dXJuIGNoaWxkSXRlbXM7XG5cdCAgICB9LFxuXHQgICAgZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKSB7IC8vIGdldEVsZW1lbnRzQnlDbGFzc05hbWUgSUU4K1xuXHQgICAgICB2YXIgc2VsZWN0aW9uTWV0aG9kID0gaXNJRSA9PT0gOCA/IHF1ZXJ5U2VsZWN0b3JBbGwgOiBnZXRFbGVtZW50c0J5Q0xBU1NOQU1FOyAgICAgIFxuXHQgICAgICByZXR1cm4gbm9kZUxpc3RUb0FycmF5KGVsZW1lbnRbc2VsZWN0aW9uTWV0aG9kXSggaXNJRSA9PT0gOCA/ICcuJyArIGNsYXNzTkFNRS5yZXBsYWNlKC9cXHMoPz1bYS16XSkvZywnLicpIDogY2xhc3NOQU1FICkpO1xuXHQgICAgfSxcblx0ICAgIHF1ZXJ5RWxlbWVudCA9IGZ1bmN0aW9uIChzZWxlY3RvciwgcGFyZW50KSB7XG5cdCAgICAgIHZhciBsb29rVXAgPSBwYXJlbnQgPyBwYXJlbnQgOiBkb2N1bWVudDtcblx0ICAgICAgcmV0dXJuIHR5cGVvZiBzZWxlY3RvciA9PT0gJ29iamVjdCcgPyBzZWxlY3RvciA6IGxvb2tVcC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcblx0ICAgIH0sXG5cdCAgICBnZXRDbG9zZXN0ID0gZnVuY3Rpb24gKGVsZW1lbnQsIHNlbGVjdG9yKSB7IC8vZWxlbWVudCBpcyB0aGUgZWxlbWVudCBhbmQgc2VsZWN0b3IgaXMgZm9yIHRoZSBjbG9zZXN0IHBhcmVudCBlbGVtZW50IHRvIGZpbmRcblx0ICAgIC8vIHNvdXJjZSBodHRwOi8vZ29tYWtldGhpbmdzLmNvbS9jbGltYmluZy11cC1hbmQtZG93bi10aGUtZG9tLXRyZWUtd2l0aC12YW5pbGxhLWphdmFzY3JpcHQvXG5cdCAgICAgIHZhciBmaXJzdENoYXIgPSBzZWxlY3Rvci5jaGFyQXQoMCk7XG5cdCAgICAgIGZvciAoIDsgZWxlbWVudCAmJiBlbGVtZW50ICE9PSBkb2N1bWVudDsgZWxlbWVudCA9IGVsZW1lbnRbcGFyZW50Tm9kZV0gKSB7Ly8gR2V0IGNsb3Nlc3QgbWF0Y2hcblx0ICAgICAgICBpZiAoIGZpcnN0Q2hhciA9PT0gJy4nIHx8IGZpcnN0Q2hhciAhPT0gJyMnKSB7Ly8gSWYgc2VsZWN0b3IgaXMgYSBjbGFzc1xuXHQgICAgICAgICAgaWYgKCBxdWVyeUVsZW1lbnQoc2VsZWN0b3IsZWxlbWVudFtwYXJlbnROb2RlXSkgIT09IG51bGwgKSB7IHJldHVybiBlbGVtZW50OyB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICggZmlyc3RDaGFyID09PSAnIycgKSB7IC8vIElmIHNlbGVjdG9yIGlzIGFuIElEXG5cdCAgICAgICAgICBpZiAoIGVsZW1lbnQuaWQgPT09IHNlbGVjdG9yLnN1YnN0cigxKSApIHsgcmV0dXJuIGVsZW1lbnQ7IH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfSxcblx0ICBcblx0ICAgIC8vIGV2ZW50IGF0dGFjaCBqUXVlcnkgc3R5bGUgLyB0cmlnZ2VyICBzaW5jZSAxLjIuMFxuXHQgICAgb24gPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcblx0ICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7XG5cdCAgICB9LFxuXHQgICAgb2ZmID0gZnVuY3Rpb24oZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIpIHtcblx0ICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7XG5cdCAgICB9LFxuXHQgICAgb25lID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7IC8vIG9uZSBzaW5jZSAyLjAuNFxuXHQgICAgICBvbihlbGVtZW50LCBldmVudCwgZnVuY3Rpb24gaGFuZGxlcldyYXBwZXIoKXtcblx0ICAgICAgICBoYW5kbGVyKCk7XG5cdCAgICAgICAgb2ZmKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyV3JhcHBlcik7XG5cdCAgICAgIH0pO1xuXHQgICAgfSxcblx0ICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24oZWxlbWVudCxoYW5kbGVyKXsgLy8gZW11bGF0ZVRyYW5zaXRpb25FbmQgc2luY2UgMi4wLjRcblx0ICAgICAgaWYgKHN1cHBvcnRUcmFuc2l0aW9ucykgeyBvbmUoZWxlbWVudCx0cmFuc2l0aW9uRW5kRXZlbnQsIGhhbmRsZXIpOyB9XG5cdCAgICAgIGVsc2UgeyBoYW5kbGVyKCk7IH1cblx0ICAgIH0sICBcblx0ICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgY29tcG9uZW50TmFtZSwgcmVsYXRlZCkge1xuXHQgICAgICB2YXIgT3JpZ2luYWxDdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCggZXZlbnROYW1lICsgJy5icy4nICsgY29tcG9uZW50TmFtZSk7XG5cdCAgICAgIE9yaWdpbmFsQ3VzdG9tRXZlbnQucmVsYXRlZFRhcmdldCA9IHJlbGF0ZWQ7XG5cdCAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChPcmlnaW5hbEN1c3RvbUV2ZW50KTtcblx0ICAgIH0sXG5cdCAgXG5cdCAgICAvLyByZWZlcmVuY2UgYSBsaXZlIGNvbGxlY3Rpb24gb2YgdGhlIERPTVxuXHQgICAgQWxsRE9NRWxlbWVudHMgPSBkb2N1bWVudFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJyonKSxcblx0ICBcblx0ICAgIC8vIEluaXQgREFUQSBBUElcblx0ICAgIGluaXRpYWxpemVEYXRhQVBJID0gZnVuY3Rpb24oIGNvbXBvbmVudCwgY29uc3RydWN0b3IsIGRhdGFBdHRyaWJ1dGUsIGNvbGxlY3Rpb24gKXtcblx0ICAgICAgdmFyIGxvb2tVcCA9IGNvbGxlY3Rpb24gJiYgY29sbGVjdGlvbltsZW5ndGhdID8gY29sbGVjdGlvbiA6IEFsbERPTUVsZW1lbnRzO1xuXHQgICAgICBmb3IgKHZhciBpPTA7IGkgPCBsb29rVXBbbGVuZ3RoXTsgaSsrKSB7XG5cdCAgICAgICAgdmFyIGF0dHJWYWx1ZSA9IGxvb2tVcFtpXVtnZXRBdHRyaWJ1dGVdKGRhdGFBdHRyaWJ1dGUpLCBleHBlY3RlZEF0dHJWYWx1ZSA9IGNvbXBvbmVudC5yZXBsYWNlKC9zcHkvaSwnJylbdG9Mb3dlckNhc2VdKCk7XG5cdCAgICAgICAgaWYgKCBhdHRyVmFsdWUgJiYgY29tcG9uZW50ID09PSBzdHJpbmdCdXR0b24gJiYgKCBhdHRyVmFsdWVbaW5kZXhPZl0oZXhwZWN0ZWRBdHRyVmFsdWUpID4gLTEgKSAvLyBkYXRhLXRvZ2dsZT1cImJ1dHRvbnNcIlxuXHQgICAgICAgICAgICB8fCBhdHRyVmFsdWUgPT09IGV4cGVjdGVkQXR0clZhbHVlICkgeyAvLyBhbGwgb3RoZXIgY29tcG9uZW50c1xuXHQgICAgICAgICAgbmV3IGNvbnN0cnVjdG9yKGxvb2tVcFtpXSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9LCAgXG5cdCAgXG5cdCAgICAvLyB0YWIgLyBjb2xsYXBzZSBzdHVmZlxuXHQgICAgZ2V0T3V0ZXJIZWlnaHQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcblx0ICAgICAgdmFyIGNoaWxkU3R5bGUgPSBjaGlsZCAmJiAoY2hpbGQuY3VycmVudFN0eWxlIHx8IGdsb2JhbE9iamVjdC5nZXRDb21wdXRlZFN0eWxlKGNoaWxkKSksIFxuXHQgICAgICAgIGJ0cCA9IC9weC8udGVzdChjaGlsZFN0eWxlLmJvcmRlclRvcFdpZHRoKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5ib3JkZXJUb3BXaWR0aC5yZXBsYWNlKCdweCcsJycpKSA6IDAsXG5cdCAgICAgICAgYnRiID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUuYm9yZGVyQm90dG9tV2lkdGgpID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLmJvcmRlckJvdHRvbVdpZHRoLnJlcGxhY2UoJ3B4JywnJykpIDogMCxcblx0ICAgICAgICBtdHAgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5tYXJnaW5Ub3ApID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLm1hcmdpblRvcC5yZXBsYWNlKCdweCcsJycpKSA6IDAsXG5cdCAgICAgICAgbWJwID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUubWFyZ2luQm90dG9tKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5tYXJnaW5Cb3R0b20ucmVwbGFjZSgncHgnLCcnKSkgOiAwO1xuXHQgICAgICByZXR1cm4gY2hpbGRbY2xpZW50SGVpZ2h0XSArIHBhcnNlSW50KCBidHAgKSArIHBhcnNlSW50KCBidGIgKSArIHBhcnNlSW50KCBtdHAgKSArIHBhcnNlSW50KCBtYnAgKTtcblx0ICAgIH0sXG5cdCAgICBnZXRNYXhIZWlnaHQgPSBmdW5jdGlvbihwYXJlbnQpIHsgLy8gZ2V0IGNvbGxhcHNlIHRydWVIZWlnaHQgYW5kIGJvcmRlclxuXHQgICAgICB2YXIgcGFyZW50SGVpZ2h0ID0gMDtcblx0ICAgICAgZm9yICh2YXIgayA9IDAsIGxsID0gcGFyZW50LmNoaWxkcmVuW2xlbmd0aF07IGsgPCBsbDsgaysrKSB7XG5cdCAgICAgICAgcGFyZW50SGVpZ2h0ICs9IGdldE91dGVySGVpZ2h0KHBhcmVudC5jaGlsZHJlbltrXSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHBhcmVudEhlaWdodDtcblx0ICAgIH0sXG5cdCAgXG5cdCAgICAvLyB0b29sdGlwIC8gcG9wb3ZlciBzdHVmZlxuXHQgICAgaXNFbGVtZW50SW5WaWV3cG9ydCA9IGZ1bmN0aW9uKGVsZW1lbnQpIHsgLy8gY2hlY2sgaWYgdGhpcy50b29sdGlwIGlzIGluIHZpZXdwb3J0XG5cdCAgICAgIHZhciByZWN0ID0gZWxlbWVudFtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCk7XG5cdCAgICAgIHJldHVybiAoIHJlY3RbdG9wXSA+PSAwICYmIHJlY3RbbGVmdF0gPj0gMCAmJlxuXHQgICAgICAgIHJlY3RbYm90dG9tXSA8PSAoZ2xvYmFsT2JqZWN0W2lubmVySGVpZ2h0XSB8fCBkb2NbY2xpZW50SGVpZ2h0XSkgJiZcblx0ICAgICAgICByZWN0W3JpZ2h0XSA8PSAoZ2xvYmFsT2JqZWN0W2lubmVyV2lkdGhdIHx8IGRvY1tjbGllbnRXaWR0aF0pIClcblx0ICAgIH0sXG5cdCAgICBnZXRTY3JvbGwgPSBmdW5jdGlvbigpIHsgLy8gYWxzbyBBZmZpeCBhbmQgU2Nyb2xsU3B5IHVzZXMgaXRcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICB5IDogZ2xvYmFsT2JqZWN0LnBhZ2VZT2Zmc2V0IHx8IGRvY1tzY3JvbGxUb3BdLFxuXHQgICAgICAgIHggOiBnbG9iYWxPYmplY3QucGFnZVhPZmZzZXQgfHwgZG9jW3Njcm9sbExlZnRdXG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdCAgICBzdHlsZVRpcCA9IGZ1bmN0aW9uKGxpbmssZWxlbWVudCxwb3NpdGlvbixjb250YWluZXIpIHsgLy8gYm90aCBwb3BvdmVycyBhbmQgdG9vbHRpcHNcblx0ICAgICAgdmFyIHJlY3QgPSBsaW5rW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKSwgXG5cdCAgICAgICAgICBzY3JvbGwgPSBjb250YWluZXIgPT09IGJvZHkgPyBnZXRTY3JvbGwoKSA6IHsgeDogY29udGFpbmVyW29mZnNldExlZnRdICsgY29udGFpbmVyW3Njcm9sbExlZnRdLCB5OiBjb250YWluZXJbb2Zmc2V0VG9wXSArIGNvbnRhaW5lcltzY3JvbGxUb3BdIH0sXG5cdCAgICAgICAgICBsaW5rRGltZW5zaW9ucyA9IHsgdzogcmVjdFtyaWdodF0gLSByZWN0W2xlZnRdLCBoOiByZWN0W2JvdHRvbV0gLSByZWN0W3RvcF0gfSxcblx0ICAgICAgICAgIGVsZW1lbnREaW1lbnNpb25zID0geyB3IDogZWxlbWVudFtvZmZzZXRXaWR0aF0sIGg6IGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSB9O1xuXHQgIFxuXHQgICAgICAvLyBhcHBseSBzdHlsaW5nIHRvIHRvb2x0aXAgb3IgcG9wb3ZlclxuXHQgICAgICBpZiAoIHBvc2l0aW9uID09PSB0b3AgKSB7IC8vIFRPUFxuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW3RvcF0gPSByZWN0W3RvcF0gKyBzY3JvbGwueSAtIGVsZW1lbnREaW1lbnNpb25zLmggKyAncHgnO1xuXHQgICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54IC0gZWxlbWVudERpbWVuc2lvbnMudy8yICsgbGlua0RpbWVuc2lvbnMudy8yICsgJ3B4J1xuXHQgIFxuXHQgICAgICB9IGVsc2UgaWYgKCBwb3NpdGlvbiA9PT0gYm90dG9tICkgeyAvLyBCT1RUT01cblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgKyBsaW5rRGltZW5zaW9ucy5oICsgJ3B4Jztcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCAtIGVsZW1lbnREaW1lbnNpb25zLncvMiArIGxpbmtEaW1lbnNpb25zLncvMiArICdweCc7XG5cdCAgXG5cdCAgICAgIH0gZWxzZSBpZiAoIHBvc2l0aW9uID09PSBsZWZ0ICkgeyAvLyBMRUZUXG5cdCAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaC8yICsgbGlua0RpbWVuc2lvbnMuaC8yICsgJ3B4Jztcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCAtIGVsZW1lbnREaW1lbnNpb25zLncgKyAncHgnO1xuXHQgIFxuXHQgICAgICB9IGVsc2UgaWYgKCBwb3NpdGlvbiA9PT0gcmlnaHQgKSB7IC8vIFJJR0hUXG5cdCAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaC8yICsgbGlua0RpbWVuc2lvbnMuaC8yICsgJ3B4Jztcblx0ICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCArIGxpbmtEaW1lbnNpb25zLncgKyAncHgnO1xuXHQgICAgICB9XG5cdCAgICAgIGVsZW1lbnQuY2xhc3NOYW1lW2luZGV4T2ZdKHBvc2l0aW9uKSA9PT0gLTEgJiYgKGVsZW1lbnQuY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZSh0aXBQb3NpdGlvbnMscG9zaXRpb24pKTtcblx0ICAgIH0sXG5cdCAgICB1cGRhdGVQbGFjZW1lbnQgPSBmdW5jdGlvbihwb3NpdGlvbikge1xuXHQgICAgICByZXR1cm4gcG9zaXRpb24gPT09IHRvcCA/IGJvdHRvbSA6IC8vIHRvcFxuXHQgICAgICAgICAgICAgcG9zaXRpb24gPT09IGJvdHRvbSA/IHRvcCA6IC8vIGJvdHRvbVxuXHQgICAgICAgICAgICAgcG9zaXRpb24gPT09IGxlZnQgPyByaWdodCA6IC8vIGxlZnRcblx0ICAgICAgICAgICAgIHBvc2l0aW9uID09PSByaWdodCA/IGxlZnQgOiBwb3NpdGlvbjsgLy8gcmlnaHRcblx0ICAgIH07XG5cdCAgXG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQWZmaXhcblx0ICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvL0FGRklYIERFRklOSVRJT05cblx0ICB2YXIgQWZmaXggPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvbnNcblx0ICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgIFxuXHQgICAgLy8gcmVhZCBEQVRBIEFQSVxuXHQgICAgdmFyIHRhcmdldERhdGEgICAgICAgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpLFxuXHQgICAgICAgIG9mZnNldFRvcERhdGEgICAgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPZmZzZXRUb3ApLFxuXHQgICAgICAgIG9mZnNldEJvdHRvbURhdGEgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPZmZzZXRCb3R0b20pLFxuXHQgICAgICAgIFxuXHQgICAgICAgIC8vIGNvbXBvbmVudCBzcGVjaWZpYyBzdHJpbmdzXG5cdCAgICAgICAgYWZmaXggPSAnYWZmaXgnLCBhZmZpeGVkID0gJ2FmZml4ZWQnLCBmbiA9ICdmdW5jdGlvbicsIHVwZGF0ZSA9ICd1cGRhdGUnLFxuXHQgICAgICAgIGFmZml4VG9wID0gJ2FmZml4LXRvcCcsIGFmZml4ZWRUb3AgPSAnYWZmaXhlZC10b3AnLFxuXHQgICAgICAgIGFmZml4Qm90dG9tID0gJ2FmZml4LWJvdHRvbScsIGFmZml4ZWRCb3R0b20gPSAnYWZmaXhlZC1ib3R0b20nO1xuXHQgIFxuXHQgICAgdGhpc1t0YXJnZXRdID0gb3B0aW9uc1t0YXJnZXRdID8gcXVlcnlFbGVtZW50KG9wdGlvbnNbdGFyZ2V0XSkgOiBxdWVyeUVsZW1lbnQodGFyZ2V0RGF0YSkgfHwgbnVsbDsgLy8gdGFyZ2V0IGlzIGFuIG9iamVjdFxuXHQgICAgdGhpc1tvZmZzZXRUb3BdID0gb3B0aW9uc1tvZmZzZXRUb3BdID8gb3B0aW9uc1tvZmZzZXRUb3BdIDogcGFyc2VJbnQob2Zmc2V0VG9wRGF0YSkgfHwgMDsgLy8gb2Zmc2V0IG9wdGlvbiBpcyBhbiBpbnRlZ2VyIG51bWJlciBvciBmdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhhdCBudW1iZXJcblx0ICAgIHRoaXNbb2Zmc2V0Qm90dG9tXSA9IG9wdGlvbnNbb2Zmc2V0Qm90dG9tXSA/IG9wdGlvbnNbb2Zmc2V0Qm90dG9tXTogcGFyc2VJbnQob2Zmc2V0Qm90dG9tRGF0YSkgfHwgMDtcblx0ICBcblx0ICAgIGlmICggIXRoaXNbdGFyZ2V0XSAmJiAhKCB0aGlzW29mZnNldFRvcF0gfHwgdGhpc1tvZmZzZXRCb3R0b21dICkgKSB7IHJldHVybjsgfSAvLyBpbnZhbGlkYXRlXG5cdCAgXG5cdCAgICAvLyBpbnRlcm5hbCBiaW5kXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsXG5cdCAgXG5cdCAgICAgIC8vIGNvbnN0YW50c1xuXHQgICAgICByZXNpemVEZWxheSA9IChpc0lFICYmIGlzSUUgPCAxMCkgPyA1MDAgOiA1MCwgLy8gZm9yIGxlZ2FjeSBicm93c2VycyB3ZSB0cnkgdG8gbGltaXQgdGhlIGludGVydmFsIGZvciB1cGRhdGluZyB0aGUgQWZmaXhcblx0ICAgICAgcGluT2Zmc2V0VG9wLCBwaW5PZmZzZXRCb3R0b20sIG1heFNjcm9sbCwgc2Nyb2xsWSwgcGlubmVkVG9wLCBwaW5uZWRCb3R0b20sXG5cdCAgICAgIGFmZml4ZWRUb1RvcCA9IGZhbHNlLCBhZmZpeGVkVG9Cb3R0b20gPSBmYWxzZSxcblx0ICAgICAgXG5cdCAgICAgIC8vIHByaXZhdGUgbWV0aG9kcyBcblx0ICAgICAgZ2V0TWF4U2Nyb2xsID0gZnVuY3Rpb24oKXtcblx0ICAgICAgICByZXR1cm4gTWF0aC5tYXgoIGJvZHlbc2Nyb2xsSGVpZ2h0XSwgYm9keVtvZmZzZXRIZWlnaHRdLCBkb2NbY2xpZW50SGVpZ2h0XSwgZG9jW3Njcm9sbEhlaWdodF0sIGRvY1tvZmZzZXRIZWlnaHRdICk7XG5cdCAgICAgIH0sXG5cdCAgICAgIGdldE9mZnNldFRvcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIHNlbGZbdGFyZ2V0XSAhPT0gbnVsbCApIHtcblx0ICAgICAgICAgIHJldHVybiBzZWxmW3RhcmdldF1bZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpW3RvcF0gKyBzY3JvbGxZO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoIHNlbGZbb2Zmc2V0VG9wXSApIHtcblx0ICAgICAgICAgIHJldHVybiBwYXJzZUludCh0eXBlb2Ygc2VsZltvZmZzZXRUb3BdID09PSBmbiA/IHNlbGZbb2Zmc2V0VG9wXSgpIDogc2VsZltvZmZzZXRUb3BdIHx8IDApO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZ2V0T2Zmc2V0Qm90dG9tID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggc2VsZltvZmZzZXRCb3R0b21dICkge1xuXHQgICAgICAgICAgcmV0dXJuIG1heFNjcm9sbCAtIGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSAtIHBhcnNlSW50KCB0eXBlb2Ygc2VsZltvZmZzZXRCb3R0b21dID09PSBmbiA/IHNlbGZbb2Zmc2V0Qm90dG9tXSgpIDogc2VsZltvZmZzZXRCb3R0b21dIHx8IDAgKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGNoZWNrUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgbWF4U2Nyb2xsID0gZ2V0TWF4U2Nyb2xsKCk7XG5cdCAgICAgICAgc2Nyb2xsWSA9IHBhcnNlSW50KGdldFNjcm9sbCgpLnksMCk7XG5cdCAgICAgICAgcGluT2Zmc2V0VG9wID0gZ2V0T2Zmc2V0VG9wKCk7XG5cdCAgICAgICAgcGluT2Zmc2V0Qm90dG9tID0gZ2V0T2Zmc2V0Qm90dG9tKCk7IFxuXHQgICAgICAgIHBpbm5lZFRvcCA9ICggcGFyc2VJbnQocGluT2Zmc2V0VG9wKSAtIHNjcm9sbFkgPCAwKSAmJiAoc2Nyb2xsWSA+IHBhcnNlSW50KHBpbk9mZnNldFRvcCkgKTtcblx0ICAgICAgICBwaW5uZWRCb3R0b20gPSAoIHBhcnNlSW50KHBpbk9mZnNldEJvdHRvbSkgLSBzY3JvbGxZIDwgMCkgJiYgKHNjcm9sbFkgPiBwYXJzZUludChwaW5PZmZzZXRCb3R0b20pICk7XG5cdCAgICAgIH0sXG5cdCAgICAgIHBpblRvcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoICFhZmZpeGVkVG9Ub3AgJiYgIWhhc0NsYXNzKGVsZW1lbnQsYWZmaXgpICkgeyAvLyBvbiBsb2FkaW5nIGEgcGFnZSBoYWxmd2F5IHNjcm9sbGVkIHRoZXNlIGV2ZW50cyBkb24ndCB0cmlnZ2VyIGluIENocm9tZVxuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeCwgYWZmaXgpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeFRvcCwgYWZmaXgpO1xuXHQgICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCxhZmZpeCk7XG5cdCAgICAgICAgICBhZmZpeGVkVG9Ub3AgPSB0cnVlO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkLCBhZmZpeCk7XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWRUb3AsIGFmZml4KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHVuUGluVG9wID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICggYWZmaXhlZFRvVG9wICYmIGhhc0NsYXNzKGVsZW1lbnQsYWZmaXgpICkge1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxhZmZpeCk7XG5cdCAgICAgICAgICBhZmZpeGVkVG9Ub3AgPSBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHBpbkJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoICFhZmZpeGVkVG9Cb3R0b20gJiYgIWhhc0NsYXNzKGVsZW1lbnQsIGFmZml4Qm90dG9tKSApIHtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXgsIGFmZml4KTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhCb3R0b20sIGFmZml4KTtcblx0ICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pO1xuXHQgICAgICAgICAgYWZmaXhlZFRvQm90dG9tID0gdHJ1ZTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXhlZCwgYWZmaXgpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkQm90dG9tLCBhZmZpeCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB1blBpbkJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIGFmZml4ZWRUb0JvdHRvbSAmJiBoYXNDbGFzcyhlbGVtZW50LGFmZml4Qm90dG9tKSApIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsYWZmaXhCb3R0b20pO1xuXHQgICAgICAgICAgYWZmaXhlZFRvQm90dG9tID0gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB1cGRhdGVQaW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCBwaW5uZWRCb3R0b20gKSB7XG5cdCAgICAgICAgICBpZiAoIHBpbm5lZFRvcCApIHsgdW5QaW5Ub3AoKTsgfVxuXHQgICAgICAgICAgcGluQm90dG9tKCk7IFxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB1blBpbkJvdHRvbSgpO1xuXHQgICAgICAgICAgaWYgKCBwaW5uZWRUb3AgKSB7IHBpblRvcCgpOyB9IFxuXHQgICAgICAgICAgZWxzZSB7IHVuUGluVG9wKCk7IH1cblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzW3VwZGF0ZV0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGNoZWNrUG9zaXRpb24oKTtcblx0ICAgICAgdXBkYXRlUGluKCk7IFxuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdBZmZpeCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIG9uKCBnbG9iYWxPYmplY3QsIHNjcm9sbEV2ZW50LCB0aGlzW3VwZGF0ZV0gKTtcblx0ICAgICAgb24oIGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIGZ1bmN0aW9uKCkgeyBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IHNlbGZbdXBkYXRlXSgpOyB9LCByZXNpemVEZWxheSk7IH0pO1xuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdBZmZpeF0gPSB0aGlzO1xuXHQgIFxuXHQgICAgdGhpc1t1cGRhdGVdKCk7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBBRkZJWCBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PT09PT09XG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkoIHN0cmluZ0FmZml4LCBBZmZpeCwgZGF0YVNweSApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEFsZXJ0XG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gQUxFUlQgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT1cblx0ICB2YXIgQWxlcnQgPSBmdW5jdGlvbiggZWxlbWVudCApIHtcblx0ICAgIFxuXHQgICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuXHQgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcblx0ICBcblx0ICAgIC8vIGJpbmQsIHRhcmdldCBhbGVydCwgZHVyYXRpb24gYW5kIHN0dWZmXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIGNvbXBvbmVudCA9ICdhbGVydCcsXG5cdCAgICAgIGFsZXJ0ID0gZ2V0Q2xvc2VzdChlbGVtZW50LCcuJytjb21wb25lbnQpLFxuXHQgICAgICAvLyBoYW5kbGVyc1xuXHQgICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKXtcblx0ICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlW3RhcmdldF07XG5cdCAgICAgICAgZXZlbnRUYXJnZXQgPSBldmVudFRhcmdldFtoYXNBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzKSA/IGV2ZW50VGFyZ2V0IDogZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV07XG5cdCAgICAgICAgaWYgKGV2ZW50VGFyZ2V0ICYmIGV2ZW50VGFyZ2V0W2hhc0F0dHJpYnV0ZV0oZGF0YURpc21pc3MpKSB7IC8vIHdlIGRvdWJsZSBjaGVjayB0aGUgZGF0YSBhdHRyaWJ1dGUsIGl0J3MgaW1wb3J0YW50XG5cdCAgICAgICAgICBhbGVydCA9IGdldENsb3Nlc3QoZXZlbnRUYXJnZXQsJy4nK2NvbXBvbmVudCk7XG5cdCAgICAgICAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KCdbJytkYXRhRGlzbWlzcysnPVwiJytjb21wb25lbnQrJ1wiXScsYWxlcnQpO1xuXHQgICAgICAgICAgKGVsZW1lbnQgPT09IGV2ZW50VGFyZ2V0IHx8IGVsZW1lbnQgPT09IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdKSAmJiBhbGVydCAmJiBzZWxmLmNsb3NlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB0cmFuc2l0aW9uRW5kSGFuZGxlciA9IGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhbGVydCwgY2xvc2VkRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgb2ZmKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7IC8vIGRldGFjaCBpdCdzIGxpc3RlbmVyXG5cdCAgICAgICAgYWxlcnRbcGFyZW50Tm9kZV0ucmVtb3ZlQ2hpbGQoYWxlcnQpO1xuXHQgICAgICB9O1xuXHQgICAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzLmNsb3NlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmICggYWxlcnQgJiYgZWxlbWVudCAmJiBoYXNDbGFzcyhhbGVydCxpbkNsYXNzKSApIHtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFsZXJ0LCBjbG9zZUV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKGFsZXJ0LGluQ2xhc3MpO1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBpZiAoYWxlcnQpIHtcblx0ICAgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoYWxlcnQsdHJhbnNpdGlvbkVuZEhhbmRsZXIpO1xuXHQgICAgICAgICAgfSBcblx0ICAgICAgICB9LCBkdXJhdGlvbik7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nQWxlcnQgaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdBbGVydF0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gQUxFUlQgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJICggc3RyaW5nQWxlcnQsIEFsZXJ0LCBkYXRhRGlzbWlzcyApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IEJ1dHRvblxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gQlVUVE9OIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIEJ1dHRvbiA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb24gKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvblxuXHQgICAgb3B0aW9uID0gb3B0aW9uIHx8IG51bGw7XG5cdCAgXG5cdCAgICAvLyBjb25zdGFudFxuXHQgICAgdmFyIHRvZ2dsZWQgPSBmYWxzZSwgLy8gdG9nZ2xlZCBtYWtlcyBzdXJlIHRvIHByZXZlbnQgdHJpZ2dlcmluZyB0d2ljZSB0aGUgY2hhbmdlLmJzLmJ1dHRvbiBldmVudHNcblx0ICBcblx0ICAgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ2J1dHRvbicsXG5cdCAgICAgICAgY2hlY2tlZCA9ICdjaGVja2VkJyxcblx0ICAgICAgICByZXNldCA9ICdyZXNldCcsXG5cdCAgICAgICAgTEFCRUwgPSAnTEFCRUwnLFxuXHQgICAgICAgIElOUFVUID0gJ0lOUFVUJyxcblx0ICBcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIHNldFN0YXRlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCAhISBvcHRpb24gJiYgb3B0aW9uICE9PSByZXNldCApIHtcblx0ICAgICAgICAgIGlmICggb3B0aW9uID09PSBsb2FkaW5nICkge1xuXHQgICAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LGRpc2FibGVkKTtcblx0ICAgICAgICAgICAgZWxlbWVudFtzZXRBdHRyaWJ1dGVdKGRpc2FibGVkLGRpc2FibGVkKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGVsZW1lbnRbc2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUZXh0LCBlbGVtZW50LmlubmVySFRNTC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJykpOyAvLyB0cmltIHRoZSB0ZXh0XG5cdCAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnZGF0YS0nK29wdGlvbisnLXRleHQnKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlc2V0U3RhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRleHQpKSB7XG5cdCAgICAgICAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsZGlzYWJsZWQpIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkaXNhYmxlZCkgPT09IGRpc2FibGVkICkge1xuXHQgICAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGRpc2FibGVkKTtcblx0ICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoZGlzYWJsZWQpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGV4dCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICB0b2dnbGUgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIHBhcmVudCA9IGVbdGFyZ2V0XVtwYXJlbnROb2RlXSxcblx0ICAgICAgICAgIGxhYmVsID0gZVt0YXJnZXRdLnRhZ05hbWUgPT09IExBQkVMID8gZVt0YXJnZXRdIDogcGFyZW50LnRhZ05hbWUgPT09IExBQkVMID8gcGFyZW50IDogbnVsbDsgLy8gdGhlIC5idG4gbGFiZWxcblx0ICBcblx0ICAgICAgICBpZiAoICFsYWJlbCApIHJldHVybjsgLy9yZWFjdCBpZiBhIGxhYmVsIG9yIGl0cyBpbW1lZGlhdGUgY2hpbGQgaXMgY2xpY2tlZFxuXHQgIFxuXHQgICAgICAgIHZhciBldmVudFRhcmdldCA9IHRoaXMsIC8vIHRoZSBidXR0b24gZ3JvdXAsIHRoZSB0YXJnZXQgb2YgdGhlIGhhbmRsZXIgZnVuY3Rpb25cblx0ICAgICAgICAgIGxhYmVscyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZXZlbnRUYXJnZXQsJ2J0bicpLCAvLyBhbGwgdGhlIGJ1dHRvbiBncm91cCBidXR0b25zXG5cdCAgICAgICAgICBpbnB1dCA9IGxhYmVsW2dldEVsZW1lbnRzQnlUYWdOYW1lXShJTlBVVClbMF07XG5cdCAgXG5cdCAgICAgICAgaWYgKCAhaW5wdXQgKSByZXR1cm47IC8vcmV0dXJuIGlmIG5vIGlucHV0IGZvdW5kXG5cdCAgXG5cdCAgICAgICAgLy8gbWFuYWdlIHRoZSBkb20gbWFuaXB1bGF0aW9uXG5cdCAgICAgICAgaWYgKCBpbnB1dC50eXBlID09PSAnY2hlY2tib3gnICkgeyAvL2NoZWNrYm94ZXNcblx0ICAgICAgICAgIGlmICggIWlucHV0W2NoZWNrZWRdICkge1xuXHQgICAgICAgICAgICBhZGRDbGFzcyhsYWJlbCxhY3RpdmUpO1xuXHQgICAgICAgICAgICBpbnB1dFtnZXRBdHRyaWJ1dGVdKGNoZWNrZWQpO1xuXHQgICAgICAgICAgICBpbnB1dFtzZXRBdHRyaWJ1dGVdKGNoZWNrZWQsY2hlY2tlZCk7XG5cdCAgICAgICAgICAgIGlucHV0W2NoZWNrZWRdID0gdHJ1ZTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHJlbW92ZUNsYXNzKGxhYmVsLGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIGlucHV0W2dldEF0dHJpYnV0ZV0oY2hlY2tlZCk7XG5cdCAgICAgICAgICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZShjaGVja2VkKTtcblx0ICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSBmYWxzZTtcblx0ICAgICAgICAgIH1cblx0ICBcblx0ICAgICAgICAgIGlmICghdG9nZ2xlZCkgeyAvLyBwcmV2ZW50IHRyaWdnZXJpbmcgdGhlIGV2ZW50IHR3aWNlXG5cdCAgICAgICAgICAgIHRvZ2dsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGlucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBpbnB1dFxuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGJ0bi1ncm91cFxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICBcblx0ICAgICAgICBpZiAoIGlucHV0LnR5cGUgPT09ICdyYWRpbycgJiYgIXRvZ2dsZWQgKSB7IC8vIHJhZGlvIGJ1dHRvbnNcblx0ICAgICAgICAgIGlmICggIWlucHV0W2NoZWNrZWRdICkgeyAvLyBkb24ndCB0cmlnZ2VyIGlmIGFscmVhZHkgYWN0aXZlXG5cdCAgICAgICAgICAgIGFkZENsYXNzKGxhYmVsLGFjdGl2ZSk7XG5cdCAgICAgICAgICAgIGlucHV0W3NldEF0dHJpYnV0ZV0oY2hlY2tlZCxjaGVja2VkKTtcblx0ICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSB0cnVlO1xuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGlucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBpbnB1dFxuXHQgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvL3RyaWdnZXIgdGhlIGNoYW5nZSBmb3IgdGhlIGJ0bi1ncm91cFxuXHQgIFxuXHQgICAgICAgICAgICB0b2dnbGVkID0gdHJ1ZTtcblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxsID0gbGFiZWxzW2xlbmd0aF07IGk8bGw7IGkrKykge1xuXHQgICAgICAgICAgICAgIHZhciBvdGhlckxhYmVsID0gbGFiZWxzW2ldLCBvdGhlcklucHV0ID0gb3RoZXJMYWJlbFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oSU5QVVQpWzBdO1xuXHQgICAgICAgICAgICAgIGlmICggb3RoZXJMYWJlbCAhPT0gbGFiZWwgJiYgaGFzQ2xhc3Mob3RoZXJMYWJlbCxhY3RpdmUpICkgIHtcblx0ICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKG90aGVyTGFiZWwsYWN0aXZlKTtcblx0ICAgICAgICAgICAgICAgIG90aGVySW5wdXQucmVtb3ZlQXR0cmlidXRlKGNoZWNrZWQpO1xuXHQgICAgICAgICAgICAgICAgb3RoZXJJbnB1dFtjaGVja2VkXSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChvdGhlcklucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy8gdHJpZ2dlciB0aGUgY2hhbmdlXG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgeyB0b2dnbGVkID0gZmFsc2U7IH0sIDUwICk7XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ2J0bicpICkgeyAvLyB3aGVuIEJ1dHRvbiB0ZXh0IGlzIHVzZWQgd2UgZXhlY3V0ZSBpdCBhcyBhbiBpbnN0YW5jZSBtZXRob2Rcblx0ICAgICAgaWYgKCBvcHRpb24gIT09IG51bGwgKSB7XG5cdCAgICAgICAgaWYgKCBvcHRpb24gIT09IHJlc2V0ICkgeyBzZXRTdGF0ZSgpOyB9IFxuXHQgICAgICAgIGVsc2UgeyByZXNldFN0YXRlKCk7IH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgaWYgKCBoYXNDbGFzcyhlbGVtZW50LCdidG4tZ3JvdXAnKSApIHtcblx0ICAgICAgaWYgKCAhKCBzdHJpbmdCdXR0b24gaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICAgIG9uKCBlbGVtZW50LCBjbGlja0V2ZW50LCB0b2dnbGUgKTtcblx0ICAgICAgfVxuXHQgICAgICBlbGVtZW50W3N0cmluZ0J1dHRvbl0gPSB0aGlzO1xuXHQgICAgfVxuXHQgIH07XG5cdCAgXG5cdCAgLy8gQlVUVE9OIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQnV0dG9uLCBCdXR0b24sIGRhdGFUb2dnbGUgKTtcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBDYXJvdXNlbFxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIENBUk9VU0VMIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIENhcm91c2VsID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KCBlbGVtZW50ICk7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgXG5cdCAgICAvLyBEQVRBIEFQSVxuXHQgICAgdmFyIGludGVydmFsRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhSW50ZXJ2YWwpID09PSAnZmFsc2UnID8gZmFsc2UgOiBwYXJzZUludChlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUludGVydmFsKSkgfHwgNTAwMCwgLy8gYm9vdHN0cmFwIGNhcm91c2VsIGRlZmF1bHQgaW50ZXJ2YWxcblx0ICAgICAgICBwYXVzZURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBhdXNlKSA9PT0gaG92ZXJFdmVudCB8fCBmYWxzZSxcblx0ICAgICAgICBrZXlib2FyZERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUtleWJvYXJkKSA9PT0gJ3RydWUnIHx8IGZhbHNlLFxuXHQgICAgICBcblx0ICAgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ2Nhcm91c2VsJyxcblx0ICAgICAgICBwYXVzZWQgPSAncGF1c2VkJyxcblx0ICAgICAgICBkaXJlY3Rpb24gPSAnZGlyZWN0aW9uJyxcblx0ICAgICAgICBkYXRhU2xpZGVUbyA9ICdkYXRhLXNsaWRlLXRvJzsgXG5cdCAgXG5cdCAgICB0aGlzW2tleWJvYXJkXSA9IG9wdGlvbnNba2V5Ym9hcmRdID09PSB0cnVlIHx8IGtleWJvYXJkRGF0YTtcblx0ICAgIHRoaXNbcGF1c2VdID0gKG9wdGlvbnNbcGF1c2VdID09PSBob3ZlckV2ZW50IHx8IHBhdXNlRGF0YSkgPyBob3ZlckV2ZW50IDogZmFsc2U7IC8vIGZhbHNlIC8gaG92ZXJcblx0ICBcblx0ICAgIGlmICggISggb3B0aW9uc1tpbnRlcnZhbF0gfHwgaW50ZXJ2YWxEYXRhICkgKSB7IC8vIGRldGVybWluZSBzbGlkZSBpbnRlcnZhbFxuXHQgICAgICB0aGlzW2ludGVydmFsXSA9IGZhbHNlO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhpc1tpbnRlcnZhbF0gPSBwYXJzZUludChvcHRpb25zW2ludGVydmFsXSkgfHwgaW50ZXJ2YWxEYXRhOyAvLyBkZWZhdWx0IHNsaWRlIGludGVydmFsXG5cdCAgICB9XG5cdCAgXG5cdCAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIGluZGV4ID0gZWxlbWVudC5pbmRleCA9IDAsIHRpbWVyID0gZWxlbWVudC50aW1lciA9IDAsIFxuXHQgICAgICBpc1NsaWRpbmcgPSBmYWxzZSwgLy8gaXNTbGlkaW5nIHByZXZlbnRzIGNsaWNrIGV2ZW50IGhhbmRsZXJzIHdoZW4gYW5pbWF0aW9uIGlzIHJ1bm5pbmdcblx0ICAgICAgc2xpZGVzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlbGVtZW50LCdpdGVtJyksIHRvdGFsID0gc2xpZGVzW2xlbmd0aF0sXG5cdCAgICAgIHNsaWRlRGlyZWN0aW9uID0gdGhpc1tkaXJlY3Rpb25dID0gbGVmdCxcblx0ICAgICAgY29udHJvbHMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW1lbnQsY29tcG9uZW50KyctY29udHJvbCcpLFxuXHQgICAgICBsZWZ0QXJyb3cgPSBjb250cm9sc1swXSwgcmlnaHRBcnJvdyA9IGNvbnRyb2xzWzFdLFxuXHQgICAgICBpbmRpY2F0b3IgPSBxdWVyeUVsZW1lbnQoICcuJytjb21wb25lbnQrJy1pbmRpY2F0b3JzJywgZWxlbWVudCApLFxuXHQgICAgICBpbmRpY2F0b3JzID0gaW5kaWNhdG9yW2dldEVsZW1lbnRzQnlUYWdOYW1lXSggXCJMSVwiICk7XG5cdCAgXG5cdCAgICAvLyBoYW5kbGVyc1xuXHQgICAgdmFyIHBhdXNlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICE9PWZhbHNlICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG5cdCAgICAgICAgICBhZGRDbGFzcyhlbGVtZW50LHBhdXNlZCk7XG5cdCAgICAgICAgICAhaXNTbGlkaW5nICYmIGNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICByZXN1bWVIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAhPT0gZmFsc2UgJiYgaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxwYXVzZWQpO1xuXHQgICAgICAgICAgIWlzU2xpZGluZyAmJiBjbGVhckludGVydmFsKCB0aW1lciApO1xuXHQgICAgICAgICAgIWlzU2xpZGluZyAmJiBzZWxmLmN5Y2xlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBpbmRpY2F0b3JIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICBpZiAoaXNTbGlkaW5nKSByZXR1cm47XG5cdCAgXG5cdCAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZVt0YXJnZXRdLCBhY3RpdmVJbmRpY2F0b3IgPSBzZWxmLmdldEFjdGl2ZUluZGV4KCk7IC8vIGV2ZW50IHRhcmdldCB8IHRoZSBjdXJyZW50IGFjdGl2ZSBpdGVtXG5cdCAgXG5cdCAgICAgICAgaWYgKCBldmVudFRhcmdldCAmJiAhaGFzQ2xhc3MoZXZlbnRUYXJnZXQsYWN0aXZlKSAmJiBldmVudFRhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFTbGlkZVRvKSApIHtcblx0ICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoIGV2ZW50VGFyZ2V0W2dldEF0dHJpYnV0ZV0oZGF0YVNsaWRlVG8pLCAxMCApO1xuXHQgIFxuXHQgICAgICAgICAgLy9kZXRlcm1pbmUgZGlyZWN0aW9uIGZpcnN0XG5cdCAgICAgICAgICBpZiAgKCAoYWN0aXZlSW5kaWNhdG9yIDwgaW5kZXggKSB8fCAoYWN0aXZlSW5kaWNhdG9yID09PSAwICYmIGluZGV4ID09PSB0b3RhbCAtMSApICkge1xuXHQgICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IGxlZnQ7IC8vIG5leHRcblx0ICAgICAgICAgIH0gZWxzZSBpZiAgKCAoYWN0aXZlSW5kaWNhdG9yID4gaW5kZXgpIHx8IChhY3RpdmVJbmRpY2F0b3IgPT09IHRvdGFsIC0gMSAmJiBpbmRleCA9PT0gMCApICkge1xuXHQgICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IHJpZ2h0OyAvLyBwcmV2XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9XG5cdCAgXG5cdCAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApOyAvL0RvIHRoZSBzbGlkZVxuXHQgICAgICB9LFxuXHQgICAgICBjb250cm9sc0hhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICBpZiAoaXNTbGlkaW5nKSByZXR1cm47XG5cdCAgXG5cdCAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZS5jdXJyZW50VGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcblx0ICBcblx0ICAgICAgICBpZiAoIGV2ZW50VGFyZ2V0ID09PSByaWdodEFycm93ICkge1xuXHQgICAgICAgICAgaW5kZXgrKztcblx0ICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDsgLy9zZXQgZGlyZWN0aW9uIGZpcnN0XG5cdCAgXG5cdCAgICAgICAgICBpZiggaW5kZXggPT09IHRvdGFsIC0gMSApIHtcblx0ICAgICAgICAgICAgaW5kZXggPSB0b3RhbCAtIDE7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKCBpbmRleCA9PT0gdG90YWwgKXtcblx0ICAgICAgICAgICAgaW5kZXggPSAwO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSBpZiAoIGV2ZW50VGFyZ2V0ID09PSBsZWZ0QXJyb3cgKSB7XG5cdCAgICAgICAgICBpbmRleC0tO1xuXHQgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSByaWdodDsgLy9zZXQgZGlyZWN0aW9uIGZpcnN0XG5cdCAgXG5cdCAgICAgICAgICBpZiggaW5kZXggPT09IDAgKSB7XG5cdCAgICAgICAgICAgIGluZGV4ID0gMDtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAoIGluZGV4IDwgMCApe1xuXHQgICAgICAgICAgICBpbmRleCA9IHRvdGFsIC0gMVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICBcblx0ICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7IC8vRG8gdGhlIHNsaWRlXG5cdCAgICAgIH0sXG5cdCAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmIChpc1NsaWRpbmcpIHJldHVybjtcblx0ICAgICAgICBzd2l0Y2ggKGUud2hpY2gpIHtcblx0ICAgICAgICAgIGNhc2UgMzk6XG5cdCAgICAgICAgICAgIGluZGV4Kys7XG5cdCAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDtcblx0ICAgICAgICAgICAgaWYoIGluZGV4ID09IHRvdGFsIC0gMSApIHsgaW5kZXggPSB0b3RhbCAtIDE7IH0gZWxzZVxuXHQgICAgICAgICAgICBpZiAoIGluZGV4ID09IHRvdGFsICl7IGluZGV4ID0gMCB9XG5cdCAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgY2FzZSAzNzpcblx0ICAgICAgICAgICAgaW5kZXgtLTtcblx0ICAgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSByaWdodDtcblx0ICAgICAgICAgICAgaWYgKCBpbmRleCA9PSAwICkgeyBpbmRleCA9IDA7IH0gZWxzZVxuXHQgICAgICAgICAgICBpZiAoIGluZGV4IDwgMCApIHsgaW5kZXggPSB0b3RhbCAtIDEgfVxuXHQgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgIGRlZmF1bHQ6IHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApOyAvL0RvIHRoZSBzbGlkZVxuXHQgICAgICB9LFxuXHQgICAgICAvLyBwcml2YXRlIG1ldGhvZHNcblx0ICAgICAgc2V0QWN0aXZlUGFnZSA9IGZ1bmN0aW9uKCBwYWdlSW5kZXggKSB7IC8vaW5kaWNhdG9yc1xuXHQgICAgICAgIGZvciAoIHZhciBpID0gMCwgaWNsID0gaW5kaWNhdG9yc1tsZW5ndGhdOyBpIDwgaWNsOyBpKysgKSB7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhpbmRpY2F0b3JzW2ldLGFjdGl2ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChpbmRpY2F0b3JzW3BhZ2VJbmRleF0pIGFkZENsYXNzKGluZGljYXRvcnNbcGFnZUluZGV4XSwgYWN0aXZlKTtcblx0ICAgICAgfTtcblx0ICBcblx0ICBcblx0ICAgIC8vIHB1YmxpYyBtZXRob2RzXG5cdCAgICB0aGlzLmN5Y2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHNsaWRlRGlyZWN0aW9uID0gdGhpc1tkaXJlY3Rpb25dID0gbGVmdDsgLy8gbWFrZSBzdXJlIHRvIGFsd2F5cyBjb21lIGJhY2sgdG8gZGVmYXVsdCBzbGlkZURpcmVjdGlvblxuXHQgICAgICB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGluZGV4Kys7XG5cdCAgXG5cdCAgICAgICAgaW5kZXggPSBpbmRleCA9PT0gdG90YWwgPyAwIDogaW5kZXg7XG5cdCAgICAgICAgc2VsZi5zbGlkZVRvKCBpbmRleCApO1xuXHQgICAgICB9LCB0aGlzW2ludGVydmFsXSk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zbGlkZVRvID0gZnVuY3Rpb24oIG5leHQgKSB7XG5cdCAgICAgIHZhciBhY3RpdmVJdGVtID0gdGhpcy5nZXRBY3RpdmVJbmRleCgpLCAvLyB0aGUgY3VycmVudCBhY3RpdmVcblx0ICAgICAgICAgIG9yaWVudGF0aW9uID0gc2xpZGVEaXJlY3Rpb24gPT09IGxlZnQgPyAnbmV4dCcgOiAncHJldic7IC8vZGV0ZXJtaW5lIHR5cGVcblx0ICBcblx0ICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzbGlkZUV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZGVcblx0ICBcblx0ICAgICAgaXNTbGlkaW5nID0gdGhpcy5pc1NsaWRpbmcgPSB0cnVlO1xuXHQgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcblx0ICAgICAgc2V0QWN0aXZlUGFnZSggbmV4dCApO1xuXHQgIFxuXHQgICAgICBpZiAoIHN1cHBvcnRUcmFuc2l0aW9ucyAmJiBoYXNDbGFzcyhlbGVtZW50LCdzbGlkZScpICkge1xuXHQgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxvcmllbnRhdGlvbik7XG5cdCAgICAgICAgc2xpZGVzW25leHRdW29mZnNldFdpZHRoXTsgIFxuXHQgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxzbGlkZURpcmVjdGlvbik7XG5cdCAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLHNsaWRlRGlyZWN0aW9uKTtcblx0ICBcblx0ICAgICAgICBvbmUoc2xpZGVzW25leHRdLCB0cmFuc2l0aW9uRW5kRXZlbnQsIGZ1bmN0aW9uKCkgeyAvL3dlJ3JlIGdvbm5hIGZha2Ugd2FpdGluZyBmb3IgdGhlIGFuaW1hdGlvbiB0byBmaW5pc2gsIGNsZWFuZXIgYW5kIGJldHRlclxuXHQgICAgICAgICAgaXNTbGlkaW5nID0gc2VsZi5pc1NsaWRpbmcgPSBmYWxzZTtcblx0ICBcblx0ICAgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxhY3RpdmUpO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLGFjdGl2ZSk7XG5cdCAgXG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbbmV4dF0sb3JpZW50YXRpb24pO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW25leHRdLHNsaWRlRGlyZWN0aW9uKTtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1thY3RpdmVJdGVtXSxzbGlkZURpcmVjdGlvbik7XG5cdCAgXG5cdCAgICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG5cdCAgICAgICAgICAgIHNlbGYuY3ljbGUoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2xpZEV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZCBldmVudFxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIFxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxhY3RpdmUpO1xuXHQgICAgICAgIHNsaWRlc1tuZXh0XVtvZmZzZXRXaWR0aF07XG5cdCAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLGFjdGl2ZSk7XG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGlzU2xpZGluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAmJiAhaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuXHQgICAgICAgICAgICBzZWxmLmN5Y2xlKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNsaWRFdmVudCwgY29tcG9uZW50LCBzbGlkZXNbbmV4dF0pOyAvLyBoZXJlIHdlIGdvIHdpdGggdGhlIHNsaWQgZXZlbnRcblx0ICAgICAgICB9LCAxMDAgKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIHRoaXMuZ2V0QWN0aXZlSW5kZXggPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBzbGlkZXNbaW5kZXhPZl0oZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlbGVtZW50LCdpdGVtIGFjdGl2ZScpWzBdKSB8fCAwO1xuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdDYXJvdXNlbCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgXG5cdCAgICAgIGlmICggdGhpc1twYXVzZV0gJiYgdGhpc1tpbnRlcnZhbF0gKSB7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsIG1vdXNlSG92ZXJbMF0sIHBhdXNlSGFuZGxlciApO1xuXHQgICAgICAgIG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzFdLCByZXN1bWVIYW5kbGVyICk7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsICd0b3VjaHN0YXJ0JywgcGF1c2VIYW5kbGVyICk7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsICd0b3VjaGVuZCcsIHJlc3VtZUhhbmRsZXIgKTtcblx0ICAgICAgfVxuXHQgICAgXG5cdCAgICAgIHJpZ2h0QXJyb3cgJiYgb24oIHJpZ2h0QXJyb3csIGNsaWNrRXZlbnQsIGNvbnRyb2xzSGFuZGxlciApO1xuXHQgICAgICBsZWZ0QXJyb3cgJiYgb24oIGxlZnRBcnJvdywgY2xpY2tFdmVudCwgY29udHJvbHNIYW5kbGVyICk7XG5cdCAgICBcblx0ICAgICAgaW5kaWNhdG9yICYmIG9uKCBpbmRpY2F0b3IsIGNsaWNrRXZlbnQsIGluZGljYXRvckhhbmRsZXIsIGZhbHNlKTtcblx0ICAgICAgdGhpc1trZXlib2FyZF0gPT09IHRydWUgJiYgb24oIGdsb2JhbE9iamVjdCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyLCBmYWxzZSk7XG5cdCAgXG5cdCAgICB9XG5cdCAgICBpZiAodGhpcy5nZXRBY3RpdmVJbmRleCgpPDApIHtcblx0ICAgICAgc2xpZGVzW2xlbmd0aF0gJiYgYWRkQ2xhc3Moc2xpZGVzWzBdLGFjdGl2ZSk7XG5cdCAgICAgIGluZGljYXRvcnNbbGVuZ3RoXSAmJiBzZXRBY3RpdmVQYWdlKDApO1xuXHQgICAgfVxuXHQgIFxuXHQgICAgaWYgKCB0aGlzW2ludGVydmFsXSApeyB0aGlzLmN5Y2xlKCk7IH1cblx0ICAgIGVsZW1lbnRbc3RyaW5nQ2Fyb3VzZWxdID0gdGhpcztcblx0ICB9O1xuXHQgIFxuXHQgIC8vIENBUk9VU0VMIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQ2Fyb3VzZWwsIENhcm91c2VsLCBkYXRhUmlkZSApO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IENvbGxhcHNlXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIENPTExBUFNFIERFRklOSVRJT05cblx0ICAvLyA9PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIENvbGxhcHNlID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvbnNcblx0ICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgIFxuXHQgIFxuXHQgICAgLy8gZXZlbnQgdGFyZ2V0cyBhbmQgY29uc3RhbnRzXG5cdCAgICB2YXIgYWNjb3JkaW9uID0gbnVsbCwgY29sbGFwc2UgPSBudWxsLCBzZWxmID0gdGhpcywgXG5cdCAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2UsIC8vIHdoZW4gdHJ1ZSBpdCB3aWxsIHByZXZlbnQgY2xpY2sgaGFuZGxlcnNcblx0ICAgICAgYWNjb3JkaW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnZGF0YS1wYXJlbnQnKSxcblx0ICBcblx0ICAgICAgLy8gY29tcG9uZW50IHN0cmluZ3Ncblx0ICAgICAgY29tcG9uZW50ID0gJ2NvbGxhcHNlJyxcblx0ICAgICAgY29sbGFwc2VkID0gJ2NvbGxhcHNlZCcsXG5cdCAgXG5cdCAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgICBvcGVuQWN0aW9uID0gZnVuY3Rpb24oY29sbGFwc2VFbGVtZW50KSB7XG5cdCAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIHNob3dFdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICBpc0FuaW1hdGluZyA9IHRydWU7XG5cdCAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuXHQgICAgICAgIGFkZENsYXNzKGNvbGxhcHNlRWxlbWVudCxpbkNsYXNzKTtcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGNvbGxhcHNlRWxlbWVudCkgKyAncHgnO1xuXHQgICAgICAgIH0sIDApO1xuXHQgIFxuXHQgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKGNvbGxhcHNlRWxlbWVudCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhjb2xsYXBzZUVsZW1lbnQsY29sbGFwc2luZyk7XG5cdCAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSAnJztcblx0ICAgICAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2U7XG5cdCAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsJ3RydWUnKTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9LFxuXHQgICAgICBjbG9zZUFjdGlvbiA9IGZ1bmN0aW9uKGNvbGxhcHNlRWxlbWVudCkge1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgaXNBbmltYXRpbmcgPSB0cnVlO1xuXHQgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9IGdldE1heEhlaWdodChjb2xsYXBzZUVsZW1lbnQpICsgJ3B4Jztcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuXHQgICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gJzBweCc7XG5cdCAgICAgICAgfSwgMCk7XG5cdCAgXG5cdCAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoY29sbGFwc2VFbGVtZW50LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxjb2xsYXBzaW5nKTtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxpbkNsYXNzKTtcblx0ICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9ICcnO1xuXHQgICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTtcblx0ICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzZXRBdHRyaWJ1dGVdKGFyaWFFeHBhbmRlZCwnZmFsc2UnKTtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSxcblx0ICAgICAgZ2V0VGFyZ2V0ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGhyZWYgPSBlbGVtZW50LmhyZWYgJiYgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdocmVmJyksXG5cdCAgICAgICAgICBwYXJlbnQgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCksXG5cdCAgICAgICAgICBpZCA9IGhyZWYgfHwgKCBwYXJlbnQgJiYgLyMvLnRlc3QocGFyZW50KSApICYmIHBhcmVudDtcblx0ICAgICAgICByZXR1cm4gaWQgJiYgcXVlcnlFbGVtZW50KGlkKTtcblx0ICAgICAgfTtcblx0ICAgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgIGlmIChpc0FuaW1hdGluZykgcmV0dXJuO1xuXHQgICAgICBpZiAoIWhhc0NsYXNzKGNvbGxhcHNlLGluQ2xhc3MpKSB7IHNlbGYuc2hvdygpOyB9IFxuXHQgICAgICBlbHNlIHsgc2VsZi5oaWRlKCk7IH1cblx0ICAgIH07XG5cdCAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgY2xvc2VBY3Rpb24oY29sbGFwc2UpO1xuXHQgICAgICBhZGRDbGFzcyhlbGVtZW50LGNvbGxhcHNlZCk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIG9wZW5BY3Rpb24oY29sbGFwc2UpO1xuXHQgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGNvbGxhcHNlZCk7XG5cdCAgXG5cdCAgICAgIGlmICggYWNjb3JkaW9uICE9PSBudWxsICkge1xuXHQgICAgICAgIHZhciBhY3RpdmVDb2xsYXBzZXMgPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGFjY29yZGlvbixjb21wb25lbnQrJyAnK2luQ2xhc3MpO1xuXHQgICAgICAgIGZvciAodmFyIGk9MCwgYWw9YWN0aXZlQ29sbGFwc2VzW2xlbmd0aF07IGk8YWw7IGkrKykge1xuXHQgICAgICAgICAgaWYgKCBhY3RpdmVDb2xsYXBzZXNbaV0gIT09IGNvbGxhcHNlKSBjbG9zZUFjdGlvbihhY3RpdmVDb2xsYXBzZXNbaV0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdDb2xsYXBzZSBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIHRoaXMudG9nZ2xlKTtcblx0ICAgIH1cblx0ICAgIGNvbGxhcHNlID0gZ2V0VGFyZ2V0KCk7XG5cdCAgICBhY2NvcmRpb24gPSBxdWVyeUVsZW1lbnQob3B0aW9ucy5wYXJlbnQpIHx8IGFjY29yZGlvbkRhdGEgJiYgZ2V0Q2xvc2VzdChlbGVtZW50LCBhY2NvcmRpb25EYXRhKTtcblx0ICAgIGVsZW1lbnRbc3RyaW5nQ29sbGFwc2VdID0gdGhpcztcblx0ICB9O1xuXHQgIFxuXHQgIC8vIENPTExBUFNFIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdDb2xsYXBzZSwgQ29sbGFwc2UsIGRhdGFUb2dnbGUpO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IERyb3Bkb3duXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gRFJPUERPV04gREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PT1cblx0ICB2YXIgRHJvcGRvd24gPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9uICkge1xuXHQgICAgICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcblx0ICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uXG5cdCAgICB0aGlzLnBlcnNpc3QgPSBvcHRpb24gPT09IHRydWUgfHwgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdkYXRhLXBlcnNpc3QnKSA9PT0gJ3RydWUnIHx8IGZhbHNlO1xuXHQgIFxuXHQgICAgLy8gY29uc3RhbnRzLCBldmVudCB0YXJnZXRzLCBzdHJpbmdzXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIGlzT3BlbiA9IGZhbHNlLFxuXHQgICAgICBwYXJlbnQgPSBlbGVtZW50W3BhcmVudE5vZGVdLFxuXHQgICAgICBjb21wb25lbnQgPSAnZHJvcGRvd24nLCBvcGVuID0gJ29wZW4nLFxuXHQgICAgICByZWxhdGVkVGFyZ2V0ID0gbnVsbCxcblx0ICAgICAgbWVudSA9IHF1ZXJ5RWxlbWVudCgnLmRyb3Bkb3duLW1lbnUnLCBwYXJlbnQpLFxuXHQgICAgICBjaGlsZHJlbiA9IG5vZGVMaXN0VG9BcnJheSggbWVudVtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJyonKSksXG5cdCAgXG5cdCAgICAgIC8vIGhhbmRsZXJzXG5cdCAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgaWYgKGlzT3BlbiAmJiAoZS53aGljaCA9PSAyNyB8fCBlLmtleUNvZGUgPT0gMjcpKSB7IHJlbGF0ZWRUYXJnZXQgPSBudWxsOyBoaWRlKCk7IH0gLy8gZS5rZXlDb2RlIGZvciBJRThcblx0ICAgICAgfSxcblx0ICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICAgIHZhciBldmVudFRhcmdldCA9IGVbdGFyZ2V0XSwgaGFzRGF0YTtcblx0ICAgICAgICBoYXNEYXRhID0gKCBldmVudFRhcmdldC5ub2RlVHlwZSAhPT0gMSAmJiAoZXZlbnRUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhVG9nZ2xlKSB8fCBldmVudFRhcmdldFtwYXJlbnROb2RlXVtnZXRBdHRyaWJ1dGVdKGRhdGFUb2dnbGUpKSApO1xuXHQgICAgICAgIGlmICggZXZlbnRUYXJnZXQgPT09IGVsZW1lbnQgfHwgZXZlbnRUYXJnZXQgPT09IHBhcmVudCB8fCBldmVudFRhcmdldFtwYXJlbnROb2RlXSA9PT0gZWxlbWVudCApIHtcblx0ICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy8gY29tbWVudCB0aGlzIGxpbmUgdG8gc3RvcCBwcmV2ZW50aW5nIG5hdmlnYXRpb24gd2hlbiBjbGljayB0YXJnZXQgaXMgYSBsaW5rIFxuXHQgICAgICAgICAgcmVsYXRlZFRhcmdldCA9IGVsZW1lbnQ7XG5cdCAgICAgICAgICBzZWxmLnRvZ2dsZSgpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoIGlzT3BlbiApIHtcblx0ICAgICAgICAgIGlmICggKGV2ZW50VGFyZ2V0ID09PSBtZW51IHx8IGNoaWxkcmVuICYmIGNoaWxkcmVuW2luZGV4T2ZdKGV2ZW50VGFyZ2V0KSA+IC0xKSAmJiAoIHNlbGYucGVyc2lzdCB8fCBoYXNEYXRhICkgKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgIH0gZWxzZSB7IHJlbGF0ZWRUYXJnZXQgPSBudWxsOyBoaWRlKCk7IH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgKC9cXCMkLy50ZXN0KGV2ZW50VGFyZ2V0LmhyZWYpIHx8IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdICYmIC9cXCMkLy50ZXN0KGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdLmhyZWYpKSAmJiBlLnByZXZlbnREZWZhdWx0KCk7IC8vIHNob3VsZCBiZSBoZXJlIHRvIHByZXZlbnQganVtcHNcblx0ICAgICAgfSxcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIHNob3cgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgc2hvd0V2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICAgIGFkZENsYXNzKHBhcmVudCxvcGVuKTtcblx0ICAgICAgICBtZW51W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLHRydWUpO1xuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICAgIG9uKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuXHQgICAgICAgIGlzT3BlbiA9IHRydWU7XG5cdCAgICAgIH0sXG5cdCAgICAgIGhpZGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgaGlkZUV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKHBhcmVudCxvcGVuKTtcblx0ICAgICAgICBtZW51W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLGZhbHNlKTtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG5cdCAgICAgICAgb2ZmKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuXHQgICAgICAgIGlzT3BlbiA9IGZhbHNlO1xuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmIChoYXNDbGFzcyhwYXJlbnQsb3BlbikgJiYgaXNPcGVuKSB7IGhpZGUoKTsgfSBcblx0ICAgICAgZWxzZSB7IHNob3coKTsgfVxuXHQgICAgfTtcblx0ICBcblx0ICAgIC8vIGluaXRcblx0ICAgIGlmICggIShzdHJpbmdEcm9wZG93biBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgbWVudVtzZXRBdHRyaWJ1dGVdKCd0YWJpbmRleCcsICcwJyk7IC8vIEZpeCBvbmJsdXIgb24gQ2hyb21lIHwgU2FmYXJpXG5cdCAgICAgIG9uKGRvY3VtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdEcm9wZG93bl0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gRFJPUERPV04gREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdEcm9wZG93biwgRHJvcGRvd24sIGRhdGFUb2dnbGUgKTtcblx0ICBcblx0ICBcblx0ICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBNb2RhbFxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgICAgXG5cdCAgLy8gTU9EQUwgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PVxuXHQgIHZhciBNb2RhbCA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHsgLy8gZWxlbWVudCBjYW4gYmUgdGhlIG1vZGFsL3RyaWdnZXJpbmcgYnV0dG9uXG5cdCAgXG5cdCAgICAvLyB0aGUgbW9kYWwgKGJvdGggSmF2YVNjcmlwdCAvIERBVEEgQVBJIGluaXQpIC8gdHJpZ2dlcmluZyBidXR0b24gZWxlbWVudCAoREFUQSBBUEkpXG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gZGV0ZXJtaW5lIG1vZGFsLCB0cmlnZ2VyaW5nIGVsZW1lbnQgXG5cdCAgICB2YXIgYnRuQ2hlY2sgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRhcmdldCl8fGVsZW1lbnRbZ2V0QXR0cmlidXRlXSgnaHJlZicpLFxuXHQgICAgICBjaGVja01vZGFsID0gcXVlcnlFbGVtZW50KCBidG5DaGVjayApLFxuXHQgICAgICBtb2RhbCA9IGhhc0NsYXNzKGVsZW1lbnQsJ21vZGFsJykgPyBlbGVtZW50IDogY2hlY2tNb2RhbCxcblx0ICBcblx0ICAgICAgLy8gc3RyaW5nc1xuXHQgICAgICBjb21wb25lbnQgPSAnbW9kYWwnLFxuXHQgICAgICBzdGF0aWNTdHJpbmcgPSAnc3RhdGljJyxcblx0ICAgICAgcGFkZGluZ0xlZnQgPSAncGFkZGluZ0xlZnQnLFxuXHQgICAgICBwYWRkaW5nUmlnaHQgPSAncGFkZGluZ1JpZ2h0Jyxcblx0ICAgICAgbW9kYWxCYWNrZHJvcFN0cmluZyA9ICdtb2RhbC1iYWNrZHJvcCc7XG5cdCAgXG5cdCAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ21vZGFsJykgKSB7IGVsZW1lbnQgPSBudWxsOyB9IC8vIG1vZGFsIGlzIG5vdyBpbmRlcGVuZGVudCBvZiBpdCdzIHRyaWdnZXJpbmcgZWxlbWVudFxuXHQgIFxuXHQgICAgaWYgKCAhbW9kYWwgKSB7IHJldHVybjsgfSAvLyBpbnZhbGlkYXRlXG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgXG5cdCAgICB0aGlzW2tleWJvYXJkXSA9IG9wdGlvbnNba2V5Ym9hcmRdID09PSBmYWxzZSB8fCBtb2RhbFtnZXRBdHRyaWJ1dGVdKGRhdGFLZXlib2FyZCkgPT09ICdmYWxzZScgPyBmYWxzZSA6IHRydWU7XG5cdCAgICB0aGlzW2JhY2tkcm9wXSA9IG9wdGlvbnNbYmFja2Ryb3BdID09PSBzdGF0aWNTdHJpbmcgfHwgbW9kYWxbZ2V0QXR0cmlidXRlXShkYXRhYmFja2Ryb3ApID09PSBzdGF0aWNTdHJpbmcgPyBzdGF0aWNTdHJpbmcgOiB0cnVlO1xuXHQgICAgdGhpc1tiYWNrZHJvcF0gPSBvcHRpb25zW2JhY2tkcm9wXSA9PT0gZmFsc2UgfHwgbW9kYWxbZ2V0QXR0cmlidXRlXShkYXRhYmFja2Ryb3ApID09PSAnZmFsc2UnID8gZmFsc2UgOiB0aGlzW2JhY2tkcm9wXTtcblx0ICAgIHRoaXNbY29udGVudF0gID0gb3B0aW9uc1tjb250ZW50XTsgLy8gSmF2YVNjcmlwdCBvbmx5XG5cdCAgXG5cdCAgICAvLyBiaW5kLCBjb25zdGFudHMsIGV2ZW50IHRhcmdldHMgYW5kIG90aGVyIHZhcnNcblx0ICAgIHZhciBzZWxmID0gdGhpcywgb3BlbiA9IHRoaXMub3BlbiA9IGZhbHNlLCByZWxhdGVkVGFyZ2V0ID0gbnVsbCxcblx0ICAgICAgYm9keUlzT3ZlcmZsb3dpbmcsIG1vZGFsSXNPdmVyZmxvd2luZywgc2Nyb2xsYmFyV2lkdGgsIG92ZXJsYXksXG5cdCAgXG5cdCAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgICBnZXRXaW5kb3dXaWR0aCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBodG1sUmVjdCA9IGRvY1tnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCk7XG5cdCAgICAgICAgcmV0dXJuIGdsb2JhbE9iamVjdFtpbm5lcldpZHRoXSB8fCAoaHRtbFJlY3RbcmlnaHRdIC0gTWF0aC5hYnMoaHRtbFJlY3RbbGVmdF0pKTtcblx0ICAgICAgfSxcblx0ICAgICAgc2V0U2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBib2R5U3R5bGUgPSBib2R5LmN1cnJlbnRTdHlsZSB8fCBnbG9iYWxPYmplY3QuZ2V0Q29tcHV0ZWRTdHlsZShib2R5KSwgYm9keVBhZCA9IHBhcnNlSW50KChib2R5U3R5bGVbcGFkZGluZ1JpZ2h0XSksIDEwKTtcblx0ICAgICAgICBpZiAoYm9keUlzT3ZlcmZsb3dpbmcpIHsgYm9keVtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9IChib2R5UGFkICsgc2Nyb2xsYmFyV2lkdGgpICsgJ3B4JzsgfVxuXHQgICAgICB9LFxuXHQgICAgICByZXNldFNjcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBib2R5W3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gJyc7XG5cdCAgICAgIH0sXG5cdCAgICAgIG1lYXN1cmVTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7IC8vIHRoeCB3YWxzaFxuXHQgICAgICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwgc2Nyb2xsQmFyV2lkdGg7XG5cdCAgICAgICAgc2Nyb2xsRGl2LmNsYXNzTmFtZSA9IGNvbXBvbmVudCsnLXNjcm9sbGJhci1tZWFzdXJlJzsgLy8gdGhpcyBpcyBoZXJlIHRvIHN0YXlcblx0ICAgICAgICBib2R5LmFwcGVuZENoaWxkKHNjcm9sbERpdik7XG5cdCAgICAgICAgc2Nyb2xsQmFyV2lkdGggPSBzY3JvbGxEaXZbb2Zmc2V0V2lkdGhdIC0gc2Nyb2xsRGl2W2NsaWVudFdpZHRoXTtcblx0ICAgICAgICBib2R5LnJlbW92ZUNoaWxkKHNjcm9sbERpdik7XG5cdCAgICAgICAgcmV0dXJuIHNjcm9sbEJhcldpZHRoO1xuXHQgICAgICB9LFxuXHQgICAgICBjaGVja1Njcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBib2R5SXNPdmVyZmxvd2luZyA9IGJvZHlbY2xpZW50V2lkdGhdIDwgZ2V0V2luZG93V2lkdGgoKTtcblx0ICAgICAgICBtb2RhbElzT3ZlcmZsb3dpbmcgPSBtb2RhbFtzY3JvbGxIZWlnaHRdID4gZG9jW2NsaWVudEhlaWdodF07XG5cdCAgICAgICAgc2Nyb2xsYmFyV2lkdGggPSBtZWFzdXJlU2Nyb2xsYmFyKCk7XG5cdCAgICAgIH0sXG5cdCAgICAgIGFkanVzdERpYWxvZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ0xlZnRdID0gIWJvZHlJc092ZXJmbG93aW5nICYmIG1vZGFsSXNPdmVyZmxvd2luZyA/IHNjcm9sbGJhcldpZHRoICsgJ3B4JyA6ICcnO1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gYm9keUlzT3ZlcmZsb3dpbmcgJiYgIW1vZGFsSXNPdmVyZmxvd2luZyA/IHNjcm9sbGJhcldpZHRoICsgJ3B4JyA6ICcnO1xuXHQgICAgICB9LFxuXHQgICAgICByZXNldEFkanVzdG1lbnRzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nTGVmdF0gPSAnJztcblx0ICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9ICcnO1xuXHQgICAgICB9LFxuXHQgICAgICBjcmVhdGVPdmVybGF5ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIG5ld092ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0ICAgICAgICBvdmVybGF5ID0gcXVlcnlFbGVtZW50KCcuJyttb2RhbEJhY2tkcm9wU3RyaW5nKTtcblx0ICBcblx0ICAgICAgICBpZiAoIG92ZXJsYXkgPT09IG51bGwgKSB7XG5cdCAgICAgICAgICBuZXdPdmVybGF5W3NldEF0dHJpYnV0ZV0oJ2NsYXNzJyxtb2RhbEJhY2tkcm9wU3RyaW5nKycgZmFkZScpO1xuXHQgICAgICAgICAgb3ZlcmxheSA9IG5ld092ZXJsYXk7XG5cdCAgICAgICAgICBib2R5LmFwcGVuZENoaWxkKG92ZXJsYXkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgcmVtb3ZlT3ZlcmxheSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIG92ZXJsYXkgPSBxdWVyeUVsZW1lbnQoJy4nK21vZGFsQmFja2Ryb3BTdHJpbmcpOyBcblx0ICAgICAgICBpZiAoIG92ZXJsYXkgJiYgb3ZlcmxheSAhPT0gbnVsbCAmJiB0eXBlb2Ygb3ZlcmxheSA9PT0gJ29iamVjdCcgKSB7XG5cdCAgICAgICAgICBib2R5LnJlbW92ZUNoaWxkKG92ZXJsYXkpOyBvdmVybGF5ID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGtleWRvd25IYW5kbGVyVG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgaWYgKCFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSkge1xuXHQgICAgICAgICAgb24oZG9jdW1lbnQsIGtleWRvd25FdmVudCwga2V5SGFuZGxlcik7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG9mZihkb2N1bWVudCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlc2l6ZUhhbmRsZXJUb2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBpZiAoIWhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7XG5cdCAgICAgICAgICBvbihnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLnVwZGF0ZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG9mZihnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLnVwZGF0ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBkaXNtaXNzSGFuZGxlclRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICghaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykpIHtcblx0ICAgICAgICAgIG9uKG1vZGFsLCBjbGlja0V2ZW50LCBkaXNtaXNzSGFuZGxlcik7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG9mZihtb2RhbCwgY2xpY2tFdmVudCwgZGlzbWlzc0hhbmRsZXIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLy8gaGFuZGxlcnNcblx0ICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICAgIHZhciBjbGlja1RhcmdldCA9IGVbdGFyZ2V0XTsgXG5cdCAgICAgICAgY2xpY2tUYXJnZXQgPSBjbGlja1RhcmdldFtoYXNBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpIHx8IGNsaWNrVGFyZ2V0W2hhc0F0dHJpYnV0ZV0oJ2hyZWYnKSA/IGNsaWNrVGFyZ2V0IDogY2xpY2tUYXJnZXRbcGFyZW50Tm9kZV07XG5cdCAgICAgICAgaWYgKCAhb3BlbiAmJiBjbGlja1RhcmdldCA9PT0gZWxlbWVudCAmJiAhaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykgKSB7XG5cdCAgICAgICAgICBtb2RhbC5tb2RhbFRyaWdnZXIgPSBlbGVtZW50O1xuXHQgICAgICAgICAgcmVsYXRlZFRhcmdldCA9IGVsZW1lbnQ7XG5cdCAgICAgICAgICBzZWxmLnNob3coKTtcblx0ICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGtleUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIGtleSA9IGUud2hpY2ggfHwgZS5rZXlDb2RlOyAvLyBrZXlDb2RlIGZvciBJRThcblx0ICAgICAgICBpZiAoc2VsZltrZXlib2FyZF0gJiYga2V5ID09IDI3ICYmIG9wZW4pIHtcblx0ICAgICAgICAgIHNlbGYuaGlkZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZGlzbWlzc0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgdmFyIGNsaWNrVGFyZ2V0ID0gZVt0YXJnZXRdO1xuXHQgICAgICAgIGlmICggb3BlbiAmJiAoY2xpY2tUYXJnZXRbcGFyZW50Tm9kZV1bZ2V0QXR0cmlidXRlXShkYXRhRGlzbWlzcykgPT09IGNvbXBvbmVudCBcblx0ICAgICAgICAgICAgfHwgY2xpY2tUYXJnZXRbZ2V0QXR0cmlidXRlXShkYXRhRGlzbWlzcykgPT09IGNvbXBvbmVudFxuXHQgICAgICAgICAgICB8fCAoY2xpY2tUYXJnZXQgPT09IG1vZGFsICYmIHNlbGZbYmFja2Ryb3BdICE9PSBzdGF0aWNTdHJpbmcpICkgKSB7XG5cdCAgICAgICAgICBzZWxmLmhpZGUoKTsgcmVsYXRlZFRhcmdldCA9IG51bGw7XG5cdCAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmIChvcGVuICYmIGhhc0NsYXNzKG1vZGFsLGluQ2xhc3MpKSB7dGhpcy5oaWRlKCk7fSBlbHNlIHt0aGlzLnNob3coKTt9XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobW9kYWwsIHNob3dFdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcblx0ICBcblx0ICAgICAgLy8gd2UgZWxlZ2FudGx5IGhpZGUgYW55IG9wZW5lZCBtb2RhbFxuXHQgICAgICB2YXIgY3VycmVudE9wZW4gPSBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGRvY3VtZW50LGNvbXBvbmVudCsnIGluJylbMF07XG5cdCAgICAgIGN1cnJlbnRPcGVuICYmIGN1cnJlbnRPcGVuICE9PSBtb2RhbCAmJiBjdXJyZW50T3Blbi5tb2RhbFRyaWdnZXJbc3RyaW5nTW9kYWxdLmhpZGUoKTsgXG5cdCAgXG5cdCAgICAgIGlmICggdGhpc1tiYWNrZHJvcF0gKSB7XG5cdCAgICAgICAgY3JlYXRlT3ZlcmxheSgpO1xuXHQgICAgICB9XG5cdCAgXG5cdCAgICAgIGlmICggb3ZlcmxheSAmJiAhaGFzQ2xhc3Mob3ZlcmxheSxpbkNsYXNzKSkge1xuXHQgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgeyBhZGRDbGFzcyhvdmVybGF5LGluQ2xhc3MpOyB9LCAwKTtcblx0ICAgICAgfVxuXHQgIFxuXHQgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblx0ICAgICAgICBtb2RhbFtzdHlsZV0uZGlzcGxheSA9ICdibG9jayc7XG5cdCAgXG5cdCAgICAgICAgY2hlY2tTY3JvbGxiYXIoKTtcblx0ICAgICAgICBzZXRTY3JvbGxiYXIoKTtcblx0ICAgICAgICBhZGp1c3REaWFsb2coKTtcblx0ICBcblx0ICAgICAgICByZXNpemVIYW5kbGVyVG9nZ2xlKCk7XG5cdCAgICAgICAgZGlzbWlzc0hhbmRsZXJUb2dnbGUoKTtcblx0ICAgICAgICBrZXlkb3duSGFuZGxlclRvZ2dsZSgpO1xuXHQgIFxuXHQgICAgICAgIGFkZENsYXNzKGJvZHksY29tcG9uZW50Kyctb3BlbicpO1xuXHQgICAgICAgIGFkZENsYXNzKG1vZGFsLGluQ2xhc3MpO1xuXHQgICAgICAgIG1vZGFsW3NldEF0dHJpYnV0ZV0oYXJpYUhpZGRlbiwgZmFsc2UpO1xuXHQgICAgICB9LCAwKTtcblx0ICBcblx0ICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQobW9kYWwsIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIG9wZW4gPSBzZWxmLm9wZW4gPSB0cnVlO1xuXHQgICAgICAgIHNldEZvY3VzKG1vZGFsKTtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBzaG93bkV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuXHQgICAgICB9KTtcblx0ICAgIH07XG5cdCAgICB0aGlzLmhpZGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChtb2RhbCwgaGlkZUV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICBvdmVybGF5ID0gcXVlcnlFbGVtZW50KCcuJyttb2RhbEJhY2tkcm9wU3RyaW5nKTtcblx0ICBcblx0ICAgICAgaWYgKCBvdmVybGF5ICE9PSBudWxsICkge1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKG92ZXJsYXksaW5DbGFzcyk7XG5cdCAgICAgIH1cblx0ICAgICAgcmVtb3ZlQ2xhc3MobW9kYWwsaW5DbGFzcyk7XG5cdCAgICAgIG1vZGFsW3NldEF0dHJpYnV0ZV0oYXJpYUhpZGRlbiwgdHJ1ZSk7XG5cdCAgXG5cdCAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKG1vZGFsLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZW1vdmVDbGFzcyhib2R5LGNvbXBvbmVudCsnLW9wZW4nKTtcblx0ICAgICAgICByZXNpemVIYW5kbGVyVG9nZ2xlKCk7XG5cdCAgICAgICAgZGlzbWlzc0hhbmRsZXJUb2dnbGUoKTtcblx0ICAgICAgICBrZXlkb3duSGFuZGxlclRvZ2dsZSgpO1xuXHQgIFxuXHQgICAgICAgIHJlc2V0QWRqdXN0bWVudHMoKTtcblx0ICAgICAgICByZXNldFNjcm9sbGJhcigpO1xuXHQgICAgICAgIG1vZGFsW3N0eWxlXS5kaXNwbGF5ID0gJyc7XG5cdCAgXG5cdCAgICAgICAgaWYgKCFnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGRvY3VtZW50LGNvbXBvbmVudCsnICcraW5DbGFzcylbMF0pIHsgcmVtb3ZlT3ZlcmxheSgpOyB9XG5cdCAgICAgICAgb3BlbiA9IHNlbGYub3BlbiA9IGZhbHNlO1xuXHQgICAgICAgIGVsZW1lbnQgJiYgKHNldEZvY3VzKGVsZW1lbnQpKTtcblx0ICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgfSk7XG5cdCAgICB9O1xuXHQgICAgdGhpcy5zZXRDb250ZW50ID0gZnVuY3Rpb24oIGNvbnRlbnQgKSB7XG5cdCAgICAgIHF1ZXJ5RWxlbWVudCgnLicrY29tcG9uZW50KyctY29udGVudCcsbW9kYWwpLmlubmVySFRNTCA9IGNvbnRlbnQ7XG5cdCAgICB9O1xuXHQgICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKG9wZW4pIHtcblx0ICAgICAgICBjaGVja1Njcm9sbGJhcigpO1xuXHQgICAgICAgIHNldFNjcm9sbGJhcigpO1xuXHQgICAgICAgIGFkanVzdERpYWxvZygpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgb3ZlciBhbmQgb3ZlclxuXHQgICAgLy8gbW9kYWwgaXMgaW5kZXBlbmRlbnQgb2YgYSB0cmlnZ2VyaW5nIGVsZW1lbnQgXG5cdCAgICBpZiAoICEhZWxlbWVudCAmJiAhKHN0cmluZ01vZGFsIGluIGVsZW1lbnQpICkge1xuXHQgICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuXHQgICAgfVxuXHQgICAgaWYgKCAhIXRoaXNbY29udGVudF0gKSB7IHRoaXMuc2V0Q29udGVudCggdGhpc1tjb250ZW50XSApOyB9XG5cdCAgICAhIWVsZW1lbnQgJiYgKGVsZW1lbnRbc3RyaW5nTW9kYWxdID0gdGhpcyk7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBEQVRBIEFQSVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ01vZGFsLCBNb2RhbCwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgUG9wb3ZlclxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIFBPUE9WRVIgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PVxuXHQgIHZhciBQb3BvdmVyID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gREFUQSBBUElcblx0ICAgIHZhciB0cmlnZ2VyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVHJpZ2dlciksIC8vIGNsaWNrIC8gaG92ZXIgLyBmb2N1c1xuXHQgICAgICAgIGFuaW1hdGlvbkRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUFuaW1hdGlvbiksIC8vIHRydWUgLyBmYWxzZVxuXHQgICAgICAgIHBsYWNlbWVudERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBsYWNlbWVudCksXG5cdCAgICAgICAgZGlzbWlzc2libGVEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzaWJsZSksXG5cdCAgICAgICAgZGVsYXlEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEZWxheSksXG5cdCAgICAgICAgY29udGFpbmVyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGFpbmVyKSxcblx0ICBcblx0ICAgICAgICAvLyBpbnRlcm5hbCBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ3BvcG92ZXInLFxuXHQgICAgICAgIHRlbXBsYXRlID0gJ3RlbXBsYXRlJyxcblx0ICAgICAgICB0cmlnZ2VyID0gJ3RyaWdnZXInLFxuXHQgICAgICAgIGNsYXNzU3RyaW5nID0gJ2NsYXNzJyxcblx0ICAgICAgICBkaXYgPSAnZGl2Jyxcblx0ICAgICAgICBmYWRlID0gJ2ZhZGUnLFxuXHQgICAgICAgIHRpdGxlID0gJ3RpdGxlJyxcblx0ICAgICAgICBjb250ZW50ID0gJ2NvbnRlbnQnLFxuXHQgICAgICAgIGRhdGFUaXRsZSA9ICdkYXRhLXRpdGxlJyxcblx0ICAgICAgICBkYXRhQ29udGVudCA9ICdkYXRhLWNvbnRlbnQnLFxuXHQgICAgICAgIGRpc21pc3NpYmxlID0gJ2Rpc21pc3NpYmxlJyxcblx0ICAgICAgICBjbG9zZUJ0biA9ICc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImNsb3NlXCI+w5c8L2J1dHRvbj4nO1xuXHQgIFxuXHQgICAgLy8gc2V0IG9wdGlvbnNcblx0ICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXHQgICAgdGhpc1t0ZW1wbGF0ZV0gPSBvcHRpb25zW3RlbXBsYXRlXSA/IG9wdGlvbnNbdGVtcGxhdGVdIDogbnVsbDsgLy8gSmF2YVNjcmlwdCBvbmx5XG5cdCAgICB0aGlzW3RyaWdnZXJdID0gb3B0aW9uc1t0cmlnZ2VyXSA/IG9wdGlvbnNbdHJpZ2dlcl0gOiB0cmlnZ2VyRGF0YSB8fCBob3ZlckV2ZW50O1xuXHQgICAgdGhpc1thbmltYXRpb25dID0gb3B0aW9uc1thbmltYXRpb25dICYmIG9wdGlvbnNbYW5pbWF0aW9uXSAhPT0gZmFkZSA/IG9wdGlvbnNbYW5pbWF0aW9uXSA6IGFuaW1hdGlvbkRhdGEgfHwgZmFkZTtcblx0ICAgIHRoaXNbcGxhY2VtZW50XSA9IG9wdGlvbnNbcGxhY2VtZW50XSA/IG9wdGlvbnNbcGxhY2VtZW50XSA6IHBsYWNlbWVudERhdGEgfHwgdG9wO1xuXHQgICAgdGhpc1tkZWxheV0gPSBwYXJzZUludChvcHRpb25zW2RlbGF5XSB8fCBkZWxheURhdGEpIHx8IDIwMDtcblx0ICAgIHRoaXNbZGlzbWlzc2libGVdID0gb3B0aW9uc1tkaXNtaXNzaWJsZV0gfHwgZGlzbWlzc2libGVEYXRhID09PSAndHJ1ZScgPyB0cnVlIDogZmFsc2U7XG5cdCAgICB0aGlzW2NvbnRhaW5lcl0gPSBxdWVyeUVsZW1lbnQob3B0aW9uc1tjb250YWluZXJdKSB8fCBxdWVyeUVsZW1lbnQoY29udGFpbmVyRGF0YSkgfHwgYm9keTtcblx0ICAgIFxuXHQgICAgLy8gYmluZCwgY29udGVudFxuXHQgICAgdmFyIHNlbGYgPSB0aGlzLCBcblx0ICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRpdGxlKSB8fCBudWxsLFxuXHQgICAgICBjb250ZW50U3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250ZW50KSB8fCBudWxsO1xuXHQgIFxuXHQgICAgaWYgKCAhY29udGVudFN0cmluZyAmJiAhdGhpc1t0ZW1wbGF0ZV0gKSByZXR1cm47IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIGNvbnN0YW50cywgdmFyc1xuXHQgICAgdmFyIHBvcG92ZXIgPSBudWxsLCB0aW1lciA9IDAsIHBsYWNlbWVudFNldHRpbmcgPSB0aGlzW3BsYWNlbWVudF0sXG5cdCAgICAgIFxuXHQgICAgICAvLyBoYW5kbGVyc1xuXHQgICAgICBkaXNtaXNzaWJsZUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgaWYgKHBvcG92ZXIgIT09IG51bGwgJiYgZVt0YXJnZXRdID09PSBxdWVyeUVsZW1lbnQoJy5jbG9zZScscG9wb3ZlcikpIHtcblx0ICAgICAgICAgIHNlbGYuaGlkZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICBcblx0ICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG5cdCAgICAgIHJlbW92ZVBvcG92ZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZWxmW2NvbnRhaW5lcl0ucmVtb3ZlQ2hpbGQocG9wb3Zlcik7XG5cdCAgICAgICAgdGltZXIgPSBudWxsOyBwb3BvdmVyID0gbnVsbDsgXG5cdCAgICAgIH0sXG5cdCAgICAgIGNyZWF0ZVBvcG92ZXIgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aXRsZVN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGl0bGUpOyAvLyBjaGVjayBjb250ZW50IGFnYWluXG5cdCAgICAgICAgY29udGVudFN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGVudCk7XG5cdCAgXG5cdCAgICAgICAgcG9wb3ZlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcblx0ICBcblx0ICAgICAgICBpZiAoIGNvbnRlbnRTdHJpbmcgIT09IG51bGwgJiYgc2VsZlt0ZW1wbGF0ZV0gPT09IG51bGwgKSB7IC8vY3JlYXRlIHRoZSBwb3BvdmVyIGZyb20gZGF0YSBhdHRyaWJ1dGVzXG5cdCAgXG5cdCAgICAgICAgICBwb3BvdmVyW3NldEF0dHJpYnV0ZV0oJ3JvbGUnLCd0b29sdGlwJyk7XG5cdCAgXG5cdCAgICAgICAgICBpZiAodGl0bGVTdHJpbmcgIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgdmFyIHBvcG92ZXJUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG5cdCAgICAgICAgICAgIHBvcG92ZXJUaXRsZVtzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLGNvbXBvbmVudCsnLXRpdGxlJyk7XG5cdCAgXG5cdCAgICAgICAgICAgIHBvcG92ZXJUaXRsZS5pbm5lckhUTUwgPSBzZWxmW2Rpc21pc3NpYmxlXSA/IHRpdGxlU3RyaW5nICsgY2xvc2VCdG4gOiB0aXRsZVN0cmluZztcblx0ICAgICAgICAgICAgcG9wb3Zlci5hcHBlbmRDaGlsZChwb3BvdmVyVGl0bGUpO1xuXHQgICAgICAgICAgfVxuXHQgIFxuXHQgICAgICAgICAgdmFyIHBvcG92ZXJBcnJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KSwgcG9wb3ZlckNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG5cdCAgICAgICAgICBwb3BvdmVyQXJyb3dbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywnYXJyb3cnKTsgcG9wb3ZlckNvbnRlbnRbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZyxjb21wb25lbnQrJy1jb250ZW50Jyk7XG5cdCAgICAgICAgICBwb3BvdmVyLmFwcGVuZENoaWxkKHBvcG92ZXJBcnJvdyk7IHBvcG92ZXIuYXBwZW5kQ2hpbGQocG9wb3ZlckNvbnRlbnQpO1xuXHQgIFxuXHQgICAgICAgICAgLy9zZXQgcG9wb3ZlciBjb250ZW50XG5cdCAgICAgICAgICBwb3BvdmVyQ29udGVudC5pbm5lckhUTUwgPSBzZWxmW2Rpc21pc3NpYmxlXSAmJiB0aXRsZVN0cmluZyA9PT0gbnVsbCA/IGNvbnRlbnRTdHJpbmcgKyBjbG9zZUJ0biA6IGNvbnRlbnRTdHJpbmc7XG5cdCAgXG5cdCAgICAgICAgfSBlbHNlIHsgIC8vIG9yIGNyZWF0ZSB0aGUgcG9wb3ZlciBmcm9tIHRlbXBsYXRlXG5cdCAgICAgICAgICB2YXIgcG9wb3ZlclRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuXHQgICAgICAgICAgcG9wb3ZlclRlbXBsYXRlLmlubmVySFRNTCA9IHNlbGZbdGVtcGxhdGVdO1xuXHQgICAgICAgICAgcG9wb3Zlci5pbm5lckhUTUwgPSBwb3BvdmVyVGVtcGxhdGUuZmlyc3RDaGlsZC5pbm5lckhUTUw7XG5cdCAgICAgICAgfVxuXHQgIFxuXHQgICAgICAgIC8vYXBwZW5kIHRvIHRoZSBjb250YWluZXJcblx0ICAgICAgICBzZWxmW2NvbnRhaW5lcl0uYXBwZW5kQ2hpbGQocG9wb3Zlcik7XG5cdCAgICAgICAgcG9wb3ZlcltzdHlsZV0uZGlzcGxheSA9ICdibG9jayc7XG5cdCAgICAgICAgcG9wb3ZlcltzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCBjb21wb25lbnQrICcgJyArIHBsYWNlbWVudFNldHRpbmcgKyAnICcgKyBzZWxmW2FuaW1hdGlvbl0pO1xuXHQgICAgICB9LFxuXHQgICAgICBzaG93UG9wb3ZlciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAhaGFzQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSAmJiAoIGFkZENsYXNzKHBvcG92ZXIsaW5DbGFzcykgKTtcblx0ICAgICAgfSxcblx0ICAgICAgdXBkYXRlUG9wb3ZlciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHN0eWxlVGlwKGVsZW1lbnQscG9wb3ZlcixwbGFjZW1lbnRTZXR0aW5nLHNlbGZbY29udGFpbmVyXSk7XG5cdCAgICAgICAgaWYgKCFpc0VsZW1lbnRJblZpZXdwb3J0KHBvcG92ZXIpICkgeyBcblx0ICAgICAgICAgIHBsYWNlbWVudFNldHRpbmcgPSB1cGRhdGVQbGFjZW1lbnQocGxhY2VtZW50U2V0dGluZyk7IFxuXHQgICAgICAgICAgc3R5bGVUaXAoZWxlbWVudCxwb3BvdmVyLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTsgXG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHMgLyBoYW5kbGVyc1xuXHQgICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKHBvcG92ZXIgPT09IG51bGwpIHsgc2VsZi5zaG93KCk7IH0gXG5cdCAgICAgIGVsc2UgeyBzZWxmLmhpZGUoKTsgfVxuXHQgICAgfTtcblx0ICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmIChwb3BvdmVyID09PSBudWxsKSB7XG5cdCAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gc2VsZltwbGFjZW1lbnRdOyAvLyB3ZSByZXNldCBwbGFjZW1lbnQgaW4gYWxsIGNhc2VzXG5cdCAgICAgICAgICBjcmVhdGVQb3BvdmVyKCk7XG5cdCAgICAgICAgICB1cGRhdGVQb3BvdmVyKCk7XG5cdCAgICAgICAgICBzaG93UG9wb3ZlcigpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChwb3BvdmVyLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCAyMCApO1xuXHQgICAgfTtcblx0ICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmIChwb3BvdmVyICYmIHBvcG92ZXIgIT09IG51bGwgJiYgaGFzQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSkge1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyhwb3BvdmVyLGluQ2xhc3MpO1xuXHQgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQocG9wb3ZlciwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHJlbW92ZVBvcG92ZXIoKTtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgc2VsZltkZWxheV0gKTtcblx0ICAgIH07XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nUG9wb3ZlciBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgaWYgKHNlbGZbdHJpZ2dlcl0gPT09IGhvdmVyRXZlbnQpIHtcblx0ICAgICAgICBvbiggZWxlbWVudCwgbW91c2VIb3ZlclswXSwgc2VsZi5zaG93ICk7XG5cdCAgICAgICAgaWYgKCFzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZWxlbWVudCwgbW91c2VIb3ZlclsxXSwgc2VsZi5oaWRlICk7IH1cblx0ICAgICAgfSBlbHNlIGlmICgvXihjbGlja3xmb2N1cykkLy50ZXN0KHNlbGZbdHJpZ2dlcl0pKSB7XG5cdCAgICAgICAgb24oIGVsZW1lbnQsIHNlbGZbdHJpZ2dlcl0sIHNlbGYudG9nZ2xlICk7XG5cdCAgICAgICAgaWYgKCFzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZWxlbWVudCwgJ2JsdXInLCBzZWxmLmhpZGUgKTsgfVxuXHQgICAgICB9XG5cdCAgICAgIFxuXHQgICAgICBpZiAoc2VsZltkaXNtaXNzaWJsZV0pIHsgb24oIGRvY3VtZW50LCBjbGlja0V2ZW50LCBkaXNtaXNzaWJsZUhhbmRsZXIgKTsgfVxuXHQgICAgXG5cdCAgICAgIC8vIGRpc21pc3Mgb24gd2luZG93IHJlc2l6ZVxuXHQgICAgICBpZiAoICEoaXNJRSAmJiBpc0lFIDwgOSkgKSB7IG9uKCBnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLmhpZGUgKTsgfVxuXHQgIFxuXHQgICAgfVxuXHQgICAgZWxlbWVudFtzdHJpbmdQb3BvdmVyXSA9IHNlbGY7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBQT1BPVkVSIERBVEEgQVBJXG5cdCAgLy8gPT09PT09PT09PT09PT09PVxuXHQgIGluaXRpYWxpemVEYXRhQVBJKHN0cmluZ1BvcG92ZXIsIFBvcG92ZXIsIGRhdGFUb2dnbGUpO1xuXHQgIFxuXHQgIFxuXHQgIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IFNjcm9sbFNweVxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0ICBcblx0ICAvLyBTQ1JPTExTUFkgREVGSU5JVElPTlxuXHQgIC8vID09PT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIFNjcm9sbFNweSA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcblx0ICBcblx0ICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnQsIHRoZSBlbGVtZW50IHdlIHNweSBvblxuXHQgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTsgXG5cdCAgXG5cdCAgICAvLyBEQVRBIEFQSVxuXHQgICAgdmFyIHRhcmdldERhdGEgPSBxdWVyeUVsZW1lbnQoZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpKTtcblx0ICBcblx0ICAgIC8vIHNldCBvcHRpb25zXG5cdCAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblx0ICAgIGlmICggIW9wdGlvbnNbdGFyZ2V0XSAmJiAhdGFyZ2V0RGF0YSApIHsgcmV0dXJuOyB9IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIGV2ZW50IHRhcmdldHMsIGNvbnN0YW50c1xuXHQgICAgdmFyIHNweVRhcmdldCA9IG9wdGlvbnNbdGFyZ2V0XSAmJiBxdWVyeUVsZW1lbnQob3B0aW9uc1t0YXJnZXRdKSB8fCB0YXJnZXREYXRhLFxuXHQgICAgICAgIGxpbmtzID0gc3B5VGFyZ2V0ICYmIHNweVRhcmdldFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJ0EnKSwgXG5cdCAgICAgICAgaXRlbXMgPSBbXSwgdGFyZ2V0SXRlbXMgPSBbXSwgc2Nyb2xsT2Zmc2V0LFxuXHQgICAgICAgIHNjcm9sbFRhcmdldCA9IGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSA8IGVsZW1lbnRbc2Nyb2xsSGVpZ2h0XSA/IGVsZW1lbnQgOiBnbG9iYWxPYmplY3QsIC8vIGRldGVybWluZSB3aGljaCBpcyB0aGUgcmVhbCBzY3JvbGxUYXJnZXRcblx0ICAgICAgICBpc1dpbmRvdyA9IHNjcm9sbFRhcmdldCA9PT0gZ2xvYmFsT2JqZWN0OyAgXG5cdCAgXG5cdCAgICAvLyBwb3B1bGF0ZSBpdGVtcyBhbmQgdGFyZ2V0c1xuXHQgICAgZm9yICh2YXIgaT0wLCBpbD1saW5rc1tsZW5ndGhdOyBpPGlsOyBpKyspIHtcblx0ICAgICAgdmFyIGhyZWYgPSBsaW5rc1tpXVtnZXRBdHRyaWJ1dGVdKCdocmVmJyksIFxuXHQgICAgICAgICAgdGFyZ2V0SXRlbSA9IGhyZWYgJiYgLyNbYS16MC05XSskL2kudGVzdChocmVmKSAmJiBxdWVyeUVsZW1lbnQoaHJlZik7XG5cdCAgICAgIGlmICggISF0YXJnZXRJdGVtICkge1xuXHQgICAgICAgIGl0ZW1zLnB1c2gobGlua3NbaV0pO1xuXHQgICAgICAgIHRhcmdldEl0ZW1zLnB1c2godGFyZ2V0SXRlbSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICBcblx0ICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgdmFyIHVwZGF0ZUl0ZW0gPSBmdW5jdGlvbihpbmRleCkge1xuXHQgICAgICAgIHZhciBwYXJlbnQgPSBpdGVtc1tpbmRleF1bcGFyZW50Tm9kZV0sIC8vIGl0ZW0ncyBwYXJlbnQgTEkgZWxlbWVudFxuXHQgICAgICAgICAgdGFyZ2V0SXRlbSA9IHRhcmdldEl0ZW1zW2luZGV4XSwgLy8gdGhlIG1lbnUgaXRlbSB0YXJnZXRzIHRoaXMgZWxlbWVudFxuXHQgICAgICAgICAgZHJvcGRvd24gPSBnZXRDbG9zZXN0KHBhcmVudCwnLmRyb3Bkb3duJyksXG5cdCAgICAgICAgICB0YXJnZXRSZWN0ID0gaXNXaW5kb3cgJiYgdGFyZ2V0SXRlbVtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCksXG5cdCAgXG5cdCAgICAgICAgICBpc0FjdGl2ZSA9IGhhc0NsYXNzKHBhcmVudCxhY3RpdmUpIHx8IGZhbHNlLFxuXHQgIFxuXHQgICAgICAgICAgdG9wRWRnZSA9IGlzV2luZG93ID8gdGFyZ2V0UmVjdFt0b3BdICsgc2Nyb2xsT2Zmc2V0IDogdGFyZ2V0SXRlbVtvZmZzZXRUb3BdIC0gKHRhcmdldEl0ZW1zW2luZGV4LTFdID8gMCA6IDEwKSxcblx0ICAgICAgICAgIGJvdHRvbUVkZ2UgPSBpc1dpbmRvdyA/IHRhcmdldFJlY3RbYm90dG9tXSArIHNjcm9sbE9mZnNldCA6IHRhcmdldEl0ZW1zW2luZGV4KzFdID8gdGFyZ2V0SXRlbXNbaW5kZXgrMV1bb2Zmc2V0VG9wXSA6IGVsZW1lbnRbc2Nyb2xsSGVpZ2h0XSxcblx0ICBcblx0ICAgICAgICAgIGluc2lkZSA9IHNjcm9sbE9mZnNldCA+PSB0b3BFZGdlICYmIGJvdHRvbUVkZ2UgPiBzY3JvbGxPZmZzZXQ7XG5cdCAgXG5cdCAgICAgICAgaWYgKCAhaXNBY3RpdmUgJiYgaW5zaWRlICkge1xuXHQgICAgICAgICAgaWYgKCBwYXJlbnQudGFnTmFtZSA9PT0gJ0xJJyAmJiAhaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgKSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKHBhcmVudCxhY3RpdmUpO1xuXHQgICAgICAgICAgICBpc0FjdGl2ZSA9IHRydWU7XG5cdCAgICAgICAgICAgIGlmIChkcm9wZG93biAmJiAhaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSApIHtcblx0ICAgICAgICAgICAgICBhZGRDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgJ2FjdGl2YXRlJywgJ3Njcm9sbHNweScsIGl0ZW1zW2luZGV4XSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIGlmICggIWluc2lkZSApIHtcblx0ICAgICAgICAgIGlmICggcGFyZW50LnRhZ05hbWUgPT09ICdMSScgJiYgaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgKSB7XG5cdCAgICAgICAgICAgIHJlbW92ZUNsYXNzKHBhcmVudCxhY3RpdmUpO1xuXHQgICAgICAgICAgICBpc0FjdGl2ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgICBpZiAoZHJvcGRvd24gJiYgaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSAmJiAhZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShwYXJlbnRbcGFyZW50Tm9kZV0sYWN0aXZlKS5sZW5ndGggKSB7XG5cdCAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoZHJvcGRvd24sYWN0aXZlKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSBpZiAoICFpbnNpZGUgJiYgIWlzQWN0aXZlIHx8IGlzQWN0aXZlICYmIGluc2lkZSApIHtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHVwZGF0ZUl0ZW1zID0gZnVuY3Rpb24oKXtcblx0ICAgICAgICBzY3JvbGxPZmZzZXQgPSBpc1dpbmRvdyA/IGdldFNjcm9sbCgpLnkgOiBlbGVtZW50W3Njcm9sbFRvcF07XG5cdCAgICAgICAgZm9yICh2YXIgaW5kZXg9MCwgaXRsPWl0ZW1zW2xlbmd0aF07IGluZGV4PGl0bDsgaW5kZXgrKykge1xuXHQgICAgICAgICAgdXBkYXRlSXRlbShpbmRleClcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHVwZGF0ZUl0ZW1zKCk7XG5cdCAgICB9XG5cdCAgXG5cdCAgICAvLyBpbml0XG5cdCAgICBpZiAoICEoc3RyaW5nU2Nyb2xsU3B5IGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuXHQgICAgICBvbiggc2Nyb2xsVGFyZ2V0LCBzY3JvbGxFdmVudCwgdGhpcy5yZWZyZXNoICk7XG5cdCAgICAgIGlmICggIShpc0lFICYmIGlzSUUgPCA5KSkgeyBcblx0ICAgICAgICBvbiggZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgdGhpcy5yZWZyZXNoICk7IFxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICB0aGlzLnJlZnJlc2goKTtcblx0ICAgIGVsZW1lbnRbc3RyaW5nU2Nyb2xsU3B5XSA9IHRoaXM7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBTQ1JPTExTUFkgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdTY3JvbGxTcHksIFNjcm9sbFNweSwgZGF0YVNweSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgVGFiXG5cdCAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHQgIFxuXHQgIC8vIFRBQiBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT1cblx0ICB2YXIgVGFiID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG5cdCAgXG5cdCAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG5cdCAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuXHQgIFxuXHQgICAgLy8gREFUQSBBUElcblx0ICAgIHZhciBoZWlnaHREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFIZWlnaHQpLFxuXHQgICAgICBcblx0ICAgICAgICAvLyBzdHJpbmdzXG5cdCAgICAgICAgY29tcG9uZW50ID0gJ3RhYicsIGhlaWdodCA9ICdoZWlnaHQnLCBpc0FuaW1hdGluZyA9ICdpc0FuaW1hdGluZyc7XG5cdCAgXG5cdCAgICAvLyBzZXQgZGVmYXVsdCBhbmltYXRpb24gc3RhdGVcblx0ICAgIGVsZW1lbnRbaXNBbmltYXRpbmddID0gZmFsc2U7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICB0aGlzW2hlaWdodF0gPSBzdXBwb3J0VHJhbnNpdGlvbnMgPyAob3B0aW9uc1toZWlnaHRdIHx8IGhlaWdodERhdGEgPT09ICd0cnVlJykgOiBmYWxzZTsgLy8gZmlsdGVyIGxlZ2FjeSBicm93c2Vyc1xuXHQgIFxuXHQgICAgLy8gYmluZCwgZXZlbnQgdGFyZ2V0c1xuXHQgICAgdmFyIHNlbGYgPSB0aGlzLCBuZXh0LFxuXHQgICAgICB0YWJzID0gZ2V0Q2xvc2VzdChlbGVtZW50LCcubmF2JyksXG5cdCAgICAgIHRhYnNDb250ZW50Q29udGFpbmVyLFxuXHQgICAgICBkcm9wZG93biA9IHF1ZXJ5RWxlbWVudCgnLmRyb3Bkb3duJyx0YWJzKTtcblx0ICBcblx0ICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgdmFyIGdldEFjdGl2ZVRhYiA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBhY3RpdmVUYWJzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0YWJzLGFjdGl2ZSksIGFjdGl2ZVRhYjtcblx0ICAgICAgICBpZiAoIGFjdGl2ZVRhYnNbbGVuZ3RoXSA9PT0gMSAmJiAhaGFzQ2xhc3MoYWN0aXZlVGFic1swXSwnZHJvcGRvd24nKSApIHtcblx0ICAgICAgICAgIGFjdGl2ZVRhYiA9IGFjdGl2ZVRhYnNbMF07XG5cdCAgICAgICAgfSBlbHNlIGlmICggYWN0aXZlVGFic1tsZW5ndGhdID4gMSApIHtcblx0ICAgICAgICAgIGFjdGl2ZVRhYiA9IGFjdGl2ZVRhYnNbYWN0aXZlVGFic1tsZW5ndGhdLTFdO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gYWN0aXZlVGFiW2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnQScpWzBdO1xuXHQgICAgICB9LFxuXHQgICAgICBnZXRBY3RpdmVDb250ZW50ID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIHF1ZXJ5RWxlbWVudChnZXRBY3RpdmVUYWIoKVtnZXRBdHRyaWJ1dGVdKCdocmVmJykpO1xuXHQgICAgICB9LFxuXHQgICAgICAvLyBoYW5kbGVyIFxuXHQgICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgICAgIG5leHQgPSBlW3RhcmdldF07XG5cdCAgICAgICAgc2VsZi5zaG93KCk7XG5cdCAgICAgIH07XG5cdCAgXG5cdCAgICAvLyBwdWJsaWMgbWV0aG9kXG5cdCAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHsgLy8gdGhlIHRhYiB3ZSBjbGlja2VkIGlzIG5vdyB0aGUgbmV4dCB0YWJcblx0ICAgICAgdmFyIG5leHRDb250ZW50ID0gcXVlcnlFbGVtZW50KG5leHRbZ2V0QXR0cmlidXRlXSgnaHJlZicpKSwgLy90aGlzIGlzIHRoZSBhY3R1YWwgb2JqZWN0LCB0aGUgbmV4dCB0YWIgY29udGVudCB0byBhY3RpdmF0ZVxuXHQgICAgICAgIGFjdGl2ZVRhYiA9IGdldEFjdGl2ZVRhYigpLCBhY3RpdmVDb250ZW50ID0gZ2V0QWN0aXZlQ29udGVudCgpO1xuXHQgICAgICBcblx0ICAgICAgaWYgKCAoIWFjdGl2ZVRhYltpc0FuaW1hdGluZ10gfHwgIW5leHRbaXNBbmltYXRpbmddKSAmJiAhaGFzQ2xhc3MobmV4dFtwYXJlbnROb2RlXSxhY3RpdmUpICkge1xuXHQgICAgICAgIGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IHRydWU7XG5cdCAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlVGFiW3BhcmVudE5vZGVdLGFjdGl2ZSk7XG5cdCAgICAgICAgYWRkQ2xhc3MobmV4dFtwYXJlbnROb2RlXSxhY3RpdmUpO1xuXHQgIFxuXHQgICAgICAgIGlmICggZHJvcGRvd24gKSB7XG5cdCAgICAgICAgICBpZiAoICFoYXNDbGFzcyhlbGVtZW50W3BhcmVudE5vZGVdW3BhcmVudE5vZGVdLCdkcm9wZG93bi1tZW51JykgKSB7XG5cdCAgICAgICAgICAgIGlmIChoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpKSByZW1vdmVDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaWYgKCFoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpKSBhZGRDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBcblx0ICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIHRhYnNDb250ZW50Q29udGFpbmVyW3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGFjdGl2ZUNvbnRlbnQpICsgJ3B4JzsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuXHQgIFxuXHQgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoYWN0aXZlVGFiLCBoaWRlRXZlbnQsIGNvbXBvbmVudCwgbmV4dCk7XG5cdCAgXG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGFjdGl2ZUNvbnRlbnQsaW5DbGFzcyk7XG5cdCAgICAgICAgfSwgMCk7XG5cdCAgXG5cdCAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoYWN0aXZlQ29udGVudCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICBpZiAodGFic0NvbnRlbnRDb250YWluZXIpIGFkZENsYXNzKHRhYnNDb250ZW50Q29udGFpbmVyLGNvbGxhcHNpbmcpO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoYWN0aXZlQ29udGVudCxhY3RpdmUpO1xuXHQgICAgICAgICAgYWRkQ2xhc3MobmV4dENvbnRlbnQsYWN0aXZlKTtcblx0ICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIGFkZENsYXNzKG5leHRDb250ZW50LGluQ2xhc3MpO1xuXHQgICAgICAgICAgICBpZih0YWJzQ29udGVudENvbnRhaW5lcikgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQobmV4dENvbnRlbnQpICsgJ3B4JzsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuXHQgICAgICAgICAgfSwgMCk7XG5cdCAgXG5cdCAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG5leHQsIHNob3dFdmVudCwgY29tcG9uZW50LCBhY3RpdmVUYWIpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChhY3RpdmVUYWIsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQsIG5leHQpO1xuXHQgIFxuXHQgICAgICAgIH0pO1xuXHQgIFxuXHQgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKG5leHRDb250ZW50LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobmV4dCwgc2hvd25FdmVudCwgY29tcG9uZW50LCBhY3RpdmVUYWIpO1xuXHQgICAgICAgICAgaWYgKHRhYnNDb250ZW50Q29udGFpbmVyKSB7IC8vIGhlaWdodCBhbmltYXRpb25cblx0ICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHQgICAgICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHRhYnNDb250ZW50Q29udGFpbmVyLCBmdW5jdGlvbigpe1xuXHQgICAgICAgICAgICAgICAgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSAgJyc7XG5cdCAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyh0YWJzQ29udGVudENvbnRhaW5lcixjb2xsYXBzaW5nKTtcblx0ICAgICAgICAgICAgICAgIGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIH0pXG5cdCAgICAgICAgICAgIH0sMCk7XG5cdCAgICAgICAgICB9IGVsc2UgeyBhY3RpdmVUYWJbaXNBbmltYXRpbmddID0gbmV4dFtpc0FuaW1hdGluZ10gPSBmYWxzZTsgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ1RhYiBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2Vcblx0ICAgICAgb24oZWxlbWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTtcblx0ICAgIH1cblx0ICAgIGlmICh0aGlzW2hlaWdodF0pIHsgdGFic0NvbnRlbnRDb250YWluZXIgPSBnZXRBY3RpdmVDb250ZW50KClbcGFyZW50Tm9kZV07IH1cblx0ICAgIGVsZW1lbnRbc3RyaW5nVGFiXSA9IHRoaXM7XG5cdCAgfTtcblx0ICBcblx0ICAvLyBUQUIgREFUQSBBUElcblx0ICAvLyA9PT09PT09PT09PT1cblx0ICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdUYWIsIFRhYiwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgVG9vbHRpcFxuXHQgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdCAgXG5cdCAgLy8gVE9PTFRJUCBERUZJTklUSU9OXG5cdCAgLy8gPT09PT09PT09PT09PT09PT09XG5cdCAgdmFyIFRvb2x0aXAgPSBmdW5jdGlvbiggZWxlbWVudCxvcHRpb25zICkge1xuXHQgIFxuXHQgICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuXHQgICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcblx0ICBcblx0ICAgIC8vIERBVEEgQVBJXG5cdCAgICB2YXIgYW5pbWF0aW9uRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQW5pbWF0aW9uKTtcblx0ICAgICAgICBwbGFjZW1lbnREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFQbGFjZW1lbnQpO1xuXHQgICAgICAgIGRlbGF5RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhRGVsYXkpLFxuXHQgICAgICAgIGNvbnRhaW5lckRhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUNvbnRhaW5lciksXG5cdCAgICAgICAgXG5cdCAgICAgICAgLy8gc3RyaW5nc1xuXHQgICAgICAgIGNvbXBvbmVudCA9ICd0b29sdGlwJyxcblx0ICAgICAgICBjbGFzc1N0cmluZyA9ICdjbGFzcycsXG5cdCAgICAgICAgdGl0bGUgPSAndGl0bGUnLFxuXHQgICAgICAgIGZhZGUgPSAnZmFkZScsXG5cdCAgICAgICAgZGl2ID0gJ2Rpdic7XG5cdCAgXG5cdCAgICAvLyBzZXQgb3B0aW9uc1xuXHQgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdCAgICB0aGlzW2FuaW1hdGlvbl0gPSBvcHRpb25zW2FuaW1hdGlvbl0gJiYgb3B0aW9uc1thbmltYXRpb25dICE9PSBmYWRlID8gb3B0aW9uc1thbmltYXRpb25dIDogYW5pbWF0aW9uRGF0YSB8fCBmYWRlO1xuXHQgICAgdGhpc1twbGFjZW1lbnRdID0gb3B0aW9uc1twbGFjZW1lbnRdID8gb3B0aW9uc1twbGFjZW1lbnRdIDogcGxhY2VtZW50RGF0YSB8fCB0b3A7XG5cdCAgICB0aGlzW2RlbGF5XSA9IHBhcnNlSW50KG9wdGlvbnNbZGVsYXldIHx8IGRlbGF5RGF0YSkgfHwgMjAwO1xuXHQgICAgdGhpc1tjb250YWluZXJdID0gcXVlcnlFbGVtZW50KG9wdGlvbnNbY29udGFpbmVyXSkgfHwgcXVlcnlFbGVtZW50KGNvbnRhaW5lckRhdGEpIHx8IGJvZHk7XG5cdCAgXG5cdCAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzLCB0aXRsZSBhbmQgY29uc3RhbnRzXG5cdCAgICB2YXIgc2VsZiA9IHRoaXMsIHRpbWVyID0gMCwgcGxhY2VtZW50U2V0dGluZyA9IHRoaXNbcGxhY2VtZW50XSwgdG9vbHRpcCA9IG51bGwsXG5cdCAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKHRpdGxlKSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGl0bGUpO1xuXHQgIFxuXHQgICAgaWYgKCAhdGl0bGVTdHJpbmcgKSByZXR1cm47IC8vIGludmFsaWRhdGVcblx0ICBcblx0ICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuXHQgICAgdmFyIHJlbW92ZVRvb2xUaXAgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgICBzZWxmW2NvbnRhaW5lcl0ucmVtb3ZlQ2hpbGQodG9vbHRpcCk7XG5cdCAgICAgICAgdG9vbHRpcCA9IG51bGw7IHRpbWVyID0gbnVsbDtcblx0ICAgICAgfSxcblx0ICAgICAgY3JlYXRlVG9vbFRpcCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKHRpdGxlKSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGl0bGUpOyAvLyByZWFkIHRoZSB0aXRsZSBhZ2FpblxuXHQgICAgICAgIHRvb2x0aXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG5cdCAgICAgICAgdG9vbHRpcFtzZXRBdHRyaWJ1dGVdKCdyb2xlJyxjb21wb25lbnQpO1xuXHQgIFxuXHQgICAgICAgIHZhciB0b29sdGlwQXJyb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdiksIHRvb2x0aXBJbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcblx0ICAgICAgICB0b29sdGlwQXJyb3dbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywgY29tcG9uZW50KyctYXJyb3cnKTsgdG9vbHRpcElubmVyW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsY29tcG9uZW50KyctaW5uZXInKTtcblx0ICBcblx0ICAgICAgICB0b29sdGlwLmFwcGVuZENoaWxkKHRvb2x0aXBBcnJvdyk7IHRvb2x0aXAuYXBwZW5kQ2hpbGQodG9vbHRpcElubmVyKTtcblx0ICBcblx0ICAgICAgICB0b29sdGlwSW5uZXIuaW5uZXJIVE1MID0gdGl0bGVTdHJpbmc7XG5cdCAgXG5cdCAgICAgICAgc2VsZltjb250YWluZXJdLmFwcGVuZENoaWxkKHRvb2x0aXApO1xuXHQgICAgICAgIHRvb2x0aXBbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywgY29tcG9uZW50ICsgJyAnICsgcGxhY2VtZW50U2V0dGluZyArICcgJyArIHNlbGZbYW5pbWF0aW9uXSk7XG5cdCAgICAgIH0sXG5cdCAgICAgIHVwZGF0ZVRvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgc3R5bGVUaXAoZWxlbWVudCx0b29sdGlwLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTtcblx0ICAgICAgICBpZiAoIWlzRWxlbWVudEluVmlld3BvcnQodG9vbHRpcCkgKSB7IFxuXHQgICAgICAgICAgcGxhY2VtZW50U2V0dGluZyA9IHVwZGF0ZVBsYWNlbWVudChwbGFjZW1lbnRTZXR0aW5nKTsgXG5cdCAgICAgICAgICBzdHlsZVRpcChlbGVtZW50LHRvb2x0aXAscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pOyBcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHNob3dUb29sdGlwID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICFoYXNDbGFzcyh0b29sdGlwLGluQ2xhc3MpICYmICggYWRkQ2xhc3ModG9vbHRpcCxpbkNsYXNzKSApO1xuXHQgICAgICB9O1xuXHQgIFxuXHQgICAgLy8gcHVibGljIG1ldGhvZHNcblx0ICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICh0b29sdGlwID09PSBudWxsKSB7XG5cdCAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gc2VsZltwbGFjZW1lbnRdOyAvLyB3ZSByZXNldCBwbGFjZW1lbnQgaW4gYWxsIGNhc2VzXG5cdCAgICAgICAgICBjcmVhdGVUb29sVGlwKCk7XG5cdCAgICAgICAgICB1cGRhdGVUb29sdGlwKCk7XG5cdCAgICAgICAgICBzaG93VG9vbHRpcCgpO1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZCh0b29sdGlwLCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCAyMCApO1xuXHQgICAgfTtcblx0ICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuXHQgICAgICB0aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIGlmICh0b29sdGlwICYmIHRvb2x0aXAgIT09IG51bGwgJiYgaGFzQ2xhc3ModG9vbHRpcCxpbkNsYXNzKSkge1xuXHQgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG5cdCAgICAgICAgICByZW1vdmVDbGFzcyh0b29sdGlwLGluQ2xhc3MpO1xuXHQgICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQodG9vbHRpcCwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgIHJlbW92ZVRvb2xUaXAoKTtcblx0ICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgc2VsZltkZWxheV0pO1xuXHQgICAgfTtcblx0ICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmICghdG9vbHRpcCkgeyBzZWxmLnNob3coKTsgfSBcblx0ICAgICAgZWxzZSB7IHNlbGYuaGlkZSgpOyB9XG5cdCAgICB9O1xuXHQgIFxuXHQgICAgLy8gaW5pdFxuXHQgICAgaWYgKCAhKHN0cmluZ1Rvb2x0aXAgaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG5cdCAgICAgIGVsZW1lbnRbc2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUaXRsZSx0aXRsZVN0cmluZyk7XG5cdCAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHRpdGxlKTtcblx0ICAgICAgb24oZWxlbWVudCwgbW91c2VIb3ZlclswXSwgdGhpcy5zaG93KTtcblx0ICAgICAgb24oZWxlbWVudCwgbW91c2VIb3ZlclsxXSwgdGhpcy5oaWRlKTtcblx0ICAgIH1cblx0ICAgIGVsZW1lbnRbc3RyaW5nVG9vbHRpcF0gPSB0aGlzO1xuXHQgIH07XG5cdCAgXG5cdCAgLy8gVE9PTFRJUCBEQVRBIEFQSVxuXHQgIC8vID09PT09PT09PT09PT09PT09XG5cdCAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nVG9vbHRpcCwgVG9vbHRpcCwgZGF0YVRvZ2dsZSk7XG5cdCAgXG5cdCAgXG5cdCAgcmV0dXJuIHtcblx0ICAgIEFmZml4OiBBZmZpeCxcblx0ICAgIEFsZXJ0OiBBbGVydCxcblx0ICAgIEJ1dHRvbjogQnV0dG9uLFxuXHQgICAgQ2Fyb3VzZWw6IENhcm91c2VsLFxuXHQgICAgQ29sbGFwc2U6IENvbGxhcHNlLFxuXHQgICAgRHJvcGRvd246IERyb3Bkb3duLFxuXHQgICAgTW9kYWw6IE1vZGFsLFxuXHQgICAgUG9wb3ZlcjogUG9wb3Zlcixcblx0ICAgIFNjcm9sbFNweTogU2Nyb2xsU3B5LFxuXHQgICAgVGFiOiBUYWIsXG5cdCAgICBUb29sdGlwOiBUb29sdGlwXG5cdCAgfTtcblx0fSkpO1xuXHRcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSkpKVxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gbXktY29tLmpzIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgZmFkYjQ4MTcxMzFjYzYwZWM4MTUiLCIvKlxuZnVuY3Rpb24gY2hlY2tWYWx1ZXMgKGVsbU5hbWUpIHtcbiAgICBhbGVydChlbG1OYW1lKTtcbn1cblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3NlYXJjaFBlcnNvbiBpbnB1dCcpLmZvckVhY2goKGN1cikgPT4ge1xuICAgIGN1ci5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGNoZWNrVmFsdWVzKCcjc2VhcmNoUGVyc29uJykpO1xufSk7Ki9cbmltcG9ydCBic24gZnJvbSAnYm9vdHN0cmFwLm5hdGl2ZSc7XG5cbmlmKGRvY3VtZW50LmJvZHkuaWQgPT0gJ2ZpbmRQZXJzb25Cb2R5Jykge1xuICAgIGxldCBibG5SZW1vdmVTdW1iaXQgPSB0cnVlO1xuICAgIGNvbnN0IGVsbUlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNzZWFyY2hQZXJzb24gaW5wdXQnKTtcbiAgICBjb25zdCBidG5TdW1iaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ZpbmRQZXJzb25cIik7XG4gICAgY29uc3QgYnRuRmluZFBlcnNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZWFyY2hQaG9uZScpO1xuXG4gICAgZWxtSW5wdXRzLmZvckVhY2goKGN1cjIpID0+IHtcbiAgICAgICAgaWYoKGN1cjIudmFsdWUudHJpbSgpLmxlbmd0aCA9PSAwKSAmJiAoKGN1cjIubmFtZSA9PSAnTE5hbWUnKSB8fCAoY3VyMi5uYW1lID09ICdGTmFtZScpKSkge1xuICAgICAgICAgICAgYmxuUmVtb3ZlU3VtYml0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGJsblJlbW92ZVN1bWJpdCA9PT0gZmFsc2UgPyBidG5TdW1iaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsJ2Rpc2FibGVkJykgOiBudWxsO1xuXG4gICAgZWxtSW5wdXRzLmZvckVhY2goKGN1cikgPT4ge1xuICAgICAgICBjdXIuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgYmxuU3VtYml0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGxldCBpbnRSaWdodCA9IDA7XG5cbiAgICAgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKChjdXJQbGFjZWQpID0+IHtcbiAgICAgICAgICAgICAgICAoY3VyUGxhY2VkLnZhbHVlLnRyaW0oKS5sZW5ndGggIT0gMCkgJiYgKChjdXJQbGFjZWQubmFtZSA9PSAnTE5hbWUnKSB8fCAoY3VyUGxhY2VkLm5hbWUgPT0gJ0ZOYW1lJykpID8gaW50UmlnaHQrKyA6IG51bGw7XG5cbiAgICAgICAgICAgICAgICAoL15bMS05XXsxfVxcZHszfS1cXGR7Mn0tXFxkezJ9JC8udGVzdChjdXJQbGFjZWQudmFsdWUudHJpbSgpKSA9PSB0cnVlKSAmJiAoKGN1clBsYWNlZC5uYW1lID09ICdET0InKSkgPyBpbnRSaWdodCsrIDogbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmKGludFJpZ2h0ID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIGJsblN1bWJpdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJ0bkZpbmRQZXJzb24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKChlbGVtZW50LCBpbmRleCwgYXJyYXkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPD0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdteUVycm9yJyk7XG4gICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYmxuU3VtYml0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKChlbGVtZW50LCBpbmRleCwgYXJyYXkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZGV4IDw9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ215RXJyb3InKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJ0bkZpbmRQZXJzb24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGJsblN1bWJpdCA9PT0gdHJ1ZSA/IGJ0blN1bWJpdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJykgOiBidG5TdW1iaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgYnRuRmluZFBlcnNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWN0aW9uJykudmFsdWUgPSBcInNlYXJjaEJ5UGhvbmVcIjtcbiAgICB9KTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNidG5DbGVhcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIGVsbUlucHV0cy5mb3JFYWNoKChjdXIpID0+IHtcbiAgICAgICAgICAgIGN1ci52YWx1ZSA9ICcnO1xuICAgICAgICB9KTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2pzL2xheW91dC5qcyIsIi8vIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB2Mi4wLjQgfCDCqSBkbnBfdGhlbWUgfCBNSVQtTGljZW5zZVxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAvLyBBTUQgc3VwcG9ydDpcbiAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgLy8gQ29tbW9uSlMtbGlrZTpcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgIHZhciBic24gPSBmYWN0b3J5KCk7XG4gICAgcm9vdC5BZmZpeCA9IGJzbi5BZmZpeDtcbiAgICByb290LkFsZXJ0ID0gYnNuLkFsZXJ0O1xuICAgIHJvb3QuQnV0dG9uID0gYnNuLkJ1dHRvbjtcbiAgICByb290LkNhcm91c2VsID0gYnNuLkNhcm91c2VsO1xuICAgIHJvb3QuQ29sbGFwc2UgPSBic24uQ29sbGFwc2U7XG4gICAgcm9vdC5Ecm9wZG93biA9IGJzbi5Ecm9wZG93bjtcbiAgICByb290Lk1vZGFsID0gYnNuLk1vZGFsO1xuICAgIHJvb3QuUG9wb3ZlciA9IGJzbi5Qb3BvdmVyO1xuICAgIHJvb3QuU2Nyb2xsU3B5ID0gYnNuLlNjcm9sbFNweTtcbiAgICByb290LlRhYiA9IGJzbi5UYWI7XG4gICAgcm9vdC5Ub29sdGlwID0gYnNuLlRvb2x0aXA7XG4gIH1cbn0odGhpcywgZnVuY3Rpb24gKCkge1xuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgSW50ZXJuYWwgVXRpbGl0eSBGdW5jdGlvbnNcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBnbG9iYWxzXG4gIHZhciBnbG9iYWxPYmplY3QgPSB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHRoaXN8fHdpbmRvdyxcbiAgICBkb2MgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIGJvZHkgPSBkb2N1bWVudC5ib2R5LFxuICBcbiAgICAvLyBJRSBicm93c2VyIGRldGVjdFxuICAgIGlzSUUgPSAobmV3IFJlZ0V4cChcIk1TSUUgKFswLTldezEsfVtcXC4wLTldezAsfSlcIikuZXhlYyhuYXZpZ2F0b3IudXNlckFnZW50KSAhPSBudWxsKSA/IHBhcnNlRmxvYXQoIFJlZ0V4cC4kMSApIDogZmFsc2UsICBcbiAgXG4gICAgLy8gZnVuY3Rpb24gdG9nZ2xlIGF0dHJpYnV0ZXNcbiAgICBkYXRhVG9nZ2xlICAgID0gJ2RhdGEtdG9nZ2xlJyxcbiAgICBkYXRhRGlzbWlzcyAgID0gJ2RhdGEtZGlzbWlzcycsXG4gICAgZGF0YVNweSAgICAgICA9ICdkYXRhLXNweScsXG4gICAgZGF0YVJpZGUgICAgICA9ICdkYXRhLXJpZGUnLFxuICAgIFxuICAgIC8vIGNvbXBvbmVudHNcbiAgICBzdHJpbmdBZmZpeCAgICAgPSAnQWZmaXgnLFxuICAgIHN0cmluZ0FsZXJ0ICAgICA9ICdBbGVydCcsXG4gICAgc3RyaW5nQnV0dG9uICAgID0gJ0J1dHRvbicsXG4gICAgc3RyaW5nQ2Fyb3VzZWwgID0gJ0Nhcm91c2VsJyxcbiAgICBzdHJpbmdDb2xsYXBzZSAgPSAnQ29sbGFwc2UnLFxuICAgIHN0cmluZ0Ryb3Bkb3duICA9ICdEcm9wZG93bicsXG4gICAgc3RyaW5nTW9kYWwgICAgID0gJ01vZGFsJyxcbiAgICBzdHJpbmdQb3BvdmVyICAgPSAnUG9wb3ZlcicsXG4gICAgc3RyaW5nU2Nyb2xsU3B5ID0gJ1Njcm9sbFNweScsXG4gICAgc3RyaW5nVGFiICAgICAgID0gJ1RhYicsXG4gICAgc3RyaW5nVG9vbHRpcCAgID0gJ1Rvb2x0aXAnLFxuICBcbiAgICAvLyBvcHRpb25zIERBVEEgQVBJXG4gICAgZGF0YWJhY2tkcm9wICAgICAgPSAnZGF0YS1iYWNrZHJvcCcsXG4gICAgZGF0YUtleWJvYXJkICAgICAgPSAnZGF0YS1rZXlib2FyZCcsXG4gICAgZGF0YVRhcmdldCAgICAgICAgPSAnZGF0YS10YXJnZXQnLFxuICAgIGRhdGFJbnRlcnZhbCAgICAgID0gJ2RhdGEtaW50ZXJ2YWwnLFxuICAgIGRhdGFIZWlnaHQgICAgICAgID0gJ2RhdGEtaGVpZ2h0JyxcbiAgICBkYXRhUGF1c2UgICAgICAgICA9ICdkYXRhLXBhdXNlJyxcbiAgICBkYXRhT3JpZ2luYWxUaXRsZSA9ICdkYXRhLW9yaWdpbmFsLXRpdGxlJyxcbiAgICBkYXRhT3JpZ2luYWxUZXh0ICA9ICdkYXRhLW9yaWdpbmFsLXRleHQnLFxuICAgIGRhdGFEaXNtaXNzaWJsZSAgID0gJ2RhdGEtZGlzbWlzc2libGUnLFxuICAgIGRhdGFUcmlnZ2VyICAgICAgID0gJ2RhdGEtdHJpZ2dlcicsXG4gICAgZGF0YUFuaW1hdGlvbiAgICAgPSAnZGF0YS1hbmltYXRpb24nLFxuICAgIGRhdGFDb250YWluZXIgICAgID0gJ2RhdGEtY29udGFpbmVyJyxcbiAgICBkYXRhUGxhY2VtZW50ICAgICA9ICdkYXRhLXBsYWNlbWVudCcsXG4gICAgZGF0YURlbGF5ICAgICAgICAgPSAnZGF0YS1kZWxheScsXG4gICAgZGF0YU9mZnNldFRvcCAgICAgPSAnZGF0YS1vZmZzZXQtdG9wJyxcbiAgICBkYXRhT2Zmc2V0Qm90dG9tICA9ICdkYXRhLW9mZnNldC1ib3R0b20nLFxuICBcbiAgICAvLyBvcHRpb24ga2V5c1xuICAgIGJhY2tkcm9wID0gJ2JhY2tkcm9wJywga2V5Ym9hcmQgPSAna2V5Ym9hcmQnLCBkZWxheSA9ICdkZWxheScsXG4gICAgZHVyYXRpb24gPSAnZHVyYXRpb24nLCBjb250ZW50ID0gJ2NvbnRlbnQnLCB0YXJnZXQgPSAndGFyZ2V0JywgXG4gICAgaW50ZXJ2YWwgPSAnaW50ZXJ2YWwnLCBwYXVzZSA9ICdwYXVzZScsIGFuaW1hdGlvbiA9ICdhbmltYXRpb24nLFxuICAgIHBsYWNlbWVudCA9ICdwbGFjZW1lbnQnLCBjb250YWluZXIgPSAnY29udGFpbmVyJywgXG4gIFxuICAgIC8vIGJveCBtb2RlbFxuICAgIG9mZnNldFRvcCAgICA9ICdvZmZzZXRUb3AnLCAgICAgIG9mZnNldEJvdHRvbSAgID0gJ29mZnNldEJvdHRvbScsXG4gICAgb2Zmc2V0TGVmdCAgID0gJ29mZnNldExlZnQnLFxuICAgIHNjcm9sbFRvcCAgICA9ICdzY3JvbGxUb3AnLCAgICAgIHNjcm9sbExlZnQgICAgID0gJ3Njcm9sbExlZnQnLFxuICAgIGNsaWVudFdpZHRoICA9ICdjbGllbnRXaWR0aCcsICAgIGNsaWVudEhlaWdodCAgID0gJ2NsaWVudEhlaWdodCcsXG4gICAgb2Zmc2V0V2lkdGggID0gJ29mZnNldFdpZHRoJywgICAgb2Zmc2V0SGVpZ2h0ICAgPSAnb2Zmc2V0SGVpZ2h0JyxcbiAgICBpbm5lcldpZHRoICAgPSAnaW5uZXJXaWR0aCcsICAgICBpbm5lckhlaWdodCAgICA9ICdpbm5lckhlaWdodCcsXG4gICAgc2Nyb2xsSGVpZ2h0ID0gJ3Njcm9sbEhlaWdodCcsICAgaGVpZ2h0ICAgICAgICAgPSAnaGVpZ2h0JyxcbiAgXG4gICAgLy8gYXJpYVxuICAgIGFyaWFFeHBhbmRlZCA9ICdhcmlhLWV4cGFuZGVkJyxcbiAgICBhcmlhSGlkZGVuICAgPSAnYXJpYS1oaWRkZW4nLFxuICBcbiAgICAvLyBldmVudCBuYW1lc1xuICAgIGNsaWNrRXZlbnQgICAgPSAnY2xpY2snLFxuICAgIGhvdmVyRXZlbnQgICAgPSAnaG92ZXInLFxuICAgIGtleWRvd25FdmVudCAgPSAna2V5ZG93bicsXG4gICAgcmVzaXplRXZlbnQgICA9ICdyZXNpemUnLFxuICAgIHNjcm9sbEV2ZW50ICAgPSAnc2Nyb2xsJyxcbiAgICAvLyBvcmlnaW5hbEV2ZW50c1xuICAgIHNob3dFdmVudCAgICAgPSAnc2hvdycsXG4gICAgc2hvd25FdmVudCAgICA9ICdzaG93bicsXG4gICAgaGlkZUV2ZW50ICAgICA9ICdoaWRlJyxcbiAgICBoaWRkZW5FdmVudCAgID0gJ2hpZGRlbicsXG4gICAgY2xvc2VFdmVudCAgICA9ICdjbG9zZScsXG4gICAgY2xvc2VkRXZlbnQgICA9ICdjbG9zZWQnLFxuICAgIHNsaWRFdmVudCAgICAgPSAnc2xpZCcsXG4gICAgc2xpZGVFdmVudCAgICA9ICdzbGlkZScsXG4gICAgY2hhbmdlRXZlbnQgICA9ICdjaGFuZ2UnLFxuICBcbiAgICAvLyBvdGhlclxuICAgIGdldEF0dHJpYnV0ZSAgICAgICAgID0gJ2dldEF0dHJpYnV0ZScsXG4gICAgc2V0QXR0cmlidXRlICAgICAgICAgPSAnc2V0QXR0cmlidXRlJyxcbiAgICBoYXNBdHRyaWJ1dGUgICAgICAgICA9ICdoYXNBdHRyaWJ1dGUnLFxuICAgIGdldEVsZW1lbnRzQnlUYWdOYW1lID0gJ2dldEVsZW1lbnRzQnlUYWdOYW1lJyxcbiAgICBnZXRCb3VuZGluZ0NsaWVudFJlY3Q9ICdnZXRCb3VuZGluZ0NsaWVudFJlY3QnLFxuICAgIHF1ZXJ5U2VsZWN0b3JBbGwgICAgID0gJ3F1ZXJ5U2VsZWN0b3JBbGwnLFxuICAgIGdldEVsZW1lbnRzQnlDTEFTU05BTUUgPSAnZ2V0RWxlbWVudHNCeUNsYXNzTmFtZScsXG4gIFxuICAgIGluZGV4T2YgICAgICA9ICdpbmRleE9mJyxcbiAgICBwYXJlbnROb2RlICAgPSAncGFyZW50Tm9kZScsXG4gICAgbGVuZ3RoICAgICAgID0gJ2xlbmd0aCcsXG4gICAgdG9Mb3dlckNhc2UgID0gJ3RvTG93ZXJDYXNlJyxcbiAgICBUcmFuc2l0aW9uICAgPSAnVHJhbnNpdGlvbicsXG4gICAgV2Via2l0ICAgICAgID0gJ1dlYmtpdCcsXG4gICAgc3R5bGUgICAgICAgID0gJ3N0eWxlJyxcbiAgICBcbiAgICBhY3RpdmUgICAgID0gJ2FjdGl2ZScsXG4gICAgaW5DbGFzcyAgICA9ICdpbicsXG4gICAgY29sbGFwc2luZyA9ICdjb2xsYXBzaW5nJyxcbiAgICBkaXNhYmxlZCAgID0gJ2Rpc2FibGVkJyxcbiAgICBsb2FkaW5nICAgID0gJ2xvYWRpbmcnLFxuICAgIGxlZnQgICAgICAgPSAnbGVmdCcsXG4gICAgcmlnaHQgICAgICA9ICdyaWdodCcsXG4gICAgdG9wICAgICAgICA9ICd0b3AnLFxuICAgIGJvdHRvbSAgICAgPSAnYm90dG9tJyxcbiAgXG4gICAgLy8gdG9vbHRpcCAvIHBvcG92ZXJcbiAgICBtb3VzZUhvdmVyID0gKCdvbm1vdXNlbGVhdmUnIGluIGRvY3VtZW50KSA/IFsgJ21vdXNlZW50ZXInLCAnbW91c2VsZWF2ZSddIDogWyAnbW91c2VvdmVyJywgJ21vdXNlb3V0JyBdLFxuICAgIHRpcFBvc2l0aW9ucyA9IC9cXGIodG9wfGJvdHRvbXxsZWZ0fHRvcCkrLyxcbiAgXG4gICAgLy8gdHJhbnNpdGlvbkVuZCBzaW5jZSAyLjAuNFxuICAgIHN1cHBvcnRUcmFuc2l0aW9ucyA9IFdlYmtpdCtUcmFuc2l0aW9uIGluIGRvY1tzdHlsZV0gfHwgVHJhbnNpdGlvblt0b0xvd2VyQ2FzZV0oKSBpbiBkb2Nbc3R5bGVdLFxuICAgIHRyYW5zaXRpb25FbmRFdmVudCA9IFdlYmtpdCtUcmFuc2l0aW9uIGluIGRvY1tzdHlsZV0gPyBXZWJraXRbdG9Mb3dlckNhc2VdKCkrVHJhbnNpdGlvbisnRW5kJyA6IFRyYW5zaXRpb25bdG9Mb3dlckNhc2VdKCkrJ2VuZCcsXG4gICAgXG4gIFxuICAgIC8vIHNldCBuZXcgZm9jdXMgZWxlbWVudCBzaW5jZSAyLjAuM1xuICAgIHNldEZvY3VzID0gZnVuY3Rpb24oZWxlbWVudCl7XG4gICAgICBlbGVtZW50LmZvY3VzID8gZWxlbWVudC5mb2N1cygpIDogZWxlbWVudC5zZXRBY3RpdmUoKTtcbiAgICB9LFxuICBcbiAgICAvLyBjbGFzcyBtYW5pcHVsYXRpb24sIHNpbmNlIDIuMC4wIHJlcXVpcmVzIHBvbHlmaWxsLmpzXG4gICAgYWRkQ2xhc3MgPSBmdW5jdGlvbihlbGVtZW50LGNsYXNzTkFNRSkge1xuICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTkFNRSk7XG4gICAgfSxcbiAgICByZW1vdmVDbGFzcyA9IGZ1bmN0aW9uKGVsZW1lbnQsY2xhc3NOQU1FKSB7XG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOQU1FKTtcbiAgICB9LFxuICAgIGhhc0NsYXNzID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpeyAvLyBzaW5jZSAyLjAuMFxuICAgICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTkFNRSk7XG4gICAgfSxcbiAgXG4gICAgLy8gc2VsZWN0aW9uIG1ldGhvZHNcbiAgICBub2RlTGlzdFRvQXJyYXkgPSBmdW5jdGlvbihub2RlTGlzdCl7XG4gICAgICB2YXIgY2hpbGRJdGVtcyA9IFtdOyBmb3IgKHZhciBpID0gMCwgbmxsID0gbm9kZUxpc3RbbGVuZ3RoXTsgaTxubGw7IGkrKykgeyBjaGlsZEl0ZW1zLnB1c2goIG5vZGVMaXN0W2ldICkgfVxuICAgICAgcmV0dXJuIGNoaWxkSXRlbXM7XG4gICAgfSxcbiAgICBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gZnVuY3Rpb24oZWxlbWVudCxjbGFzc05BTUUpIHsgLy8gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSBJRTgrXG4gICAgICB2YXIgc2VsZWN0aW9uTWV0aG9kID0gaXNJRSA9PT0gOCA/IHF1ZXJ5U2VsZWN0b3JBbGwgOiBnZXRFbGVtZW50c0J5Q0xBU1NOQU1FOyAgICAgIFxuICAgICAgcmV0dXJuIG5vZGVMaXN0VG9BcnJheShlbGVtZW50W3NlbGVjdGlvbk1ldGhvZF0oIGlzSUUgPT09IDggPyAnLicgKyBjbGFzc05BTUUucmVwbGFjZSgvXFxzKD89W2Etel0pL2csJy4nKSA6IGNsYXNzTkFNRSApKTtcbiAgICB9LFxuICAgIHF1ZXJ5RWxlbWVudCA9IGZ1bmN0aW9uIChzZWxlY3RvciwgcGFyZW50KSB7XG4gICAgICB2YXIgbG9va1VwID0gcGFyZW50ID8gcGFyZW50IDogZG9jdW1lbnQ7XG4gICAgICByZXR1cm4gdHlwZW9mIHNlbGVjdG9yID09PSAnb2JqZWN0JyA/IHNlbGVjdG9yIDogbG9va1VwLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICAgIH0sXG4gICAgZ2V0Q2xvc2VzdCA9IGZ1bmN0aW9uIChlbGVtZW50LCBzZWxlY3RvcikgeyAvL2VsZW1lbnQgaXMgdGhlIGVsZW1lbnQgYW5kIHNlbGVjdG9yIGlzIGZvciB0aGUgY2xvc2VzdCBwYXJlbnQgZWxlbWVudCB0byBmaW5kXG4gICAgLy8gc291cmNlIGh0dHA6Ly9nb21ha2V0aGluZ3MuY29tL2NsaW1iaW5nLXVwLWFuZC1kb3duLXRoZS1kb20tdHJlZS13aXRoLXZhbmlsbGEtamF2YXNjcmlwdC9cbiAgICAgIHZhciBmaXJzdENoYXIgPSBzZWxlY3Rvci5jaGFyQXQoMCk7XG4gICAgICBmb3IgKCA7IGVsZW1lbnQgJiYgZWxlbWVudCAhPT0gZG9jdW1lbnQ7IGVsZW1lbnQgPSBlbGVtZW50W3BhcmVudE5vZGVdICkgey8vIEdldCBjbG9zZXN0IG1hdGNoXG4gICAgICAgIGlmICggZmlyc3RDaGFyID09PSAnLicgfHwgZmlyc3RDaGFyICE9PSAnIycpIHsvLyBJZiBzZWxlY3RvciBpcyBhIGNsYXNzXG4gICAgICAgICAgaWYgKCBxdWVyeUVsZW1lbnQoc2VsZWN0b3IsZWxlbWVudFtwYXJlbnROb2RlXSkgIT09IG51bGwgKSB7IHJldHVybiBlbGVtZW50OyB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCBmaXJzdENoYXIgPT09ICcjJyApIHsgLy8gSWYgc2VsZWN0b3IgaXMgYW4gSURcbiAgICAgICAgICBpZiAoIGVsZW1lbnQuaWQgPT09IHNlbGVjdG9yLnN1YnN0cigxKSApIHsgcmV0dXJuIGVsZW1lbnQ7IH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0sXG4gIFxuICAgIC8vIGV2ZW50IGF0dGFjaCBqUXVlcnkgc3R5bGUgLyB0cmlnZ2VyICBzaW5jZSAxLjIuMFxuICAgIG9uID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICB9LFxuICAgIG9mZiA9IGZ1bmN0aW9uKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7XG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIGZhbHNlKTtcbiAgICB9LFxuICAgIG9uZSA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudCwgaGFuZGxlcikgeyAvLyBvbmUgc2luY2UgMi4wLjRcbiAgICAgIG9uKGVsZW1lbnQsIGV2ZW50LCBmdW5jdGlvbiBoYW5kbGVyV3JhcHBlcigpe1xuICAgICAgICBoYW5kbGVyKCk7XG4gICAgICAgIG9mZihlbGVtZW50LCBldmVudCwgaGFuZGxlcldyYXBwZXIpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uKGVsZW1lbnQsaGFuZGxlcil7IC8vIGVtdWxhdGVUcmFuc2l0aW9uRW5kIHNpbmNlIDIuMC40XG4gICAgICBpZiAoc3VwcG9ydFRyYW5zaXRpb25zKSB7IG9uZShlbGVtZW50LHRyYW5zaXRpb25FbmRFdmVudCwgaGFuZGxlcik7IH1cbiAgICAgIGVsc2UgeyBoYW5kbGVyKCk7IH1cbiAgICB9LCAgXG4gICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjb21wb25lbnROYW1lLCByZWxhdGVkKSB7XG4gICAgICB2YXIgT3JpZ2luYWxDdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCggZXZlbnROYW1lICsgJy5icy4nICsgY29tcG9uZW50TmFtZSk7XG4gICAgICBPcmlnaW5hbEN1c3RvbUV2ZW50LnJlbGF0ZWRUYXJnZXQgPSByZWxhdGVkO1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KE9yaWdpbmFsQ3VzdG9tRXZlbnQpO1xuICAgIH0sXG4gIFxuICAgIC8vIHJlZmVyZW5jZSBhIGxpdmUgY29sbGVjdGlvbiBvZiB0aGUgRE9NXG4gICAgQWxsRE9NRWxlbWVudHMgPSBkb2N1bWVudFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJyonKSxcbiAgXG4gICAgLy8gSW5pdCBEQVRBIEFQSVxuICAgIGluaXRpYWxpemVEYXRhQVBJID0gZnVuY3Rpb24oIGNvbXBvbmVudCwgY29uc3RydWN0b3IsIGRhdGFBdHRyaWJ1dGUsIGNvbGxlY3Rpb24gKXtcbiAgICAgIHZhciBsb29rVXAgPSBjb2xsZWN0aW9uICYmIGNvbGxlY3Rpb25bbGVuZ3RoXSA/IGNvbGxlY3Rpb24gOiBBbGxET01FbGVtZW50cztcbiAgICAgIGZvciAodmFyIGk9MDsgaSA8IGxvb2tVcFtsZW5ndGhdOyBpKyspIHtcbiAgICAgICAgdmFyIGF0dHJWYWx1ZSA9IGxvb2tVcFtpXVtnZXRBdHRyaWJ1dGVdKGRhdGFBdHRyaWJ1dGUpLCBleHBlY3RlZEF0dHJWYWx1ZSA9IGNvbXBvbmVudC5yZXBsYWNlKC9zcHkvaSwnJylbdG9Mb3dlckNhc2VdKCk7XG4gICAgICAgIGlmICggYXR0clZhbHVlICYmIGNvbXBvbmVudCA9PT0gc3RyaW5nQnV0dG9uICYmICggYXR0clZhbHVlW2luZGV4T2ZdKGV4cGVjdGVkQXR0clZhbHVlKSA+IC0xICkgLy8gZGF0YS10b2dnbGU9XCJidXR0b25zXCJcbiAgICAgICAgICAgIHx8IGF0dHJWYWx1ZSA9PT0gZXhwZWN0ZWRBdHRyVmFsdWUgKSB7IC8vIGFsbCBvdGhlciBjb21wb25lbnRzXG4gICAgICAgICAgbmV3IGNvbnN0cnVjdG9yKGxvb2tVcFtpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCAgXG4gIFxuICAgIC8vIHRhYiAvIGNvbGxhcHNlIHN0dWZmXG4gICAgZ2V0T3V0ZXJIZWlnaHQgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgIHZhciBjaGlsZFN0eWxlID0gY2hpbGQgJiYgKGNoaWxkLmN1cnJlbnRTdHlsZSB8fCBnbG9iYWxPYmplY3QuZ2V0Q29tcHV0ZWRTdHlsZShjaGlsZCkpLCBcbiAgICAgICAgYnRwID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUuYm9yZGVyVG9wV2lkdGgpID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLmJvcmRlclRvcFdpZHRoLnJlcGxhY2UoJ3B4JywnJykpIDogMCxcbiAgICAgICAgYnRiID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUuYm9yZGVyQm90dG9tV2lkdGgpID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLmJvcmRlckJvdHRvbVdpZHRoLnJlcGxhY2UoJ3B4JywnJykpIDogMCxcbiAgICAgICAgbXRwID0gL3B4Ly50ZXN0KGNoaWxkU3R5bGUubWFyZ2luVG9wKSA/IE1hdGgucm91bmQoY2hpbGRTdHlsZS5tYXJnaW5Ub3AucmVwbGFjZSgncHgnLCcnKSkgOiAwLFxuICAgICAgICBtYnAgPSAvcHgvLnRlc3QoY2hpbGRTdHlsZS5tYXJnaW5Cb3R0b20pID8gTWF0aC5yb3VuZChjaGlsZFN0eWxlLm1hcmdpbkJvdHRvbS5yZXBsYWNlKCdweCcsJycpKSA6IDA7XG4gICAgICByZXR1cm4gY2hpbGRbY2xpZW50SGVpZ2h0XSArIHBhcnNlSW50KCBidHAgKSArIHBhcnNlSW50KCBidGIgKSArIHBhcnNlSW50KCBtdHAgKSArIHBhcnNlSW50KCBtYnAgKTtcbiAgICB9LFxuICAgIGdldE1heEhlaWdodCA9IGZ1bmN0aW9uKHBhcmVudCkgeyAvLyBnZXQgY29sbGFwc2UgdHJ1ZUhlaWdodCBhbmQgYm9yZGVyXG4gICAgICB2YXIgcGFyZW50SGVpZ2h0ID0gMDtcbiAgICAgIGZvciAodmFyIGsgPSAwLCBsbCA9IHBhcmVudC5jaGlsZHJlbltsZW5ndGhdOyBrIDwgbGw7IGsrKykge1xuICAgICAgICBwYXJlbnRIZWlnaHQgKz0gZ2V0T3V0ZXJIZWlnaHQocGFyZW50LmNoaWxkcmVuW2tdKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwYXJlbnRIZWlnaHQ7XG4gICAgfSxcbiAgXG4gICAgLy8gdG9vbHRpcCAvIHBvcG92ZXIgc3R1ZmZcbiAgICBpc0VsZW1lbnRJblZpZXdwb3J0ID0gZnVuY3Rpb24oZWxlbWVudCkgeyAvLyBjaGVjayBpZiB0aGlzLnRvb2x0aXAgaXMgaW4gdmlld3BvcnRcbiAgICAgIHZhciByZWN0ID0gZWxlbWVudFtnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCk7XG4gICAgICByZXR1cm4gKCByZWN0W3RvcF0gPj0gMCAmJiByZWN0W2xlZnRdID49IDAgJiZcbiAgICAgICAgcmVjdFtib3R0b21dIDw9IChnbG9iYWxPYmplY3RbaW5uZXJIZWlnaHRdIHx8IGRvY1tjbGllbnRIZWlnaHRdKSAmJlxuICAgICAgICByZWN0W3JpZ2h0XSA8PSAoZ2xvYmFsT2JqZWN0W2lubmVyV2lkdGhdIHx8IGRvY1tjbGllbnRXaWR0aF0pIClcbiAgICB9LFxuICAgIGdldFNjcm9sbCA9IGZ1bmN0aW9uKCkgeyAvLyBhbHNvIEFmZml4IGFuZCBTY3JvbGxTcHkgdXNlcyBpdFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgeSA6IGdsb2JhbE9iamVjdC5wYWdlWU9mZnNldCB8fCBkb2Nbc2Nyb2xsVG9wXSxcbiAgICAgICAgeCA6IGdsb2JhbE9iamVjdC5wYWdlWE9mZnNldCB8fCBkb2Nbc2Nyb2xsTGVmdF1cbiAgICAgIH1cbiAgICB9LFxuICAgIHN0eWxlVGlwID0gZnVuY3Rpb24obGluayxlbGVtZW50LHBvc2l0aW9uLGNvbnRhaW5lcikgeyAvLyBib3RoIHBvcG92ZXJzIGFuZCB0b29sdGlwc1xuICAgICAgdmFyIHJlY3QgPSBsaW5rW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKSwgXG4gICAgICAgICAgc2Nyb2xsID0gY29udGFpbmVyID09PSBib2R5ID8gZ2V0U2Nyb2xsKCkgOiB7IHg6IGNvbnRhaW5lcltvZmZzZXRMZWZ0XSArIGNvbnRhaW5lcltzY3JvbGxMZWZ0XSwgeTogY29udGFpbmVyW29mZnNldFRvcF0gKyBjb250YWluZXJbc2Nyb2xsVG9wXSB9LFxuICAgICAgICAgIGxpbmtEaW1lbnNpb25zID0geyB3OiByZWN0W3JpZ2h0XSAtIHJlY3RbbGVmdF0sIGg6IHJlY3RbYm90dG9tXSAtIHJlY3RbdG9wXSB9LFxuICAgICAgICAgIGVsZW1lbnREaW1lbnNpb25zID0geyB3IDogZWxlbWVudFtvZmZzZXRXaWR0aF0sIGg6IGVsZW1lbnRbb2Zmc2V0SGVpZ2h0XSB9O1xuICBcbiAgICAgIC8vIGFwcGx5IHN0eWxpbmcgdG8gdG9vbHRpcCBvciBwb3BvdmVyXG4gICAgICBpZiAoIHBvc2l0aW9uID09PSB0b3AgKSB7IC8vIFRPUFxuICAgICAgICBlbGVtZW50W3N0eWxlXVt0b3BdID0gcmVjdFt0b3BdICsgc2Nyb2xsLnkgLSBlbGVtZW50RGltZW5zaW9ucy5oICsgJ3B4JztcbiAgICAgICAgZWxlbWVudFtzdHlsZV1bbGVmdF0gPSByZWN0W2xlZnRdICsgc2Nyb2xsLnggLSBlbGVtZW50RGltZW5zaW9ucy53LzIgKyBsaW5rRGltZW5zaW9ucy53LzIgKyAncHgnXG4gIFxuICAgICAgfSBlbHNlIGlmICggcG9zaXRpb24gPT09IGJvdHRvbSApIHsgLy8gQk9UVE9NXG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW3RvcF0gPSByZWN0W3RvcF0gKyBzY3JvbGwueSArIGxpbmtEaW1lbnNpb25zLmggKyAncHgnO1xuICAgICAgICBlbGVtZW50W3N0eWxlXVtsZWZ0XSA9IHJlY3RbbGVmdF0gKyBzY3JvbGwueCAtIGVsZW1lbnREaW1lbnNpb25zLncvMiArIGxpbmtEaW1lbnNpb25zLncvMiArICdweCc7XG4gIFxuICAgICAgfSBlbHNlIGlmICggcG9zaXRpb24gPT09IGxlZnQgKSB7IC8vIExFRlRcbiAgICAgICAgZWxlbWVudFtzdHlsZV1bdG9wXSA9IHJlY3RbdG9wXSArIHNjcm9sbC55IC0gZWxlbWVudERpbWVuc2lvbnMuaC8yICsgbGlua0RpbWVuc2lvbnMuaC8yICsgJ3B4JztcbiAgICAgICAgZWxlbWVudFtzdHlsZV1bbGVmdF0gPSByZWN0W2xlZnRdICsgc2Nyb2xsLnggLSBlbGVtZW50RGltZW5zaW9ucy53ICsgJ3B4JztcbiAgXG4gICAgICB9IGVsc2UgaWYgKCBwb3NpdGlvbiA9PT0gcmlnaHQgKSB7IC8vIFJJR0hUXG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW3RvcF0gPSByZWN0W3RvcF0gKyBzY3JvbGwueSAtIGVsZW1lbnREaW1lbnNpb25zLmgvMiArIGxpbmtEaW1lbnNpb25zLmgvMiArICdweCc7XG4gICAgICAgIGVsZW1lbnRbc3R5bGVdW2xlZnRdID0gcmVjdFtsZWZ0XSArIHNjcm9sbC54ICsgbGlua0RpbWVuc2lvbnMudyArICdweCc7XG4gICAgICB9XG4gICAgICBlbGVtZW50LmNsYXNzTmFtZVtpbmRleE9mXShwb3NpdGlvbikgPT09IC0xICYmIChlbGVtZW50LmNsYXNzTmFtZSA9IGVsZW1lbnQuY2xhc3NOYW1lLnJlcGxhY2UodGlwUG9zaXRpb25zLHBvc2l0aW9uKSk7XG4gICAgfSxcbiAgICB1cGRhdGVQbGFjZW1lbnQgPSBmdW5jdGlvbihwb3NpdGlvbikge1xuICAgICAgcmV0dXJuIHBvc2l0aW9uID09PSB0b3AgPyBib3R0b20gOiAvLyB0b3BcbiAgICAgICAgICAgICBwb3NpdGlvbiA9PT0gYm90dG9tID8gdG9wIDogLy8gYm90dG9tXG4gICAgICAgICAgICAgcG9zaXRpb24gPT09IGxlZnQgPyByaWdodCA6IC8vIGxlZnRcbiAgICAgICAgICAgICBwb3NpdGlvbiA9PT0gcmlnaHQgPyBsZWZ0IDogcG9zaXRpb247IC8vIHJpZ2h0XG4gICAgfTtcbiAgXG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgQWZmaXhcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvL0FGRklYIERFRklOSVRJT05cbiAgdmFyIEFmZml4ID0gZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucykge1xuICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgXG4gICAgLy8gcmVhZCBEQVRBIEFQSVxuICAgIHZhciB0YXJnZXREYXRhICAgICAgICA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGFyZ2V0KSxcbiAgICAgICAgb2Zmc2V0VG9wRGF0YSAgICAgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9mZnNldFRvcCksXG4gICAgICAgIG9mZnNldEJvdHRvbURhdGEgID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPZmZzZXRCb3R0b20pLFxuICAgICAgICBcbiAgICAgICAgLy8gY29tcG9uZW50IHNwZWNpZmljIHN0cmluZ3NcbiAgICAgICAgYWZmaXggPSAnYWZmaXgnLCBhZmZpeGVkID0gJ2FmZml4ZWQnLCBmbiA9ICdmdW5jdGlvbicsIHVwZGF0ZSA9ICd1cGRhdGUnLFxuICAgICAgICBhZmZpeFRvcCA9ICdhZmZpeC10b3AnLCBhZmZpeGVkVG9wID0gJ2FmZml4ZWQtdG9wJyxcbiAgICAgICAgYWZmaXhCb3R0b20gPSAnYWZmaXgtYm90dG9tJywgYWZmaXhlZEJvdHRvbSA9ICdhZmZpeGVkLWJvdHRvbSc7XG4gIFxuICAgIHRoaXNbdGFyZ2V0XSA9IG9wdGlvbnNbdGFyZ2V0XSA/IHF1ZXJ5RWxlbWVudChvcHRpb25zW3RhcmdldF0pIDogcXVlcnlFbGVtZW50KHRhcmdldERhdGEpIHx8IG51bGw7IC8vIHRhcmdldCBpcyBhbiBvYmplY3RcbiAgICB0aGlzW29mZnNldFRvcF0gPSBvcHRpb25zW29mZnNldFRvcF0gPyBvcHRpb25zW29mZnNldFRvcF0gOiBwYXJzZUludChvZmZzZXRUb3BEYXRhKSB8fCAwOyAvLyBvZmZzZXQgb3B0aW9uIGlzIGFuIGludGVnZXIgbnVtYmVyIG9yIGZ1bmN0aW9uIHRvIGRldGVybWluZSB0aGF0IG51bWJlclxuICAgIHRoaXNbb2Zmc2V0Qm90dG9tXSA9IG9wdGlvbnNbb2Zmc2V0Qm90dG9tXSA/IG9wdGlvbnNbb2Zmc2V0Qm90dG9tXTogcGFyc2VJbnQob2Zmc2V0Qm90dG9tRGF0YSkgfHwgMDtcbiAgXG4gICAgaWYgKCAhdGhpc1t0YXJnZXRdICYmICEoIHRoaXNbb2Zmc2V0VG9wXSB8fCB0aGlzW29mZnNldEJvdHRvbV0gKSApIHsgcmV0dXJuOyB9IC8vIGludmFsaWRhdGVcbiAgXG4gICAgLy8gaW50ZXJuYWwgYmluZFxuICAgIHZhciBzZWxmID0gdGhpcyxcbiAgXG4gICAgICAvLyBjb25zdGFudHNcbiAgICAgIHJlc2l6ZURlbGF5ID0gKGlzSUUgJiYgaXNJRSA8IDEwKSA/IDUwMCA6IDUwLCAvLyBmb3IgbGVnYWN5IGJyb3dzZXJzIHdlIHRyeSB0byBsaW1pdCB0aGUgaW50ZXJ2YWwgZm9yIHVwZGF0aW5nIHRoZSBBZmZpeFxuICAgICAgcGluT2Zmc2V0VG9wLCBwaW5PZmZzZXRCb3R0b20sIG1heFNjcm9sbCwgc2Nyb2xsWSwgcGlubmVkVG9wLCBwaW5uZWRCb3R0b20sXG4gICAgICBhZmZpeGVkVG9Ub3AgPSBmYWxzZSwgYWZmaXhlZFRvQm90dG9tID0gZmFsc2UsXG4gICAgICBcbiAgICAgIC8vIHByaXZhdGUgbWV0aG9kcyBcbiAgICAgIGdldE1heFNjcm9sbCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBNYXRoLm1heCggYm9keVtzY3JvbGxIZWlnaHRdLCBib2R5W29mZnNldEhlaWdodF0sIGRvY1tjbGllbnRIZWlnaHRdLCBkb2Nbc2Nyb2xsSGVpZ2h0XSwgZG9jW29mZnNldEhlaWdodF0gKTtcbiAgICAgIH0sXG4gICAgICBnZXRPZmZzZXRUb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggc2VsZlt0YXJnZXRdICE9PSBudWxsICkge1xuICAgICAgICAgIHJldHVybiBzZWxmW3RhcmdldF1bZ2V0Qm91bmRpbmdDbGllbnRSZWN0XSgpW3RvcF0gKyBzY3JvbGxZO1xuICAgICAgICB9IGVsc2UgaWYgKCBzZWxmW29mZnNldFRvcF0gKSB7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHR5cGVvZiBzZWxmW29mZnNldFRvcF0gPT09IGZuID8gc2VsZltvZmZzZXRUb3BdKCkgOiBzZWxmW29mZnNldFRvcF0gfHwgMCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBnZXRPZmZzZXRCb3R0b20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggc2VsZltvZmZzZXRCb3R0b21dICkge1xuICAgICAgICAgIHJldHVybiBtYXhTY3JvbGwgLSBlbGVtZW50W29mZnNldEhlaWdodF0gLSBwYXJzZUludCggdHlwZW9mIHNlbGZbb2Zmc2V0Qm90dG9tXSA9PT0gZm4gPyBzZWxmW29mZnNldEJvdHRvbV0oKSA6IHNlbGZbb2Zmc2V0Qm90dG9tXSB8fCAwICk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBjaGVja1Bvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBtYXhTY3JvbGwgPSBnZXRNYXhTY3JvbGwoKTtcbiAgICAgICAgc2Nyb2xsWSA9IHBhcnNlSW50KGdldFNjcm9sbCgpLnksMCk7XG4gICAgICAgIHBpbk9mZnNldFRvcCA9IGdldE9mZnNldFRvcCgpO1xuICAgICAgICBwaW5PZmZzZXRCb3R0b20gPSBnZXRPZmZzZXRCb3R0b20oKTsgXG4gICAgICAgIHBpbm5lZFRvcCA9ICggcGFyc2VJbnQocGluT2Zmc2V0VG9wKSAtIHNjcm9sbFkgPCAwKSAmJiAoc2Nyb2xsWSA+IHBhcnNlSW50KHBpbk9mZnNldFRvcCkgKTtcbiAgICAgICAgcGlubmVkQm90dG9tID0gKCBwYXJzZUludChwaW5PZmZzZXRCb3R0b20pIC0gc2Nyb2xsWSA8IDApICYmIChzY3JvbGxZID4gcGFyc2VJbnQocGluT2Zmc2V0Qm90dG9tKSApO1xuICAgICAgfSxcbiAgICAgIHBpblRvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCAhYWZmaXhlZFRvVG9wICYmICFoYXNDbGFzcyhlbGVtZW50LGFmZml4KSApIHsgLy8gb24gbG9hZGluZyBhIHBhZ2UgaGFsZndheSBzY3JvbGxlZCB0aGVzZSBldmVudHMgZG9uJ3QgdHJpZ2dlciBpbiBDaHJvbWVcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4LCBhZmZpeCk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeFRvcCwgYWZmaXgpO1xuICAgICAgICAgIGFkZENsYXNzKGVsZW1lbnQsYWZmaXgpO1xuICAgICAgICAgIGFmZml4ZWRUb1RvcCA9IHRydWU7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkLCBhZmZpeCk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBhZmZpeGVkVG9wLCBhZmZpeCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1blBpblRvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCBhZmZpeGVkVG9Ub3AgJiYgaGFzQ2xhc3MoZWxlbWVudCxhZmZpeCkgKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxhZmZpeCk7XG4gICAgICAgICAgYWZmaXhlZFRvVG9wID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBwaW5Cb3R0b20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggIWFmZml4ZWRUb0JvdHRvbSAmJiAhaGFzQ2xhc3MoZWxlbWVudCwgYWZmaXhCb3R0b20pICkge1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgYWZmaXgsIGFmZml4KTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4Qm90dG9tLCBhZmZpeCk7XG4gICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCxhZmZpeEJvdHRvbSk7XG4gICAgICAgICAgYWZmaXhlZFRvQm90dG9tID0gdHJ1ZTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWQsIGFmZml4KTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGFmZml4ZWRCb3R0b20sIGFmZml4KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVuUGluQm90dG9tID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIGFmZml4ZWRUb0JvdHRvbSAmJiBoYXNDbGFzcyhlbGVtZW50LGFmZml4Qm90dG9tKSApIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyhlbGVtZW50LGFmZml4Qm90dG9tKTtcbiAgICAgICAgICBhZmZpeGVkVG9Cb3R0b20gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVwZGF0ZVBpbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCBwaW5uZWRCb3R0b20gKSB7XG4gICAgICAgICAgaWYgKCBwaW5uZWRUb3AgKSB7IHVuUGluVG9wKCk7IH1cbiAgICAgICAgICBwaW5Cb3R0b20oKTsgXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdW5QaW5Cb3R0b20oKTtcbiAgICAgICAgICBpZiAoIHBpbm5lZFRvcCApIHsgcGluVG9wKCk7IH0gXG4gICAgICAgICAgZWxzZSB7IHVuUGluVG9wKCk7IH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZFxuICAgIHRoaXNbdXBkYXRlXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGNoZWNrUG9zaXRpb24oKTtcbiAgICAgIHVwZGF0ZVBpbigpOyBcbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ0FmZml4IGluIGVsZW1lbnQgKSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIG9uKCBnbG9iYWxPYmplY3QsIHNjcm9sbEV2ZW50LCB0aGlzW3VwZGF0ZV0gKTtcbiAgICAgIG9uKCBnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBmdW5jdGlvbigpIHsgc2V0VGltZW91dChmdW5jdGlvbigpeyBzZWxmW3VwZGF0ZV0oKTsgfSwgcmVzaXplRGVsYXkpOyB9KTtcbiAgICB9XG4gICAgZWxlbWVudFtzdHJpbmdBZmZpeF0gPSB0aGlzO1xuICBcbiAgICB0aGlzW3VwZGF0ZV0oKTtcbiAgfTtcbiAgXG4gIC8vIEFGRklYIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT09XG4gIGluaXRpYWxpemVEYXRhQVBJKCBzdHJpbmdBZmZpeCwgQWZmaXgsIGRhdGFTcHkgKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBBbGVydFxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIEFMRVJUIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PVxuICB2YXIgQWxlcnQgPSBmdW5jdGlvbiggZWxlbWVudCApIHtcbiAgICBcbiAgICAvLyBpbml0aWFsaXphdGlvbiBlbGVtZW50XG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gYmluZCwgdGFyZ2V0IGFsZXJ0LCBkdXJhdGlvbiBhbmQgc3R1ZmZcbiAgICB2YXIgc2VsZiA9IHRoaXMsIGNvbXBvbmVudCA9ICdhbGVydCcsXG4gICAgICBhbGVydCA9IGdldENsb3Nlc3QoZWxlbWVudCwnLicrY29tcG9uZW50KSxcbiAgICAgIC8vIGhhbmRsZXJzXG4gICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKXtcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZVt0YXJnZXRdO1xuICAgICAgICBldmVudFRhcmdldCA9IGV2ZW50VGFyZ2V0W2hhc0F0dHJpYnV0ZV0oZGF0YURpc21pc3MpID8gZXZlbnRUYXJnZXQgOiBldmVudFRhcmdldFtwYXJlbnROb2RlXTtcbiAgICAgICAgaWYgKGV2ZW50VGFyZ2V0ICYmIGV2ZW50VGFyZ2V0W2hhc0F0dHJpYnV0ZV0oZGF0YURpc21pc3MpKSB7IC8vIHdlIGRvdWJsZSBjaGVjayB0aGUgZGF0YSBhdHRyaWJ1dGUsIGl0J3MgaW1wb3J0YW50XG4gICAgICAgICAgYWxlcnQgPSBnZXRDbG9zZXN0KGV2ZW50VGFyZ2V0LCcuJytjb21wb25lbnQpO1xuICAgICAgICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoJ1snK2RhdGFEaXNtaXNzKyc9XCInK2NvbXBvbmVudCsnXCJdJyxhbGVydCk7XG4gICAgICAgICAgKGVsZW1lbnQgPT09IGV2ZW50VGFyZ2V0IHx8IGVsZW1lbnQgPT09IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdKSAmJiBhbGVydCAmJiBzZWxmLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB0cmFuc2l0aW9uRW5kSGFuZGxlciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoYWxlcnQsIGNsb3NlZEV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICBvZmYoZWxlbWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTsgLy8gZGV0YWNoIGl0J3MgbGlzdGVuZXJcbiAgICAgICAgYWxlcnRbcGFyZW50Tm9kZV0ucmVtb3ZlQ2hpbGQoYWxlcnQpO1xuICAgICAgfTtcbiAgICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kXG4gICAgdGhpcy5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCBhbGVydCAmJiBlbGVtZW50ICYmIGhhc0NsYXNzKGFsZXJ0LGluQ2xhc3MpICkge1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGFsZXJ0LCBjbG9zZUV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICByZW1vdmVDbGFzcyhhbGVydCxpbkNsYXNzKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoYWxlcnQpIHtcbiAgICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKGFsZXJ0LHRyYW5zaXRpb25FbmRIYW5kbGVyKTtcbiAgICAgICAgICB9IFxuICAgICAgICB9LCBkdXJhdGlvbik7XG4gICAgICB9XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdBbGVydCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuICAgIH1cbiAgICBlbGVtZW50W3N0cmluZ0FsZXJ0XSA9IHRoaXM7XG4gIH07XG4gIFxuICAvLyBBTEVSVCBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSSAoIHN0cmluZ0FsZXJ0LCBBbGVydCwgZGF0YURpc21pc3MgKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBCdXR0b25cbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIEJVVFRPTiBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT1cbiAgdmFyIEJ1dHRvbiA9IGZ1bmN0aW9uKCBlbGVtZW50LCBvcHRpb24gKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBzZXQgb3B0aW9uXG4gICAgb3B0aW9uID0gb3B0aW9uIHx8IG51bGw7XG4gIFxuICAgIC8vIGNvbnN0YW50XG4gICAgdmFyIHRvZ2dsZWQgPSBmYWxzZSwgLy8gdG9nZ2xlZCBtYWtlcyBzdXJlIHRvIHByZXZlbnQgdHJpZ2dlcmluZyB0d2ljZSB0aGUgY2hhbmdlLmJzLmJ1dHRvbiBldmVudHNcbiAgXG4gICAgICAgIC8vIHN0cmluZ3NcbiAgICAgICAgY29tcG9uZW50ID0gJ2J1dHRvbicsXG4gICAgICAgIGNoZWNrZWQgPSAnY2hlY2tlZCcsXG4gICAgICAgIHJlc2V0ID0gJ3Jlc2V0JyxcbiAgICAgICAgTEFCRUwgPSAnTEFCRUwnLFxuICAgICAgICBJTlBVVCA9ICdJTlBVVCcsXG4gIFxuICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgICBzZXRTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoICEhIG9wdGlvbiAmJiBvcHRpb24gIT09IHJlc2V0ICkge1xuICAgICAgICAgIGlmICggb3B0aW9uID09PSBsb2FkaW5nICkge1xuICAgICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCxkaXNhYmxlZCk7XG4gICAgICAgICAgICBlbGVtZW50W3NldEF0dHJpYnV0ZV0oZGlzYWJsZWQsZGlzYWJsZWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbGVtZW50W3NldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGV4dCwgZWxlbWVudC5pbm5lckhUTUwucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpKTsgLy8gdHJpbSB0aGUgdGV4dFxuICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdkYXRhLScrb3B0aW9uKyctdGV4dCcpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVzZXRTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFPcmlnaW5hbFRleHQpKSB7XG4gICAgICAgICAgaWYgKCBoYXNDbGFzcyhlbGVtZW50LGRpc2FibGVkKSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGlzYWJsZWQpID09PSBkaXNhYmxlZCApIHtcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsZGlzYWJsZWQpO1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoZGlzYWJsZWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUZXh0KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHRvZ2dsZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IGVbdGFyZ2V0XVtwYXJlbnROb2RlXSxcbiAgICAgICAgICBsYWJlbCA9IGVbdGFyZ2V0XS50YWdOYW1lID09PSBMQUJFTCA/IGVbdGFyZ2V0XSA6IHBhcmVudC50YWdOYW1lID09PSBMQUJFTCA/IHBhcmVudCA6IG51bGw7IC8vIHRoZSAuYnRuIGxhYmVsXG4gIFxuICAgICAgICBpZiAoICFsYWJlbCApIHJldHVybjsgLy9yZWFjdCBpZiBhIGxhYmVsIG9yIGl0cyBpbW1lZGlhdGUgY2hpbGQgaXMgY2xpY2tlZFxuICBcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gdGhpcywgLy8gdGhlIGJ1dHRvbiBncm91cCwgdGhlIHRhcmdldCBvZiB0aGUgaGFuZGxlciBmdW5jdGlvblxuICAgICAgICAgIGxhYmVscyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZXZlbnRUYXJnZXQsJ2J0bicpLCAvLyBhbGwgdGhlIGJ1dHRvbiBncm91cCBidXR0b25zXG4gICAgICAgICAgaW5wdXQgPSBsYWJlbFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oSU5QVVQpWzBdO1xuICBcbiAgICAgICAgaWYgKCAhaW5wdXQgKSByZXR1cm47IC8vcmV0dXJuIGlmIG5vIGlucHV0IGZvdW5kXG4gIFxuICAgICAgICAvLyBtYW5hZ2UgdGhlIGRvbSBtYW5pcHVsYXRpb25cbiAgICAgICAgaWYgKCBpbnB1dC50eXBlID09PSAnY2hlY2tib3gnICkgeyAvL2NoZWNrYm94ZXNcbiAgICAgICAgICBpZiAoICFpbnB1dFtjaGVja2VkXSApIHtcbiAgICAgICAgICAgIGFkZENsYXNzKGxhYmVsLGFjdGl2ZSk7XG4gICAgICAgICAgICBpbnB1dFtnZXRBdHRyaWJ1dGVdKGNoZWNrZWQpO1xuICAgICAgICAgICAgaW5wdXRbc2V0QXR0cmlidXRlXShjaGVja2VkLGNoZWNrZWQpO1xuICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSB0cnVlO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyhsYWJlbCxhY3RpdmUpO1xuICAgICAgICAgICAgaW5wdXRbZ2V0QXR0cmlidXRlXShjaGVja2VkKTtcbiAgICAgICAgICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZShjaGVja2VkKTtcbiAgICAgICAgICAgIGlucHV0W2NoZWNrZWRdID0gZmFsc2U7XG4gICAgICAgICAgfVxuICBcbiAgICAgICAgICBpZiAoIXRvZ2dsZWQpIHsgLy8gcHJldmVudCB0cmlnZ2VyaW5nIHRoZSBldmVudCB0d2ljZVxuICAgICAgICAgICAgdG9nZ2xlZCA9IHRydWU7XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGlucHV0LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBpbnB1dFxuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBjaGFuZ2VFdmVudCwgY29tcG9uZW50KTsgLy90cmlnZ2VyIHRoZSBjaGFuZ2UgZm9yIHRoZSBidG4tZ3JvdXBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgXG4gICAgICAgIGlmICggaW5wdXQudHlwZSA9PT0gJ3JhZGlvJyAmJiAhdG9nZ2xlZCApIHsgLy8gcmFkaW8gYnV0dG9uc1xuICAgICAgICAgIGlmICggIWlucHV0W2NoZWNrZWRdICkgeyAvLyBkb24ndCB0cmlnZ2VyIGlmIGFscmVhZHkgYWN0aXZlXG4gICAgICAgICAgICBhZGRDbGFzcyhsYWJlbCxhY3RpdmUpO1xuICAgICAgICAgICAgaW5wdXRbc2V0QXR0cmlidXRlXShjaGVja2VkLGNoZWNrZWQpO1xuICAgICAgICAgICAgaW5wdXRbY2hlY2tlZF0gPSB0cnVlO1xuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChpbnB1dCwgY2hhbmdlRXZlbnQsIGNvbXBvbmVudCk7IC8vdHJpZ2dlciB0aGUgY2hhbmdlIGZvciB0aGUgaW5wdXRcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgY2hhbmdlRXZlbnQsIGNvbXBvbmVudCk7IC8vdHJpZ2dlciB0aGUgY2hhbmdlIGZvciB0aGUgYnRuLWdyb3VwXG4gIFxuICAgICAgICAgICAgdG9nZ2xlZCA9IHRydWU7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGwgPSBsYWJlbHNbbGVuZ3RoXTsgaTxsbDsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBvdGhlckxhYmVsID0gbGFiZWxzW2ldLCBvdGhlcklucHV0ID0gb3RoZXJMYWJlbFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oSU5QVVQpWzBdO1xuICAgICAgICAgICAgICBpZiAoIG90aGVyTGFiZWwgIT09IGxhYmVsICYmIGhhc0NsYXNzKG90aGVyTGFiZWwsYWN0aXZlKSApICB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3Mob3RoZXJMYWJlbCxhY3RpdmUpO1xuICAgICAgICAgICAgICAgIG90aGVySW5wdXQucmVtb3ZlQXR0cmlidXRlKGNoZWNrZWQpO1xuICAgICAgICAgICAgICAgIG90aGVySW5wdXRbY2hlY2tlZF0gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG90aGVySW5wdXQsIGNoYW5nZUV2ZW50LCBjb21wb25lbnQpOyAvLyB0cmlnZ2VyIHRoZSBjaGFuZ2VcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsgdG9nZ2xlZCA9IGZhbHNlOyB9LCA1MCApO1xuICAgICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggaGFzQ2xhc3MoZWxlbWVudCwnYnRuJykgKSB7IC8vIHdoZW4gQnV0dG9uIHRleHQgaXMgdXNlZCB3ZSBleGVjdXRlIGl0IGFzIGFuIGluc3RhbmNlIG1ldGhvZFxuICAgICAgaWYgKCBvcHRpb24gIT09IG51bGwgKSB7XG4gICAgICAgIGlmICggb3B0aW9uICE9PSByZXNldCApIHsgc2V0U3RhdGUoKTsgfSBcbiAgICAgICAgZWxzZSB7IHJlc2V0U3RhdGUoKTsgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ2J0bi1ncm91cCcpICkge1xuICAgICAgaWYgKCAhKCBzdHJpbmdCdXR0b24gaW4gZWxlbWVudCApICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgICBvbiggZWxlbWVudCwgY2xpY2tFdmVudCwgdG9nZ2xlICk7XG4gICAgICB9XG4gICAgICBlbGVtZW50W3N0cmluZ0J1dHRvbl0gPSB0aGlzO1xuICAgIH1cbiAgfTtcbiAgXG4gIC8vIEJVVFRPTiBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQnV0dG9uLCBCdXR0b24sIGRhdGFUb2dnbGUgKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBDYXJvdXNlbFxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIENBUk9VU0VMIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PVxuICB2YXIgQ2Fyb3VzZWwgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoIGVsZW1lbnQgKTtcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgXG4gICAgLy8gREFUQSBBUElcbiAgICB2YXIgaW50ZXJ2YWxEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFJbnRlcnZhbCkgPT09ICdmYWxzZScgPyBmYWxzZSA6IHBhcnNlSW50KGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhSW50ZXJ2YWwpKSB8fCA1MDAwLCAvLyBib290c3RyYXAgY2Fyb3VzZWwgZGVmYXVsdCBpbnRlcnZhbFxuICAgICAgICBwYXVzZURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVBhdXNlKSA9PT0gaG92ZXJFdmVudCB8fCBmYWxzZSxcbiAgICAgICAga2V5Ym9hcmREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFLZXlib2FyZCkgPT09ICd0cnVlJyB8fCBmYWxzZSxcbiAgICAgIFxuICAgICAgICAvLyBzdHJpbmdzXG4gICAgICAgIGNvbXBvbmVudCA9ICdjYXJvdXNlbCcsXG4gICAgICAgIHBhdXNlZCA9ICdwYXVzZWQnLFxuICAgICAgICBkaXJlY3Rpb24gPSAnZGlyZWN0aW9uJyxcbiAgICAgICAgZGF0YVNsaWRlVG8gPSAnZGF0YS1zbGlkZS10byc7IFxuICBcbiAgICB0aGlzW2tleWJvYXJkXSA9IG9wdGlvbnNba2V5Ym9hcmRdID09PSB0cnVlIHx8IGtleWJvYXJkRGF0YTtcbiAgICB0aGlzW3BhdXNlXSA9IChvcHRpb25zW3BhdXNlXSA9PT0gaG92ZXJFdmVudCB8fCBwYXVzZURhdGEpID8gaG92ZXJFdmVudCA6IGZhbHNlOyAvLyBmYWxzZSAvIGhvdmVyXG4gIFxuICAgIGlmICggISggb3B0aW9uc1tpbnRlcnZhbF0gfHwgaW50ZXJ2YWxEYXRhICkgKSB7IC8vIGRldGVybWluZSBzbGlkZSBpbnRlcnZhbFxuICAgICAgdGhpc1tpbnRlcnZhbF0gPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpc1tpbnRlcnZhbF0gPSBwYXJzZUludChvcHRpb25zW2ludGVydmFsXSkgfHwgaW50ZXJ2YWxEYXRhOyAvLyBkZWZhdWx0IHNsaWRlIGludGVydmFsXG4gICAgfVxuICBcbiAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzXG4gICAgdmFyIHNlbGYgPSB0aGlzLCBpbmRleCA9IGVsZW1lbnQuaW5kZXggPSAwLCB0aW1lciA9IGVsZW1lbnQudGltZXIgPSAwLCBcbiAgICAgIGlzU2xpZGluZyA9IGZhbHNlLCAvLyBpc1NsaWRpbmcgcHJldmVudHMgY2xpY2sgZXZlbnQgaGFuZGxlcnMgd2hlbiBhbmltYXRpb24gaXMgcnVubmluZ1xuICAgICAgc2xpZGVzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlbGVtZW50LCdpdGVtJyksIHRvdGFsID0gc2xpZGVzW2xlbmd0aF0sXG4gICAgICBzbGlkZURpcmVjdGlvbiA9IHRoaXNbZGlyZWN0aW9uXSA9IGxlZnQsXG4gICAgICBjb250cm9scyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUoZWxlbWVudCxjb21wb25lbnQrJy1jb250cm9sJyksXG4gICAgICBsZWZ0QXJyb3cgPSBjb250cm9sc1swXSwgcmlnaHRBcnJvdyA9IGNvbnRyb2xzWzFdLFxuICAgICAgaW5kaWNhdG9yID0gcXVlcnlFbGVtZW50KCAnLicrY29tcG9uZW50KyctaW5kaWNhdG9ycycsIGVsZW1lbnQgKSxcbiAgICAgIGluZGljYXRvcnMgPSBpbmRpY2F0b3JbZ2V0RWxlbWVudHNCeVRhZ05hbWVdKCBcIkxJXCIgKTtcbiAgXG4gICAgLy8gaGFuZGxlcnNcbiAgICB2YXIgcGF1c2VIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICE9PWZhbHNlICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG4gICAgICAgICAgYWRkQ2xhc3MoZWxlbWVudCxwYXVzZWQpO1xuICAgICAgICAgICFpc1NsaWRpbmcgJiYgY2xlYXJJbnRlcnZhbCggdGltZXIgKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlc3VtZUhhbmRsZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAhPT0gZmFsc2UgJiYgaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQscGF1c2VkKTtcbiAgICAgICAgICAhaXNTbGlkaW5nICYmIGNsZWFySW50ZXJ2YWwoIHRpbWVyICk7XG4gICAgICAgICAgIWlzU2xpZGluZyAmJiBzZWxmLmN5Y2xlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBpbmRpY2F0b3JIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmIChpc1NsaWRpbmcpIHJldHVybjtcbiAgXG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGVbdGFyZ2V0XSwgYWN0aXZlSW5kaWNhdG9yID0gc2VsZi5nZXRBY3RpdmVJbmRleCgpOyAvLyBldmVudCB0YXJnZXQgfCB0aGUgY3VycmVudCBhY3RpdmUgaXRlbVxuICBcbiAgICAgICAgaWYgKCBldmVudFRhcmdldCAmJiAhaGFzQ2xhc3MoZXZlbnRUYXJnZXQsYWN0aXZlKSAmJiBldmVudFRhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFTbGlkZVRvKSApIHtcbiAgICAgICAgICBpbmRleCA9IHBhcnNlSW50KCBldmVudFRhcmdldFtnZXRBdHRyaWJ1dGVdKGRhdGFTbGlkZVRvKSwgMTAgKTtcbiAgXG4gICAgICAgICAgLy9kZXRlcm1pbmUgZGlyZWN0aW9uIGZpcnN0XG4gICAgICAgICAgaWYgICggKGFjdGl2ZUluZGljYXRvciA8IGluZGV4ICkgfHwgKGFjdGl2ZUluZGljYXRvciA9PT0gMCAmJiBpbmRleCA9PT0gdG90YWwgLTEgKSApIHtcbiAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDsgLy8gbmV4dFxuICAgICAgICAgIH0gZWxzZSBpZiAgKCAoYWN0aXZlSW5kaWNhdG9yID4gaW5kZXgpIHx8IChhY3RpdmVJbmRpY2F0b3IgPT09IHRvdGFsIC0gMSAmJiBpbmRleCA9PT0gMCApICkge1xuICAgICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSByaWdodDsgLy8gcHJldlxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9XG4gIFxuICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7IC8vRG8gdGhlIHNsaWRlXG4gICAgICB9LFxuICAgICAgY29udHJvbHNIYW5kbGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAoaXNTbGlkaW5nKSByZXR1cm47XG4gIFxuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBlLmN1cnJlbnRUYXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuICBcbiAgICAgICAgaWYgKCBldmVudFRhcmdldCA9PT0gcmlnaHRBcnJvdyApIHtcbiAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gbGVmdDsgLy9zZXQgZGlyZWN0aW9uIGZpcnN0XG4gIFxuICAgICAgICAgIGlmKCBpbmRleCA9PT0gdG90YWwgLSAxICkge1xuICAgICAgICAgICAgaW5kZXggPSB0b3RhbCAtIDE7XG4gICAgICAgICAgfSBlbHNlIGlmICggaW5kZXggPT09IHRvdGFsICl7XG4gICAgICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCBldmVudFRhcmdldCA9PT0gbGVmdEFycm93ICkge1xuICAgICAgICAgIGluZGV4LS07XG4gICAgICAgICAgc2xpZGVEaXJlY3Rpb24gPSBzZWxmW2RpcmVjdGlvbl0gPSByaWdodDsgLy9zZXQgZGlyZWN0aW9uIGZpcnN0XG4gIFxuICAgICAgICAgIGlmKCBpbmRleCA9PT0gMCApIHtcbiAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICB9IGVsc2UgaWYgKCBpbmRleCA8IDAgKXtcbiAgICAgICAgICAgIGluZGV4ID0gdG90YWwgLSAxXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gIFxuICAgICAgICBzZWxmLnNsaWRlVG8oIGluZGV4ICk7IC8vRG8gdGhlIHNsaWRlXG4gICAgICB9LFxuICAgICAga2V5SGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmIChpc1NsaWRpbmcpIHJldHVybjtcbiAgICAgICAgc3dpdGNoIChlLndoaWNoKSB7XG4gICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgICBzbGlkZURpcmVjdGlvbiA9IHNlbGZbZGlyZWN0aW9uXSA9IGxlZnQ7XG4gICAgICAgICAgICBpZiggaW5kZXggPT0gdG90YWwgLSAxICkgeyBpbmRleCA9IHRvdGFsIC0gMTsgfSBlbHNlXG4gICAgICAgICAgICBpZiAoIGluZGV4ID09IHRvdGFsICl7IGluZGV4ID0gMCB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgICAgIHNsaWRlRGlyZWN0aW9uID0gc2VsZltkaXJlY3Rpb25dID0gcmlnaHQ7XG4gICAgICAgICAgICBpZiAoIGluZGV4ID09IDAgKSB7IGluZGV4ID0gMDsgfSBlbHNlXG4gICAgICAgICAgICBpZiAoIGluZGV4IDwgMCApIHsgaW5kZXggPSB0b3RhbCAtIDEgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDogcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuc2xpZGVUbyggaW5kZXggKTsgLy9EbyB0aGUgc2xpZGVcbiAgICAgIH0sXG4gICAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICAgIHNldEFjdGl2ZVBhZ2UgPSBmdW5jdGlvbiggcGFnZUluZGV4ICkgeyAvL2luZGljYXRvcnNcbiAgICAgICAgZm9yICggdmFyIGkgPSAwLCBpY2wgPSBpbmRpY2F0b3JzW2xlbmd0aF07IGkgPCBpY2w7IGkrKyApIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyhpbmRpY2F0b3JzW2ldLGFjdGl2ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluZGljYXRvcnNbcGFnZUluZGV4XSkgYWRkQ2xhc3MoaW5kaWNhdG9yc1twYWdlSW5kZXhdLCBhY3RpdmUpO1xuICAgICAgfTtcbiAgXG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgdGhpcy5jeWNsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgc2xpZGVEaXJlY3Rpb24gPSB0aGlzW2RpcmVjdGlvbl0gPSBsZWZ0OyAvLyBtYWtlIHN1cmUgdG8gYWx3YXlzIGNvbWUgYmFjayB0byBkZWZhdWx0IHNsaWRlRGlyZWN0aW9uXG4gICAgICB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICBpbmRleCsrO1xuICBcbiAgICAgICAgaW5kZXggPSBpbmRleCA9PT0gdG90YWwgPyAwIDogaW5kZXg7XG4gICAgICAgIHNlbGYuc2xpZGVUbyggaW5kZXggKTtcbiAgICAgIH0sIHRoaXNbaW50ZXJ2YWxdKTtcbiAgICB9O1xuICAgIHRoaXMuc2xpZGVUbyA9IGZ1bmN0aW9uKCBuZXh0ICkge1xuICAgICAgdmFyIGFjdGl2ZUl0ZW0gPSB0aGlzLmdldEFjdGl2ZUluZGV4KCksIC8vIHRoZSBjdXJyZW50IGFjdGl2ZVxuICAgICAgICAgIG9yaWVudGF0aW9uID0gc2xpZGVEaXJlY3Rpb24gPT09IGxlZnQgPyAnbmV4dCcgOiAncHJldic7IC8vZGV0ZXJtaW5lIHR5cGVcbiAgXG4gICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNsaWRlRXZlbnQsIGNvbXBvbmVudCwgc2xpZGVzW25leHRdKTsgLy8gaGVyZSB3ZSBnbyB3aXRoIHRoZSBzbGlkZVxuICBcbiAgICAgIGlzU2xpZGluZyA9IHRoaXMuaXNTbGlkaW5nID0gdHJ1ZTtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xuICAgICAgc2V0QWN0aXZlUGFnZSggbmV4dCApO1xuICBcbiAgICAgIGlmICggc3VwcG9ydFRyYW5zaXRpb25zICYmIGhhc0NsYXNzKGVsZW1lbnQsJ3NsaWRlJykgKSB7XG4gICAgICAgIGFkZENsYXNzKHNsaWRlc1tuZXh0XSxvcmllbnRhdGlvbik7XG4gICAgICAgIHNsaWRlc1tuZXh0XVtvZmZzZXRXaWR0aF07ICBcbiAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLHNsaWRlRGlyZWN0aW9uKTtcbiAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLHNsaWRlRGlyZWN0aW9uKTtcbiAgXG4gICAgICAgIG9uZShzbGlkZXNbbmV4dF0sIHRyYW5zaXRpb25FbmRFdmVudCwgZnVuY3Rpb24oKSB7IC8vd2UncmUgZ29ubmEgZmFrZSB3YWl0aW5nIGZvciB0aGUgYW5pbWF0aW9uIHRvIGZpbmlzaCwgY2xlYW5lciBhbmQgYmV0dGVyXG4gICAgICAgICAgaXNTbGlkaW5nID0gc2VsZi5pc1NsaWRpbmcgPSBmYWxzZTtcbiAgXG4gICAgICAgICAgYWRkQ2xhc3Moc2xpZGVzW25leHRdLGFjdGl2ZSk7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLGFjdGl2ZSk7XG4gIFxuICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlc1tuZXh0XSxvcmllbnRhdGlvbik7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW25leHRdLHNsaWRlRGlyZWN0aW9uKTtcbiAgICAgICAgICByZW1vdmVDbGFzcyhzbGlkZXNbYWN0aXZlSXRlbV0sc2xpZGVEaXJlY3Rpb24pO1xuICBcbiAgICAgICAgICBpZiAoIHNlbGZbaW50ZXJ2YWxdICYmICFoYXNDbGFzcyhlbGVtZW50LHBhdXNlZCkgKSB7XG4gICAgICAgICAgICBzZWxmLmN5Y2xlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2xpZEV2ZW50LCBjb21wb25lbnQsIHNsaWRlc1tuZXh0XSk7IC8vIGhlcmUgd2UgZ28gd2l0aCB0aGUgc2xpZCBldmVudFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhZGRDbGFzcyhzbGlkZXNbbmV4dF0sYWN0aXZlKTtcbiAgICAgICAgc2xpZGVzW25leHRdW29mZnNldFdpZHRoXTtcbiAgICAgICAgcmVtb3ZlQ2xhc3Moc2xpZGVzW2FjdGl2ZUl0ZW1dLGFjdGl2ZSk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaXNTbGlkaW5nID0gZmFsc2U7XG4gICAgICAgICAgaWYgKCBzZWxmW2ludGVydmFsXSAmJiAhaGFzQ2xhc3MoZWxlbWVudCxwYXVzZWQpICkge1xuICAgICAgICAgICAgc2VsZi5jeWNsZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNsaWRFdmVudCwgY29tcG9uZW50LCBzbGlkZXNbbmV4dF0pOyAvLyBoZXJlIHdlIGdvIHdpdGggdGhlIHNsaWQgZXZlbnRcbiAgICAgICAgfSwgMTAwICk7XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLmdldEFjdGl2ZUluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHNsaWRlc1tpbmRleE9mXShnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW1lbnQsJ2l0ZW0gYWN0aXZlJylbMF0pIHx8IDA7XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdDYXJvdXNlbCBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gIFxuICAgICAgaWYgKCB0aGlzW3BhdXNlXSAmJiB0aGlzW2ludGVydmFsXSApIHtcbiAgICAgICAgb24oIGVsZW1lbnQsIG1vdXNlSG92ZXJbMF0sIHBhdXNlSGFuZGxlciApO1xuICAgICAgICBvbiggZWxlbWVudCwgbW91c2VIb3ZlclsxXSwgcmVzdW1lSGFuZGxlciApO1xuICAgICAgICBvbiggZWxlbWVudCwgJ3RvdWNoc3RhcnQnLCBwYXVzZUhhbmRsZXIgKTtcbiAgICAgICAgb24oIGVsZW1lbnQsICd0b3VjaGVuZCcsIHJlc3VtZUhhbmRsZXIgKTtcbiAgICAgIH1cbiAgICBcbiAgICAgIHJpZ2h0QXJyb3cgJiYgb24oIHJpZ2h0QXJyb3csIGNsaWNrRXZlbnQsIGNvbnRyb2xzSGFuZGxlciApO1xuICAgICAgbGVmdEFycm93ICYmIG9uKCBsZWZ0QXJyb3csIGNsaWNrRXZlbnQsIGNvbnRyb2xzSGFuZGxlciApO1xuICAgIFxuICAgICAgaW5kaWNhdG9yICYmIG9uKCBpbmRpY2F0b3IsIGNsaWNrRXZlbnQsIGluZGljYXRvckhhbmRsZXIsIGZhbHNlKTtcbiAgICAgIHRoaXNba2V5Ym9hcmRdID09PSB0cnVlICYmIG9uKCBnbG9iYWxPYmplY3QsIGtleWRvd25FdmVudCwga2V5SGFuZGxlciwgZmFsc2UpO1xuICBcbiAgICB9XG4gICAgaWYgKHRoaXMuZ2V0QWN0aXZlSW5kZXgoKTwwKSB7XG4gICAgICBzbGlkZXNbbGVuZ3RoXSAmJiBhZGRDbGFzcyhzbGlkZXNbMF0sYWN0aXZlKTtcbiAgICAgIGluZGljYXRvcnNbbGVuZ3RoXSAmJiBzZXRBY3RpdmVQYWdlKDApO1xuICAgIH1cbiAgXG4gICAgaWYgKCB0aGlzW2ludGVydmFsXSApeyB0aGlzLmN5Y2xlKCk7IH1cbiAgICBlbGVtZW50W3N0cmluZ0Nhcm91c2VsXSA9IHRoaXM7XG4gIH07XG4gIFxuICAvLyBDQVJPVVNFTCBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSSggc3RyaW5nQ2Fyb3VzZWwsIENhcm91c2VsLCBkYXRhUmlkZSApO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IENvbGxhcHNlXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIENPTExBUFNFIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PVxuICB2YXIgQ29sbGFwc2UgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIFxuICBcbiAgICAvLyBldmVudCB0YXJnZXRzIGFuZCBjb25zdGFudHNcbiAgICB2YXIgYWNjb3JkaW9uID0gbnVsbCwgY29sbGFwc2UgPSBudWxsLCBzZWxmID0gdGhpcywgXG4gICAgICBpc0FuaW1hdGluZyA9IGZhbHNlLCAvLyB3aGVuIHRydWUgaXQgd2lsbCBwcmV2ZW50IGNsaWNrIGhhbmRsZXJzXG4gICAgICBhY2NvcmRpb25EYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdkYXRhLXBhcmVudCcpLFxuICBcbiAgICAgIC8vIGNvbXBvbmVudCBzdHJpbmdzXG4gICAgICBjb21wb25lbnQgPSAnY29sbGFwc2UnLFxuICAgICAgY29sbGFwc2VkID0gJ2NvbGxhcHNlZCcsXG4gIFxuICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgICBvcGVuQWN0aW9uID0gZnVuY3Rpb24oY29sbGFwc2VFbGVtZW50KSB7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBzaG93RXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgIGlzQW5pbWF0aW5nID0gdHJ1ZTtcbiAgICAgICAgYWRkQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuICAgICAgICBhZGRDbGFzcyhjb2xsYXBzZUVsZW1lbnQsaW5DbGFzcyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGNvbGxhcHNlRWxlbWVudCkgKyAncHgnO1xuICAgICAgICB9LCAwKTtcbiAgXG4gICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKGNvbGxhcHNlRWxlbWVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoY29sbGFwc2VFbGVtZW50LGNvbGxhcHNpbmcpO1xuICAgICAgICAgIGNvbGxhcHNlRWxlbWVudFtzdHlsZV1baGVpZ2h0XSA9ICcnO1xuICAgICAgICAgIGlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgY29sbGFwc2VFbGVtZW50W3NldEF0dHJpYnV0ZV0oYXJpYUV4cGFuZGVkLCd0cnVlJyk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIHNob3duRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGNsb3NlQWN0aW9uID0gZnVuY3Rpb24oY29sbGFwc2VFbGVtZW50KSB7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoY29sbGFwc2VFbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgIGlzQW5pbWF0aW5nID0gdHJ1ZTtcbiAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gZ2V0TWF4SGVpZ2h0KGNvbGxhcHNlRWxlbWVudCkgKyAncHgnO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGFkZENsYXNzKGNvbGxhcHNlRWxlbWVudCxjb2xsYXBzaW5nKTtcbiAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc3R5bGVdW2hlaWdodF0gPSAnMHB4JztcbiAgICAgICAgfSwgMCk7XG4gIFxuICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChjb2xsYXBzZUVsZW1lbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGNvbGxhcHNlRWxlbWVudCxjb2xsYXBzaW5nKTtcbiAgICAgICAgICByZW1vdmVDbGFzcyhjb2xsYXBzZUVsZW1lbnQsaW5DbGFzcyk7XG4gICAgICAgICAgY29sbGFwc2VFbGVtZW50W3N0eWxlXVtoZWlnaHRdID0gJyc7XG4gICAgICAgICAgaXNBbmltYXRpbmcgPSBmYWxzZTtcbiAgICAgICAgICBjb2xsYXBzZUVsZW1lbnRbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsJ2ZhbHNlJyk7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChjb2xsYXBzZUVsZW1lbnQsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBnZXRUYXJnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGhyZWYgPSBlbGVtZW50LmhyZWYgJiYgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdocmVmJyksXG4gICAgICAgICAgcGFyZW50ID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpLFxuICAgICAgICAgIGlkID0gaHJlZiB8fCAoIHBhcmVudCAmJiAvIy8udGVzdChwYXJlbnQpICkgJiYgcGFyZW50O1xuICAgICAgICByZXR1cm4gaWQgJiYgcXVlcnlFbGVtZW50KGlkKTtcbiAgICAgIH07XG4gICAgXG4gICAgLy8gcHVibGljIG1ldGhvZHNcbiAgICB0aGlzLnRvZ2dsZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGlmIChpc0FuaW1hdGluZykgcmV0dXJuO1xuICAgICAgaWYgKCFoYXNDbGFzcyhjb2xsYXBzZSxpbkNsYXNzKSkgeyBzZWxmLnNob3coKTsgfSBcbiAgICAgIGVsc2UgeyBzZWxmLmhpZGUoKTsgfVxuICAgIH07XG4gICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBjbG9zZUFjdGlvbihjb2xsYXBzZSk7XG4gICAgICBhZGRDbGFzcyhlbGVtZW50LGNvbGxhcHNlZCk7XG4gICAgfTtcbiAgICB0aGlzLnNob3cgPSBmdW5jdGlvbigpIHtcbiAgICAgIG9wZW5BY3Rpb24oY29sbGFwc2UpO1xuICAgICAgcmVtb3ZlQ2xhc3MoZWxlbWVudCxjb2xsYXBzZWQpO1xuICBcbiAgICAgIGlmICggYWNjb3JkaW9uICE9PSBudWxsICkge1xuICAgICAgICB2YXIgYWN0aXZlQ29sbGFwc2VzID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShhY2NvcmRpb24sY29tcG9uZW50KycgJytpbkNsYXNzKTtcbiAgICAgICAgZm9yICh2YXIgaT0wLCBhbD1hY3RpdmVDb2xsYXBzZXNbbGVuZ3RoXTsgaTxhbDsgaSsrKSB7XG4gICAgICAgICAgaWYgKCBhY3RpdmVDb2xsYXBzZXNbaV0gIT09IGNvbGxhcHNlKSBjbG9zZUFjdGlvbihhY3RpdmVDb2xsYXBzZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgXG4gICAgLy8gaW5pdFxuICAgIGlmICggIShzdHJpbmdDb2xsYXBzZSBpbiBlbGVtZW50ICkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCB0aGlzLnRvZ2dsZSk7XG4gICAgfVxuICAgIGNvbGxhcHNlID0gZ2V0VGFyZ2V0KCk7XG4gICAgYWNjb3JkaW9uID0gcXVlcnlFbGVtZW50KG9wdGlvbnMucGFyZW50KSB8fCBhY2NvcmRpb25EYXRhICYmIGdldENsb3Nlc3QoZWxlbWVudCwgYWNjb3JkaW9uRGF0YSk7XG4gICAgZWxlbWVudFtzdHJpbmdDb2xsYXBzZV0gPSB0aGlzO1xuICB9O1xuICBcbiAgLy8gQ09MTEFQU0UgREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nQ29sbGFwc2UsIENvbGxhcHNlLCBkYXRhVG9nZ2xlKTtcbiAgXG4gIFxuICAvKiBOYXRpdmUgSmF2YXNjcmlwdCBmb3IgQm9vdHN0cmFwIDMgfCBEcm9wZG93blxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIERST1BET1dOIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PVxuICB2YXIgRHJvcGRvd24gPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9uICkge1xuICAgICAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIHNldCBvcHRpb25cbiAgICB0aGlzLnBlcnNpc3QgPSBvcHRpb24gPT09IHRydWUgfHwgZWxlbWVudFtnZXRBdHRyaWJ1dGVdKCdkYXRhLXBlcnNpc3QnKSA9PT0gJ3RydWUnIHx8IGZhbHNlO1xuICBcbiAgICAvLyBjb25zdGFudHMsIGV2ZW50IHRhcmdldHMsIHN0cmluZ3NcbiAgICB2YXIgc2VsZiA9IHRoaXMsIGlzT3BlbiA9IGZhbHNlLFxuICAgICAgcGFyZW50ID0gZWxlbWVudFtwYXJlbnROb2RlXSxcbiAgICAgIGNvbXBvbmVudCA9ICdkcm9wZG93bicsIG9wZW4gPSAnb3BlbicsXG4gICAgICByZWxhdGVkVGFyZ2V0ID0gbnVsbCxcbiAgICAgIG1lbnUgPSBxdWVyeUVsZW1lbnQoJy5kcm9wZG93bi1tZW51JywgcGFyZW50KSxcbiAgICAgIGNoaWxkcmVuID0gbm9kZUxpc3RUb0FycmF5KCBtZW51W2dldEVsZW1lbnRzQnlUYWdOYW1lXSgnKicpKSxcbiAgXG4gICAgICAvLyBoYW5kbGVyc1xuICAgICAga2V5SGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGlzT3BlbiAmJiAoZS53aGljaCA9PSAyNyB8fCBlLmtleUNvZGUgPT0gMjcpKSB7IHJlbGF0ZWRUYXJnZXQgPSBudWxsOyBoaWRlKCk7IH0gLy8gZS5rZXlDb2RlIGZvciBJRThcbiAgICAgIH0sXG4gICAgICBjbGlja0hhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGVbdGFyZ2V0XSwgaGFzRGF0YTtcbiAgICAgICAgaGFzRGF0YSA9ICggZXZlbnRUYXJnZXQubm9kZVR5cGUgIT09IDEgJiYgKGV2ZW50VGFyZ2V0W2dldEF0dHJpYnV0ZV0oZGF0YVRvZ2dsZSkgfHwgZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV1bZ2V0QXR0cmlidXRlXShkYXRhVG9nZ2xlKSkgKTtcbiAgICAgICAgaWYgKCBldmVudFRhcmdldCA9PT0gZWxlbWVudCB8fCBldmVudFRhcmdldCA9PT0gcGFyZW50IHx8IGV2ZW50VGFyZ2V0W3BhcmVudE5vZGVdID09PSBlbGVtZW50ICkge1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy8gY29tbWVudCB0aGlzIGxpbmUgdG8gc3RvcCBwcmV2ZW50aW5nIG5hdmlnYXRpb24gd2hlbiBjbGljayB0YXJnZXQgaXMgYSBsaW5rIFxuICAgICAgICAgIHJlbGF0ZWRUYXJnZXQgPSBlbGVtZW50O1xuICAgICAgICAgIHNlbGYudG9nZ2xlKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoIGlzT3BlbiApIHtcbiAgICAgICAgICBpZiAoIChldmVudFRhcmdldCA9PT0gbWVudSB8fCBjaGlsZHJlbiAmJiBjaGlsZHJlbltpbmRleE9mXShldmVudFRhcmdldCkgPiAtMSkgJiYgKCBzZWxmLnBlcnNpc3QgfHwgaGFzRGF0YSApICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSB7IHJlbGF0ZWRUYXJnZXQgPSBudWxsOyBoaWRlKCk7IH1cbiAgICAgICAgfVxuICAgICAgICAoL1xcIyQvLnRlc3QoZXZlbnRUYXJnZXQuaHJlZikgfHwgZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV0gJiYgL1xcIyQvLnRlc3QoZXZlbnRUYXJnZXRbcGFyZW50Tm9kZV0uaHJlZikpICYmIGUucHJldmVudERlZmF1bHQoKTsgLy8gc2hvdWxkIGJlIGhlcmUgdG8gcHJldmVudCBqdW1wc1xuICAgICAgfSxcbiAgICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgICAgc2hvdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKHBhcmVudCwgc2hvd0V2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuICAgICAgICBhZGRDbGFzcyhwYXJlbnQsb3Blbik7XG4gICAgICAgIG1lbnVbc2V0QXR0cmlidXRlXShhcmlhRXhwYW5kZWQsdHJ1ZSk7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQsIHJlbGF0ZWRUYXJnZXQpO1xuICAgICAgICBvbihkb2N1bWVudCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyKTtcbiAgICAgICAgaXNPcGVuID0gdHJ1ZTtcbiAgICAgIH0sXG4gICAgICBoaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG4gICAgICAgIHJlbW92ZUNsYXNzKHBhcmVudCxvcGVuKTtcbiAgICAgICAgbWVudVtzZXRBdHRyaWJ1dGVdKGFyaWFFeHBhbmRlZCxmYWxzZSk7XG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwocGFyZW50LCBoaWRkZW5FdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcbiAgICAgICAgb2ZmKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuICAgICAgICBpc09wZW4gPSBmYWxzZTtcbiAgICAgIH07XG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgdGhpcy50b2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChoYXNDbGFzcyhwYXJlbnQsb3BlbikgJiYgaXNPcGVuKSB7IGhpZGUoKTsgfSBcbiAgICAgIGVsc2UgeyBzaG93KCk7IH1cbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ0Ryb3Bkb3duIGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgbWVudVtzZXRBdHRyaWJ1dGVdKCd0YWJpbmRleCcsICcwJyk7IC8vIEZpeCBvbmJsdXIgb24gQ2hyb21lIHwgU2FmYXJpXG4gICAgICBvbihkb2N1bWVudCwgY2xpY2tFdmVudCwgY2xpY2tIYW5kbGVyKTtcbiAgICB9XG4gICAgZWxlbWVudFtzdHJpbmdEcm9wZG93bl0gPSB0aGlzO1xuICB9O1xuICBcbiAgLy8gRFJPUERPV04gREFUQSBBUElcbiAgLy8gPT09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoIHN0cmluZ0Ryb3Bkb3duLCBEcm9wZG93biwgZGF0YVRvZ2dsZSApO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IE1vZGFsXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICAgIFxuICAvLyBNT0RBTCBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PVxuICB2YXIgTW9kYWwgPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7IC8vIGVsZW1lbnQgY2FuIGJlIHRoZSBtb2RhbC90cmlnZ2VyaW5nIGJ1dHRvblxuICBcbiAgICAvLyB0aGUgbW9kYWwgKGJvdGggSmF2YVNjcmlwdCAvIERBVEEgQVBJIGluaXQpIC8gdHJpZ2dlcmluZyBidXR0b24gZWxlbWVudCAoREFUQSBBUEkpXG4gICAgZWxlbWVudCA9IHF1ZXJ5RWxlbWVudChlbGVtZW50KTtcbiAgXG4gICAgLy8gZGV0ZXJtaW5lIG1vZGFsLCB0cmlnZ2VyaW5nIGVsZW1lbnQgXG4gICAgdmFyIGJ0bkNoZWNrID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFUYXJnZXQpfHxlbGVtZW50W2dldEF0dHJpYnV0ZV0oJ2hyZWYnKSxcbiAgICAgIGNoZWNrTW9kYWwgPSBxdWVyeUVsZW1lbnQoIGJ0bkNoZWNrICksXG4gICAgICBtb2RhbCA9IGhhc0NsYXNzKGVsZW1lbnQsJ21vZGFsJykgPyBlbGVtZW50IDogY2hlY2tNb2RhbCxcbiAgXG4gICAgICAvLyBzdHJpbmdzXG4gICAgICBjb21wb25lbnQgPSAnbW9kYWwnLFxuICAgICAgc3RhdGljU3RyaW5nID0gJ3N0YXRpYycsXG4gICAgICBwYWRkaW5nTGVmdCA9ICdwYWRkaW5nTGVmdCcsXG4gICAgICBwYWRkaW5nUmlnaHQgPSAncGFkZGluZ1JpZ2h0JyxcbiAgICAgIG1vZGFsQmFja2Ryb3BTdHJpbmcgPSAnbW9kYWwtYmFja2Ryb3AnO1xuICBcbiAgICBpZiAoIGhhc0NsYXNzKGVsZW1lbnQsJ21vZGFsJykgKSB7IGVsZW1lbnQgPSBudWxsOyB9IC8vIG1vZGFsIGlzIG5vdyBpbmRlcGVuZGVudCBvZiBpdCdzIHRyaWdnZXJpbmcgZWxlbWVudFxuICBcbiAgICBpZiAoICFtb2RhbCApIHsgcmV0dXJuOyB9IC8vIGludmFsaWRhdGVcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgXG4gICAgdGhpc1trZXlib2FyZF0gPSBvcHRpb25zW2tleWJvYXJkXSA9PT0gZmFsc2UgfHwgbW9kYWxbZ2V0QXR0cmlidXRlXShkYXRhS2V5Ym9hcmQpID09PSAnZmFsc2UnID8gZmFsc2UgOiB0cnVlO1xuICAgIHRoaXNbYmFja2Ryb3BdID0gb3B0aW9uc1tiYWNrZHJvcF0gPT09IHN0YXRpY1N0cmluZyB8fCBtb2RhbFtnZXRBdHRyaWJ1dGVdKGRhdGFiYWNrZHJvcCkgPT09IHN0YXRpY1N0cmluZyA/IHN0YXRpY1N0cmluZyA6IHRydWU7XG4gICAgdGhpc1tiYWNrZHJvcF0gPSBvcHRpb25zW2JhY2tkcm9wXSA9PT0gZmFsc2UgfHwgbW9kYWxbZ2V0QXR0cmlidXRlXShkYXRhYmFja2Ryb3ApID09PSAnZmFsc2UnID8gZmFsc2UgOiB0aGlzW2JhY2tkcm9wXTtcbiAgICB0aGlzW2NvbnRlbnRdICA9IG9wdGlvbnNbY29udGVudF07IC8vIEphdmFTY3JpcHQgb25seVxuICBcbiAgICAvLyBiaW5kLCBjb25zdGFudHMsIGV2ZW50IHRhcmdldHMgYW5kIG90aGVyIHZhcnNcbiAgICB2YXIgc2VsZiA9IHRoaXMsIG9wZW4gPSB0aGlzLm9wZW4gPSBmYWxzZSwgcmVsYXRlZFRhcmdldCA9IG51bGwsXG4gICAgICBib2R5SXNPdmVyZmxvd2luZywgbW9kYWxJc092ZXJmbG93aW5nLCBzY3JvbGxiYXJXaWR0aCwgb3ZlcmxheSxcbiAgXG4gICAgICAvLyBwcml2YXRlIG1ldGhvZHNcbiAgICAgIGdldFdpbmRvd1dpZHRoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBodG1sUmVjdCA9IGRvY1tnZXRCb3VuZGluZ0NsaWVudFJlY3RdKCk7XG4gICAgICAgIHJldHVybiBnbG9iYWxPYmplY3RbaW5uZXJXaWR0aF0gfHwgKGh0bWxSZWN0W3JpZ2h0XSAtIE1hdGguYWJzKGh0bWxSZWN0W2xlZnRdKSk7XG4gICAgICB9LFxuICAgICAgc2V0U2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYm9keVN0eWxlID0gYm9keS5jdXJyZW50U3R5bGUgfHwgZ2xvYmFsT2JqZWN0LmdldENvbXB1dGVkU3R5bGUoYm9keSksIGJvZHlQYWQgPSBwYXJzZUludCgoYm9keVN0eWxlW3BhZGRpbmdSaWdodF0pLCAxMCk7XG4gICAgICAgIGlmIChib2R5SXNPdmVyZmxvd2luZykgeyBib2R5W3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gKGJvZHlQYWQgKyBzY3JvbGxiYXJXaWR0aCkgKyAncHgnOyB9XG4gICAgICB9LFxuICAgICAgcmVzZXRTY3JvbGxiYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGJvZHlbc3R5bGVdW3BhZGRpbmdSaWdodF0gPSAnJztcbiAgICAgIH0sXG4gICAgICBtZWFzdXJlU2Nyb2xsYmFyID0gZnVuY3Rpb24gKCkgeyAvLyB0aHggd2Fsc2hcbiAgICAgICAgdmFyIHNjcm9sbERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCBzY3JvbGxCYXJXaWR0aDtcbiAgICAgICAgc2Nyb2xsRGl2LmNsYXNzTmFtZSA9IGNvbXBvbmVudCsnLXNjcm9sbGJhci1tZWFzdXJlJzsgLy8gdGhpcyBpcyBoZXJlIHRvIHN0YXlcbiAgICAgICAgYm9keS5hcHBlbmRDaGlsZChzY3JvbGxEaXYpO1xuICAgICAgICBzY3JvbGxCYXJXaWR0aCA9IHNjcm9sbERpdltvZmZzZXRXaWR0aF0gLSBzY3JvbGxEaXZbY2xpZW50V2lkdGhdO1xuICAgICAgICBib2R5LnJlbW92ZUNoaWxkKHNjcm9sbERpdik7XG4gICAgICAgIHJldHVybiBzY3JvbGxCYXJXaWR0aDtcbiAgICAgIH0sXG4gICAgICBjaGVja1Njcm9sbGJhciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYm9keUlzT3ZlcmZsb3dpbmcgPSBib2R5W2NsaWVudFdpZHRoXSA8IGdldFdpbmRvd1dpZHRoKCk7XG4gICAgICAgIG1vZGFsSXNPdmVyZmxvd2luZyA9IG1vZGFsW3Njcm9sbEhlaWdodF0gPiBkb2NbY2xpZW50SGVpZ2h0XTtcbiAgICAgICAgc2Nyb2xsYmFyV2lkdGggPSBtZWFzdXJlU2Nyb2xsYmFyKCk7XG4gICAgICB9LFxuICAgICAgYWRqdXN0RGlhbG9nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ0xlZnRdID0gIWJvZHlJc092ZXJmbG93aW5nICYmIG1vZGFsSXNPdmVyZmxvd2luZyA/IHNjcm9sbGJhcldpZHRoICsgJ3B4JyA6ICcnO1xuICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ1JpZ2h0XSA9IGJvZHlJc092ZXJmbG93aW5nICYmICFtb2RhbElzT3ZlcmZsb3dpbmcgPyBzY3JvbGxiYXJXaWR0aCArICdweCcgOiAnJztcbiAgICAgIH0sXG4gICAgICByZXNldEFkanVzdG1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBtb2RhbFtzdHlsZV1bcGFkZGluZ0xlZnRdID0gJyc7XG4gICAgICAgIG1vZGFsW3N0eWxlXVtwYWRkaW5nUmlnaHRdID0gJyc7XG4gICAgICB9LFxuICAgICAgY3JlYXRlT3ZlcmxheSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgbmV3T3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBvdmVybGF5ID0gcXVlcnlFbGVtZW50KCcuJyttb2RhbEJhY2tkcm9wU3RyaW5nKTtcbiAgXG4gICAgICAgIGlmICggb3ZlcmxheSA9PT0gbnVsbCApIHtcbiAgICAgICAgICBuZXdPdmVybGF5W3NldEF0dHJpYnV0ZV0oJ2NsYXNzJyxtb2RhbEJhY2tkcm9wU3RyaW5nKycgZmFkZScpO1xuICAgICAgICAgIG92ZXJsYXkgPSBuZXdPdmVybGF5O1xuICAgICAgICAgIGJvZHkuYXBwZW5kQ2hpbGQob3ZlcmxheSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICByZW1vdmVPdmVybGF5ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIG92ZXJsYXkgPSBxdWVyeUVsZW1lbnQoJy4nK21vZGFsQmFja2Ryb3BTdHJpbmcpOyBcbiAgICAgICAgaWYgKCBvdmVybGF5ICYmIG92ZXJsYXkgIT09IG51bGwgJiYgdHlwZW9mIG92ZXJsYXkgPT09ICdvYmplY3QnICkge1xuICAgICAgICAgIGJvZHkucmVtb3ZlQ2hpbGQob3ZlcmxheSk7IG92ZXJsYXkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAga2V5ZG93bkhhbmRsZXJUb2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSkge1xuICAgICAgICAgIG9uKGRvY3VtZW50LCBrZXlkb3duRXZlbnQsIGtleUhhbmRsZXIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9mZihkb2N1bWVudCwga2V5ZG93bkV2ZW50LCBrZXlIYW5kbGVyKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHJlc2l6ZUhhbmRsZXJUb2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSkge1xuICAgICAgICAgIG9uKGdsb2JhbE9iamVjdCwgcmVzaXplRXZlbnQsIHNlbGYudXBkYXRlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvZmYoZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgc2VsZi51cGRhdGUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGlzbWlzc0hhbmRsZXJUb2dnbGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCFoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSkge1xuICAgICAgICAgIG9uKG1vZGFsLCBjbGlja0V2ZW50LCBkaXNtaXNzSGFuZGxlcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2ZmKG1vZGFsLCBjbGlja0V2ZW50LCBkaXNtaXNzSGFuZGxlcik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvLyBoYW5kbGVyc1xuICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgY2xpY2tUYXJnZXQgPSBlW3RhcmdldF07IFxuICAgICAgICBjbGlja1RhcmdldCA9IGNsaWNrVGFyZ2V0W2hhc0F0dHJpYnV0ZV0oZGF0YVRhcmdldCkgfHwgY2xpY2tUYXJnZXRbaGFzQXR0cmlidXRlXSgnaHJlZicpID8gY2xpY2tUYXJnZXQgOiBjbGlja1RhcmdldFtwYXJlbnROb2RlXTtcbiAgICAgICAgaWYgKCAhb3BlbiAmJiBjbGlja1RhcmdldCA9PT0gZWxlbWVudCAmJiAhaGFzQ2xhc3MobW9kYWwsaW5DbGFzcykgKSB7XG4gICAgICAgICAgbW9kYWwubW9kYWxUcmlnZ2VyID0gZWxlbWVudDtcbiAgICAgICAgICByZWxhdGVkVGFyZ2V0ID0gZWxlbWVudDtcbiAgICAgICAgICBzZWxmLnNob3coKTtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBrZXlIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIga2V5ID0gZS53aGljaCB8fCBlLmtleUNvZGU7IC8vIGtleUNvZGUgZm9yIElFOFxuICAgICAgICBpZiAoc2VsZltrZXlib2FyZF0gJiYga2V5ID09IDI3ICYmIG9wZW4pIHtcbiAgICAgICAgICBzZWxmLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRpc21pc3NIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICB2YXIgY2xpY2tUYXJnZXQgPSBlW3RhcmdldF07XG4gICAgICAgIGlmICggb3BlbiAmJiAoY2xpY2tUYXJnZXRbcGFyZW50Tm9kZV1bZ2V0QXR0cmlidXRlXShkYXRhRGlzbWlzcykgPT09IGNvbXBvbmVudCBcbiAgICAgICAgICAgIHx8IGNsaWNrVGFyZ2V0W2dldEF0dHJpYnV0ZV0oZGF0YURpc21pc3MpID09PSBjb21wb25lbnRcbiAgICAgICAgICAgIHx8IChjbGlja1RhcmdldCA9PT0gbW9kYWwgJiYgc2VsZltiYWNrZHJvcF0gIT09IHN0YXRpY1N0cmluZykgKSApIHtcbiAgICAgICAgICBzZWxmLmhpZGUoKTsgcmVsYXRlZFRhcmdldCA9IG51bGw7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICB9O1xuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kc1xuICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAob3BlbiAmJiBoYXNDbGFzcyhtb2RhbCxpbkNsYXNzKSkge3RoaXMuaGlkZSgpO30gZWxzZSB7dGhpcy5zaG93KCk7fVxuICAgIH07XG4gICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBzaG93RXZlbnQsIGNvbXBvbmVudCwgcmVsYXRlZFRhcmdldCk7XG4gIFxuICAgICAgLy8gd2UgZWxlZ2FudGx5IGhpZGUgYW55IG9wZW5lZCBtb2RhbFxuICAgICAgdmFyIGN1cnJlbnRPcGVuID0gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShkb2N1bWVudCxjb21wb25lbnQrJyBpbicpWzBdO1xuICAgICAgY3VycmVudE9wZW4gJiYgY3VycmVudE9wZW4gIT09IG1vZGFsICYmIGN1cnJlbnRPcGVuLm1vZGFsVHJpZ2dlcltzdHJpbmdNb2RhbF0uaGlkZSgpOyBcbiAgXG4gICAgICBpZiAoIHRoaXNbYmFja2Ryb3BdICkge1xuICAgICAgICBjcmVhdGVPdmVybGF5KCk7XG4gICAgICB9XG4gIFxuICAgICAgaWYgKCBvdmVybGF5ICYmICFoYXNDbGFzcyhvdmVybGF5LGluQ2xhc3MpKSB7XG4gICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgeyBhZGRDbGFzcyhvdmVybGF5LGluQ2xhc3MpOyB9LCAwKTtcbiAgICAgIH1cbiAgXG4gICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgbW9kYWxbc3R5bGVdLmRpc3BsYXkgPSAnYmxvY2snO1xuICBcbiAgICAgICAgY2hlY2tTY3JvbGxiYXIoKTtcbiAgICAgICAgc2V0U2Nyb2xsYmFyKCk7XG4gICAgICAgIGFkanVzdERpYWxvZygpO1xuICBcbiAgICAgICAgcmVzaXplSGFuZGxlclRvZ2dsZSgpO1xuICAgICAgICBkaXNtaXNzSGFuZGxlclRvZ2dsZSgpO1xuICAgICAgICBrZXlkb3duSGFuZGxlclRvZ2dsZSgpO1xuICBcbiAgICAgICAgYWRkQ2xhc3MoYm9keSxjb21wb25lbnQrJy1vcGVuJyk7XG4gICAgICAgIGFkZENsYXNzKG1vZGFsLGluQ2xhc3MpO1xuICAgICAgICBtb2RhbFtzZXRBdHRyaWJ1dGVdKGFyaWFIaWRkZW4sIGZhbHNlKTtcbiAgICAgIH0sIDApO1xuICBcbiAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKG1vZGFsLCBmdW5jdGlvbigpIHtcbiAgICAgICAgb3BlbiA9IHNlbGYub3BlbiA9IHRydWU7XG4gICAgICAgIHNldEZvY3VzKG1vZGFsKTtcbiAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChtb2RhbCwgc2hvd25FdmVudCwgY29tcG9uZW50LCByZWxhdGVkVGFyZ2V0KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICBvdmVybGF5ID0gcXVlcnlFbGVtZW50KCcuJyttb2RhbEJhY2tkcm9wU3RyaW5nKTtcbiAgXG4gICAgICBpZiAoIG92ZXJsYXkgIT09IG51bGwgKSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKG92ZXJsYXksaW5DbGFzcyk7XG4gICAgICB9XG4gICAgICByZW1vdmVDbGFzcyhtb2RhbCxpbkNsYXNzKTtcbiAgICAgIG1vZGFsW3NldEF0dHJpYnV0ZV0oYXJpYUhpZGRlbiwgdHJ1ZSk7XG4gIFxuICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQobW9kYWwsIGZ1bmN0aW9uKCkge1xuICAgICAgICByZW1vdmVDbGFzcyhib2R5LGNvbXBvbmVudCsnLW9wZW4nKTtcbiAgICAgICAgcmVzaXplSGFuZGxlclRvZ2dsZSgpO1xuICAgICAgICBkaXNtaXNzSGFuZGxlclRvZ2dsZSgpO1xuICAgICAgICBrZXlkb3duSGFuZGxlclRvZ2dsZSgpO1xuICBcbiAgICAgICAgcmVzZXRBZGp1c3RtZW50cygpO1xuICAgICAgICByZXNldFNjcm9sbGJhcigpO1xuICAgICAgICBtb2RhbFtzdHlsZV0uZGlzcGxheSA9ICcnO1xuICBcbiAgICAgICAgaWYgKCFnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGRvY3VtZW50LGNvbXBvbmVudCsnICcraW5DbGFzcylbMF0pIHsgcmVtb3ZlT3ZlcmxheSgpOyB9XG4gICAgICAgIG9wZW4gPSBzZWxmLm9wZW4gPSBmYWxzZTtcbiAgICAgICAgZWxlbWVudCAmJiAoc2V0Rm9jdXMoZWxlbWVudCkpO1xuICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG1vZGFsLCBoaWRkZW5FdmVudCwgY29tcG9uZW50KTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgdGhpcy5zZXRDb250ZW50ID0gZnVuY3Rpb24oIGNvbnRlbnQgKSB7XG4gICAgICBxdWVyeUVsZW1lbnQoJy4nK2NvbXBvbmVudCsnLWNvbnRlbnQnLG1vZGFsKS5pbm5lckhUTUwgPSBjb250ZW50O1xuICAgIH07XG4gICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChvcGVuKSB7XG4gICAgICAgIGNoZWNrU2Nyb2xsYmFyKCk7XG4gICAgICAgIHNldFNjcm9sbGJhcigpO1xuICAgICAgICBhZGp1c3REaWFsb2coKTtcbiAgICAgIH1cbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgb3ZlciBhbmQgb3ZlclxuICAgIC8vIG1vZGFsIGlzIGluZGVwZW5kZW50IG9mIGEgdHJpZ2dlcmluZyBlbGVtZW50IFxuICAgIGlmICggISFlbGVtZW50ICYmICEoc3RyaW5nTW9kYWwgaW4gZWxlbWVudCkgKSB7XG4gICAgICBvbihlbGVtZW50LCBjbGlja0V2ZW50LCBjbGlja0hhbmRsZXIpO1xuICAgIH1cbiAgICBpZiAoICEhdGhpc1tjb250ZW50XSApIHsgdGhpcy5zZXRDb250ZW50KCB0aGlzW2NvbnRlbnRdICk7IH1cbiAgICAhIWVsZW1lbnQgJiYgKGVsZW1lbnRbc3RyaW5nTW9kYWxdID0gdGhpcyk7XG4gIH07XG4gIFxuICAvLyBEQVRBIEFQSVxuICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdNb2RhbCwgTW9kYWwsIGRhdGFUb2dnbGUpO1xuICBcbiAgXG4gIC8qIE5hdGl2ZSBKYXZhc2NyaXB0IGZvciBCb290c3RyYXAgMyB8IFBvcG92ZXJcbiAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4gIFxuICAvLyBQT1BPVkVSIERFRklOSVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09XG4gIHZhciBQb3BvdmVyID0gZnVuY3Rpb24oIGVsZW1lbnQsIG9wdGlvbnMgKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBEQVRBIEFQSVxuICAgIHZhciB0cmlnZ2VyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVHJpZ2dlciksIC8vIGNsaWNrIC8gaG92ZXIgLyBmb2N1c1xuICAgICAgICBhbmltYXRpb25EYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFBbmltYXRpb24pLCAvLyB0cnVlIC8gZmFsc2VcbiAgICAgICAgcGxhY2VtZW50RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhUGxhY2VtZW50KSxcbiAgICAgICAgZGlzbWlzc2libGVEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFEaXNtaXNzaWJsZSksXG4gICAgICAgIGRlbGF5RGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhRGVsYXkpLFxuICAgICAgICBjb250YWluZXJEYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFDb250YWluZXIpLFxuICBcbiAgICAgICAgLy8gaW50ZXJuYWwgc3RyaW5nc1xuICAgICAgICBjb21wb25lbnQgPSAncG9wb3ZlcicsXG4gICAgICAgIHRlbXBsYXRlID0gJ3RlbXBsYXRlJyxcbiAgICAgICAgdHJpZ2dlciA9ICd0cmlnZ2VyJyxcbiAgICAgICAgY2xhc3NTdHJpbmcgPSAnY2xhc3MnLFxuICAgICAgICBkaXYgPSAnZGl2JyxcbiAgICAgICAgZmFkZSA9ICdmYWRlJyxcbiAgICAgICAgdGl0bGUgPSAndGl0bGUnLFxuICAgICAgICBjb250ZW50ID0gJ2NvbnRlbnQnLFxuICAgICAgICBkYXRhVGl0bGUgPSAnZGF0YS10aXRsZScsXG4gICAgICAgIGRhdGFDb250ZW50ID0gJ2RhdGEtY29udGVudCcsXG4gICAgICAgIGRpc21pc3NpYmxlID0gJ2Rpc21pc3NpYmxlJyxcbiAgICAgICAgY2xvc2VCdG4gPSAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJjbG9zZVwiPsOXPC9idXR0b24+JztcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICB0aGlzW3RlbXBsYXRlXSA9IG9wdGlvbnNbdGVtcGxhdGVdID8gb3B0aW9uc1t0ZW1wbGF0ZV0gOiBudWxsOyAvLyBKYXZhU2NyaXB0IG9ubHlcbiAgICB0aGlzW3RyaWdnZXJdID0gb3B0aW9uc1t0cmlnZ2VyXSA/IG9wdGlvbnNbdHJpZ2dlcl0gOiB0cmlnZ2VyRGF0YSB8fCBob3ZlckV2ZW50O1xuICAgIHRoaXNbYW5pbWF0aW9uXSA9IG9wdGlvbnNbYW5pbWF0aW9uXSAmJiBvcHRpb25zW2FuaW1hdGlvbl0gIT09IGZhZGUgPyBvcHRpb25zW2FuaW1hdGlvbl0gOiBhbmltYXRpb25EYXRhIHx8IGZhZGU7XG4gICAgdGhpc1twbGFjZW1lbnRdID0gb3B0aW9uc1twbGFjZW1lbnRdID8gb3B0aW9uc1twbGFjZW1lbnRdIDogcGxhY2VtZW50RGF0YSB8fCB0b3A7XG4gICAgdGhpc1tkZWxheV0gPSBwYXJzZUludChvcHRpb25zW2RlbGF5XSB8fCBkZWxheURhdGEpIHx8IDIwMDtcbiAgICB0aGlzW2Rpc21pc3NpYmxlXSA9IG9wdGlvbnNbZGlzbWlzc2libGVdIHx8IGRpc21pc3NpYmxlRGF0YSA9PT0gJ3RydWUnID8gdHJ1ZSA6IGZhbHNlO1xuICAgIHRoaXNbY29udGFpbmVyXSA9IHF1ZXJ5RWxlbWVudChvcHRpb25zW2NvbnRhaW5lcl0pIHx8IHF1ZXJ5RWxlbWVudChjb250YWluZXJEYXRhKSB8fCBib2R5O1xuICAgIFxuICAgIC8vIGJpbmQsIGNvbnRlbnRcbiAgICB2YXIgc2VsZiA9IHRoaXMsIFxuICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YVRpdGxlKSB8fCBudWxsLFxuICAgICAgY29udGVudFN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGVudCkgfHwgbnVsbDtcbiAgXG4gICAgaWYgKCAhY29udGVudFN0cmluZyAmJiAhdGhpc1t0ZW1wbGF0ZV0gKSByZXR1cm47IC8vIGludmFsaWRhdGVcbiAgXG4gICAgLy8gY29uc3RhbnRzLCB2YXJzXG4gICAgdmFyIHBvcG92ZXIgPSBudWxsLCB0aW1lciA9IDAsIHBsYWNlbWVudFNldHRpbmcgPSB0aGlzW3BsYWNlbWVudF0sXG4gICAgICBcbiAgICAgIC8vIGhhbmRsZXJzXG4gICAgICBkaXNtaXNzaWJsZUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChwb3BvdmVyICE9PSBudWxsICYmIGVbdGFyZ2V0XSA9PT0gcXVlcnlFbGVtZW50KCcuY2xvc2UnLHBvcG92ZXIpKSB7XG4gICAgICAgICAgc2VsZi5oaWRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gIFxuICAgICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgICByZW1vdmVQb3BvdmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGZbY29udGFpbmVyXS5yZW1vdmVDaGlsZChwb3BvdmVyKTtcbiAgICAgICAgdGltZXIgPSBudWxsOyBwb3BvdmVyID0gbnVsbDsgXG4gICAgICB9LFxuICAgICAgY3JlYXRlUG9wb3ZlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aXRsZVN0cmluZyA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGl0bGUpOyAvLyBjaGVjayBjb250ZW50IGFnYWluXG4gICAgICAgIGNvbnRlbnRTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUNvbnRlbnQpO1xuICBcbiAgICAgICAgcG9wb3ZlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcbiAgXG4gICAgICAgIGlmICggY29udGVudFN0cmluZyAhPT0gbnVsbCAmJiBzZWxmW3RlbXBsYXRlXSA9PT0gbnVsbCApIHsgLy9jcmVhdGUgdGhlIHBvcG92ZXIgZnJvbSBkYXRhIGF0dHJpYnV0ZXNcbiAgXG4gICAgICAgICAgcG9wb3ZlcltzZXRBdHRyaWJ1dGVdKCdyb2xlJywndG9vbHRpcCcpO1xuICBcbiAgICAgICAgICBpZiAodGl0bGVTdHJpbmcgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHZhciBwb3BvdmVyVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuICAgICAgICAgICAgcG9wb3ZlclRpdGxlW3NldEF0dHJpYnV0ZV0oY2xhc3NTdHJpbmcsY29tcG9uZW50KyctdGl0bGUnKTtcbiAgXG4gICAgICAgICAgICBwb3BvdmVyVGl0bGUuaW5uZXJIVE1MID0gc2VsZltkaXNtaXNzaWJsZV0gPyB0aXRsZVN0cmluZyArIGNsb3NlQnRuIDogdGl0bGVTdHJpbmc7XG4gICAgICAgICAgICBwb3BvdmVyLmFwcGVuZENoaWxkKHBvcG92ZXJUaXRsZSk7XG4gICAgICAgICAgfVxuICBcbiAgICAgICAgICB2YXIgcG9wb3ZlckFycm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpLCBwb3BvdmVyQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcbiAgICAgICAgICBwb3BvdmVyQXJyb3dbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywnYXJyb3cnKTsgcG9wb3ZlckNvbnRlbnRbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZyxjb21wb25lbnQrJy1jb250ZW50Jyk7XG4gICAgICAgICAgcG9wb3Zlci5hcHBlbmRDaGlsZChwb3BvdmVyQXJyb3cpOyBwb3BvdmVyLmFwcGVuZENoaWxkKHBvcG92ZXJDb250ZW50KTtcbiAgXG4gICAgICAgICAgLy9zZXQgcG9wb3ZlciBjb250ZW50XG4gICAgICAgICAgcG9wb3ZlckNvbnRlbnQuaW5uZXJIVE1MID0gc2VsZltkaXNtaXNzaWJsZV0gJiYgdGl0bGVTdHJpbmcgPT09IG51bGwgPyBjb250ZW50U3RyaW5nICsgY2xvc2VCdG4gOiBjb250ZW50U3RyaW5nO1xuICBcbiAgICAgICAgfSBlbHNlIHsgIC8vIG9yIGNyZWF0ZSB0aGUgcG9wb3ZlciBmcm9tIHRlbXBsYXRlXG4gICAgICAgICAgdmFyIHBvcG92ZXJUZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZGl2KTtcbiAgICAgICAgICBwb3BvdmVyVGVtcGxhdGUuaW5uZXJIVE1MID0gc2VsZlt0ZW1wbGF0ZV07XG4gICAgICAgICAgcG9wb3Zlci5pbm5lckhUTUwgPSBwb3BvdmVyVGVtcGxhdGUuZmlyc3RDaGlsZC5pbm5lckhUTUw7XG4gICAgICAgIH1cbiAgXG4gICAgICAgIC8vYXBwZW5kIHRvIHRoZSBjb250YWluZXJcbiAgICAgICAgc2VsZltjb250YWluZXJdLmFwcGVuZENoaWxkKHBvcG92ZXIpO1xuICAgICAgICBwb3BvdmVyW3N0eWxlXS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgcG9wb3ZlcltzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCBjb21wb25lbnQrICcgJyArIHBsYWNlbWVudFNldHRpbmcgKyAnICcgKyBzZWxmW2FuaW1hdGlvbl0pO1xuICAgICAgfSxcbiAgICAgIHNob3dQb3BvdmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAhaGFzQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSAmJiAoIGFkZENsYXNzKHBvcG92ZXIsaW5DbGFzcykgKTtcbiAgICAgIH0sXG4gICAgICB1cGRhdGVQb3BvdmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHN0eWxlVGlwKGVsZW1lbnQscG9wb3ZlcixwbGFjZW1lbnRTZXR0aW5nLHNlbGZbY29udGFpbmVyXSk7XG4gICAgICAgIGlmICghaXNFbGVtZW50SW5WaWV3cG9ydChwb3BvdmVyKSApIHsgXG4gICAgICAgICAgcGxhY2VtZW50U2V0dGluZyA9IHVwZGF0ZVBsYWNlbWVudChwbGFjZW1lbnRTZXR0aW5nKTsgXG4gICAgICAgICAgc3R5bGVUaXAoZWxlbWVudCxwb3BvdmVyLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTsgXG4gICAgICAgIH1cbiAgICAgIH07XG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RzIC8gaGFuZGxlcnNcbiAgICB0aGlzLnRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHBvcG92ZXIgPT09IG51bGwpIHsgc2VsZi5zaG93KCk7IH0gXG4gICAgICBlbHNlIHsgc2VsZi5oaWRlKCk7IH1cbiAgICB9O1xuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChwb3BvdmVyID09PSBudWxsKSB7XG4gICAgICAgICAgcGxhY2VtZW50U2V0dGluZyA9IHNlbGZbcGxhY2VtZW50XTsgLy8gd2UgcmVzZXQgcGxhY2VtZW50IGluIGFsbCBjYXNlc1xuICAgICAgICAgIGNyZWF0ZVBvcG92ZXIoKTtcbiAgICAgICAgICB1cGRhdGVQb3BvdmVyKCk7XG4gICAgICAgICAgc2hvd1BvcG92ZXIoKTtcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIHNob3dFdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZChwb3BvdmVyLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2hvd25FdmVudCwgY29tcG9uZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSwgMjAgKTtcbiAgICB9O1xuICAgIHRoaXMuaGlkZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChwb3BvdmVyICYmIHBvcG92ZXIgIT09IG51bGwgJiYgaGFzQ2xhc3MocG9wb3ZlcixpbkNsYXNzKSkge1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgaGlkZUV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIHJlbW92ZUNsYXNzKHBvcG92ZXIsaW5DbGFzcyk7XG4gICAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQocG9wb3ZlciwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZW1vdmVQb3BvdmVyKCk7XG4gICAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKGVsZW1lbnQsIGhpZGRlbkV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBzZWxmW2RlbGF5XSApO1xuICAgIH07XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nUG9wb3ZlciBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIGlmIChzZWxmW3RyaWdnZXJdID09PSBob3ZlckV2ZW50KSB7XG4gICAgICAgIG9uKCBlbGVtZW50LCBtb3VzZUhvdmVyWzBdLCBzZWxmLnNob3cgKTtcbiAgICAgICAgaWYgKCFzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZWxlbWVudCwgbW91c2VIb3ZlclsxXSwgc2VsZi5oaWRlICk7IH1cbiAgICAgIH0gZWxzZSBpZiAoL14oY2xpY2t8Zm9jdXMpJC8udGVzdChzZWxmW3RyaWdnZXJdKSkge1xuICAgICAgICBvbiggZWxlbWVudCwgc2VsZlt0cmlnZ2VyXSwgc2VsZi50b2dnbGUgKTtcbiAgICAgICAgaWYgKCFzZWxmW2Rpc21pc3NpYmxlXSkgeyBvbiggZWxlbWVudCwgJ2JsdXInLCBzZWxmLmhpZGUgKTsgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoc2VsZltkaXNtaXNzaWJsZV0pIHsgb24oIGRvY3VtZW50LCBjbGlja0V2ZW50LCBkaXNtaXNzaWJsZUhhbmRsZXIgKTsgfVxuICAgIFxuICAgICAgLy8gZGlzbWlzcyBvbiB3aW5kb3cgcmVzaXplXG4gICAgICBpZiAoICEoaXNJRSAmJiBpc0lFIDwgOSkgKSB7IG9uKCBnbG9iYWxPYmplY3QsIHJlc2l6ZUV2ZW50LCBzZWxmLmhpZGUgKTsgfVxuICBcbiAgICB9XG4gICAgZWxlbWVudFtzdHJpbmdQb3BvdmVyXSA9IHNlbGY7XG4gIH07XG4gIFxuICAvLyBQT1BPVkVSIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT1cbiAgaW5pdGlhbGl6ZURhdGFBUEkoc3RyaW5nUG9wb3ZlciwgUG9wb3ZlciwgZGF0YVRvZ2dsZSk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgU2Nyb2xsU3B5XG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIFNDUk9MTFNQWSBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PT09XG4gIHZhciBTY3JvbGxTcHkgPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnQsIHRoZSBlbGVtZW50IHdlIHNweSBvblxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7IFxuICBcbiAgICAvLyBEQVRBIEFQSVxuICAgIHZhciB0YXJnZXREYXRhID0gcXVlcnlFbGVtZW50KGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhVGFyZ2V0KSk7XG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgaWYgKCAhb3B0aW9uc1t0YXJnZXRdICYmICF0YXJnZXREYXRhICkgeyByZXR1cm47IH0gLy8gaW52YWxpZGF0ZVxuICBcbiAgICAvLyBldmVudCB0YXJnZXRzLCBjb25zdGFudHNcbiAgICB2YXIgc3B5VGFyZ2V0ID0gb3B0aW9uc1t0YXJnZXRdICYmIHF1ZXJ5RWxlbWVudChvcHRpb25zW3RhcmdldF0pIHx8IHRhcmdldERhdGEsXG4gICAgICAgIGxpbmtzID0gc3B5VGFyZ2V0ICYmIHNweVRhcmdldFtnZXRFbGVtZW50c0J5VGFnTmFtZV0oJ0EnKSwgXG4gICAgICAgIGl0ZW1zID0gW10sIHRhcmdldEl0ZW1zID0gW10sIHNjcm9sbE9mZnNldCxcbiAgICAgICAgc2Nyb2xsVGFyZ2V0ID0gZWxlbWVudFtvZmZzZXRIZWlnaHRdIDwgZWxlbWVudFtzY3JvbGxIZWlnaHRdID8gZWxlbWVudCA6IGdsb2JhbE9iamVjdCwgLy8gZGV0ZXJtaW5lIHdoaWNoIGlzIHRoZSByZWFsIHNjcm9sbFRhcmdldFxuICAgICAgICBpc1dpbmRvdyA9IHNjcm9sbFRhcmdldCA9PT0gZ2xvYmFsT2JqZWN0OyAgXG4gIFxuICAgIC8vIHBvcHVsYXRlIGl0ZW1zIGFuZCB0YXJnZXRzXG4gICAgZm9yICh2YXIgaT0wLCBpbD1saW5rc1tsZW5ndGhdOyBpPGlsOyBpKyspIHtcbiAgICAgIHZhciBocmVmID0gbGlua3NbaV1bZ2V0QXR0cmlidXRlXSgnaHJlZicpLCBcbiAgICAgICAgICB0YXJnZXRJdGVtID0gaHJlZiAmJiAvI1thLXowLTldKyQvaS50ZXN0KGhyZWYpICYmIHF1ZXJ5RWxlbWVudChocmVmKTtcbiAgICAgIGlmICggISF0YXJnZXRJdGVtICkge1xuICAgICAgICBpdGVtcy5wdXNoKGxpbmtzW2ldKTtcbiAgICAgICAgdGFyZ2V0SXRlbXMucHVzaCh0YXJnZXRJdGVtKTtcbiAgICAgIH1cbiAgICB9XG4gIFxuICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgIHZhciB1cGRhdGVJdGVtID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IGl0ZW1zW2luZGV4XVtwYXJlbnROb2RlXSwgLy8gaXRlbSdzIHBhcmVudCBMSSBlbGVtZW50XG4gICAgICAgICAgdGFyZ2V0SXRlbSA9IHRhcmdldEl0ZW1zW2luZGV4XSwgLy8gdGhlIG1lbnUgaXRlbSB0YXJnZXRzIHRoaXMgZWxlbWVudFxuICAgICAgICAgIGRyb3Bkb3duID0gZ2V0Q2xvc2VzdChwYXJlbnQsJy5kcm9wZG93bicpLFxuICAgICAgICAgIHRhcmdldFJlY3QgPSBpc1dpbmRvdyAmJiB0YXJnZXRJdGVtW2dldEJvdW5kaW5nQ2xpZW50UmVjdF0oKSxcbiAgXG4gICAgICAgICAgaXNBY3RpdmUgPSBoYXNDbGFzcyhwYXJlbnQsYWN0aXZlKSB8fCBmYWxzZSxcbiAgXG4gICAgICAgICAgdG9wRWRnZSA9IGlzV2luZG93ID8gdGFyZ2V0UmVjdFt0b3BdICsgc2Nyb2xsT2Zmc2V0IDogdGFyZ2V0SXRlbVtvZmZzZXRUb3BdIC0gKHRhcmdldEl0ZW1zW2luZGV4LTFdID8gMCA6IDEwKSxcbiAgICAgICAgICBib3R0b21FZGdlID0gaXNXaW5kb3cgPyB0YXJnZXRSZWN0W2JvdHRvbV0gKyBzY3JvbGxPZmZzZXQgOiB0YXJnZXRJdGVtc1tpbmRleCsxXSA/IHRhcmdldEl0ZW1zW2luZGV4KzFdW29mZnNldFRvcF0gOiBlbGVtZW50W3Njcm9sbEhlaWdodF0sXG4gIFxuICAgICAgICAgIGluc2lkZSA9IHNjcm9sbE9mZnNldCA+PSB0b3BFZGdlICYmIGJvdHRvbUVkZ2UgPiBzY3JvbGxPZmZzZXQ7XG4gIFxuICAgICAgICBpZiAoICFpc0FjdGl2ZSAmJiBpbnNpZGUgKSB7XG4gICAgICAgICAgaWYgKCBwYXJlbnQudGFnTmFtZSA9PT0gJ0xJJyAmJiAhaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgKSB7XG4gICAgICAgICAgICBhZGRDbGFzcyhwYXJlbnQsYWN0aXZlKTtcbiAgICAgICAgICAgIGlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChkcm9wZG93biAmJiAhaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSApIHtcbiAgICAgICAgICAgICAgYWRkQ2xhc3MoZHJvcGRvd24sYWN0aXZlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgJ2FjdGl2YXRlJywgJ3Njcm9sbHNweScsIGl0ZW1zW2luZGV4XSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCAhaW5zaWRlICkge1xuICAgICAgICAgIGlmICggcGFyZW50LnRhZ05hbWUgPT09ICdMSScgJiYgaGFzQ2xhc3MocGFyZW50LGFjdGl2ZSkgKSB7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyhwYXJlbnQsYWN0aXZlKTtcbiAgICAgICAgICAgIGlzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoZHJvcGRvd24gJiYgaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSAmJiAhZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShwYXJlbnRbcGFyZW50Tm9kZV0sYWN0aXZlKS5sZW5ndGggKSB7XG4gICAgICAgICAgICAgIHJlbW92ZUNsYXNzKGRyb3Bkb3duLGFjdGl2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCAhaW5zaWRlICYmICFpc0FjdGl2ZSB8fCBpc0FjdGl2ZSAmJiBpbnNpZGUgKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgdXBkYXRlSXRlbXMgPSBmdW5jdGlvbigpe1xuICAgICAgICBzY3JvbGxPZmZzZXQgPSBpc1dpbmRvdyA/IGdldFNjcm9sbCgpLnkgOiBlbGVtZW50W3Njcm9sbFRvcF07XG4gICAgICAgIGZvciAodmFyIGluZGV4PTAsIGl0bD1pdGVtc1tsZW5ndGhdOyBpbmRleDxpdGw7IGluZGV4KyspIHtcbiAgICAgICAgICB1cGRhdGVJdGVtKGluZGV4KVxuICAgICAgICB9XG4gICAgICB9O1xuICBcbiAgICAvLyBwdWJsaWMgbWV0aG9kXG4gICAgdGhpcy5yZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgdXBkYXRlSXRlbXMoKTtcbiAgICB9XG4gIFxuICAgIC8vIGluaXRcbiAgICBpZiAoICEoc3RyaW5nU2Nyb2xsU3B5IGluIGVsZW1lbnQpICkgeyAvLyBwcmV2ZW50IGFkZGluZyBldmVudCBoYW5kbGVycyB0d2ljZVxuICAgICAgb24oIHNjcm9sbFRhcmdldCwgc2Nyb2xsRXZlbnQsIHRoaXMucmVmcmVzaCApO1xuICAgICAgaWYgKCAhKGlzSUUgJiYgaXNJRSA8IDkpKSB7IFxuICAgICAgICBvbiggZ2xvYmFsT2JqZWN0LCByZXNpemVFdmVudCwgdGhpcy5yZWZyZXNoICk7IFxuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgICBlbGVtZW50W3N0cmluZ1Njcm9sbFNweV0gPSB0aGlzO1xuICB9O1xuICBcbiAgLy8gU0NST0xMU1BZIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdTY3JvbGxTcHksIFNjcm9sbFNweSwgZGF0YVNweSk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgVGFiXG4gIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbiAgXG4gIC8vIFRBQiBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09XG4gIHZhciBUYWIgPSBmdW5jdGlvbiggZWxlbWVudCwgb3B0aW9ucyApIHtcbiAgXG4gICAgLy8gaW5pdGlhbGl6YXRpb24gZWxlbWVudFxuICAgIGVsZW1lbnQgPSBxdWVyeUVsZW1lbnQoZWxlbWVudCk7XG4gIFxuICAgIC8vIERBVEEgQVBJXG4gICAgdmFyIGhlaWdodERhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YUhlaWdodCksXG4gICAgICBcbiAgICAgICAgLy8gc3RyaW5nc1xuICAgICAgICBjb21wb25lbnQgPSAndGFiJywgaGVpZ2h0ID0gJ2hlaWdodCcsIGlzQW5pbWF0aW5nID0gJ2lzQW5pbWF0aW5nJztcbiAgXG4gICAgLy8gc2V0IGRlZmF1bHQgYW5pbWF0aW9uIHN0YXRlXG4gICAgZWxlbWVudFtpc0FuaW1hdGluZ10gPSBmYWxzZTtcbiAgXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICB0aGlzW2hlaWdodF0gPSBzdXBwb3J0VHJhbnNpdGlvbnMgPyAob3B0aW9uc1toZWlnaHRdIHx8IGhlaWdodERhdGEgPT09ICd0cnVlJykgOiBmYWxzZTsgLy8gZmlsdGVyIGxlZ2FjeSBicm93c2Vyc1xuICBcbiAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzXG4gICAgdmFyIHNlbGYgPSB0aGlzLCBuZXh0LFxuICAgICAgdGFicyA9IGdldENsb3Nlc3QoZWxlbWVudCwnLm5hdicpLFxuICAgICAgdGFic0NvbnRlbnRDb250YWluZXIsXG4gICAgICBkcm9wZG93biA9IHF1ZXJ5RWxlbWVudCgnLmRyb3Bkb3duJyx0YWJzKTtcbiAgXG4gICAgLy8gcHJpdmF0ZSBtZXRob2RzXG4gICAgdmFyIGdldEFjdGl2ZVRhYiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYWN0aXZlVGFicyA9IGdldEVsZW1lbnRzQnlDbGFzc05hbWUodGFicyxhY3RpdmUpLCBhY3RpdmVUYWI7XG4gICAgICAgIGlmICggYWN0aXZlVGFic1tsZW5ndGhdID09PSAxICYmICFoYXNDbGFzcyhhY3RpdmVUYWJzWzBdLCdkcm9wZG93bicpICkge1xuICAgICAgICAgIGFjdGl2ZVRhYiA9IGFjdGl2ZVRhYnNbMF07XG4gICAgICAgIH0gZWxzZSBpZiAoIGFjdGl2ZVRhYnNbbGVuZ3RoXSA+IDEgKSB7XG4gICAgICAgICAgYWN0aXZlVGFiID0gYWN0aXZlVGFic1thY3RpdmVUYWJzW2xlbmd0aF0tMV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjdGl2ZVRhYltnZXRFbGVtZW50c0J5VGFnTmFtZV0oJ0EnKVswXTtcbiAgICAgIH0sXG4gICAgICBnZXRBY3RpdmVDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBxdWVyeUVsZW1lbnQoZ2V0QWN0aXZlVGFiKClbZ2V0QXR0cmlidXRlXSgnaHJlZicpKTtcbiAgICAgIH0sXG4gICAgICAvLyBoYW5kbGVyIFxuICAgICAgY2xpY2tIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIG5leHQgPSBlW3RhcmdldF07XG4gICAgICAgIHNlbGYuc2hvdygpO1xuICAgICAgfTtcbiAgXG4gICAgLy8gcHVibGljIG1ldGhvZFxuICAgIHRoaXMuc2hvdyA9IGZ1bmN0aW9uKCkgeyAvLyB0aGUgdGFiIHdlIGNsaWNrZWQgaXMgbm93IHRoZSBuZXh0IHRhYlxuICAgICAgdmFyIG5leHRDb250ZW50ID0gcXVlcnlFbGVtZW50KG5leHRbZ2V0QXR0cmlidXRlXSgnaHJlZicpKSwgLy90aGlzIGlzIHRoZSBhY3R1YWwgb2JqZWN0LCB0aGUgbmV4dCB0YWIgY29udGVudCB0byBhY3RpdmF0ZVxuICAgICAgICBhY3RpdmVUYWIgPSBnZXRBY3RpdmVUYWIoKSwgYWN0aXZlQ29udGVudCA9IGdldEFjdGl2ZUNvbnRlbnQoKTtcbiAgICAgIFxuICAgICAgaWYgKCAoIWFjdGl2ZVRhYltpc0FuaW1hdGluZ10gfHwgIW5leHRbaXNBbmltYXRpbmddKSAmJiAhaGFzQ2xhc3MobmV4dFtwYXJlbnROb2RlXSxhY3RpdmUpICkge1xuICAgICAgICBhY3RpdmVUYWJbaXNBbmltYXRpbmddID0gbmV4dFtpc0FuaW1hdGluZ10gPSB0cnVlO1xuICAgICAgICByZW1vdmVDbGFzcyhhY3RpdmVUYWJbcGFyZW50Tm9kZV0sYWN0aXZlKTtcbiAgICAgICAgYWRkQ2xhc3MobmV4dFtwYXJlbnROb2RlXSxhY3RpdmUpO1xuICBcbiAgICAgICAgaWYgKCBkcm9wZG93biApIHtcbiAgICAgICAgICBpZiAoICFoYXNDbGFzcyhlbGVtZW50W3BhcmVudE5vZGVdW3BhcmVudE5vZGVdLCdkcm9wZG93bi1tZW51JykgKSB7XG4gICAgICAgICAgICBpZiAoaGFzQ2xhc3MoZHJvcGRvd24sYWN0aXZlKSkgcmVtb3ZlQ2xhc3MoZHJvcGRvd24sYWN0aXZlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCFoYXNDbGFzcyhkcm9wZG93bixhY3RpdmUpKSBhZGRDbGFzcyhkcm9wZG93bixhY3RpdmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHRhYnNDb250ZW50Q29udGFpbmVyKSB0YWJzQ29udGVudENvbnRhaW5lcltzdHlsZV1baGVpZ2h0XSA9IGdldE1heEhlaWdodChhY3RpdmVDb250ZW50KSArICdweCc7IC8vIGhlaWdodCBhbmltYXRpb25cbiAgXG4gICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoYWN0aXZlVGFiLCBoaWRlRXZlbnQsIGNvbXBvbmVudCwgbmV4dCk7XG4gIFxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJlbW92ZUNsYXNzKGFjdGl2ZUNvbnRlbnQsaW5DbGFzcyk7XG4gICAgICAgIH0sIDApO1xuICBcbiAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQoYWN0aXZlQ29udGVudCwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaWYgKHRhYnNDb250ZW50Q29udGFpbmVyKSBhZGRDbGFzcyh0YWJzQ29udGVudENvbnRhaW5lcixjb2xsYXBzaW5nKTtcbiAgICAgICAgICByZW1vdmVDbGFzcyhhY3RpdmVDb250ZW50LGFjdGl2ZSk7XG4gICAgICAgICAgYWRkQ2xhc3MobmV4dENvbnRlbnQsYWN0aXZlKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYWRkQ2xhc3MobmV4dENvbnRlbnQsaW5DbGFzcyk7XG4gICAgICAgICAgICBpZih0YWJzQ29udGVudENvbnRhaW5lcikgdGFic0NvbnRlbnRDb250YWluZXJbc3R5bGVdW2hlaWdodF0gPSBnZXRNYXhIZWlnaHQobmV4dENvbnRlbnQpICsgJ3B4JzsgLy8gaGVpZ2h0IGFuaW1hdGlvblxuICAgICAgICAgIH0sIDApO1xuICBcbiAgICAgICAgICBib290c3RyYXBDdXN0b21FdmVudC5jYWxsKG5leHQsIHNob3dFdmVudCwgY29tcG9uZW50LCBhY3RpdmVUYWIpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoYWN0aXZlVGFiLCBoaWRkZW5FdmVudCwgY29tcG9uZW50LCBuZXh0KTtcbiAgXG4gICAgICAgIH0pO1xuICBcbiAgICAgICAgZW11bGF0ZVRyYW5zaXRpb25FbmQobmV4dENvbnRlbnQsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwobmV4dCwgc2hvd25FdmVudCwgY29tcG9uZW50LCBhY3RpdmVUYWIpO1xuICAgICAgICAgIGlmICh0YWJzQ29udGVudENvbnRhaW5lcikgeyAvLyBoZWlnaHQgYW5pbWF0aW9uXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHRhYnNDb250ZW50Q29udGFpbmVyLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHRhYnNDb250ZW50Q29udGFpbmVyW3N0eWxlXVtoZWlnaHRdID0gICcnO1xuICAgICAgICAgICAgICAgIHJlbW92ZUNsYXNzKHRhYnNDb250ZW50Q29udGFpbmVyLGNvbGxhcHNpbmcpO1xuICAgICAgICAgICAgICAgIGFjdGl2ZVRhYltpc0FuaW1hdGluZ10gPSBuZXh0W2lzQW5pbWF0aW5nXSA9IGZhbHNlO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSwwKTtcbiAgICAgICAgICB9IGVsc2UgeyBhY3RpdmVUYWJbaXNBbmltYXRpbmddID0gbmV4dFtpc0FuaW1hdGluZ10gPSBmYWxzZTsgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ1RhYiBpbiBlbGVtZW50KSApIHsgLy8gcHJldmVudCBhZGRpbmcgZXZlbnQgaGFuZGxlcnMgdHdpY2VcbiAgICAgIG9uKGVsZW1lbnQsIGNsaWNrRXZlbnQsIGNsaWNrSGFuZGxlcik7XG4gICAgfVxuICAgIGlmICh0aGlzW2hlaWdodF0pIHsgdGFic0NvbnRlbnRDb250YWluZXIgPSBnZXRBY3RpdmVDb250ZW50KClbcGFyZW50Tm9kZV07IH1cbiAgICBlbGVtZW50W3N0cmluZ1RhYl0gPSB0aGlzO1xuICB9O1xuICBcbiAgLy8gVEFCIERBVEEgQVBJXG4gIC8vID09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdUYWIsIFRhYiwgZGF0YVRvZ2dsZSk7XG4gIFxuICBcbiAgLyogTmF0aXZlIEphdmFzY3JpcHQgZm9yIEJvb3RzdHJhcCAzIHwgVG9vbHRpcFxuICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuICBcbiAgLy8gVE9PTFRJUCBERUZJTklUSU9OXG4gIC8vID09PT09PT09PT09PT09PT09PVxuICB2YXIgVG9vbHRpcCA9IGZ1bmN0aW9uKCBlbGVtZW50LG9wdGlvbnMgKSB7XG4gIFxuICAgIC8vIGluaXRpYWxpemF0aW9uIGVsZW1lbnRcbiAgICBlbGVtZW50ID0gcXVlcnlFbGVtZW50KGVsZW1lbnQpO1xuICBcbiAgICAvLyBEQVRBIEFQSVxuICAgIHZhciBhbmltYXRpb25EYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFBbmltYXRpb24pO1xuICAgICAgICBwbGFjZW1lbnREYXRhID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKGRhdGFQbGFjZW1lbnQpO1xuICAgICAgICBkZWxheURhdGEgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YURlbGF5KSxcbiAgICAgICAgY29udGFpbmVyRGF0YSA9IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhQ29udGFpbmVyKSxcbiAgICAgICAgXG4gICAgICAgIC8vIHN0cmluZ3NcbiAgICAgICAgY29tcG9uZW50ID0gJ3Rvb2x0aXAnLFxuICAgICAgICBjbGFzc1N0cmluZyA9ICdjbGFzcycsXG4gICAgICAgIHRpdGxlID0gJ3RpdGxlJyxcbiAgICAgICAgZmFkZSA9ICdmYWRlJyxcbiAgICAgICAgZGl2ID0gJ2Rpdic7XG4gIFxuICAgIC8vIHNldCBvcHRpb25zXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gICAgdGhpc1thbmltYXRpb25dID0gb3B0aW9uc1thbmltYXRpb25dICYmIG9wdGlvbnNbYW5pbWF0aW9uXSAhPT0gZmFkZSA/IG9wdGlvbnNbYW5pbWF0aW9uXSA6IGFuaW1hdGlvbkRhdGEgfHwgZmFkZTtcbiAgICB0aGlzW3BsYWNlbWVudF0gPSBvcHRpb25zW3BsYWNlbWVudF0gPyBvcHRpb25zW3BsYWNlbWVudF0gOiBwbGFjZW1lbnREYXRhIHx8IHRvcDtcbiAgICB0aGlzW2RlbGF5XSA9IHBhcnNlSW50KG9wdGlvbnNbZGVsYXldIHx8IGRlbGF5RGF0YSkgfHwgMjAwO1xuICAgIHRoaXNbY29udGFpbmVyXSA9IHF1ZXJ5RWxlbWVudChvcHRpb25zW2NvbnRhaW5lcl0pIHx8IHF1ZXJ5RWxlbWVudChjb250YWluZXJEYXRhKSB8fCBib2R5O1xuICBcbiAgICAvLyBiaW5kLCBldmVudCB0YXJnZXRzLCB0aXRsZSBhbmQgY29uc3RhbnRzXG4gICAgdmFyIHNlbGYgPSB0aGlzLCB0aW1lciA9IDAsIHBsYWNlbWVudFNldHRpbmcgPSB0aGlzW3BsYWNlbWVudF0sIHRvb2x0aXAgPSBudWxsLFxuICAgICAgdGl0bGVTdHJpbmcgPSBlbGVtZW50W2dldEF0dHJpYnV0ZV0odGl0bGUpIHx8IGVsZW1lbnRbZ2V0QXR0cmlidXRlXShkYXRhT3JpZ2luYWxUaXRsZSk7XG4gIFxuICAgIGlmICggIXRpdGxlU3RyaW5nICkgcmV0dXJuOyAvLyBpbnZhbGlkYXRlXG4gIFxuICAgIC8vIHByaXZhdGUgbWV0aG9kc1xuICAgIHZhciByZW1vdmVUb29sVGlwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGZbY29udGFpbmVyXS5yZW1vdmVDaGlsZCh0b29sdGlwKTtcbiAgICAgICAgdG9vbHRpcCA9IG51bGw7IHRpbWVyID0gbnVsbDtcbiAgICAgIH0sXG4gICAgICBjcmVhdGVUb29sVGlwID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRpdGxlU3RyaW5nID0gZWxlbWVudFtnZXRBdHRyaWJ1dGVdKHRpdGxlKSB8fCBlbGVtZW50W2dldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGl0bGUpOyAvLyByZWFkIHRoZSB0aXRsZSBhZ2FpblxuICAgICAgICB0b29sdGlwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpO1xuICAgICAgICB0b29sdGlwW3NldEF0dHJpYnV0ZV0oJ3JvbGUnLGNvbXBvbmVudCk7XG4gIFxuICAgICAgICB2YXIgdG9vbHRpcEFycm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChkaXYpLCB0b29sdGlwSW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGRpdik7XG4gICAgICAgIHRvb2x0aXBBcnJvd1tzZXRBdHRyaWJ1dGVdKGNsYXNzU3RyaW5nLCBjb21wb25lbnQrJy1hcnJvdycpOyB0b29sdGlwSW5uZXJbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZyxjb21wb25lbnQrJy1pbm5lcicpO1xuICBcbiAgICAgICAgdG9vbHRpcC5hcHBlbmRDaGlsZCh0b29sdGlwQXJyb3cpOyB0b29sdGlwLmFwcGVuZENoaWxkKHRvb2x0aXBJbm5lcik7XG4gIFxuICAgICAgICB0b29sdGlwSW5uZXIuaW5uZXJIVE1MID0gdGl0bGVTdHJpbmc7XG4gIFxuICAgICAgICBzZWxmW2NvbnRhaW5lcl0uYXBwZW5kQ2hpbGQodG9vbHRpcCk7XG4gICAgICAgIHRvb2x0aXBbc2V0QXR0cmlidXRlXShjbGFzc1N0cmluZywgY29tcG9uZW50ICsgJyAnICsgcGxhY2VtZW50U2V0dGluZyArICcgJyArIHNlbGZbYW5pbWF0aW9uXSk7XG4gICAgICB9LFxuICAgICAgdXBkYXRlVG9vbHRpcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc3R5bGVUaXAoZWxlbWVudCx0b29sdGlwLHBsYWNlbWVudFNldHRpbmcsc2VsZltjb250YWluZXJdKTtcbiAgICAgICAgaWYgKCFpc0VsZW1lbnRJblZpZXdwb3J0KHRvb2x0aXApICkgeyBcbiAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gdXBkYXRlUGxhY2VtZW50KHBsYWNlbWVudFNldHRpbmcpOyBcbiAgICAgICAgICBzdHlsZVRpcChlbGVtZW50LHRvb2x0aXAscGxhY2VtZW50U2V0dGluZyxzZWxmW2NvbnRhaW5lcl0pOyBcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHNob3dUb29sdGlwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAhaGFzQ2xhc3ModG9vbHRpcCxpbkNsYXNzKSAmJiAoIGFkZENsYXNzKHRvb2x0aXAsaW5DbGFzcykgKTtcbiAgICAgIH07XG4gIFxuICAgIC8vIHB1YmxpYyBtZXRob2RzXG4gICAgdGhpcy5zaG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRvb2x0aXAgPT09IG51bGwpIHtcbiAgICAgICAgICBwbGFjZW1lbnRTZXR0aW5nID0gc2VsZltwbGFjZW1lbnRdOyAvLyB3ZSByZXNldCBwbGFjZW1lbnQgaW4gYWxsIGNhc2VzXG4gICAgICAgICAgY3JlYXRlVG9vbFRpcCgpO1xuICAgICAgICAgIHVwZGF0ZVRvb2x0aXAoKTtcbiAgICAgICAgICBzaG93VG9vbHRpcCgpO1xuICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgc2hvd0V2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIGVtdWxhdGVUcmFuc2l0aW9uRW5kKHRvb2x0aXAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBzaG93bkV2ZW50LCBjb21wb25lbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCAyMCApO1xuICAgIH07XG4gICAgdGhpcy5oaWRlID0gZnVuY3Rpb24oKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRvb2x0aXAgJiYgdG9vbHRpcCAhPT0gbnVsbCAmJiBoYXNDbGFzcyh0b29sdGlwLGluQ2xhc3MpKSB7XG4gICAgICAgICAgYm9vdHN0cmFwQ3VzdG9tRXZlbnQuY2FsbChlbGVtZW50LCBoaWRlRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3ModG9vbHRpcCxpbkNsYXNzKTtcbiAgICAgICAgICBlbXVsYXRlVHJhbnNpdGlvbkVuZCh0b29sdGlwLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJlbW92ZVRvb2xUaXAoKTtcbiAgICAgICAgICAgIGJvb3RzdHJhcEN1c3RvbUV2ZW50LmNhbGwoZWxlbWVudCwgaGlkZGVuRXZlbnQsIGNvbXBvbmVudCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sIHNlbGZbZGVsYXldKTtcbiAgICB9O1xuICAgIHRoaXMudG9nZ2xlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXRvb2x0aXApIHsgc2VsZi5zaG93KCk7IH0gXG4gICAgICBlbHNlIHsgc2VsZi5oaWRlKCk7IH1cbiAgICB9O1xuICBcbiAgICAvLyBpbml0XG4gICAgaWYgKCAhKHN0cmluZ1Rvb2x0aXAgaW4gZWxlbWVudCkgKSB7IC8vIHByZXZlbnQgYWRkaW5nIGV2ZW50IGhhbmRsZXJzIHR3aWNlXG4gICAgICBlbGVtZW50W3NldEF0dHJpYnV0ZV0oZGF0YU9yaWdpbmFsVGl0bGUsdGl0bGVTdHJpbmcpO1xuICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUodGl0bGUpO1xuICAgICAgb24oZWxlbWVudCwgbW91c2VIb3ZlclswXSwgdGhpcy5zaG93KTtcbiAgICAgIG9uKGVsZW1lbnQsIG1vdXNlSG92ZXJbMV0sIHRoaXMuaGlkZSk7XG4gICAgfVxuICAgIGVsZW1lbnRbc3RyaW5nVG9vbHRpcF0gPSB0aGlzO1xuICB9O1xuICBcbiAgLy8gVE9PTFRJUCBEQVRBIEFQSVxuICAvLyA9PT09PT09PT09PT09PT09PVxuICBpbml0aWFsaXplRGF0YUFQSShzdHJpbmdUb29sdGlwLCBUb29sdGlwLCBkYXRhVG9nZ2xlKTtcbiAgXG4gIFxuICByZXR1cm4ge1xuICAgIEFmZml4OiBBZmZpeCxcbiAgICBBbGVydDogQWxlcnQsXG4gICAgQnV0dG9uOiBCdXR0b24sXG4gICAgQ2Fyb3VzZWw6IENhcm91c2VsLFxuICAgIENvbGxhcHNlOiBDb2xsYXBzZSxcbiAgICBEcm9wZG93bjogRHJvcGRvd24sXG4gICAgTW9kYWw6IE1vZGFsLFxuICAgIFBvcG92ZXI6IFBvcG92ZXIsXG4gICAgU2Nyb2xsU3B5OiBTY3JvbGxTcHksXG4gICAgVGFiOiBUYWIsXG4gICAgVG9vbHRpcDogVG9vbHRpcFxuICB9O1xufSkpO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9+L2Jvb3RzdHJhcC5uYXRpdmUvZGlzdC9ib290c3RyYXAtbmF0aXZlLmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=